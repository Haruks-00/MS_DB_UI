const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/firebase-init-BJHqUzM8.js","assets/vue-B_P1t2xt.js","assets/vuetify-11KXpVxS.js"])))=>i.map(i=>d[i]);
import{x as e,b as t,J as n,d as a,K as i,r,L as s,M as o,y as l,q as u,v as c,o as d,I as h,B as p,e as f,l as v,s as m,T as g,j as y,N as b,n as w,k as _,O as I,P as S,m as C,h as k,Q as E,z as x,t as T,R as A,F as N,S as V,H as D,U as M,D as R,p as P,u as O,w as L,V as F,W as B,c as U,A as $,X as j,E as z,Y as q,Z as H,_ as G,$ as K,a0 as W,a1 as Q,a as X,a2 as Y,a3 as J,a4 as Z,a5 as ee,a6 as te,a7 as ne,a8 as ae,f as ie,a9 as re}from"./vue-B_P1t2xt.js";import{g as se,p as oe,a as le,d as ue,i as ce,b as de,c as he,e as pe,f as fe,h as ve,j as me,u as ge,k as ye,l as be,m as we,n as _e,I as Ie,o as Se,q as Ce,r as ke,S as Ee,s as xe,t as Te,v as Ae,w as Ne,x as Ve,y as De,z as Me,A as Re,B as Pe,C as Oe,D as Le,E as Fe,F as Be,G as Ue,H as $e,J as je,K as ze,L as qe,M as He,N as Ge,O as Ke,P as We,Q as Qe,R as Xe,T as Ye,U as Je,V as Ze,W as et,X as tt,Y as nt,Z as at,_ as it,$ as rt,a0 as st,a1 as ot,a2 as lt,a3 as ut,a4 as ct,a5 as dt,a6 as ht,a7 as pt,a8 as ft,a9 as vt,aa as mt,ab as gt,ac as yt,ad as bt,ae as wt,af as _t,ag as It,ah as St,ai as Ct,aj as kt,ak as Et,al as xt,am as Tt,an as At,ao as Nt,ap as Vt,aq as Dt,ar as Mt,as as Rt,at as Pt,au as Ot,av as Lt,aw as Ft,ax as Bt,ay as Ut,az as $t,aA as jt,aB as zt,aC as qt,aD as Ht,aE as Gt,aF as Kt,aG as Wt,aH as Qt}from"./vuetify-11KXpVxS.js";
/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */
let Xt;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Yt=e=>Xt=e,Jt=Symbol();function Zt(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var en,tn;(tn=en||(en={})).direct="direct",tn.patchObject="patch object",tn.patchFunction="patch function";const nn=()=>{};function an(e,t,n,a=nn){e.push(t);const i=()=>{const n=e.indexOf(t);n>-1&&(e.splice(n,1),a())};return!n&&u()&&c(i),i}function rn(e,...t){e.slice().forEach(e=>{e(...t)})}const sn=e=>e(),on=Symbol(),ln=Symbol();function un(e,t){e instanceof Map&&t instanceof Map?t.forEach((t,n)=>e.set(n,t)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const a=t[n],i=e[n];Zt(i)&&Zt(a)&&e.hasOwnProperty(n)&&!s(a)&&!o(a)?e[n]=un(i,a):e[n]=a}return e}const cn=Symbol();function dn(e){return!Zt(e)||!e.hasOwnProperty(cn)}const{assign:hn}=Object;function pn(e){return!(!s(e)||!e.effect)}function fn(n,a,i={},u,c,p){let f;const v=hn({actions:{}},i),m={deep:!0};let g,y,b,w=[],_=[];const I=u.state.value[n];let S;function C(e){let t;g=y=!1,"function"==typeof e?(e(u.state.value[n]),t={type:en.patchFunction,storeId:n,events:b}):(un(u.state.value[n],e),t={type:en.patchObject,payload:e,storeId:n,events:b});const a=S=Symbol();h().then(()=>{S===a&&(g=!0)}),y=!0,rn(w,t,u.state.value[n])}p||I||(u.state.value[n]={}),t({});const k=p?function(){const{state:e}=i,t=e?e():{};this.$patch(e=>{hn(e,t)})}:nn;const E=(e,t="")=>{if(on in e)return e[ln]=t,e;const a=function(){Yt(u);const t=Array.from(arguments),i=[],r=[];let s;rn(_,{args:t,name:a[ln],store:T,after:function(e){i.push(e)},onError:function(e){r.push(e)}});try{s=e.apply(this&&this.$id===n?this:T,t)}catch(o){throw rn(r,o),o}return s instanceof Promise?s.then(e=>(rn(i,e),e)).catch(e=>(rn(r,e),Promise.reject(e))):(rn(i,s),s)};return a[on]=!0,a[ln]=t,a},x={_p:u,$id:n,$onAction:an.bind(null,_),$patch:C,$reset:k,$subscribe(e,t={}){const a=an(w,e,t.detached,()=>i()),i=f.run(()=>d(()=>u.state.value[n],a=>{("sync"===t.flush?y:g)&&e({storeId:n,type:en.direct,events:b},a)},hn({},m,t)));return a},$dispose:function(){f.stop(),w=[],_=[],u._s.delete(n)}},T=r(x);u._s.set(n,T);const A=(u._a&&u._a.runWithContext||sn)(()=>u._e.run(()=>(f=e()).run(()=>a({action:E}))));for(const e in A){const t=A[e];if(s(t)&&!pn(t)||o(t))p||(I&&dn(t)&&(s(t)?t.value=I[e]:un(t,I[e])),u.state.value[n][e]=t);else if("function"==typeof t){const n=E(t,e);A[e]=n,v.actions[e]=t}}return hn(T,A),hn(l(T),A),Object.defineProperty(T,"$state",{get:()=>u.state.value[n],set:e=>{C(t=>{hn(t,e)})}}),u._p.forEach(e=>{hn(T,f.run(()=>e({store:T,app:u._a,pinia:u,options:v})))}),I&&p&&i.hydrate&&i.hydrate(T.$state,I),g=!0,y=!0,T}
/*! #__NO_SIDE_EFFECTS__ */function vn(e,t,r){let s,o;const l="function"==typeof t;function u(e,r){const u=i();(e=e||(u?a(Jt,null):null))&&Yt(e),(e=Xt)._s.has(s)||(l?fn(s,t,o,e):function(e,t,a){const{state:i,actions:r,getters:s}=t,o=a.state.value[e];let l;l=fn(e,function(){o||(a.state.value[e]=i?i():{});const t=p(a.state.value[e]);return hn(t,r,Object.keys(s||{}).reduce((t,i)=>(t[i]=n(f(()=>{Yt(a);const t=a._s.get(e);return s[i].call(t,t)})),t),{}))},t,a,0,!0)}(s,o,e));return e._s.get(s)}return"string"==typeof e?(s=e,o=l?r:t):(o=e,s=e.id),u.$id=s,u}var mn={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn=function(e){const t=[];let n=0;for(let a=0;a<e.length;a++){let i=e.charCodeAt(a);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&a+1<e.length&&56320==(64512&e.charCodeAt(a+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++a)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},yn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let i=0;i<e.length;i+=3){const t=e[i],r=i+1<e.length,s=r?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,u=t>>2,c=(3&t)<<4|s>>4;let d=(15&s)<<2|l>>6,h=63&l;o||(h=64,r||(d=64)),a.push(n[u],n[c],n[d],n[h])}return a.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(gn(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,a=0;for(;n<e.length;){const i=e[n++];if(i<128)t[a++]=String.fromCharCode(i);else if(i>191&&i<224){const r=e[n++];t[a++]=String.fromCharCode((31&i)<<6|63&r)}else if(i>239&&i<365){const r=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[a++]=String.fromCharCode(55296+(r>>10)),t[a++]=String.fromCharCode(56320+(1023&r))}else{const r=e[n++],s=e[n++];t[a++]=String.fromCharCode((15&i)<<12|(63&r)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],r=i<e.length?n[e.charAt(i)]:0;++i;const s=i<e.length?n[e.charAt(i)]:64;++i;const o=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==r||null==s||null==o)throw new bn;const l=t<<2|r>>4;if(a.push(l),64!==s){const e=r<<4&240|s>>2;if(a.push(e),64!==o){const e=s<<6&192|o;a.push(e)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class bn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wn=function(e){return function(e){const t=gn(e);return yn.encodeByteArray(t,!0)}(e).replace(/\./g,"")},_n=function(e){try{return yn.decodeString(e,!0)}catch(t){}return null};
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const In=()=>
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Sn=()=>{try{return In()||(()=>{if("undefined"==typeof process)return;const e=mn.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&_n(e[1]);return t&&JSON.parse(t)})()}catch(e){return}},Cn=e=>{var t,n;return null===(n=null===(t=Sn())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},kn=()=>{var e;return null===(e=Sn())||void 0===e?void 0:e.config},En=e=>{var t;return null===(t=Sn())||void 0===t?void 0:t[`_${e}`]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class xn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Tn(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}class An extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,An.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nn.prototype.create)}}class Nn{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},a=`${this.service}/${e}`,i=this.errors[e],r=i?function(e,t){return e.replace(Vn,(e,n)=>{const a=t[n];return null!=a?String(a):`<${n}?>`})}(i,n):"Error",s=`${this.serviceName}: ${r} (${a}).`;return new An(a,s,n)}}const Vn=/\{\$([^}]+)}/g;function Dn(e,t){if(e===t)return!0;const n=Object.keys(e),a=Object.keys(t);for(const i of n){if(!a.includes(i))return!1;const n=e[i],r=t[i];if(Mn(n)&&Mn(r)){if(!Dn(n,r))return!1}else if(n!==r)return!1}for(const i of a)if(!n.includes(i))return!1;return!0}function Mn(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(e){const t=[];for(const[n,a]of Object.entries(e))Array.isArray(a)?a.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a));return t.length?"&"+t.join("&"):""}class Pn{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let a;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");a=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===a.next&&(a.next=On),void 0===a.error&&(a.error=On),void 0===a.complete&&(a.complete=On);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch(e){}}),this.observers.push(a),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!=typeof console&&console.error}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function On(){}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ln(e){return e&&e._delegate?e._delegate:e}class Fn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new xn;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),a=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(a)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(a)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:Bn})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:a});n.resolve(e)}catch(t){}}}}clearInstance(e=Bn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=Bn){return this.instances.has(e)}getOptions(e=Bn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&r.resolve(a)}return a}onInit(e,t){var n;const a=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(a))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(a,i);const r=this.instances.get(a);return r&&e(r,a),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(a){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(a=e,a===Bn?void 0:a),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(i){}var a;return n||null}normalizeInstanceIdentifier(e=Bn){return this.component?this.component.multipleInstances?e:Bn:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class $n{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Un(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jn,zn;(zn=jn||(jn={}))[zn.DEBUG=0]="DEBUG",zn[zn.VERBOSE=1]="VERBOSE",zn[zn.INFO=2]="INFO",zn[zn.WARN=3]="WARN",zn[zn.ERROR=4]="ERROR",zn[zn.SILENT=5]="SILENT";const qn={debug:jn.DEBUG,verbose:jn.VERBOSE,info:jn.INFO,warn:jn.WARN,error:jn.ERROR,silent:jn.SILENT},Hn=jn.INFO,Gn={[jn.DEBUG]:"log",[jn.VERBOSE]:"log",[jn.INFO]:"info",[jn.WARN]:"warn",[jn.ERROR]:"error"},Kn=(e,t,...n)=>{if(t<e.logLevel)return;(new Date).toISOString();if(!Gn[t])throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class Wn{constructor(e){this.name=e,this._logLevel=Hn,this._logHandler=Kn,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in jn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?qn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,jn.DEBUG,...e),this._logHandler(this,jn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,jn.VERBOSE,...e),this._logHandler(this,jn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,jn.INFO,...e),this._logHandler(this,jn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,jn.WARN,...e),this._logHandler(this,jn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,jn.ERROR,...e),this._logHandler(this,jn.ERROR,...e)}}let Qn,Xn;const Yn=new WeakMap,Jn=new WeakMap,Zn=new WeakMap,ea=new WeakMap,ta=new WeakMap;let na={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Jn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Zn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ra(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function aa(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Xn||(Xn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(sa(this),t),ra(Yn.get(this))}:function(...t){return ra(e.apply(sa(this),t))}:function(t,...n){const a=e.call(sa(this),t,...n);return Zn.set(a,t.sort?t.sort():[t]),ra(a)}}function ia(e){return"function"==typeof e?aa(e):(e instanceof IDBTransaction&&function(e){if(Jn.has(e))return;const t=new Promise((t,n)=>{const a=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",r),e.removeEventListener("abort",r)},i=()=>{t(),a()},r=()=>{n(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",i),e.addEventListener("error",r),e.addEventListener("abort",r)});Jn.set(e,t)}(e),t=e,(Qn||(Qn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,na):e);var t}function ra(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const a=()=>{e.removeEventListener("success",i),e.removeEventListener("error",r)},i=()=>{t(ra(e.result)),a()},r=()=>{n(e.error),a()};e.addEventListener("success",i),e.addEventListener("error",r)});return t.then(t=>{t instanceof IDBCursor&&Yn.set(t,e)}).catch(()=>{}),ta.set(t,e),t}(e);if(ea.has(e))return ea.get(e);const t=ia(e);return t!==e&&(ea.set(e,t),ta.set(t,e)),t}const sa=e=>ta.get(e);const oa=["get","getKey","getAll","getAllKeys","count"],la=["put","add","delete","clear"],ua=new Map;function ca(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(ua.get(t))return ua.get(t);const n=t.replace(/FromIndex$/,""),a=t!==n,i=la.includes(n);if(!(n in(a?IDBIndex:IDBObjectStore).prototype)||!i&&!oa.includes(n))return;const r=async function(e,...t){const r=this.transaction(e,i?"readwrite":"readonly");let s=r.store;return a&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&r.done]))[0]};return ua.set(t,r),r}na=(e=>({...e,get:(t,n,a)=>ca(t,n)||e.get(t,n,a),has:(t,n)=>!!ca(t,n)||e.has(t,n)}))(na);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class da{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const ha="@firebase/app",pa="0.9.13",fa=new Wn("@firebase/app"),va="@firebase/app-compat",ma="@firebase/analytics-compat",ga="@firebase/analytics",ya="@firebase/app-check-compat",ba="@firebase/app-check",wa="@firebase/auth",_a="@firebase/auth-compat",Ia="@firebase/database",Sa="@firebase/database-compat",Ca="@firebase/functions",ka="@firebase/functions-compat",Ea="@firebase/installations",xa="@firebase/installations-compat",Ta="@firebase/messaging",Aa="@firebase/messaging-compat",Na="@firebase/performance",Va="@firebase/performance-compat",Da="@firebase/remote-config",Ma="@firebase/remote-config-compat",Ra="@firebase/storage",Pa="@firebase/storage-compat",Oa="@firebase/firestore",La="@firebase/firestore-compat",Fa="firebase",Ba="[DEFAULT]",Ua={[ha]:"fire-core",[va]:"fire-core-compat",[ga]:"fire-analytics",[ma]:"fire-analytics-compat",[ba]:"fire-app-check",[ya]:"fire-app-check-compat",[wa]:"fire-auth",[_a]:"fire-auth-compat",[Ia]:"fire-rtdb",[Sa]:"fire-rtdb-compat",[Ca]:"fire-fn",[ka]:"fire-fn-compat",[Ea]:"fire-iid",[xa]:"fire-iid-compat",[Ta]:"fire-fcm",[Aa]:"fire-fcm-compat",[Na]:"fire-perf",[Va]:"fire-perf-compat",[Da]:"fire-rc",[Ma]:"fire-rc-compat",[Ra]:"fire-gcs",[Pa]:"fire-gcs-compat",[Oa]:"fire-fst",[La]:"fire-fst-compat","fire-js":"fire-js",[Fa]:"fire-js-all"},$a=new Map,ja=new Map;function za(e,t){try{e.container.addComponent(t)}catch(n){fa.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function qa(e){const t=e.name;if(ja.has(t))return fa.debug(`There were multiple attempts to register component ${t}.`),!1;ja.set(t,e);for(const n of $a.values())za(n,e);return!0}function Ha(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new Nn("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ka{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Fn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ga.create("app-deleted",{appName:this._name})}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa="9.23.0";function Qa(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const a=Object.assign({name:Ba,automaticDataCollectionEnabled:!1},t),i=a.name;if("string"!=typeof i||!i)throw Ga.create("bad-app-name",{appName:String(i)});if(n||(n=kn()),!n)throw Ga.create("no-options");const r=$a.get(i);if(r){if(Dn(n,r.options)&&Dn(a,r.config))return r;throw Ga.create("duplicate-app",{appName:i})}const s=new $n(i);for(const l of ja.values())s.addComponent(l);const o=new Ka(n,a,s);return $a.set(i,o),o}function Xa(e=Ba){const t=$a.get(e);if(!t&&e===Ba&&kn())return Qa();if(!t)throw Ga.create("no-app",{appName:e});return t}function Ya(e,t,n){var a;let i=null!==(a=Ua[e])&&void 0!==a?a:e;n&&(i+=`-${n}`);const r=i.match(/\s|\//),s=t.match(/\s|\//);if(r||s){const e=[`Unable to register library "${i}" with version "${t}":`];return r&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void fa.warn(e.join(" "))}qa(new Fn(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ja="firebase-heartbeat-store";let Za=null;function ei(){return Za||(Za=function(e,t,{blocked:n,upgrade:a,blocking:i,terminated:r}={}){const s=indexedDB.open(e,t),o=ra(s);return a&&s.addEventListener("upgradeneeded",e=>{a(ra(s.result),e.oldVersion,e.newVersion,ra(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{r&&e.addEventListener("close",()=>r()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Ja)}}).catch(e=>{throw Ga.create("idb-open",{originalErrorMessage:e.message})})),Za}async function ti(e,t){try{const n=(await ei()).transaction(Ja,"readwrite"),a=n.objectStore(Ja);await a.put(t,ni(e)),await n.done}catch(n){if(n instanceof An)fa.warn(n.message);else{const e=Ga.create("idb-set",{originalErrorMessage:null==n?void 0:n.message});fa.warn(e.message)}}}function ni(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ri(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=ii();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some(e=>e.date===t))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=ii(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let a=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),si(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),si(n)>t){n.pop();break}a=a.slice(1)}return{heartbeatsToSend:n,unsentEntries:a}}(this._heartbeatsCache.heartbeats),a=wn(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}}function ii(){return(new Date).toISOString().substring(0,10)}class ri{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise((e,t)=>{try{let n=!0;const a="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(a);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(a),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{const t=await ei();return await t.transaction(Ja).objectStore(Ja).get(ni(e))}catch(t){if(t instanceof An)fa.warn(t.message);else{const e=Ga.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});fa.warn(e.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ti(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ti(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function si(e){return wn(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oi;function li(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}function ui(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}oi="",qa(new Fn("platform-logger",e=>new da(e),"PRIVATE")),qa(new Fn("heartbeat",e=>new ai(e),"PRIVATE")),Ya(ha,pa,oi),Ya(ha,pa,"esm2017"),Ya("fire-js",""),"function"==typeof SuppressedError&&SuppressedError;const ci=ui,di=new Nn("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),hi=new Wn("@firebase/auth");function pi(e,...t){hi.logLevel<=jn.ERROR&&hi.error(`Auth (${Wa}): ${e}`,...t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(e,...t){throw gi(e,...t)}function vi(e,...t){return gi(e,...t)}function mi(e,t,n){const a=Object.assign(Object.assign({},ci()),{[t]:n});return new Nn("auth","Firebase",a).create(t,{appName:e.name})}function gi(e,...t){if("string"!=typeof e){const n=t[0],a=[...t.slice(1)];return a[0]&&(a[0].appName=e.name),e._errorFactory.create(n,...a)}return di.create(e,...t)}function yi(e,t,...n){if(!e)throw gi(t,...n)}function bi(e){const t="INTERNAL ASSERTION FAILED: "+e;throw pi(t),new Error(t)}function wi(e,t){e||bi(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _i(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ii(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Si(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==Ii()&&"https:"!==Ii()&&!function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&!("connection"in navigator)||navigator.onLine}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ci{constructor(e,t){this.shortDelay=e,this.longDelay=t,wi(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tn())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return Si()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(e,t){wi(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void bi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void bi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void bi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xi={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Ti=new Ci(3e4,6e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Ni(e,t,n,a,i={}){return Vi(e,i,async()=>{let i={},r={};a&&("GET"===t?r=a:i={body:JSON.stringify(a)});const s=Rn(Object.assign({key:e.config.apiKey},r)).slice(1),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode),Ei.fetch()(Di(e,e.config.apiHost,n,s),Object.assign({method:t,headers:o,referrerPolicy:"no-referrer"},i))})}async function Vi(e,t,n){e._canInitEmulator=!1;const a=Object.assign(Object.assign({},xi),t);try{const t=new Mi(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const r=await i.json();if("needConfirmation"in r)throw Ri(e,"account-exists-with-different-credential",r);if(i.ok&&!("errorMessage"in r))return r;{const t=i.ok?r.errorMessage:r.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Ri(e,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw Ri(e,"email-already-in-use",r);if("USER_DISABLED"===n)throw Ri(e,"user-disabled",r);const o=a[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw mi(e,o,s);fi(e,o)}}catch(i){if(i instanceof An)throw i;fi(e,"network-request-failed",{message:String(i)})}}function Di(e,t,n,a){const i=`${t}${n}?${a}`;return e.config.emulator?ki(e.config,i):`${e.config.apiScheme}://${i}`}class Mi{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(vi(this.auth,"network-request-failed")),Ti.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ri(e,t,n){const a={appName:e.name};n.email&&(a.email=n.email),n.phoneNumber&&(a.phoneNumber=n.phoneNumber);const i=vi(e,t,a);return i.customData._tokenResponse=n,i}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Pi(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Oi(e){return 1e3*Number(e)}function Li(e){const[t,n,a]=e.split(".");if(void 0===t||void 0===n||void 0===a)return pi("JWT malformed, contained fewer than 3 sections"),null;try{const e=_n(n);return e?JSON.parse(e):(pi("Failed to decode base64 JWT payload"),null)}catch(i){return pi("Caught error parsing JWT payload as JSON",null==i?void 0:i.toString()),null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Fi(e,t,n=!1){if(n)return t;try{return await t}catch(a){throw a instanceof An&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(a)&&e.auth.currentUser===e&&await e.auth.signOut(),a}}class Bi{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pi(this.lastLoginAt),this.creationTime=Pi(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $i(e){var t;const n=e.auth,a=await e.getIdToken(),i=await Fi(e,async function(e,t){return Ni(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:a}));yi(null==i?void 0:i.users.length,n,"internal-error");const r=i.users[0];e._notifyReloadListener(r);const s=(null===(t=r.providerUserInfo)||void 0===t?void 0:t.length)?r.providerUserInfo.map(e=>{var{providerId:t}=e,n=li(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[];const o=(l=e.providerData,u=s,[...l.filter(e=>!u.some(t=>t.providerId===e.providerId)),...u]);var l,u;const c=e.isAnonymous,d=!(e.email&&r.passwordHash||(null==o?void 0:o.length)),h=!!c&&d,p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Ui(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(e,p)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ji{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){yi(e.idToken,"internal-error"),yi(void 0!==e.idToken,"internal-error"),yi(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Li(e);return yi(t,"internal-error"),yi(void 0!==t.exp,"internal-error"),yi(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return yi(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:a,expiresIn:i}=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */await async function(e,t){const n=await Vi(e,{},async()=>{const n=Rn({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:a,apiKey:i}=e.config,r=Di(e,a,"/v1/token",`key=${i}`),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",Ei.fetch()(r,{method:"POST",headers:s,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,a,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:a,expirationTime:i}=t,r=new ji;return n&&(yi("string"==typeof n,"internal-error",{appName:e}),r.refreshToken=n),a&&(yi("string"==typeof a,"internal-error",{appName:e}),r.accessToken=a),i&&(yi("number"==typeof i,"internal-error",{appName:e}),r.expirationTime=i),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ji,this.toJSON())}_performRefresh(){return bi("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(e,t){yi("string"==typeof e||void 0===e,"internal-error",{appName:t})}class qi{constructor(e){var{uid:t,auth:n,stsTokenManager:a}=e,i=li(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Bi(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ui(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Fi(this,this.stsTokenManager.getToken(this.auth,e));return yi(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Ln(e),a=await n.getIdToken(t),i=Li(a);yi(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const r="object"==typeof i.firebase?i.firebase:void 0,s=null==r?void 0:r.sign_in_provider;return{claims:i,token:a,authTime:Pi(Oi(i.auth_time)),issuedAtTime:Pi(Oi(i.iat)),expirationTime:Pi(Oi(i.exp)),signInProvider:s||null,signInSecondFactor:(null==r?void 0:r.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Ln(e);await $i(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(yi(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new qi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){yi(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await $i(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Fi(this,async function(e,t){return Ni(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,a,i,r,s,o,l,u;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(a=t.email)&&void 0!==a?a:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(r=t.photoURL)&&void 0!==r?r:void 0,f=null!==(s=t.tenantId)&&void 0!==s?s:void 0,v=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,g=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:_,stsTokenManager:I}=t;yi(y&&I,e,"internal-error");const S=ji.fromJSON(this.name,I);yi("string"==typeof y,e,"internal-error"),zi(c,e.name),zi(d,e.name),yi("boolean"==typeof b,e,"internal-error"),yi("boolean"==typeof w,e,"internal-error"),zi(h,e.name),zi(p,e.name),zi(f,e.name),zi(v,e.name),zi(m,e.name),zi(g,e.name);const C=new qi({uid:y,auth:e,email:d,emailVerified:b,displayName:c,isAnonymous:w,photoURL:p,phoneNumber:h,tenantId:f,stsTokenManager:S,createdAt:m,lastLoginAt:g});return _&&Array.isArray(_)&&(C.providerData=_.map(e=>Object.assign({},e))),v&&(C._redirectEventId=v),C}static async _fromIdTokenResponse(e,t,n=!1){const a=new ji;a.updateFromServerResponse(t);const i=new qi({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await $i(i),i}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=new Map;function Gi(e){wi(e instanceof Function,"Expected a class definition");let t=Hi.get(e);return t?(wi(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Hi.set(e,t),t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Ki.type="NONE";const Wi=Ki;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qi(e,t,n){return`firebase:${e}:${t}:${n}`}class Xi{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:a,name:i}=this.auth;this.fullUserKey=Qi(this.userKey,a.apiKey,i),this.fullPersistenceKey=Qi("persistence",a.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?qi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Xi(Gi(Wi),e,n);const a=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=a[0]||Gi(Wi);const r=Qi(n,e.config.apiKey,e.name);let s=null;for(const u of t)try{const t=await u._get(r);if(t){const n=qi._fromJSON(e,t);u!==i&&(s=n),i=u;break}}catch(l){}const o=a.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length?(i=o[0],s&&await i._set(r,s.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(r)}catch(l){}})),new Xi(i,e,n)):new Xi(i,e,n)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(tr(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ji(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ar(t))return"Blackberry";if(ir(t))return"Webos";if(Zi(t))return"Safari";if((t.includes("chrome/")||er(t))&&!t.includes("edge/"))return"Chrome";if(nr(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Ji(e=Tn()){return/firefox\//i.test(e)}function Zi(e=Tn()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function er(e=Tn()){return/crios\//i.test(e)}function tr(e=Tn()){return/iemobile/i.test(e)}function nr(e=Tn()){return/android/i.test(e)}function ar(e=Tn()){return/blackberry/i.test(e)}function ir(e=Tn()){return/webos/i.test(e)}function rr(e=Tn()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function sr(){return function(){const e=Tn();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function or(e=Tn()){return rr(e)||nr(e)||ir(e)||ar(e)||/windows phone/i.test(e)||tr(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function lr(e,t=[]){let n;switch(e){case"Browser":n=Yi(Tn());break;case"Worker":n=`${Yi(Tn())}-${e}`;break;default:n=e}const a=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Wa}/${a}`}async function ur(e,t){return Ni(e,"GET","/v2/recaptchaConfig",Ai(e,t))}function cr(e){return void 0!==e&&void 0!==e.enterprise}class dr{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(e){return new Promise((t,n)=>{const a=document.createElement("script");var i,r;a.setAttribute("src",e),a.onload=t,a.onerror=e=>{const t=vi("internal-error");t.customData=e,n(t)},a.type="text/javascript",a.charset="UTF-8",(null!==(r=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==r?r:document).appendChild(a)})}class pr{constructor(e){this.type="recaptcha-enterprise",this.auth=mr(e)}async verify(e="verify",t=!1){function n(t,n,a){const i=window.grecaptcha;cr(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,a)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{ur(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(a=>{if(void 0!==a.recaptchaKey){const n=new dr(a);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&cr(window.grecaptcha))n(i,e,a);else{if("undefined"==typeof window)return void a(new Error("RecaptchaVerifier is only supported in browser"));hr("https://www.google.com/recaptcha/enterprise.js?render="+i).then(()=>{n(i,e,a)}).catch(e=>{a(e)})}}).catch(e=>{a(e)})})}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,a)=>{try{n(e(t))}catch(i){a(i)}});n.onAbort=t,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(a){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==n?void 0:n.message})}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{constructor(e,t,n,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gr(this),this.idTokenSubscription=new gr(this),this.beforeStateQueue=new fr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=di,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Gi(t)),this._initializationPromise=this.queue(async()=>{var n,a;if(!this._deleted&&(this.persistenceManager=await Xi.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(a=this.currentUser)||void 0===a?void 0:a.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let a=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==a?void 0:a._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==r||!(null==s?void 0:s.user)||(a=s.user,i=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(a)}catch(r){a=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return yi(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await $i(e)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Ln(e):null;return t&&yi(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&yi(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Gi(e))})}async initializeRecaptchaConfig(){const e=await ur(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new dr(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new pr(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Nn("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Gi(e)||this._popupRedirectResolver;yi(t,this,"argument-error"),this.redirectPersistenceManager=await Xi.create(this,[Gi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,a){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),r=this._isInitialized?Promise.resolve():this._initializationPromise;return yi(r,this,"internal-error"),r.then(()=>i(this.currentUser)),"function"==typeof t?e.addObserver(t,n,a):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return yi(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lr(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){hi.logLevel<=jn.WARN&&hi.warn(`Auth (${Wa}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function mr(e){return Ln(e)}class gr{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Pn(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return yi(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(e,t,n){const a=mr(e);yi(a._canInitEmulator,a,"emulator-config-failed"),yi(/^https?:\/\//.test(t),a,"invalid-emulator-scheme");const i=br(t),{host:r,port:s}=function(e){const t=br(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const a=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(a);if(i){const e=i[1];return{host:e,port:wr(a.substr(e.length+1))}}{const[e,t]=a.split(":");return{host:e,port:wr(t)}}}(t),o=null===s?"":`:${s}`;a.config.emulator={url:`${i}//${r}${o}/`},a.settings.appVerificationDisabledForTesting=!0,a.emulatorConfig=Object.freeze({host:r,port:s,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:!1})}),function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&console.info;"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function br(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function wr(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class _r{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return bi("not implemented")}_getIdTokenResponse(e){return bi("not implemented")}_linkToIdToken(e,t){return bi("not implemented")}_getReauthenticationResolver(e){return bi("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ir(e,t){return async function(e,t,n,a,i={}){const r=await Ni(e,t,n,a,i);return"mfaPendingCredential"in r&&fi(e,"multi-factor-auth-required",{_serverResponse:r}),r}(e,"POST","/v1/accounts:signInWithIdp",Ai(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr extends _r{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Sr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):fi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:a}=t,i=li(t,["providerId","signInMethod"]);if(!n||!a)return null;const r=new Sr(n,a);return r.idToken=i.idToken||void 0,r.accessToken=i.accessToken||void 0,r.secret=i.secret,r.nonce=i.nonce,r.pendingToken=i.pendingToken||null,r}_getIdTokenResponse(e){return Ir(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ir(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ir(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Rn(t)}return e}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr extends Cr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er extends kr{constructor(){super("facebook.com")}static credential(e){return Sr._fromParams({providerId:Er.PROVIDER_ID,signInMethod:Er.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Er.credentialFromTaggedObject(e)}static credentialFromError(e){return Er.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Er.credential(e.oauthAccessToken)}catch(t){return null}}}Er.FACEBOOK_SIGN_IN_METHOD="facebook.com",Er.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class xr extends kr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Sr._fromParams({providerId:xr.PROVIDER_ID,signInMethod:xr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xr.credentialFromTaggedObject(e)}static credentialFromError(e){return xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return xr.credential(t,n)}catch(a){return null}}}xr.GOOGLE_SIGN_IN_METHOD="google.com",xr.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Tr extends kr{constructor(){super("github.com")}static credential(e){return Sr._fromParams({providerId:Tr.PROVIDER_ID,signInMethod:Tr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Tr.credentialFromTaggedObject(e)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Tr.credential(e.oauthAccessToken)}catch(t){return null}}}Tr.GITHUB_SIGN_IN_METHOD="github.com",Tr.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ar extends kr{constructor(){super("twitter.com")}static credential(e,t){return Sr._fromParams({providerId:Ar.PROVIDER_ID,signInMethod:Ar.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ar.credentialFromTaggedObject(e)}static credentialFromError(e){return Ar.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ar.credential(t,n)}catch(a){return null}}}Ar.TWITTER_SIGN_IN_METHOD="twitter.com",Ar.PROVIDER_ID="twitter.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Nr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,a=!1){const i=await qi._fromIdTokenResponse(e,n,a),r=Vr(n);return new Nr({user:i,providerId:r,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const a=Vr(n);return new Nr({user:e,providerId:a,_tokenResponse:n,operationType:t})}}function Vr(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends An{constructor(e,t,n,a){var i;super(t.code,t.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Dr.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,a){return new Dr(e,t,n,a)}}function Mr(e,t,n,a){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Dr._fromErrorAndOperation(e,n,t,a);throw n})}const Rr="__sak";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rr,"1"),this.storage.removeItem(Rr),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or extends Pr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Tn();return Zi(e)||rr(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=or(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),a=this.localCache[t];n!==a&&e(t,a,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const a=this.storage.getItem(n);if(e.newValue!==a)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const a=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);sr()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Or.type="LOCAL";const Lr=Or;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr extends Pr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Fr.type="SESSION";const Br=Fr;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ur{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Ur(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:a,data:i}=t.data,r=this.handlersMap[a];if(!(null==r?void 0:r.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const s=Array.from(r).map(async e=>e(t.origin,i)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function $r(e="",t=10){let n="";for(let a=0;a<t;a++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ur.receivers=[];class jr{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const a="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let i,r;return new Promise((s,o)=>{const l=$r("",20);a.port1.start();const u=setTimeout(()=>{o(new Error("unsupported_event"))},n);r={messageChannel:a,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),s(t.data.response);break;default:clearTimeout(u),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(r),a.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[a.port2])}).finally(()=>{r&&this.removeMessageHandler(r)})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zr(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function qr(){return void 0!==zr().WorkerGlobalScope&&"function"==typeof zr().importScripts}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Hr="firebaseLocalStorageDb",Gr="firebaseLocalStorage",Kr="fbase_key";class Wr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Qr(e,t){return e.transaction([Gr],t?"readwrite":"readonly").objectStore(Gr)}function Xr(){const e=indexedDB.open(Hr,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Gr,{keyPath:Kr})}catch(a){n(a)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Gr)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Hr);return new Wr(e).toPromise()}(),t(await Xr()))})})}async function Yr(e,t,n){const a=Qr(e,!0).put({[Kr]:t,value:n});return new Wr(a).toPromise()}function Jr(e,t){const n=Qr(e,!0).delete(t);return new Wr(n).toPromise()}class Zr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Xr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return qr()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ur._getInstance(qr()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new jr(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xr();return await Yr(e,Rr,"1"),await Jr(e,Rr),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Yr(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Qr(e,!1).get(t),a=await new Wr(n).toPromise();return void 0===a?null:a.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Jr(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Qr(e,!1).getAll();return new Wr(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:a,value:i}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(i)&&(this.notifyListeners(a,i),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Zr.type="LOCAL";const es=Zr;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ts(e,t){return t?Gi(t):(yi(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Ci(3e4,6e4);class ns extends _r{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ir(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ir(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ir(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function as(e){
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return async function(e,t,n=!1){const a="signIn",i=await Mr(e,a,t),r=await Nr._fromIdTokenResponse(e,a,i);return n||await e._updateCurrentUser(r.user),r}(e.auth,new ns(e),e.bypassAuthState)}function is(e){const{auth:t,user:n}=e;return yi(n,t,"internal-error"),
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function(e,t,n=!1){const{auth:a}=e,i="reauthenticate";try{const r=await Fi(e,Mr(a,i,t,e),n);yi(r.idToken,a,"internal-error");const s=Li(r.idToken);yi(s,a,"internal-error");const{sub:o}=s;return yi(e.uid===o,a,"user-mismatch"),Nr._forOperation(e,i,r)}catch(r){throw"auth/user-not-found"===(null==r?void 0:r.code)&&fi(a,"user-mismatch"),r}}(n,new ns(e),e.bypassAuthState)}async function rs(e){const{auth:t,user:n}=e;return yi(n,t,"internal-error"),async function(e,t,n=!1){const a=await Fi(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Nr._forOperation(e,"link",a)}(n,new ns(e),e.bypassAuthState)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,t,n,a,i=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:a,tenantId:i,error:r,type:s}=e;if(r)return void this.reject(r);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return as;case"linkViaPopup":case"linkViaRedirect":return rs;case"reauthViaPopup":case"reauthViaRedirect":return is;default:fi(this.auth,"internal-error")}}resolve(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os=new Ci(2e3,1e4);async function ls(e,t,n){const a=mr(e);!function(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&fi(e,"argument-error"),mi(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(e,t,Cr);const i=ts(a,n);return new us(a,"signInViaPopup",t,i).executeNotNull()}class us extends ss{constructor(e,t,n,a,i){super(e,t,a,i),this.provider=n,this.authWindow=null,this.pollId=null,us.currentPopupAction&&us.currentPopupAction.cancel(),us.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return yi(e,this.auth,"internal-error"),e}async onExecution(){wi(1===this.filter.length,"Popup operations only handle one event");const e=$r();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(vi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(vi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,us.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(vi(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,os.get())};e()}}us.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const cs="pendingRedirect",ds=new Map;class hs extends ss{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=ds.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Qi(cs,e.config.apiKey,e.name)}(t),a=function(e){return Gi(e._redirectPersistence)}(e);if(!(await a._isAvailable()))return!1;const i="true"===await a._get(n);return await a._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}ds.set(this.auth._key(),e)}return this.bypassAuthState||ds.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ps(e,t){ds.set(e._key(),t)}async function fs(e,t,n=!1){const a=mr(e),i=ts(a,t),r=new hs(a,i,n),s=await r.execute();return s&&!n&&(delete s.user._redirectEventId,await a._persistUserIfCurrent(s.user),await a._setRedirectUser(null,t)),s}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gs(e);default:return!1}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!gs(e)){const a=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(vi(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ms(e))}saveEventToCache(e){this.cachedEventUids.add(ms(e)),this.lastProcessedEventTime=Date.now()}}function ms(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function gs({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const ys=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,bs=/^https?/;async function ws(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Ni(e,"GET","/v1/projects",t)}(e);for(const a of t)try{if(_s(a))return}catch(n){}fi(e,"unauthorized-domain")}function _s(e){const t=_i(),{protocol:n,hostname:a}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===a?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===a}if(!bs.test(n))return!1;if(ys.test(e))return a===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(a)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=new Ci(3e4,6e4);function Ss(){const e=zr().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Cs(e){return new Promise((t,n)=>{var a,i,r;function s(){Ss(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Ss(),n(vi(e,"network-request-failed"))},timeout:Is.get()})}if(null===(i=null===(a=zr().gapi)||void 0===a?void 0:a.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(r=zr().gapi)||void 0===r?void 0:r.load)){const t=`__${"iframefcb"}${Math.floor(1e6*Math.random())}`;return zr()[t]=()=>{gapi.load?s():n(vi(e,"network-request-failed"))},hr(`https://apis.google.com/js/api.js?onload=${t}`).catch(e=>n(e))}s()}}).catch(e=>{throw ks=null,e})}let ks=null;
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Es=new Ci(5e3,15e3),xs={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ts=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function As(e){const t=e.config;yi(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?ki(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,a={apiKey:t.apiKey,appName:e.name,v:Wa},i=Ts.get(e.config.apiHost);i&&(a.eid=i);const r=e._getFrameworks();return r.length&&(a.fw=r.join(",")),`${n}?${Rn(a).slice(1)}`}async function Ns(e){const t=await function(e){return ks=ks||Cs(e),ks}(e),n=zr().gapi;return yi(n,e,"internal-error"),t.open({where:document.body,url:As(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xs,dontclear:!0},t=>new Promise(async(n,a)=>{await t.restyle({setHideOnLeave:!1});const i=vi(e,"network-request-failed"),r=zr().setTimeout(()=>{a(i)},Es.get());function s(){zr().clearTimeout(r),n(t)}t.ping(s).then(s,()=>{a(i)})}))}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ds{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Ms(e,t,n,a=500,i=600){const r=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-a)/2,0).toString();let o="";const l=Object.assign(Object.assign({},Vs),{width:a.toString(),height:i.toString(),top:r,left:s}),u=Tn().toLowerCase();n&&(o=er(u)?"_blank":n),Ji(u)&&(t=t||"http://localhost",l.scrollbars="yes");const c=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=Tn()){var t;return rr(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(a)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t||"",o),new Ds(null);const d=window.open(t||"",o,c);yi(d,e,"popup-blocked");try{d.focus()}catch(h){}return new Ds(d)}const Rs="__/auth/handler",Ps="emulator/auth/handler",Os=encodeURIComponent("fac");async function Ls(e,t,n,a,i,r){yi(e.config.authDomain,e,"auth-domain-config-required"),yi(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:a,v:Wa,eventId:i};if(t instanceof Cr){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))s[e]=t}if(t instanceof kr){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const c of Object.keys(o))void 0===o[c]&&delete o[c];const l=await e._getAppCheckToken(),u=l?`#${Os}=${encodeURIComponent(l)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${Rs}`;return ki(e,Ps)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)}?${Rn(o).slice(1)}${u}`}const Fs="webStorageSupport";const Bs=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Br,this._completeRedirectFn=fs,this._overrideRedirectResult=ps}async _openPopup(e,t,n,a){var i;wi(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Ms(e,await Ls(e,t,n,_i(),a),$r())}async _openRedirect(e,t,n,a){await this._originValidation(e);return function(e){zr().location.href=e}(await Ls(e,t,n,_i(),a)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(wi(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Ns(e),n=new vs(e);return t.register("authEvent",t=>{yi(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Fs,{type:Fs},n=>{var a;const i=null===(a=null==n?void 0:n[0])||void 0===a?void 0:a[Fs];void 0!==i&&t(!!i),fi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ws(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return or()||Zi()||rr()}};var Us="@firebase/auth",$s="0.23.2";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class js{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){yi(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const zs=En("authIdTokenMaxAge")||300;let qs=null;function Hs(e=Xa()){const t=Ha(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Ha(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Dn(n.getOptions(),null!=t?t:{}))return e;fi(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Bs,persistence:[es,Lr,Br]}),a=En("authTokenSyncURL");if(a){const e=(i=a,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>zs)return;const a=null==t?void 0:t.token;qs!==a&&(qs=a,await fetch(i,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))});!function(e,t,n){Ln(e).beforeAuthStateChanged(t,n)}(n,e,()=>e(n.currentUser)),function(e,t,n,a){Ln(e).onIdTokenChanged(t,n,a)}(n,t=>e(t))}var i;const r=Cn("auth");return r&&yr(n,`http://${r}`),n}var Gs;Gs="Browser",qa(new Fn("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:r,authDomain:s}=n.options;yi(r&&!r.includes(":"),"invalid-api-key",{appName:n.name});const o={apiKey:r,authDomain:s,clientPlatform:Gs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lr(Gs)},l=new vr(n,a,i,o);return function(e,t){const n=(null==t?void 0:t.persistence)||[],a=(Array.isArray(n)?n:[n]).map(Gi);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(a,null==t?void 0:t.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),qa(new Fn("auth-internal",e=>{const t=mr(e.getProvider("auth").getImmediate());return new js(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ya(Us,$s,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Gs)),Ya(Us,$s,"esm2017");const Ks={},Ws=async()=>{const{getFirebaseInstances:e}=await function(e,t){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),a=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));n=Promise.allSettled(t.map(e=>{if((e=function(e){return"/MS_DB_UI/"+e}(e))in Ks)return;Ks[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,a&&i.setAttribute("nonce",a),document.head.appendChild(i),t?new Promise((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})}(async()=>{const{getFirebaseInstances:e}=await import("./firebase-init-BJHqUzM8.js");return{getFirebaseInstances:e}},__vite__mapDeps([0,1,2]));return e()},Qs=async()=>{const{db:e}=await Ws();return e},Xs=async()=>{const{auth:e}=await Ws();return e},Ys=async()=>ls(await Xs(),new xr).catch(e=>{throw e}),Js=async()=>function(e){return Ln(e).signOut()}(await Xs()),Zs=async e=>function(e,t,n,a){return Ln(e).onAuthStateChanged(t,n,a)}(await Xs(),e),eo=vn("auth",{state:()=>({user:null,isAuthReady:!1}),getters:{isLoggedIn:e=>null!==e.user,userId:e=>{var t;return(null==(t=e.user)?void 0:t.uid)||null},userName:e=>{var t;return(null==(t=e.user)?void 0:t.displayName)||null},userEmail:e=>{var t;return(null==(t=e.user)?void 0:t.email)||null}},actions:{setUser(e){this.user=e},setAuthReady(e){this.isAuthReady=e},async loginWithGoogle(){try{const e=await Ys();this.setUser(e.user)}catch(e){throw e}},async logout(){try{await Js(),this.setUser(null)}catch(e){throw e}},async initAuthListener(){await Zs(e=>{this.setUser(e),this.isAuthReady||this.setAuthReady(!0)})}}}),to=e=>{return e?(e=>{if(!Array.isArray(e)||0===e.length)return!1;const t=e[0];return"number"==typeof t||"string"==typeof t})(e)?(t=e,Array.isArray(t)?t.map(e=>{const t=Number(e);return isNaN(t)?null:{itemId:t,isVirtual:!1,isEL:!1}}).filter(e=>null!==e):[]):e.map(e=>({...e,isEL:void 0!==e.isEL&&e.isEL})):[];var t},no=e=>to(e).filter(e=>!e.isVirtual);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Ya("firebase","9.23.0","app");var ao,io="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ro=ro||{},so=io||self;function oo(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function lo(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function uo(e,t,n){return e.call.apply(e.bind,arguments)}function co(e,t,n){if(!e)throw Error();if(2<arguments.length){var a=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,a),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function ho(e,t,n){return(ho=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?uo:co).apply(null,arguments)}function po(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function fo(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,a){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return t.prototype[n].apply(e,i)}}function vo(){this.s=this.s,this.o=this.o}vo.prototype.s=!1,vo.prototype.sa=function(){!this.s&&(this.s=!0,this.N())},vo.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const mo=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function go(e){const t=e.length;if(0<t){const n=Array(t);for(let a=0;a<t;a++)n[a]=e[a];return n}return[]}function yo(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(oo(t)){const n=e.length||0,a=t.length||0;e.length=n+a;for(let i=0;i<a;i++)e[n+i]=t[i]}else e.push(t)}}function bo(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}bo.prototype.h=function(){this.defaultPrevented=!0};var wo=function(){if(!so.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{so.addEventListener("test",()=>{},t),so.removeEventListener("test",()=>{},t)}catch(n){}return e}();function _o(e){return/^[\s\xa0]*$/.test(e)}function Io(){var e=so.navigator;return e&&(e=e.userAgent)?e:""}function So(e){return-1!=Io().indexOf(e)}function Co(e){return Co[" "](e),e}Co[" "]=function(){};var ko,Eo,xo,To=So("Opera"),Ao=So("Trident")||So("MSIE"),No=So("Edge"),Vo=No||Ao,Do=So("Gecko")&&!(-1!=Io().toLowerCase().indexOf("webkit")&&!So("Edge"))&&!(So("Trident")||So("MSIE"))&&!So("Edge"),Mo=-1!=Io().toLowerCase().indexOf("webkit")&&!So("Edge");function Ro(){var e=so.document;return e?e.documentMode:void 0}e:{var Po="",Oo=(Eo=Io(),Do?/rv:([^\);]+)(\)|;)/.exec(Eo):No?/Edge\/([\d\.]+)/.exec(Eo):Ao?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Eo):Mo?/WebKit\/(\S+)/.exec(Eo):To?/(?:Version)[ \/]?(\S+)/.exec(Eo):void 0);if(Oo&&(Po=Oo?Oo[1]:""),Ao){var Lo=Ro();if(null!=Lo&&Lo>parseFloat(Po)){ko=String(Lo);break e}}ko=Po}if(so.document&&Ao){var Fo=Ro();xo=Fo||(parseInt(ko,10)||void 0)}else xo=void 0;var Bo=xo;function Uo(e,t){if(bo.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,a=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Do){e:{try{Co(t.nodeName);var i=!0;break e}catch(r){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,a?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:$o[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Uo.$.h.call(this)}}fo(Uo,bo);var $o={2:"touch",3:"pen",4:"mouse"};Uo.prototype.h=function(){Uo.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var jo="closure_listenable_"+(1e6*Math.random()|0),zo=0;function qo(e,t,n,a,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!a,this.la=i,this.key=++zo,this.fa=this.ia=!1}function Ho(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function Go(e,t,n){for(const a in e)t.call(n,e[a],a,e)}function Ko(e){const t={};for(const n in e)t[n]=e[n];return t}const Wo="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Qo(e,t){let n,a;for(let i=1;i<arguments.length;i++){for(n in a=arguments[i],a)e[n]=a[n];for(let t=0;t<Wo.length;t++)n=Wo[t],Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}}function Xo(e){this.src=e,this.g={},this.h=0}function Yo(e,t){var n=t.type;if(n in e.g){var a,i=e.g[n],r=mo(i,t);(a=0<=r)&&Array.prototype.splice.call(i,r,1),a&&(Ho(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Jo(e,t,n,a){for(var i=0;i<e.length;++i){var r=e[i];if(!r.fa&&r.listener==t&&r.capture==!!n&&r.la==a)return i}return-1}Xo.prototype.add=function(e,t,n,a,i){var r=e.toString();(e=this.g[r])||(e=this.g[r]=[],this.h++);var s=Jo(e,t,a,i);return-1<s?(t=e[s],n||(t.ia=!1)):((t=new qo(t,this.src,r,!!a,i)).ia=n,e.push(t)),t};var Zo="closure_lm_"+(1e6*Math.random()|0),el={};function tl(e,t,n,a,i){if(Array.isArray(t)){for(var r=0;r<t.length;r++)tl(e,t[r],n,a,i);return null}return n=ll(n),e&&e[jo]?e.O(t,n,!!lo(a)&&!!a.capture,i):function(e,t,n,a,i,r){if(!t)throw Error("Invalid event type");var s=lo(i)?!!i.capture:!!i,o=sl(e);if(o||(e[Zo]=o=new Xo(e)),n=o.add(t,n,a,s,r),n.proxy)return n;if(a=function(){function e(n){return t.call(e.src,e.listener,n)}const t=rl;return e}(),n.proxy=a,a.src=e,a.listener=n,e.addEventListener)wo||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),a,i);else if(e.attachEvent)e.attachEvent(il(t.toString()),a);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(a)}return n}(e,t,n,!1,a,i)}function nl(e,t,n,a,i){if(Array.isArray(t))for(var r=0;r<t.length;r++)nl(e,t[r],n,a,i);else a=lo(a)?!!a.capture:!!a,n=ll(n),e&&e[jo]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Jo(r=e.g[t],n,a,i))&&(Ho(r[n]),Array.prototype.splice.call(r,n,1),0==r.length&&(delete e.g[t],e.h--)))):e&&(e=sl(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Jo(t,n,a,i)),(n=-1<e?t[e]:null)&&al(n))}function al(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[jo])Yo(t.i,e);else{var n=e.type,a=e.proxy;t.removeEventListener?t.removeEventListener(n,a,e.capture):t.detachEvent?t.detachEvent(il(n),a):t.addListener&&t.removeListener&&t.removeListener(a),(n=sl(t))?(Yo(n,e),0==n.h&&(n.src=null,t[Zo]=null)):Ho(e)}}}function il(e){return e in el?el[e]:el[e]="on"+e}function rl(e,t){if(e.fa)e=!0;else{t=new Uo(t,this);var n=e.listener,a=e.la||e.src;e.ia&&al(e),e=n.call(a,t)}return e}function sl(e){return(e=e[Zo])instanceof Xo?e:null}var ol="__closure_events_fn_"+(1e9*Math.random()>>>0);function ll(e){return"function"==typeof e?e:(e[ol]||(e[ol]=function(t){return e.handleEvent(t)}),e[ol])}function ul(){vo.call(this),this.i=new Xo(this),this.S=this,this.J=null}function cl(e,t){var n,a=e.J;if(a)for(n=[];a;a=a.J)n.push(a);if(e=e.S,a=t.type||t,"string"==typeof t)t=new bo(t,e);else if(t instanceof bo)t.target=t.target||e;else{var i=t;Qo(t=new bo(a,e),i)}if(i=!0,n)for(var r=n.length-1;0<=r;r--){var s=t.g=n[r];i=dl(s,a,!0,t)&&i}if(i=dl(s=t.g=e,a,!0,t)&&i,i=dl(s,a,!1,t)&&i,n)for(r=0;r<n.length;r++)i=dl(s=t.g=n[r],a,!1,t)&&i}function dl(e,t,n,a){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,r=0;r<t.length;++r){var s=t[r];if(s&&!s.fa&&s.capture==n){var o=s.listener,l=s.la||s.src;s.ia&&Yo(e.i,s),i=!1!==o.call(l,a)&&i}}return i&&!a.defaultPrevented}fo(ul,vo),ul.prototype[jo]=!0,ul.prototype.removeEventListener=function(e,t,n,a){nl(this,e,t,n,a)},ul.prototype.N=function(){if(ul.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],a=0;a<n.length;a++)Ho(n[a]);delete t.g[e],t.h--}}this.J=null},ul.prototype.O=function(e,t,n,a){return this.i.add(String(e),t,!1,n,a)},ul.prototype.P=function(e,t,n,a){return this.i.add(String(e),t,!0,n,a)};var hl=so.JSON.stringify;function pl(){var e=wl;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var fl=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new vl,e=>e.reset());class vl{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function ml(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function gl(e){so.setTimeout(()=>{throw e},0)}let yl,bl=!1,wl=new class{constructor(){this.h=this.g=null}add(e,t){const n=fl.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},_l=()=>{const e=so.Promise.resolve(void 0);yl=()=>{e.then(Il)}};var Il=()=>{for(var e;e=pl();){try{e.h.call(e.g)}catch(n){gl(n)}var t=fl;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}bl=!1};function Sl(e,t){ul.call(this),this.h=e||1,this.g=t||so,this.j=ho(this.qb,this),this.l=Date.now()}function Cl(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function kl(e,t,n){if("function"==typeof e)n&&(e=ho(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=ho(e.handleEvent,e)}return 2147483647<Number(t)?-1:so.setTimeout(e,t||0)}function El(e){e.g=kl(()=>{e.g=null,e.i&&(e.i=!1,El(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}fo(Sl,ul),(ao=Sl.prototype).ga=!1,ao.T=null,ao.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),cl(this,"tick"),this.ga&&(Cl(this),this.start()))}},ao.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ao.N=function(){Sl.$.N.call(this),Cl(this),delete this.g};class xl extends vo{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:El(this)}N(){super.N(),this.g&&(so.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Tl(e){vo.call(this),this.h=e,this.g={}}fo(Tl,vo);var Al=[];function Nl(e,t,n,a){Array.isArray(n)||(n&&(Al[0]=n.toString()),n=Al);for(var i=0;i<n.length;i++){var r=tl(t,n[i],a||e.handleEvent,!1,e.h||e);if(!r)break;e.g[r.key]=r}}function Vl(e){Go(e.g,function(e,t){this.g.hasOwnProperty(t)&&al(e)},e),e.g={}}function Dl(){this.g=!0}function Ml(e,t,n,a){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var a=n[e];if(!(2>a.length)){var i=a[1];if(Array.isArray(i)&&!(1>i.length)){var r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var s=1;s<i.length;s++)i[s]=""}}}return hl(n)}catch(o){return t}}(e,n)+(a?" "+a:"")})}Tl.prototype.N=function(){Tl.$.N.call(this),Vl(this)},Tl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Dl.prototype.Ea=function(){this.g=!1},Dl.prototype.info=function(){};var Rl={},Pl=null;function Ol(){return Pl=Pl||new ul}function Ll(e){bo.call(this,Rl.Ta,e)}function Fl(e){const t=Ol();cl(t,new Ll(t))}function Bl(e,t){bo.call(this,Rl.STAT_EVENT,e),this.stat=t}function Ul(e){const t=Ol();cl(t,new Bl(t,e))}function $l(e,t){bo.call(this,Rl.Ua,e),this.size=t}function jl(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return so.setTimeout(function(){e()},t)}Rl.Ta="serverreachability",fo(Ll,bo),Rl.STAT_EVENT="statevent",fo(Bl,bo),Rl.Ua="timingevent",fo($l,bo);var zl={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ql={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Hl(){}function Gl(e){return e.h||(e.h=e.i())}function Kl(){}Hl.prototype.h=null;var Wl,Ql={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Xl(){bo.call(this,"d")}function Yl(){bo.call(this,"c")}function Jl(){}function Zl(e,t,n,a){this.l=e,this.j=t,this.m=n,this.W=a||1,this.U=new Tl(this),this.P=tu,e=Vo?125:void 0,this.V=new Sl(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new eu}function eu(){this.i=null,this.g="",this.h=!1}fo(Xl,bo),fo(Yl,bo),fo(Jl,Hl),Jl.prototype.g=function(){return new XMLHttpRequest},Jl.prototype.i=function(){return{}},Wl=new Jl;var tu=45e3,nu={},au={};function iu(e,t,n){e.L=1,e.v=Su(yu(t)),e.s=n,e.S=!0,ru(e,null)}function ru(e,t){e.G=Date.now(),uu(e),e.A=yu(e.v);var n=e.A,a=e.W;Array.isArray(a)||(a=[String(a)]),Ou(n.i,"t",a),e.C=0,n=e.l.J,e.h=new eu,e.g=Oc(e.l,n?t:null,!e.s),0<e.O&&(e.M=new xl(ho(e.Pa,e,e.g),e.O)),Nl(e.U,e.g,"readystatechange",e.nb),t=e.I?Ko(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),Fl(),function(e,t,n,a,i,r){e.info(function(){if(e.g)if(r)for(var s="",o=r.split("&"),l=0;l<o.length;l++){var u=o[l].split("=");if(1<u.length){var c=u[0];u=u[1];var d=c.split("_");s=2<=d.length&&"type"==d[1]?s+(c+"=")+u+"&":s+(c+"=redacted&")}}else s=null;else s=r;return"XMLHTTP REQ ("+a+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s})}(e.j,e.u,e.A,e.m,e.W,e.s)}function su(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function ou(e,t,n){let a,i=!0;for(;!e.J&&e.C<n.length;){if(a=lu(e,n),a==au){4==t&&(e.o=4,Ul(14),i=!1),Ml(e.j,e.m,null,"[Incomplete Response]");break}if(a==nu){e.o=4,Ul(15),Ml(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ml(e.j,e.m,a,null),fu(e,a)}su(e)&&a!=au&&a!=nu&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Ul(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Tc(t),t.M=!0,Ul(11))):(Ml(e.j,e.m,n,"[Invalid Chunked Response]"),pu(e),hu(e))}function lu(e,t){var n=e.C,a=t.indexOf("\n",n);return-1==a?au:(n=Number(t.substring(n,a)),isNaN(n)?nu:(a+=1)+n>t.length?au:(t=t.slice(a,a+n),e.C=a+n,t))}function uu(e){e.Y=Date.now()+e.P,cu(e,e.P)}function cu(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=jl(ho(e.lb,e),t)}function du(e){e.B&&(so.clearTimeout(e.B),e.B=null)}function hu(e){0==e.l.H||e.J||Vc(e.l,e)}function pu(e){du(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Cl(e.V),Vl(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function fu(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||zu(n.i,e)))if(!e.K&&zu(n.i,e)&&3==n.H){try{var a=n.Ja.g.parse(t)}catch(u){a=null}if(Array.isArray(a)&&3==a.length){var i=a;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Nc(n),wc(n)}xc(n),Ul(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=jl(ho(n.ib,n),6e3));if(1>=ju(n.i)&&n.oa){try{n.oa()}catch(u){}n.oa=void 0}}else Mc(n,11)}else if((e.K||n.g==e)&&Nc(n),!_o(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const t=u[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=u[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const c=u[5];null!=c&&"number"==typeof c&&0<c&&(a=1.5*c,n.L=a,n.l.info("backChannelRequestTimeoutMs_="+a)),a=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var r=a.i;r.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(r.j=r.l,r.g=new Set,r.h&&(qu(r,r.h),r.h=null))}if(a.F){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(a.Da=e,Iu(a.I,a.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var s=e;if((a=n).wa=Pc(a,a.J?a.pa:null,a.Y),s.K){Hu(a.i,s);var o=s,l=a.L;l&&o.setTimeout(l),o.B&&(du(o),uu(o)),a.g=s}else Ec(a);0<n.j.length&&Ic(n)}else"stop"!=u[0]&&"close"!=u[0]||Mc(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?Mc(n,7):bc(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}Fl()}catch(u){}}function vu(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(oo(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(oo(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const a in e)t[n++]=a;return t}}}(e),a=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(oo(e)){for(var t=[],n=e.length,a=0;a<n;a++)t.push(e[a]);return t}for(a in t=[],n=0,e)t[n++]=e[a];return t}(e),i=a.length,r=0;r<i;r++)t.call(void 0,a[r],n&&n[r],e)}(ao=Zl.prototype).setTimeout=function(e){this.P=e},ao.nb=function(e){e=e.target;const t=this.M;t&&3==pc(e)?t.l():this.Pa(e)},ao.Pa=function(e){try{if(e==this.g)e:{const c=pc(this.g);var t=this.g.Ia();this.g.da();if(!(3>c)&&(3!=c||Vo||this.g&&(this.h.h||this.g.ja()||fc(this.g)))){this.J||4!=c||7==t||Fl(),du(this);var n=this.g.da();this.ca=n;t:if(su(this)){var a=fc(this.g);e="";var i=a.length,r=4==pc(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){pu(this),hu(this);var s="";break t}this.h.i=new so.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(a[t],{stream:r&&t==i-1});a.splice(0,i),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.ja();if(this.i=200==n,function(e,t,n,a,i,r,s){e.info(function(){return"XMLHTTP RESP ("+a+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+r+" "+s})}(this.j,this.u,this.A,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,l=this.g;if((o=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_o(o)){var u=o;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Ul(12),pu(this),hu(this);break e}Ml(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,fu(this,n)}this.S?(ou(this,c,s),Vo&&this.i&&3==c&&(Nl(this.U,this.V,"tick",this.mb),this.V.start())):(Ml(this.j,this.m,s,null),fu(this,s)),4==c&&pu(this),this.i&&!this.J&&(4==c?Vc(this.l,this):(this.i=!1,uu(this)))}else(function(e){const t={};e=(e.g&&2<=pc(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let a=0;a<e.length;a++){if(_o(e[a]))continue;var n=ml(e[a]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const r=t[i]||[];t[i]=r,r.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<s.indexOf("Unknown SID")?(this.o=3,Ul(12)):(this.o=0,Ul(13)),pu(this),hu(this)}}}catch(c){}},ao.mb=function(){if(this.g){var e=pc(this.g),t=this.g.ja();this.C<t.length&&(du(this),ou(this,e,t),this.i&&4!=e&&uu(this))}},ao.cancel=function(){this.J=!0,pu(this)},ao.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.L&&(Fl(),Ul(17)),pu(this),this.o=2,hu(this)):cu(this,this.Y-e)};var mu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gu(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof gu){this.h=e.h,bu(this,e.j),this.s=e.s,this.g=e.g,wu(this,e.m),this.l=e.l;var t=e.i,n=new Du;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),_u(this,n),this.o=e.o}else e&&(t=String(e).match(mu))?(this.h=!1,bu(this,t[1]||"",!0),this.s=Cu(t[2]||""),this.g=Cu(t[3]||"",!0),wu(this,t[4]),this.l=Cu(t[5]||"",!0),_u(this,t[6]||"",!0),this.o=Cu(t[7]||"")):(this.h=!1,this.i=new Du(null,this.h))}function yu(e){return new gu(e)}function bu(e,t,n){e.j=n?Cu(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function wu(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function _u(e,t,n){t instanceof Du?(e.i=t,function(e,t){t&&!e.j&&(Mu(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Ru(this,t),Ou(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=ku(t,Nu)),e.i=new Du(t,e.h))}function Iu(e,t,n){e.i.set(t,n)}function Su(e){return Iu(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Cu(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ku(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Eu),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Eu(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}gu.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ku(t,xu,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(ku(t,xu,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ku(n,"/"==n.charAt(0)?Au:Tu,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",ku(n,Vu)),e.join("")};var xu=/[#\/\?@]/g,Tu=/[#\?:]/g,Au=/[#\?]/g,Nu=/[#\?@]/g,Vu=/#/g;function Du(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Mu(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var a=e[n].indexOf("="),i=null;if(0<=a){var r=e[n].substring(0,a);i=e[n].substring(a+1)}else r=e[n];t(r,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function Ru(e,t){Mu(e),t=Lu(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Pu(e,t){return Mu(e),t=Lu(e,t),e.g.has(t)}function Ou(e,t,n){Ru(e,t),0<n.length&&(e.i=null,e.g.set(Lu(e,t),go(n)),e.h+=n.length)}function Lu(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(ao=Du.prototype).add=function(e,t){Mu(this),this.i=null,e=Lu(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},ao.forEach=function(e,t){Mu(this),this.g.forEach(function(n,a){n.forEach(function(n){e.call(t,n,a,this)},this)},this)},ao.ta=function(){Mu(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let a=0;a<t.length;a++){const i=e[a];for(let e=0;e<i.length;e++)n.push(t[a])}return n},ao.Z=function(e){Mu(this);let t=[];if("string"==typeof e)Pu(this,e)&&(t=t.concat(this.g.get(Lu(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},ao.set=function(e,t){return Mu(this),this.i=null,Pu(this,e=Lu(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},ao.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},ao.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var a=t[n];const r=encodeURIComponent(String(a)),s=this.Z(a);for(a=0;a<s.length;a++){var i=r;""!==s[a]&&(i+="="+encodeURIComponent(String(s[a]))),e.push(i)}}return this.i=e.join("&")};var Fu=class{constructor(e,t){this.g=e,this.map=t}};function Bu(e){this.l=e||Uu,so.PerformanceNavigationTiming?e=0<(e=so.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(so.g&&so.g.Ka&&so.g.Ka()&&so.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Uu=10;function $u(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ju(e){return e.h?1:e.g?e.g.size:0}function zu(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function qu(e,t){e.g?e.g.add(t):e.h=t}function Hu(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Gu(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return go(e.i)}Bu.prototype.cancel=function(){if(this.i=Gu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Ku=class{stringify(e){return so.JSON.stringify(e,void 0)}parse(e){return so.JSON.parse(e,void 0)}};function Wu(){this.g=new Ku}function Qu(e,t,n){const a=n||"";try{vu(e,function(e,n){let i=e;lo(e)&&(i=hl(e)),t.push(a+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(a+"type="+encodeURIComponent("_badmap")),i}}function Xu(e,t,n,a,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(a)}catch(r){}}function Yu(e){this.l=e.fc||null,this.j=e.ob||!1}function Ju(e,t){ul.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Zu,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}fo(Yu,Hl),Yu.prototype.g=function(){return new Ju(this.l,this.j)},Yu.prototype.i=function(e){return function(){return e}}({}),fo(Ju,ul);var Zu=0;function ec(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function tc(e){e.readyState=4,e.l=null,e.j=null,e.A=null,nc(e)}function nc(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(ao=Ju.prototype).open=function(e,t){if(this.readyState!=Zu)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,nc(this)},ao.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||so).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},ao.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,tc(this)),this.readyState=Zu},ao.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,nc(this)),this.g&&(this.readyState=3,nc(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==so.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ec(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},ao.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?tc(this):nc(this),3==this.readyState&&ec(this)}},ao.Za=function(e){this.g&&(this.response=this.responseText=e,tc(this))},ao.Ya=function(e){this.g&&(this.response=e,tc(this))},ao.ka=function(){this.g&&tc(this)},ao.setRequestHeader=function(e,t){this.v.append(e,t)},ao.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},ao.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ju.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var ac=so.JSON.parse;function ic(e){ul.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=rc,this.L=this.M=!1}fo(ic,ul);var rc="",sc=/^https?$/i,oc=["POST","PUT"];function lc(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,uc(e),dc(e)}function uc(e){e.F||(e.F=!0,cl(e,"complete"),cl(e,"error"))}function cc(e){if(e.h&&void 0!==ro&&(!e.C[1]||4!=pc(e)||2!=e.da()))if(e.v&&4==pc(e))kl(e.La,0,e);else if(cl(e,"readystatechange"),4==pc(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var a;if(a=0===o){var i=String(e.I).match(mu)[1]||null;!i&&so.self&&so.self.location&&(i=so.self.location.protocol.slice(0,-1)),a=!sc.test(i?i.toLowerCase():"")}n=a}if(n)cl(e,"complete"),cl(e,"success");else{e.m=6;try{var r=2<pc(e)?e.g.statusText:""}catch(s){r=""}e.j=r+" ["+e.da()+"]",uc(e)}}finally{dc(e)}}}function dc(e,t){if(e.g){hc(e);const a=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||cl(e,"ready");try{a.onreadystatechange=i}catch(n){}}}function hc(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(so.clearTimeout(e.A),e.A=null)}function pc(e){return e.g?e.g.readyState:0}function fc(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case rc:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function vc(e){let t="";return Go(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function mc(e,t,n){e:{for(a in n){var a=!1;break e}a=!0}a||(n=vc(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Iu(e,t,n))}function gc(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function yc(e){this.Ga=0,this.j=[],this.l=new Dl,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=gc("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=gc("baseRetryDelayMs",5e3,e),this.hb=gc("retryDelaySeedMs",1e4,e),this.eb=gc("forwardChannelMaxRetries",2,e),this.xa=gc("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Bu(e&&e.concurrentRequestLimit),this.Ja=new Wu,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function bc(e){if(_c(e),3==e.H){var t=e.W++,n=yu(e.I);if(Iu(n,"SID",e.K),Iu(n,"RID",t),Iu(n,"TYPE","terminate"),Cc(e,n),(t=new Zl(e,e.l,t)).L=2,t.v=Su(yu(n)),n=!1,so.navigator&&so.navigator.sendBeacon)try{n=so.navigator.sendBeacon(t.v.toString(),"")}catch(a){}!n&&so.Image&&((new Image).src=t.v,n=!0),n||(t.g=Oc(t.l,null),t.g.ha(t.v)),t.G=Date.now(),uu(t)}Rc(e)}function wc(e){e.g&&(Tc(e),e.g.cancel(),e.g=null)}function _c(e){wc(e),e.u&&(so.clearTimeout(e.u),e.u=null),Nc(e),e.i.cancel(),e.m&&("number"==typeof e.m&&so.clearTimeout(e.m),e.m=null)}function Ic(e){if(!$u(e.i)&&!e.m){e.m=!0;var t=e.Na;yl||_l(),bl||(yl(),bl=!0),wl.add(t,e),e.C=0}}function Sc(e,t){var n;n=t?t.m:e.W++;const a=yu(e.I);Iu(a,"SID",e.K),Iu(a,"RID",n),Iu(a,"AID",e.V),Cc(e,a),e.o&&e.s&&mc(a,e.o,e.s),n=new Zl(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=kc(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),qu(e.i,n),iu(n,a,t)}function Cc(e,t){e.na&&Go(e.na,function(e,n){Iu(t,n,e)}),e.h&&vu({},function(e,n){Iu(t,n,e)})}function kc(e,t,n){n=Math.min(e.j.length,n);var a=e.h?ho(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const l=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{Qu(l,e,"req"+n+"_")}catch(r){a&&a(l)}}if(s){a=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,a}function Ec(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;yl||_l(),bl||(yl(),bl=!0),wl.add(t,e),e.A=0}}function xc(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=jl(ho(e.Ma,e),Dc(e,e.A)),e.A++,!0)}function Tc(e){null!=e.B&&(so.clearTimeout(e.B),e.B=null)}function Ac(e){e.g=new Zl(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=yu(e.wa);Iu(t,"RID","rpc"),Iu(t,"SID",e.K),Iu(t,"AID",e.V),Iu(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Iu(t,"TO",e.qa),Iu(t,"TYPE","xmlhttp"),Cc(e,t),e.o&&e.s&&mc(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Su(yu(t)),n.s=null,n.S=!0,ru(n,e)}function Nc(e){null!=e.v&&(so.clearTimeout(e.v),e.v=null)}function Vc(e,t){var n=null;if(e.g==t){Nc(e),Tc(e),e.g=null;var a=2}else{if(!zu(e.i,t))return;n=t.F,Hu(e.i,t),a=1}if(0!=e.H)if(t.i)if(1==a){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;cl(a=Ol(),new $l(a,n)),Ic(e)}else Ec(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==a&&function(e,t){return!(ju(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=jl(ho(e.Na,e,t),Dc(e,e.C)),e.C++,0)))}(e,t)||2==a&&xc(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Mc(e,5);break;case 4:Mc(e,10);break;case 3:Mc(e,6);break;default:Mc(e,2)}}function Dc(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Mc(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var a=ho(e.pb,e);n||(n=new gu("//www.google.com/images/cleardot.gif"),so.location&&"http"==so.location.protocol||bu(n,"https"),Su(n)),function(e,t){const n=new Dl;if(so.Image){const a=new Image;a.onload=po(Xu,n,a,"TestLoadImage: loaded",!0,t),a.onerror=po(Xu,n,a,"TestLoadImage: error",!1,t),a.onabort=po(Xu,n,a,"TestLoadImage: abort",!1,t),a.ontimeout=po(Xu,n,a,"TestLoadImage: timeout",!1,t),so.setTimeout(function(){a.ontimeout&&a.ontimeout()},1e4),a.src=e}else t(!1)}(n.toString(),a)}else Ul(2);e.H=0,e.h&&e.h.za(t),Rc(e),_c(e)}function Rc(e){if(e.H=0,e.ma=[],e.h){const t=Gu(e.i);0==t.length&&0==e.j.length||(yo(e.ma,t),yo(e.ma,e.j),e.i.i.length=0,go(e.j),e.j.length=0),e.h.ya()}}function Pc(e,t,n){var a=n instanceof gu?yu(n):new gu(n);if(""!=a.g)t&&(a.g=t+"."+a.g),wu(a,a.m);else{var i=so.location;a=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var r=new gu(null);a&&bu(r,a),t&&(r.g=t),i&&wu(r,i),n&&(r.l=n),a=r}return n=e.F,t=e.Da,n&&t&&Iu(a,n,t),Iu(a,"VER",e.ra),Cc(e,a),a}function Oc(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new ic(new Yu({ob:!0})):new ic(e.va)).Oa(e.J),t}function Lc(){}function Fc(){if(Ao&&!(10<=Number(Bo)))throw Error("Environmental error: no available transport.")}function Bc(e,t){ul.call(this),this.g=new yc(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!_o(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!_o(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new jc(this)}function Uc(e){Xl.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function $c(){Yl.call(this),this.status=1}function jc(e){this.g=e}function zc(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function qc(e,t,n){n||(n=0);var a=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)a[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)a[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var r=e.g[3],s=t+(r^n&(i^r))+a[0]+3614090360&4294967295;s=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=(n=(i=(r=(t=n+(s<<7&4294967295|s>>>25))+((s=r+(i^t&(n^i))+a[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^r&(t^n))+a[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(r^t))+a[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^n&(i^r))+a[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=r+(i^t&(n^i))+a[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^r&(t^n))+a[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(r^t))+a[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^n&(i^r))+a[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=r+(i^t&(n^i))+a[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^r&(t^n))+a[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(r^t))+a[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(r^n&(i^r))+a[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=r+(i^t&(n^i))+a[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^r&(t^n))+a[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(r^t))+a[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^r&(n^i))+a[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=r+(n^i&(t^n))+a[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(r^t))+a[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(r^t&(i^r))+a[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^r&(n^i))+a[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=r+(n^i&(t^n))+a[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(r^t))+a[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(r^t&(i^r))+a[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^r&(n^i))+a[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=r+(n^i&(t^n))+a[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(r^t))+a[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(r^t&(i^r))+a[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^r&(n^i))+a[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=r+(n^i&(t^n))+a[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(r^t))+a[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(r^t&(i^r))+a[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^i^r)+a[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=r+(t^n^i)+a[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(r^t^n)+a[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^r^t)+a[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^r)+a[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=r+(t^n^i)+a[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(r^t^n)+a[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^r^t)+a[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^r)+a[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=r+(t^n^i)+a[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(r^t^n)+a[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^r^t)+a[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^r)+a[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=r+(t^n^i)+a[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(r^t^n)+a[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^r^t)+a[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(n|~r))+a[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=r+(n^(t|~i))+a[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(r|~n))+a[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(r^(i|~t))+a[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~r))+a[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=r+(n^(t|~i))+a[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(r|~n))+a[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(r^(i|~t))+a[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~r))+a[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=r+(n^(t|~i))+a[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(r|~n))+a[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(r^(i|~t))+a[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((r=(t=n+((s=t+(i^(n|~r))+a[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=r+(n^(t|~i))+a[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=r+((s=i+(t^(r|~n))+a[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+a[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+r&4294967295}function Hc(e,t){this.h=t;for(var n=[],a=!0,i=e.length-1;0<=i;i--){var r=0|e[i];a&&r==t||(n[i]=r,a=!1)}this.g=n}(ao=ic.prototype).Oa=function(e){this.M=e},ao.ha=function(e,t,n,a){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Wl.g(),this.C=this.u?Gl(this.u):Gl(Wl),this.g.onreadystatechange=ho(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(r){return void lc(this,r)}if(e=n||"",n=new Map(this.headers),a)if(Object.getPrototypeOf(a)===Object.prototype)for(var i in a)n.set(i,a[i]);else{if("function"!=typeof a.keys||"function"!=typeof a.get)throw Error("Unknown input type for opt_headers: "+String(a));for(const e of a.keys())n.set(e,a.get(e))}a=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=so.FormData&&e instanceof so.FormData,!(0<=mo(oc,t))||a||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{hc(this),0<this.B&&((this.L=function(e){return Ao&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ho(this.ua,this)):this.A=kl(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(r){lc(this,r)}},ao.ua=function(){void 0!==ro&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,cl(this,"timeout"),this.abort(8))},ao.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,cl(this,"complete"),cl(this,"abort"),dc(this))},ao.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),dc(this,!0)),ic.$.N.call(this)},ao.La=function(){this.s||(this.G||this.v||this.l?cc(this):this.kb())},ao.kb=function(){cc(this)},ao.isActive=function(){return!!this.g},ao.da=function(){try{return 2<pc(this)?this.g.status:-1}catch(Eo){return-1}},ao.ja=function(){try{return this.g?this.g.responseText:""}catch(Eo){return""}},ao.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ac(t)}},ao.Ia=function(){return this.m},ao.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(ao=yc.prototype).ra=8,ao.H=1,ao.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new Zl(this,this.l,e);let r=this.s;if(this.U&&(r?(r=Ko(r),Qo(r,this.U)):r=this.U),null!==this.o||this.O||(i.I=r,r=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var a=this.j[n];if(void 0===(a="__data__"in a.map&&"string"==typeof(a=a.map.__data__)?a.length:void 0))break;if(4096<(t+=a)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=kc(this,i,t),Iu(n=yu(this.I),"RID",e),Iu(n,"CVER",22),this.F&&Iu(n,"X-HTTP-Session-Id",this.F),Cc(this,n),r&&(this.O?t="headers="+encodeURIComponent(String(vc(r)))+"&"+t:this.o&&mc(n,this.o,r)),qu(this.i,i),this.bb&&Iu(n,"TYPE","init"),this.P?(Iu(n,"$req",t),Iu(n,"SID","null"),i.aa=!0,iu(i,n,null)):iu(i,n,t),this.H=2}}else 3==this.H&&(e?Sc(this,e):0==this.j.length||$u(this.i)||Sc(this))},ao.Ma=function(){if(this.u=null,Ac(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=jl(ho(this.jb,this),e)}},ao.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Ul(10),wc(this),Ac(this))},ao.ib=function(){null!=this.v&&(this.v=null,wc(this),xc(this),Ul(19))},ao.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Ul(2)):(this.l.info("Failed to ping google.com"),Ul(1))},ao.isActive=function(){return!!this.h&&this.h.isActive(this)},(ao=Lc.prototype).Ba=function(){},ao.Aa=function(){},ao.za=function(){},ao.ya=function(){},ao.isActive=function(){return!0},ao.Va=function(){},Fc.prototype.g=function(e,t){return new Bc(e,t)},fo(Bc,ul),Bc.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Ul(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Pc(e,null,e.Y),Ic(e)},Bc.prototype.close=function(){bc(this.g)},Bc.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=hl(e),e=n);t.j.push(new Fu(t.fb++,e)),3==t.H&&Ic(t)},Bc.prototype.N=function(){this.g.h=null,delete this.j,bc(this.g),delete this.g,Bc.$.N.call(this)},fo(Uc,Xl),fo($c,Yl),fo(jc,Lc),jc.prototype.Ba=function(){cl(this.g,"a")},jc.prototype.Aa=function(e){cl(this.g,new Uc(e))},jc.prototype.za=function(e){cl(this.g,new $c)},jc.prototype.ya=function(){cl(this.g,"b")},fo(zc,function(){this.blockSize=-1}),zc.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},zc.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,a=this.m,i=this.h,r=0;r<t;){if(0==i)for(;r<=n;)qc(this,e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(a[i++]=e.charCodeAt(r++),i==this.blockSize){qc(this,a),i=0;break}}else for(;r<t;)if(a[i++]=e[r++],i==this.blockSize){qc(this,a),i=0;break}}this.h=i,this.i+=t},zc.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var a=0;32>a;a+=8)e[n++]=this.g[t]>>>a&255;return e};var Gc={};function Kc(e){return-128<=e&&128>e?function(e,t){var n=Gc;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new Hc([0|e],0>e?-1:0)}):new Hc([0|e],0>e?-1:0)}function Wc(e){if(isNaN(e)||!isFinite(e))return Xc;if(0>e)return td(Wc(-e));for(var t=[],n=1,a=0;e>=n;a++)t[a]=e/n|0,n*=Qc;return new Hc(t,0)}var Qc=4294967296,Xc=Kc(0),Yc=Kc(1),Jc=Kc(16777216);function Zc(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function ed(e){return-1==e.h}function td(e){for(var t=e.g.length,n=[],a=0;a<t;a++)n[a]=~e.g[a];return new Hc(n,~e.h).add(Yc)}function nd(e,t){return e.add(td(t))}function ad(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function id(e,t){this.g=e,this.h=t}function rd(e,t){if(Zc(t))throw Error("division by zero");if(Zc(e))return new id(Xc,Xc);if(ed(e))return t=rd(td(e),t),new id(td(t.g),td(t.h));if(ed(t))return t=rd(e,td(t)),new id(td(t.g),t.h);if(30<e.g.length){if(ed(e)||ed(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Yc,a=t;0>=a.X(e);)n=sd(n),a=sd(a);var i=od(n,1),r=od(a,1);for(a=od(a,2),n=od(n,2);!Zc(a);){var s=r.add(a);0>=s.X(e)&&(i=i.add(n),r=s),a=od(a,1),n=od(n,1)}return t=nd(e,i.R(t)),new id(i,t)}for(i=Xc;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),a=48>=(a=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,a-48),s=(r=Wc(n)).R(t);ed(s)||0<s.X(e);)s=(r=Wc(n-=a)).R(t);Zc(r)&&(r=Yc),i=i.add(r),e=nd(e,s)}return new id(i,e)}function sd(e){for(var t=e.g.length+1,n=[],a=0;a<t;a++)n[a]=e.D(a)<<1|e.D(a-1)>>>31;return new Hc(n,e.h)}function od(e,t){var n=t>>5;t%=32;for(var a=e.g.length-n,i=[],r=0;r<a;r++)i[r]=0<t?e.D(r+n)>>>t|e.D(r+n+1)<<32-t:e.D(r+n);return new Hc(i,e.h)}(ao=Hc.prototype).ea=function(){if(ed(this))return-td(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var a=this.D(n);e+=(0<=a?a:Qc+a)*t,t*=Qc}return e},ao.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Zc(this))return"0";if(ed(this))return"-"+td(this).toString(e);for(var t=Wc(Math.pow(e,6)),n=this,a="";;){var i=rd(n,t).g,r=((0<(n=nd(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Zc(n=i))return r+a;for(;6>r.length;)r="0"+r;a=r+a}},ao.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},ao.X=function(e){return ed(e=nd(this,e))?-1:Zc(e)?0:1},ao.abs=function(){return ed(this)?td(this):this},ao.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0,i=0;i<=t;i++){var r=a+(65535&this.D(i))+(65535&e.D(i)),s=(r>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);a=s>>>16,r&=65535,s&=65535,n[i]=s<<16|r}return new Hc(n,-2147483648&n[n.length-1]?-1:0)},ao.R=function(e){if(Zc(this)||Zc(e))return Xc;if(ed(this))return ed(e)?td(this).R(td(e)):td(td(this).R(e));if(ed(e))return td(this.R(td(e)));if(0>this.X(Jc)&&0>e.X(Jc))return Wc(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],a=0;a<2*t;a++)n[a]=0;for(a=0;a<this.g.length;a++)for(var i=0;i<e.g.length;i++){var r=this.D(a)>>>16,s=65535&this.D(a),o=e.D(i)>>>16,l=65535&e.D(i);n[2*a+2*i]+=s*l,ad(n,2*a+2*i),n[2*a+2*i+1]+=r*l,ad(n,2*a+2*i+1),n[2*a+2*i+1]+=s*o,ad(n,2*a+2*i+1),n[2*a+2*i+2]+=r*o,ad(n,2*a+2*i+2)}for(a=0;a<t;a++)n[a]=n[2*a+1]<<16|n[2*a];for(a=t;a<2*t;a++)n[a]=0;return new Hc(n,0)},ao.gb=function(e){return rd(this,e).h},ao.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.D(a)&e.D(a);return new Hc(n,this.h&e.h)},ao.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.D(a)|e.D(a);return new Hc(n,this.h|e.h)},ao.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],a=0;a<t;a++)n[a]=this.D(a)^e.D(a);return new Hc(n,this.h^e.h)},Fc.prototype.createWebChannel=Fc.prototype.g,Bc.prototype.send=Bc.prototype.u,Bc.prototype.open=Bc.prototype.m,Bc.prototype.close=Bc.prototype.close,zl.NO_ERROR=0,zl.TIMEOUT=8,zl.HTTP_ERROR=6,ql.COMPLETE="complete",Kl.EventType=Ql,Ql.OPEN="a",Ql.CLOSE="b",Ql.ERROR="c",Ql.MESSAGE="d",ul.prototype.listen=ul.prototype.O,ic.prototype.listenOnce=ic.prototype.P,ic.prototype.getLastError=ic.prototype.Sa,ic.prototype.getLastErrorCode=ic.prototype.Ia,ic.prototype.getStatus=ic.prototype.da,ic.prototype.getResponseJson=ic.prototype.Wa,ic.prototype.getResponseText=ic.prototype.ja,ic.prototype.send=ic.prototype.ha,ic.prototype.setWithCredentials=ic.prototype.Oa,zc.prototype.digest=zc.prototype.l,zc.prototype.reset=zc.prototype.reset,zc.prototype.update=zc.prototype.j,Hc.prototype.add=Hc.prototype.add,Hc.prototype.multiply=Hc.prototype.R,Hc.prototype.modulo=Hc.prototype.gb,Hc.prototype.compare=Hc.prototype.X,Hc.prototype.toNumber=Hc.prototype.ea,Hc.prototype.toString=Hc.prototype.toString,Hc.prototype.getBits=Hc.prototype.D,Hc.fromNumber=Wc,Hc.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return td(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var a=Wc(Math.pow(n,8)),i=Xc,r=0;r<t.length;r+=8){var s=Math.min(8,t.length-r),o=parseInt(t.substring(r,r+s),n);8>s?(s=Wc(Math.pow(n,s)),i=i.R(s).add(Wc(o))):i=(i=i.R(a)).add(Wc(o))}return i};var ld=zl,ud=ql,cd=Rl,dd=10,hd=11,pd=Yu,fd=Kl,vd=ic,md=zc,gd=Hc;const yd="@firebase/firestore";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bd.UNAUTHENTICATED=new bd(null),bd.GOOGLE_CREDENTIALS=new bd("google-credentials-uid"),bd.FIRST_PARTY=new bd("first-party-uid"),bd.MOCK_USER=new bd("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let wd="9.23.0";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _d=new Wn("@firebase/firestore");function Id(){return _d.logLevel}function Sd(e,...t){if(_d.logLevel<=jn.DEBUG){const n=t.map(Ed);_d.debug(`Firestore (${wd}): ${e}`,...n)}}function Cd(e,...t){if(_d.logLevel<=jn.ERROR){const n=t.map(Ed);_d.error(`Firestore (${wd}): ${e}`,...n)}}function kd(e,...t){if(_d.logLevel<=jn.WARN){const n=t.map(Ed);_d.warn(`Firestore (${wd}): ${e}`,...n)}}function Ed(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(n){return e}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(e="Unexpected state"){const t=`FIRESTORE (${wd}) INTERNAL ASSERTION FAILED: `+e;throw Cd(t),new Error(t)}function Td(e,t){e||xd()}function Ad(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Vd extends An{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rd{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(bd.UNAUTHENTICATED))}shutdown(){}}class Pd{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Od{constructor(e){this.t=e,this.currentUser=bd.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const a=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Dd;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Dd,e.enqueueRetryable(()=>a(this.currentUser))};const r=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await a(this.currentUser)})},s=e=>{Sd("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),r()};this.t.onInit(e=>s(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(Sd("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Dd)}},0),r()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Sd("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Td("string"==typeof t.accessToken),new Md(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Td(null===e||"string"==typeof e),new bd(e)}}class Ld{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=bd.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class Fd{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new Ld(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(bd.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Bd{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ud{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&Sd("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,Sd("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const a=e=>{Sd("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit(e=>a(e)),setTimeout(()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?a(e):Sd("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Td("string"==typeof e.token),this.T=e.token,new Bd(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $d(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let a=0;a<e;a++)n[a]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const a=$d(40);for(let i=0;i<a.length;++i)n.length<20&&a[i]<t&&(n+=e.charAt(a[i]%62))}return n}}function zd(e,t){return e<t?-1:e>t?1:0}function qd(e,t,n){return e.length===t.length&&e.every((e,a)=>n(e,t[a]))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Vd(Nd.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Vd(Nd.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Vd(Nd.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Vd(Nd.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Hd.fromMillis(Date.now())}static fromDate(e){return Hd.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Hd(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?zd(this.nanoseconds,e.nanoseconds):zd(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Gd(e)}static min(){return new Gd(new Hd(0,0))}static max(){return new Gd(new Hd(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,t,n){void 0===t?t=0:t>e.length&&xd(),void 0===n?n=e.length-t:n>e.length-t&&xd(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Kd.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Kd?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let a=0;a<n;a++){const n=e.get(a),i=t.get(a);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Wd extends Kd{construct(e,t,n){return new Wd(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Vd(Nd.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new Wd(t)}static emptyPath(){return new Wd([])}}const Qd=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Xd extends Kd{construct(e,t,n){return new Xd(e,t,n)}static isValidIdentifier(e){return Qd.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Xd.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Xd(["__name__"])}static fromServerFormat(e){const t=[];let n="",a=0;const i=()=>{if(0===n.length)throw new Vd(Nd.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let r=!1;for(;a<e.length;){const t=e[a];if("\\"===t){if(a+1===e.length)throw new Vd(Nd.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[a+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Vd(Nd.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,a+=2}else"`"===t?(r=!r,a++):"."!==t||r?(n+=t,a++):(i(),a++)}if(i(),r)throw new Vd(Nd.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Xd(t)}static emptyPath(){return new Xd([])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e){this.path=e}static fromPath(e){return new Yd(Wd.fromString(e))}static fromName(e){return new Yd(Wd.fromString(e).popFirst(5))}static empty(){return new Yd(Wd.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Wd.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Wd.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Yd(new Wd(e.slice()))}}function Jd(e){return new Zd(e.readTime,e.key,-1)}class Zd{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Zd(Gd.min(),Yd.empty(),-1)}static max(){return new Zd(Gd.max(),Yd.empty(),-1)}}function eh(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Yd.comparator(e.documentKey,t.documentKey),0!==n?n:zd(e.largestBatchId,t.largestBatchId)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}class th{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nh(e){if(e.code!==Nd.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;Sd("LocalStore","Unexpectedly lost primary lease")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xd(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ah((n,a)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,a)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,a)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ah?t:ah.resolve(t)}catch(t){return ah.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ah.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ah.reject(t)}static resolve(e){return new ah((t,n)=>{t(e)})}static reject(e){return new ah((t,n)=>{n(e)})}static waitFor(e){return new ah((t,n)=>{let a=0,i=0,r=!1;e.forEach(e=>{++a,e.next(()=>{++i,r&&i===a&&t()},e=>n(e))}),r=!0,i===a&&t()})}static or(e){let t=ah.resolve(!1);for(const n of e)t=t.next(e=>e?ah.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,a)=>{n.push(t.call(this,e,a))}),this.waitFor(n)}static mapArray(e,t){return new ah((n,a)=>{const i=e.length,r=new Array(i);let s=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next(e=>{r[l]=e,++s,s===i&&n(r)},e=>a(e))}})}static doWhile(e,t){return new ah((n,a)=>{const i=()=>{!0===e()?t().next(()=>{i()},a):n()};i()})}}function ih(e){return"IndexedDbTransactionError"===e.name}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function sh(e){return null==e}function oh(e){return 0===e&&1/e==-1/0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function lh(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function uh(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ch(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rh.ct=-1;class dh{constructor(e,t){this.comparator=e,this.root=t||ph.EMPTY}insert(e,t){return new dh(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ph.BLACK,null,null))}remove(e){return new dh(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ph.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(0===a)return t+n.left.size;a<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hh(this.root,e,this.comparator,!1)}getReverseIterator(){return new hh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hh(this.root,e,this.comparator,!0)}}class hh{constructor(e,t,n,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&a&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ph{constructor(e,t,n,a,i){this.key=e,this.value=t,this.color=null!=n?n:ph.RED,this.left=null!=a?a:ph.EMPTY,this.right=null!=i?i:ph.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,a,i){return new ph(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=a?a:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let a=this;const i=n(e,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(e,t,n),null):0===i?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return ph.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),0===t(e,a.key)){if(a.right.isEmpty())return ph.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ph.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ph.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xd();if(this.right.isRed())throw xd();const e=this.left.check();if(e!==this.right.check())throw xd();return e+(this.isRed()?0:1)}}ph.EMPTY=null,ph.RED=!0,ph.BLACK=!1,ph.EMPTY=new class{constructor(){this.size=0}get key(){throw xd()}get value(){throw xd()}get color(){throw xd()}get left(){throw xd()}get right(){throw xd()}copy(e,t,n,a,i){return this}insert(e,t,n){return new ph(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class fh{constructor(e){this.comparator=e,this.data=new dh(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vh(this.data.getIterator())}getIteratorFrom(e){return new vh(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof fh))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,a=n.getNext().key;if(0!==this.comparator(e,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new fh(this.comparator);return t.data=e,t}}class vh{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e){this.fields=e,e.sort(Xd.comparator)}static empty(){return new mh([])}unionWith(e){let t=new fh(Xd.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new mh(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return qd(this.fields,e.fields,(e,t)=>e.isEqual(t))}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new gh("Invalid base64 string: "+t):t}}(e);return new yh(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new yh(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return zd(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yh.EMPTY_BYTE_STRING=new yh("");const bh=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wh(e){if(Td(!!e),"string"==typeof e){let t=0;const n=bh.exec(e);if(Td(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const a=new Date(e);return{seconds:Math.floor(a.getTime()/1e3),nanos:t}}return{seconds:_h(e.seconds),nanos:_h(e.nanos)}}function _h(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ih(e){return"string"==typeof e?yh.fromBase64String(e):yh.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ch(e){const t=e.mapValue.fields.__previous_value__;return Sh(t)?Ch(t):t}function kh(e){const t=wh(e.mapValue.fields.__local_write_time__.timestampValue);return new Hd(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e,t,n,a,i,r,s,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=a,this.ssl=i,this.forceLongPolling=r,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l}}class xh{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new xh("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof xh&&e.projectId===this.projectId&&e.database===this.database}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th={};function Ah(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Sh(e)?4:function(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)?9007199254740991:10:xd()}function Nh(e,t){if(e===t)return!0;const n=Ah(e);if(n!==Ah(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return kh(e).isEqual(kh(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=wh(e.timestampValue),a=wh(t.timestampValue);return n.seconds===a.seconds&&n.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return a=t,Ih(e.bytesValue).isEqual(Ih(a.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return _h(e.geoPointValue.latitude)===_h(t.geoPointValue.latitude)&&_h(e.geoPointValue.longitude)===_h(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return _h(e.integerValue)===_h(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=_h(e.doubleValue),a=_h(t.doubleValue);return n===a?oh(n)===oh(a):isNaN(n)&&isNaN(a)}return!1}(e,t);case 9:return qd(e.arrayValue.values||[],t.arrayValue.values||[],Nh);case 10:return function(e,t){const n=e.mapValue.fields||{},a=t.mapValue.fields||{};if(lh(n)!==lh(a))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===a[i]||!Nh(n[i],a[i])))return!1;return!0}(e,t);default:return xd()}var a}function Vh(e,t){return void 0!==(e.values||[]).find(e=>Nh(e,t))}function Dh(e,t){if(e===t)return 0;const n=Ah(e),a=Ah(t);if(n!==a)return zd(n,a);switch(n){case 0:case 9007199254740991:return 0;case 1:return zd(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=_h(e.integerValue||e.doubleValue),a=_h(t.integerValue||t.doubleValue);return n<a?-1:n>a?1:n===a?0:isNaN(n)?isNaN(a)?0:-1:1}(e,t);case 3:return Mh(e.timestampValue,t.timestampValue);case 4:return Mh(kh(e),kh(t));case 5:return zd(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Ih(e),a=Ih(t);return n.compareTo(a)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),a=t.split("/");for(let i=0;i<n.length&&i<a.length;i++){const e=zd(n[i],a[i]);if(0!==e)return e}return zd(n.length,a.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=zd(_h(e.latitude),_h(t.latitude));return 0!==n?n:zd(_h(e.longitude),_h(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],a=t.values||[];for(let i=0;i<n.length&&i<a.length;++i){const e=Dh(n[i],a[i]);if(e)return e}return zd(n.length,a.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Th&&t===Th)return 0;if(e===Th)return 1;if(t===Th)return-1;const n=e.fields||{},a=Object.keys(n),i=t.fields||{},r=Object.keys(i);a.sort(),r.sort();for(let s=0;s<a.length&&s<r.length;++s){const e=zd(a[s],r[s]);if(0!==e)return e;const t=Dh(n[a[s]],i[r[s]]);if(0!==t)return t}return zd(a.length,r.length)}(e.mapValue,t.mapValue);default:throw xd()}}function Mh(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return zd(e,t);const n=wh(e),a=wh(t),i=zd(n.seconds,a.seconds);return 0!==i?i:zd(n.nanos,a.nanos)}function Rh(e){return Ph(e)}function Ph(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=wh(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ih(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Yd.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const a of e.values||[])n?n=!1:t+=",",t+=Ph(a);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",a=!0;for(const i of t)a?a=!1:n+=",",n+=`${i}:${Ph(e.fields[i])}`;return n+"}"}(e.mapValue):xd();var t,n}function Oh(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Lh(e){return!!e&&"integerValue"in e}function Fh(e){return!!e&&"arrayValue"in e}function Bh(e){return!!e&&"nullValue"in e}function Uh(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function $h(e){return!!e&&"mapValue"in e}function jh(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return uh(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=jh(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=jh(e.arrayValue.values[n]);return t}return Object.assign({},e)}class zh{constructor(e){this.value=e}static empty(){return new zh({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!$h(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=jh(t)}setAll(e){let t=Xd.emptyPath(),n={},a=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,a),n={},a=[],t=i.popLast()}e?n[i.lastSegment()]=jh(e):a.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,a)}delete(e){const t=this.field(e.popLast());$h(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nh(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=t.mapValue.fields[e.get(n)];$h(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,n){uh(t,(t,n)=>e[t]=n);for(const a of n)delete e[a]}clone(){return new zh(jh(this.value))}}function qh(e){const t=[];return uh(e.fields,(e,n)=>{const a=new Xd([e]);if($h(n)){const e=qh(n.mapValue).fields;if(0===e.length)t.push(a);else for(const n of e)t.push(a.child(n))}else t.push(a)}),new mh(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Hh{constructor(e,t,n,a,i,r,s){this.key=e,this.documentType=t,this.version=n,this.readTime=a,this.createTime=i,this.data=r,this.documentState=s}static newInvalidDocument(e){return new Hh(e,0,Gd.min(),Gd.min(),Gd.min(),zh.empty(),0)}static newFoundDocument(e,t,n,a){return new Hh(e,1,t,Gd.min(),n,a,0)}static newNoDocument(e,t){return new Hh(e,2,t,Gd.min(),Gd.min(),zh.empty(),0)}static newUnknownDocument(e,t){return new Hh(e,3,t,Gd.min(),Gd.min(),zh.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Gd.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zh.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zh.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Gd.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Hh&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Hh(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e,t){this.position=e,this.inclusive=t}}function Kh(e,t,n){let a=0;for(let i=0;i<e.position.length;i++){const r=t[i],s=e.position[i];if(a=r.field.isKeyField()?Yd.comparator(Yd.fromName(s.referenceValue),n.key):Dh(s,n.data.field(r.field)),"desc"===r.dir&&(a*=-1),0!==a)break}return a}function Wh(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Nh(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,t="asc"){this.field=e,this.dir=t}}function Xh(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{}class Jh extends Yh{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new rp(e,t,n):"array-contains"===t?new up(e,n):"in"===t?new cp(e,n):"not-in"===t?new dp(e,n):"array-contains-any"===t?new hp(e,n):new Jh(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new sp(e,n):new op(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Dh(t,this.value)):null!==t&&Ah(this.value)===Ah(t)&&this.matchesComparison(Dh(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return xd()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Zh extends Yh{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Zh(e,t)}matches(e){return ep(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(e=>e.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function ep(e){return"and"===e.op}function tp(e){return function(e){for(const t of e.filters)if(t instanceof Zh)return!1;return!0}(e)&&ep(e)}function np(e){if(e instanceof Jh)return e.field.canonicalString()+e.op.toString()+Rh(e.value);if(tp(e))return e.filters.map(e=>np(e)).join(",");{const t=e.filters.map(e=>np(e)).join(",");return`${e.op}(${t})`}}function ap(e,t){return e instanceof Jh?(n=e,(a=t)instanceof Jh&&n.op===a.op&&n.field.isEqual(a.field)&&Nh(n.value,a.value)):e instanceof Zh?function(e,t){return t instanceof Zh&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,a)=>e&&ap(n,t.filters[a]),!0)}(e,t):void xd();var n,a}function ip(e){return e instanceof Jh?`${(t=e).field.canonicalString()} ${t.op} ${Rh(t.value)}`:e instanceof Zh?function(e){return e.op.toString()+" {"+e.getFilters().map(ip).join(" ,")+"}"}(e):"Filter";var t}class rp extends Jh{constructor(e,t,n){super(e,t,n),this.key=Yd.fromName(n.referenceValue)}matches(e){const t=Yd.comparator(e.key,this.key);return this.matchesComparison(t)}}class sp extends Jh{constructor(e,t){super(e,"in",t),this.keys=lp("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class op extends Jh{constructor(e,t){super(e,"not-in",t),this.keys=lp("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function lp(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Yd.fromName(e.referenceValue))}class up extends Jh{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Fh(t)&&Vh(t.arrayValue,this.value)}}class cp extends Jh{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Vh(this.value.arrayValue,t)}}class dp extends Jh{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Vh(this.value.arrayValue,t)}}class hp extends Jh{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Fh(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Vh(this.value.arrayValue,e))}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,t=null,n=[],a=[],i=null,r=null,s=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=a,this.limit=i,this.startAt=r,this.endAt=s,this.dt=null}}function fp(e,t=null,n=[],a=[],i=null,r=null,s=null){return new pp(e,t,n,a,i,r,s)}function vp(e){const t=Ad(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>np(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),sh(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Rh(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Rh(e)).join(",")),t.dt=e}return t.dt}function mp(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Xh(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!ap(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Wh(e.startAt,t.startAt)&&Wh(e.endAt,t.endAt)}function gp(e){return Yd.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,t=null,n=[],a=[],i=null,r="F",s=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=a,this.limit=i,this.limitType=r,this.startAt=s,this.endAt=o,this.wt=null,this._t=null,this.startAt,this.endAt}}function bp(e){return new yp(e)}function wp(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function _p(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Ip(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function Sp(e){return null!==e.collectionGroup}function Cp(e){const t=Ad(e);if(null===t.wt){t.wt=[];const e=Ip(t),n=_p(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new Qh(e)),t.wt.push(new Qh(Xd.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new Qh(Xd.keyField(),e))}}}return t.wt}function kp(e){const t=Ad(e);if(!t._t)if("F"===t.limitType)t._t=fp(t.path,t.collectionGroup,Cp(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of Cp(t)){const t="desc"===i.dir?"asc":"desc";e.push(new Qh(i.field,t))}const n=t.endAt?new Gh(t.endAt.position,t.endAt.inclusive):null,a=t.startAt?new Gh(t.startAt.position,t.startAt.inclusive):null;t._t=fp(t.path,t.collectionGroup,e,t.filters,t.limit,n,a)}return t._t}function Ep(e,t){t.getFirstInequalityField(),Ip(e);const n=e.filters.concat([t]);return new yp(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function xp(e,t,n){return new yp(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Tp(e,t){return mp(kp(e),kp(t))&&e.limitType===t.limitType}function Ap(e){return`${vp(kp(e))}|lt:${e.limitType}`}function Np(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>ip(e)).join(", ")}]`),sh(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Rh(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Rh(e)).join(",")),`Target(${t})`}(kp(e))}; limitType=${e.limitType})`}function Vp(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Yd.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Cp(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(a=t,!((n=e).startAt&&!function(e,t,n){const a=Kh(e,t,n);return e.inclusive?a<=0:a<0}(n.startAt,Cp(n),a)||n.endAt&&!function(e,t,n){const a=Kh(e,t,n);return e.inclusive?a>=0:a>0}(n.endAt,Cp(n),a)));var n,a}function Dp(e){return(t,n)=>{let a=!1;for(const i of Cp(e)){const e=Mp(i,t,n);if(0!==e)return e;a=a||i.field.isKeyField()}return 0}}function Mp(e,t,n){const a=e.field.isKeyField()?Yd.comparator(t.key,n.key):function(e,t,n){const a=t.data.field(e),i=n.data.field(e);return null!==a&&null!==i?Dh(a,i):xd()}(e.field,t,n);switch(e.dir){case"asc":return a;case"desc":return-1*a;default:return xd()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[a,i]of n)if(this.equalsFn(a,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),a=this.inner[n];if(void 0===a)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],e))return void(a[i]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return 1===n.length?delete this.inner[t]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){uh(this.inner,(t,n)=>{for(const[a,i]of n)e(a,i)})}isEmpty(){return ch(this.inner)}size(){return this.innerSize}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp=new dh(Yd.comparator);function Op(){return Pp}const Lp=new dh(Yd.comparator);function Fp(...e){let t=Lp;for(const n of e)t=t.insert(n.key,n);return t}function Bp(e){let t=Lp;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Up(){return jp()}function $p(){return jp()}function jp(){return new Rp(e=>e.toString(),(e,t)=>e.isEqual(t))}const zp=new dh(Yd.comparator),qp=new fh(Yd.comparator);function Hp(...e){let t=qp;for(const n of e)t=t.add(n);return t}const Gp=new fh(zd);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Kp(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:oh(t)?"-0":t}}function Wp(e){return{integerValue:""+e}}function Qp(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!oh(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?Wp(t):Kp(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xp{constructor(){this._=void 0}}function Yp(e,t,n){return e instanceof ef?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Sh(t)&&(t=Ch(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof tf?nf(e,t):e instanceof af?rf(e,t):function(e,t){const n=Zp(e,t),a=of(n)+of(e.gt);return Lh(n)&&Lh(e.gt)?Wp(a):Kp(e.serializer,a)}(e,t)}function Jp(e,t,n){return e instanceof tf?nf(e,t):e instanceof af?rf(e,t):n}function Zp(e,t){return e instanceof sf?Lh(a=t)||(n=a)&&"doubleValue"in n?t:{integerValue:0}:null;var n,a}class ef extends Xp{}class tf extends Xp{constructor(e){super(),this.elements=e}}function nf(e,t){const n=lf(t);for(const a of e.elements)n.some(e=>Nh(e,a))||n.push(a);return{arrayValue:{values:n}}}class af extends Xp{constructor(e){super(),this.elements=e}}function rf(e,t){let n=lf(t);for(const a of e.elements)n=n.filter(e=>!Nh(e,a));return{arrayValue:{values:n}}}class sf extends Xp{constructor(e,t){super(),this.serializer=e,this.gt=t}}function of(e){return _h(e.integerValue||e.doubleValue)}function lf(e){return Fh(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t){this.field=e,this.transform=t}}class cf{constructor(e,t){this.version=e,this.transformResults=t}}class df{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new df}static exists(e){return new df(void 0,e)}static updateTime(e){return new df(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hf(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class pf{}function ff(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Cf(e.key,df.none()):new bf(e.key,e.data,df.none());{const n=e.data,a=zh.empty();let i=new fh(Xd.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?a.delete(e):a.set(e,t),i=i.add(e)}return new wf(e.key,a,new mh(i.toArray()),df.none())}}function vf(e,t,n){var a;e instanceof bf?function(e,t,n){const a=e.value.clone(),i=If(e.fieldTransforms,t,n.transformResults);a.setAll(i),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}(e,t,n):e instanceof wf?function(e,t,n){if(!hf(e.precondition,t))return void t.convertToUnknownDocument(n.version);const a=If(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(_f(e)),i.setAll(a),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):(a=n,t.convertToNoDocument(a.version).setHasCommittedMutations())}function mf(e,t,n,a){return e instanceof bf?function(e,t,n,a){if(!hf(e.precondition,t))return n;const i=e.value.clone(),r=Sf(e.fieldTransforms,a,t);return i.setAll(r),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,a):e instanceof wf?function(e,t,n,a){if(!hf(e.precondition,t))return n;const i=Sf(e.fieldTransforms,a,t),r=t.data;return r.setAll(_f(e)),r.setAll(i),t.convertToFoundDocument(t.version,r).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,a):(i=t,r=n,hf(e.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):r);var i,r}function gf(e,t){let n=null;for(const a of e.fieldTransforms){const e=t.data.field(a.field),i=Zp(a.transform,e||null);null!=i&&(null===n&&(n=zh.empty()),n.set(a.field,i))}return n||null}function yf(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,a=t.fieldTransforms,!!(void 0===n&&void 0===a||n&&a&&qd(n,a,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,a=t.transform,n instanceof tf&&a instanceof tf||n instanceof af&&a instanceof af?qd(n.elements,a.elements,Nh):n instanceof sf&&a instanceof sf?Nh(n.gt,a.gt):n instanceof ef&&a instanceof ef);var n,a}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,a}class bf extends pf{constructor(e,t,n,a=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class wf extends pf{constructor(e,t,n,a,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function _f(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const a=e.data.field(n);t.set(n,a)}}),t}function If(e,t,n){const a=new Map;Td(e.length===n.length);for(let i=0;i<n.length;i++){const r=e[i],s=r.transform,o=t.data.field(r.field);a.set(r.field,Jp(s,o,n[i]))}return a}function Sf(e,t,n){const a=new Map;for(const i of e){const e=i.transform,r=n.data.field(i.field);a.set(i.field,Yp(e,r,t))}return a}class Cf extends pf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kf extends pf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,t,n,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const t=this.mutations[a];t.key.isEqual(e.key)&&vf(t,e,n[a])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=mf(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=mf(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=$p();return this.mutations.forEach(a=>{const i=e.get(a.key),r=i.overlayedDocument;let s=this.applyToLocalView(r,i.mutatedFields);s=t.has(a.key)?null:s;const o=ff(r,s);null!==o&&n.set(a.key,o),r.isValidDocument()||r.convertToNoDocument(Gd.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Hp())}isEqual(e){return this.batchId===e.batchId&&qd(this.mutations,e.mutations,(e,t)=>yf(e,t))&&qd(this.baseMutations,e.baseMutations,(e,t)=>yf(e,t))}}class xf{constructor(e,t,n,a){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=a}static from(e,t,n){Td(e.mutations.length===n.length);let a=zp;const i=e.mutations;for(let r=0;r<i.length;r++)a=a.insert(i[r].key,n[r].version);return new xf(e,t,n,a)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nf,Vf;function Df(e){if(void 0===e)return Cd("GRPC error has no .code"),Nd.UNKNOWN;switch(e){case Nf.OK:return Nd.OK;case Nf.CANCELLED:return Nd.CANCELLED;case Nf.UNKNOWN:return Nd.UNKNOWN;case Nf.DEADLINE_EXCEEDED:return Nd.DEADLINE_EXCEEDED;case Nf.RESOURCE_EXHAUSTED:return Nd.RESOURCE_EXHAUSTED;case Nf.INTERNAL:return Nd.INTERNAL;case Nf.UNAVAILABLE:return Nd.UNAVAILABLE;case Nf.UNAUTHENTICATED:return Nd.UNAUTHENTICATED;case Nf.INVALID_ARGUMENT:return Nd.INVALID_ARGUMENT;case Nf.NOT_FOUND:return Nd.NOT_FOUND;case Nf.ALREADY_EXISTS:return Nd.ALREADY_EXISTS;case Nf.PERMISSION_DENIED:return Nd.PERMISSION_DENIED;case Nf.FAILED_PRECONDITION:return Nd.FAILED_PRECONDITION;case Nf.ABORTED:return Nd.ABORTED;case Nf.OUT_OF_RANGE:return Nd.OUT_OF_RANGE;case Nf.UNIMPLEMENTED:return Nd.UNIMPLEMENTED;case Nf.DATA_LOSS:return Nd.DATA_LOSS;default:return xd()}}(Vf=Nf||(Nf={}))[Vf.OK=0]="OK",Vf[Vf.CANCELLED=1]="CANCELLED",Vf[Vf.UNKNOWN=2]="UNKNOWN",Vf[Vf.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vf[Vf.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vf[Vf.NOT_FOUND=5]="NOT_FOUND",Vf[Vf.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vf[Vf.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vf[Vf.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vf[Vf.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vf[Vf.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vf[Vf.ABORTED=10]="ABORTED",Vf[Vf.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vf[Vf.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vf[Vf.INTERNAL=13]="INTERNAL",Vf[Vf.UNAVAILABLE=14]="UNAVAILABLE",Vf[Vf.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Mf{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Rf}static getOrCreateInstance(){return null===Rf&&(Rf=new Mf),Rf}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let Rf=null;
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Pf=new gd([4294967295,4294967295],0);function Of(e){const t=(new TextEncoder).encode(e),n=new md;return n.update(t),new Uint8Array(n.digest())}function Lf(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),a=t.getUint32(4,!0),i=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new gd([n,a],0),new gd([i,r],0)]}class Ff{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Bf(`Invalid padding: ${t}`);if(n<0)throw new Bf(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Bf(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Bf(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=gd.fromNumber(this.It)}Et(e,t,n){let a=e.add(t.multiply(gd.fromNumber(n)));return 1===a.compare(Pf)&&(a=new gd([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Tt).toNumber()}At(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=Of(e),[n,a]=Lf(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,a,i);if(!this.At(e))return!1}return!0}static create(e,t,n){const a=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),r=new Ff(i,a,t);return n.forEach(e=>r.insert(e)),r}insert(e){if(0===this.It)return;const t=Of(e),[n,a]=Lf(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,a,i);this.Rt(e)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Bf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t,n,a,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const a=new Map;return a.set(e,$f.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Uf(Gd.min(),a,new dh(zd),Op(),Hp())}}class $f{constructor(e,t,n,a,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new $f(n,t,Hp(),Hp(),Hp())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,t,n,a){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=a}}class zf{constructor(e,t){this.targetId=e,this.Vt=t}}class qf{constructor(e,t,n=yh.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=a}}class Hf{constructor(){this.St=0,this.Dt=Wf(),this.Ct=yh.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Hp(),t=Hp(),n=Hp();return this.Dt.forEach((a,i)=>{switch(i){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:n=n.add(a);break;default:xd()}}),new $f(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=Wf()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Gf{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Op(),this.zt=Kf(),this.Wt=new dh(zd)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:xd()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((e,n)=>{this.te(n)&&t(n)})}ne(e){var t;const n=e.targetId,a=e.Vt.count,i=this.se(n);if(i){const r=i.target;if(gp(r))if(0===a){const e=new Yd(r.path);this.Yt(n,e,Hh.newNoDocument(e,Gd.min()))}else Td(1===a);else{const i=this.ie(n);if(i!==a){const a=this.re(e,i);if(0!==a){this.ee(n);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=Mf.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var a,i,r,s,o,l;const u={localCacheCount:t,existenceFilterCount:n.count},c=n.unchangedNames;return c&&(u.bloomFilter={applied:0===e,hashCount:null!==(a=null==c?void 0:c.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(s=null===(r=null===(i=null==c?void 0:c.bits)||void 0===i?void 0:i.bitmap)||void 0===r?void 0:r.length)&&void 0!==s?s:0,padding:null!==(l=null===(o=null==c?void 0:c.bits)||void 0===o?void 0:o.padding)&&void 0!==l?l:0}),u}(a,i,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:a}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=n;let o,l;try{o=Ih(i).toUint8Array()}catch(u){if(u instanceof gh)return kd("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw u}try{l=new Ff(o,r,s)}catch(u){return kd(u instanceof Bf?"BloomFilter error: ":"Applying bloom filter failed: ",u),1}return 0===l.It?1:a!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let a=0;return n.forEach(n=>{const i=this.Gt.ue(),r=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;t.vt(r)||(this.Yt(e,n,null),a++)}),a}ce(e){const t=new Map;this.Qt.forEach((n,a)=>{const i=this.se(a);if(i){if(n.current&&gp(i.target)){const t=new Yd(i.target.path);null!==this.jt.get(t)||this.ae(a,t)||this.Yt(a,t,Hh.newNoDocument(t,e))}n.Mt&&(t.set(a,n.Ot()),n.Ft())}});let n=Hp();this.zt.forEach((e,t)=>{let a=!0;t.forEachWhile(e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(a=!1,!1)}),a&&(n=n.add(e))}),this.jt.forEach((t,n)=>n.setReadTime(e));const a=new Uf(e,t,this.Wt,this.jt,n);return this.jt=Op(),this.zt=Kf(),this.Wt=new dh(zd),a}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const a=this.Zt(e);this.ae(e,t)?a.Bt(t,1):a.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new Hf,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new fh(zd),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Sd("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Hf),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function Kf(){return new dh(Yd.comparator)}function Wf(){return new dh(Yd.comparator)}const Qf=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Xf=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Yf=(()=>({and:"AND",or:"OR"}))();class Jf{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Zf(e,t){return e.useProto3Json||sh(t)?t:{value:t}}function ev(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function tv(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function nv(e,t){return ev(e,t.toTimestamp())}function av(e){return Td(!!e),Gd.fromTimestamp(function(e){const t=wh(e);return new Hd(t.seconds,t.nanos)}(e))}function iv(e,t){return(n=e,new Wd(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function rv(e){const t=Wd.fromString(e);return Td(Sv(t)),t}function sv(e,t){return iv(e.databaseId,t.path)}function ov(e,t){const n=rv(t);if(n.get(1)!==e.databaseId.projectId)throw new Vd(Nd.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Vd(Nd.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Yd(cv(n))}function lv(e,t){return iv(e.databaseId,t)}function uv(e){return new Wd(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function cv(e){return Td(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function dv(e,t,n){return{name:sv(e,t),fields:n.value.mapValue.fields}}function hv(e,t){return{documents:[lv(e,t.path)]}}function pv(e,t){const n={structuredQuery:{}},a=t.path;null!==t.collectionGroup?(n.parent=lv(e,a),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=lv(e,a.popLast()),n.structuredQuery.from=[{collectionId:a.lastSegment()}]);const i=function(e){if(0!==e.length)return _v(Zh.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const r=function(e){if(0!==e.length)return e.map(e=>{return{field:bv((t=e).field),direction:mv(t.dir)};var t})}(t.orderBy);r&&(n.structuredQuery.orderBy=r);const s=Zf(e,t.limit);var o,l;return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt={before:!(l=t.endAt).inclusive,values:l.position}),n}function fv(e){let t=function(e){const t=rv(e);return 4===t.length?Wd.emptyPath():cv(t)}(e.parent);const n=e.structuredQuery,a=n.from?n.from.length:0;let i=null;if(a>0){Td(1===a);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let r=[];n.where&&(r=function(e){const t=vv(e);return t instanceof Zh&&tp(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=n.orderBy.map(e=>{return new Qh(wv((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,sh(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Gh(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Gh(n,t)}(n.endAt)),function(e,t,n,a,i,r,s,o){return new yp(e,t,n,a,i,r,s,o)}(t,i,s,r,o,"F",l,u)}function vv(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=wv(e.unaryFilter.field);return Jh.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=wv(e.unaryFilter.field);return Jh.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=wv(e.unaryFilter.field);return Jh.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=wv(e.unaryFilter.field);return Jh.create(i,"!=",{nullValue:"NULL_VALUE"});default:return xd()}}(e):void 0!==e.fieldFilter?(t=e,Jh.create(wv(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return xd()}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return Zh.create(e.compositeFilter.filters.map(e=>vv(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return xd()}}(e.compositeFilter.op))}(e):xd();var t}function mv(e){return Qf[e]}function gv(e){return Xf[e]}function yv(e){return Yf[e]}function bv(e){return{fieldPath:e.canonicalString()}}function wv(e){return Xd.fromServerFormat(e.fieldPath)}function _v(e){return e instanceof Jh?function(e){if("=="===e.op){if(Uh(e.value))return{unaryFilter:{field:bv(e.field),op:"IS_NAN"}};if(Bh(e.value))return{unaryFilter:{field:bv(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Uh(e.value))return{unaryFilter:{field:bv(e.field),op:"IS_NOT_NAN"}};if(Bh(e.value))return{unaryFilter:{field:bv(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bv(e.field),op:gv(e.op),value:e.value}}}(e):e instanceof Zh?function(e){const t=e.getFilters().map(e=>_v(e));return 1===t.length?t[0]:{compositeFilter:{op:yv(e.op),filters:t}}}(e):xd()}function Iv(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Sv(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(e,t,n,a,i=Gd.min(),r=Gd.min(),s=yh.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=r,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Cv(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Cv(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cv(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cv(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e){this.fe=e}}function Ev(e){const t=fv({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?xp(t,t.limit,"L"):t}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(){this.rn=new Tv}addToCollectionParentIndex(e,t){return this.rn.add(t),ah.resolve()}getCollectionParents(e,t){return ah.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return ah.resolve()}deleteFieldIndex(e,t){return ah.resolve()}getDocumentsMatchingTarget(e,t){return ah.resolve(null)}getIndexType(e,t){return ah.resolve(0)}getFieldIndexes(e,t){return ah.resolve([])}getNextCollectionGroupToUpdate(e){return ah.resolve(null)}getMinOffset(e,t){return ah.resolve(Zd.min())}getMinOffsetFromCollectionGroup(e,t){return ah.resolve(Zd.min())}updateCollectionGroup(e,t,n){return ah.resolve()}updateIndexEntries(e,t){return ah.resolve()}}class Tv{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t]||new fh(Wd.comparator),i=!a.has(n);return this.index[t]=a.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),a=this.index[t];return a&&a.has(n)}getEntries(e){return(this.index[e]||new fh(Wd.comparator)).toArray()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Av(0)}static Mn(){return new Av(-1)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(){this.changes=new Rp(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Hh.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ah.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,t,n,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(a=>(n=a,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&mf(n.mutation,e,mh.empty(),Hd.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Hp()).next(()=>t))}getLocalViewOfDocuments(e,t,n=Hp()){const a=Up();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,n).next(e=>{let t=Fp();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Up();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Hp()))}populateOverlays(e,t,n){const a=[];return n.forEach(e=>{t.has(e)||a.push(e)}),this.documentOverlayCache.getOverlays(e,a).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,a){let i=Op();const r=jp(),s=jp();return t.forEach((e,t)=>{const s=n.get(t.key);a.has(t.key)&&(void 0===s||s.mutation instanceof wf)?i=i.insert(t.key,t):void 0!==s?(r.set(t.key,s.mutation.getFieldMask()),mf(s.mutation,t,s.mutation.getFieldMask(),Hd.now())):r.set(t.key,mh.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>r.set(e,t)),t.forEach((e,t)=>{var n;return s.set(e,new Vv(t,null!==(n=r.get(e))&&void 0!==n?n:null))}),s))}recalculateAndSaveOverlays(e,t){const n=jp();let a=new dh((e,t)=>e-t),i=Hp();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const r=t.get(e);if(null===r)return;let s=n.get(e)||mh.empty();s=i.applyToLocalView(r,s),n.set(e,s);const o=(a.get(i.batchId)||Hp()).add(e);a=a.insert(i.batchId,o)})}).next(()=>{const r=[],s=a.getReverseIterator();for(;s.hasNext();){const a=s.getNext(),o=a.key,l=a.value,u=$p();l.forEach(e=>{if(!i.has(e)){const a=ff(t.get(e),n.get(e));null!==a&&u.set(e,a),i=i.add(e)}}),r.push(this.documentOverlayCache.saveOverlays(e,o,u))}return ah.waitFor(r)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return a=t,Yd.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Sp(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var a}getNextDocuments(e,t,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,a).next(i=>{const r=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,a-i.size):ah.resolve(Up());let s=-1,o=i;return r.next(t=>ah.forEach(t,(t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?ah.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,Hp())).next(e=>({batchId:s,changes:Bp(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Yd(t)).next(e=>{let t=Fp();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const a=t.collectionGroup;let i=Fp();return this.indexManager.getCollectionParents(e,a).next(r=>ah.forEach(r,r=>{const s=(o=t,l=r.child(a),new yp(l,null,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt));var o,l;return this.getDocumentsMatchingCollectionQuery(e,s,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(a=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a))).next(e=>{a.forEach((t,n)=>{const a=n.getKey();null===e.get(a)&&(e=e.insert(a,Hh.newInvalidDocument(a)))});let n=Fp();return e.forEach((e,i)=>{const r=a.get(e);void 0!==r&&mf(r.mutation,i,mh.empty(),Hd.now()),Vp(t,i)&&(n=n.insert(e,i))}),n})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return ah.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:av(n.createTime)}),ah.resolve()}getNamedQuery(e,t){return ah.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:Ev(n.bundledQuery),readTime:av(n.readTime)}),ah.resolve();var n}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.overlays=new dh(Yd.comparator),this.ls=new Map}getOverlay(e,t){return ah.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Up();return ah.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,a)=>{this.we(e,t,a)}),ah.resolve()}removeOverlaysForBatchId(e,t,n){const a=this.ls.get(n);return void 0!==a&&(a.forEach(e=>this.overlays=this.overlays.remove(e)),this.ls.delete(n)),ah.resolve()}getOverlaysForCollection(e,t,n){const a=Up(),i=t.length+1,r=new Yd(t.child("")),s=this.overlays.getIteratorFrom(r);for(;s.hasNext();){const e=s.getNext().value,r=e.getKey();if(!t.isPrefixOf(r.path))break;r.path.length===i&&e.largestBatchId>n&&a.set(e.getKey(),e)}return ah.resolve(a)}getOverlaysForCollectionGroup(e,t,n,a){let i=new dh((e,t)=>e-t);const r=this.overlays.getIterator();for(;r.hasNext();){const e=r.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Up(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=Up(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>s.set(e,t)),!(s.size()>=a)););return ah.resolve(s)}we(e,t,n){const a=this.overlays.get(n.key);if(null!==a){const e=this.ls.get(a.largestBatchId).delete(n.key);this.ls.set(a.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Tf(t,n));let i=this.ls.get(t);void 0===i&&(i=Hp(),this.ls.set(t,i)),this.ls.set(t,i.add(n.key))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(){this.fs=new fh(Ov.ds),this.ws=new fh(Ov._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new Ov(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.ys(new Ov(e,t))}ps(e,t){e.forEach(e=>this.removeReference(e,t))}Is(e){const t=new Yd(new Wd([])),n=new Ov(t,e),a=new Ov(t,e+1),i=[];return this.ws.forEachInRange([n,a],e=>{this.ys(e),i.push(e.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Yd(new Wd([])),n=new Ov(t,e),a=new Ov(t,e+1);let i=Hp();return this.ws.forEachInRange([n,a],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new Ov(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Ov{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Yd.comparator(e.key,t.key)||zd(e.As,t.As)}static _s(e,t){return zd(e.As,t.As)||Yd.comparator(e.key,t.key)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new fh(Ov.ds)}checkEmpty(e){return ah.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,a){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const r=new Ef(i,t,n,a);this.mutationQueue.push(r);for(const s of a)this.Rs=this.Rs.add(new Ov(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return ah.resolve(r)}lookupMutationBatch(e,t){return ah.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,a=this.bs(n),i=a<0?0:a;return ah.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ah.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return ah.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ov(t,0),a=new Ov(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([n,a],e=>{const t=this.Ps(e.As);i.push(t)}),ah.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new fh(zd);return t.forEach(e=>{const t=new Ov(e,0),a=new Ov(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,a],e=>{n=n.add(e.As)})}),ah.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,a=n.length+1;let i=n;Yd.isDocumentKey(i)||(i=i.child(""));const r=new Ov(new Yd(i),0);let s=new fh(zd);return this.Rs.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===a&&(s=s.add(e.As)),!0)},r),ah.resolve(this.Vs(s))}Vs(e){const t=[];return e.forEach(e=>{const n=this.Ps(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Td(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return ah.forEach(t.mutations,a=>{const i=new Ov(a.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new Ov(t,0),a=this.Rs.firstAfterOrEqual(n);return ah.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ah.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fv{constructor(e){this.Ds=e,this.docs=new dh(Yd.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,a=this.docs.get(n),i=a?a.size:0,r=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:r}),this.size+=r-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ah.resolve(n?n.document.mutableCopy():Hh.newInvalidDocument(t))}getEntries(e,t){let n=Op();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Hh.newInvalidDocument(e))}),ah.resolve(n)}getDocumentsMatchingQuery(e,t,n,a){let i=Op();const r=t.path,s=new Yd(r.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!r.isPrefixOf(e.path))break;e.path.length>r.length+1||eh(Jd(s),n)<=0||(a.has(s.key)||Vp(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return ah.resolve(i)}getAllFromCollectionGroup(e,t,n,a){xd()}Cs(e,t){return ah.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Bv(this)}getSize(e){return ah.resolve(this.size)}}class Bv extends Nv{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,a)=>{a.isValidDocument()?t.push(this.os.addEntry(e,a)):this.os.removeEntry(n)}),ah.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e){this.persistence=e,this.xs=new Rp(e=>vp(e),mp),this.lastRemoteSnapshotVersion=Gd.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Pv,this.targetCount=0,this.Ms=Av.kn()}forEachTarget(e,t){return this.xs.forEach((e,n)=>t(n)),ah.resolve()}getLastRemoteSnapshotVersion(e){return ah.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ah.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),ah.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),ah.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new Av(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,ah.resolve()}updateTargetData(e,t){return this.Fn(t),ah.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,ah.resolve()}removeTargets(e,t,n){let a=0;const i=[];return this.xs.forEach((r,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.xs.delete(r),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),a++)}),ah.waitFor(i).next(()=>a)}getTargetCount(e){return ah.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return ah.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),ah.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const a=this.persistence.referenceDelegate,i=[];return a&&t.forEach(t=>{i.push(a.markPotentiallyOrphaned(e,t))}),ah.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),ah.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return ah.resolve(n)}containsKey(e,t){return ah.resolve(this.ks.containsKey(t))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e,t){this.$s={},this.overlays={},this.Os=new rh(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Uv(this),this.indexManager=new xv,this.remoteDocumentCache=new Fv(e=>this.referenceDelegate.Ls(e)),this.serializer=new kv(t),this.qs=new Mv(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Rv,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new Lv(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Sd("MemoryPersistence","Starting transaction:",e);const a=new jv(this.Os.next());return this.referenceDelegate.Us(),n(a).next(e=>this.referenceDelegate.Ks(a).next(()=>e)).toPromise().then(e=>(a.raiseOnCommittedEvent(),e))}Gs(e,t){return ah.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class jv extends th{constructor(e){super(),this.currentSequenceNumber=e}}class zv{constructor(e){this.persistence=e,this.Qs=new Pv,this.js=null}static zs(e){return new zv(e)}get Ws(){if(this.js)return this.js;throw xd()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),ah.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),ah.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),ah.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(e=>this.Ws.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Ws.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ah.forEach(this.Ws,n=>{const a=Yd.fromPath(n);return this.Hs(e,a).next(e=>{e||t.removeEntry(a,Gd.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return ah.or([()=>ah.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(e,t,n,a){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=a}static Li(e,t){let n=Hp(),a=Hp();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new qv(e,t.fromCache,n,a)}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hv{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,a){return this.Ki(e,t).next(i=>i||this.Gi(e,t,a,n)).next(n=>n||this.Qi(e,t))}Ki(e,t){if(wp(t))return ah.resolve(null);let n=kp(t);return this.indexManager.getIndexType(e,n).next(a=>0===a?null:(null!==t.limit&&1===a&&(t=xp(t,null,"F"),n=kp(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const i=Hp(...a);return this.Ui.getDocuments(e,i).next(a=>this.indexManager.getMinOffset(e,n).next(n=>{const r=this.ji(t,a);return this.zi(t,r,i,n.readTime)?this.Ki(e,xp(t,null,"F")):this.Wi(e,r,t,n)}))})))}Gi(e,t,n,a){return wp(t)||a.isEqual(Gd.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(i=>{const r=this.ji(t,i);return this.zi(t,r,n,a)?this.Qi(e,t):(Id()<=jn.DEBUG&&Sd("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Np(t)),this.Wi(e,r,t,function(e,t){const n=e.toTimestamp().seconds,a=e.toTimestamp().nanoseconds+1,i=Gd.fromTimestamp(1e9===a?new Hd(n+1,0):new Hd(n,a));return new Zd(i,Yd.empty(),t)}(a,-1)))})}ji(e,t){let n=new fh(Dp(e));return t.forEach((t,a)=>{Vp(e,a)&&(n=n.add(a))}),n}zi(e,t,n,a){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Qi(e,t){return Id()<=jn.DEBUG&&Sd("QueryEngine","Using full collection scan to execute query:",Np(t)),this.Ui.getDocumentsMatchingQuery(e,t,Zd.min())}Wi(e,t,n,a){return this.Ui.getDocumentsMatchingQuery(e,n,a).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e,t,n,a){this.persistence=e,this.Hi=t,this.serializer=a,this.Ji=new dh(zd),this.Yi=new Rp(e=>vp(e),mp),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Dv(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}async function Kv(e,t){const n=Ad(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let a;return n.mutationQueue.getAllMutationBatches(e).next(i=>(a=i,n.tr(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],r=[];let s=Hp();for(const e of a){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next(e=>({er:e,removedBatchIds:i,addedBatchIds:r}))})})}function Wv(e){const t=Ad(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Bs.getLastRemoteSnapshotVersion(e))}function Qv(e,t){const n=Ad(e),a=t.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const r=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const s=[];t.targetChanges.forEach((r,o)=>{const l=i.get(o);if(!l)return;s.push(n.Bs.removeMatchingKeys(e,r.removedDocuments,o).next(()=>n.Bs.addMatchingKeys(e,r.addedDocuments,o)));let u=l.withSequenceNumber(e.currentSequenceNumber);var c,d,h;null!==t.targetMismatches.get(o)?u=u.withResumeToken(yh.EMPTY_BYTE_STRING,Gd.min()).withLastLimboFreeSnapshotVersion(Gd.min()):r.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(r.resumeToken,a)),i=i.insert(o,u),d=u,h=r,(0===(c=l).resumeToken.approximateByteSize()||d.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&s.push(n.Bs.updateTargetData(e,u))});let o=Op(),l=Hp();if(t.documentUpdates.forEach(a=>{t.resolvedLimboDocuments.has(a)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,a))}),s.push(function(e,t,n){let a=Hp(),i=Hp();return n.forEach(e=>a=a.add(e)),t.getEntries(e,a).next(e=>{let a=Op();return n.forEach((n,r)=>{const s=e.get(n);r.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),r.isNoDocument()&&r.version.isEqual(Gd.min())?(t.removeEntry(n,r.readTime),a=a.insert(n,r)):!s.isValidDocument()||r.version.compareTo(s.version)>0||0===r.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(r),a=a.insert(n,r)):Sd("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",r.version)}),{nr:a,sr:i}})}(e,r,t.documentUpdates).next(e=>{o=e.nr,l=e.sr})),!a.isEqual(Gd.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next(t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,a));s.push(t)}return ah.waitFor(s).next(()=>r.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ji=i,e))}function Xv(e,t){const n=Ad(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}async function Yv(e,t,n){const a=Ad(e),i=a.Ji.get(t),r=n?"readwrite":"readwrite-primary";try{n||await a.persistence.runTransaction("Release target",r,e=>a.persistence.referenceDelegate.removeTarget(e,i))}catch(s){if(!ih(s))throw s;Sd("LocalStore",`Failed to update sequence numbers for target ${t}: ${s}`)}a.Ji=a.Ji.remove(t),a.Yi.delete(i.target)}function Jv(e,t,n){const a=Ad(e);let i=Gd.min(),r=Hp();return a.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const a=Ad(e),i=a.Yi.get(n);return void 0!==i?ah.resolve(a.Ji.get(i)):a.Bs.getTargetData(t,n)}(a,e,kp(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,a.Bs.getMatchingKeysForTargetId(e,t.targetId).next(e=>{r=e})}).next(()=>a.Hi.getDocumentsMatchingQuery(e,t,n?i:Gd.min(),n?r:Hp())).next(e=>(function(e,t,n){let a=e.Xi.get(t)||Gd.min();n.forEach((e,t)=>{t.readTime.compareTo(a)>0&&(a=t.readTime)}),e.Xi.set(t,a)}(a,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,ir:r})))}class Zv{constructor(){this.activeTargetIds=Gp}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class em{constructor(){this.Hr=new Zv,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Zv,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{Yr(e){}shutdown(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Sd("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Sd("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let am=null;function im(){return null===am?am=268435456+Math.round(2147483648*Math.random()):am++,"0x"+am.toString(16)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const rm={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="WebChannelConnection";class lm extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,a,i){const r=im(),s=this.To(e,t);Sd("RestConnection",`Sending RPC '${e}' ${r}:`,s,n);const o={};return this.Eo(o,a,i),this.Ao(e,s,o,n).then(t=>(Sd("RestConnection",`Received RPC '${e}' ${r}: `,t),t),t=>{throw kd("RestConnection",`RPC '${e}' ${r} failed with error: `,t,"url: ",s,"request:",n),t})}vo(e,t,n,a,i,r){return this.Io(e,t,n,a,i)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+wd,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}To(e,t){const n=rm[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,a){const i=im();return new Promise((r,s)=>{const o=new vd;o.setWithCredentials(!0),o.listenOnce(ud.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case ld.NO_ERROR:const t=o.getResponseJson();Sd(om,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),r(t);break;case ld.TIMEOUT:Sd(om,`RPC '${e}' ${i} timed out`),s(new Vd(Nd.DEADLINE_EXCEEDED,"Request time out"));break;case ld.HTTP_ERROR:const n=o.getStatus();if(Sd(om,`RPC '${e}' ${i} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Nd).indexOf(t)>=0?t:Nd.UNKNOWN}(t.status);s(new Vd(e,t.message))}else s(new Vd(Nd.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Vd(Nd.UNAVAILABLE,"Connection failed."));break;default:xd()}}finally{Sd(om,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(a);Sd(om,`RPC '${e}' ${i} sending request:`,a),o.send(t,"POST",l,n,15)})}Ro(e,t,n){const a=im(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=new Fc,s=Ol(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.xmlHttpFactory=new pd({})),this.Eo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const u=i.join("");Sd(om,`Creating RPC '${e}' stream ${a}: ${u}`,o);const c=r.createWebChannel(u,o);let d=!1,h=!1;const p=new sm({ro:t=>{h?Sd(om,`Not sending because RPC '${e}' stream ${a} is closed:`,t):(d||(Sd(om,`Opening RPC '${e}' stream ${a} transport.`),c.open(),d=!0),Sd(om,`RPC '${e}' stream ${a} sending:`,t),c.send(t))},oo:()=>c.close()}),f=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return f(c,fd.EventType.OPEN,()=>{h||Sd(om,`RPC '${e}' stream ${a} transport opened.`)}),f(c,fd.EventType.CLOSE,()=>{h||(h=!0,Sd(om,`RPC '${e}' stream ${a} transport closed`),p.wo())}),f(c,fd.EventType.ERROR,t=>{h||(h=!0,kd(om,`RPC '${e}' stream ${a} transport errored:`,t),p.wo(new Vd(Nd.UNAVAILABLE,"The operation could not be completed")))}),f(c,fd.EventType.MESSAGE,t=>{var n;if(!h){const i=t.data[0];Td(!!i);const r=i,s=r.error||(null===(n=r[0])||void 0===n?void 0:n.error);if(s){Sd(om,`RPC '${e}' stream ${a} received error:`,s);const t=s.status;let n=function(e){const t=Nf[e];if(void 0!==t)return Df(t)}(t),i=s.message;void 0===n&&(n=Nd.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),h=!0,p.wo(new Vd(n,i)),c.close()}else Sd(om,`RPC '${e}' stream ${a} received:`,i),p._o(i)}}),f(s,cd.STAT_EVENT,t=>{t.stat===dd?Sd(om,`RPC '${e}' stream ${a} detected buffering proxy`):t.stat===hd&&Sd(om,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{p.fo()},0),p}}function um(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(e){return new Jf(e,!0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e,t,n=1e3,a=1.5,i=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=a,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),a=Math.max(0,t-n);a>0&&Sd("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,a,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,t,n,a,i,r,s,o){this.ii=e,this.$o=n,this.Oo=a,this.connection=i,this.authCredentialsProvider=r,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new dm(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===Nd.RESOURCE_EXHAUSTED?(Cd(t.toString()),Cd("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===Nd.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.Fo===t&&this.Zo(e,n)},t=>{e(()=>{const e=new Vd(Nd.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(e=>{n(()=>this.tu(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return Sd("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Sd("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class pm extends hm{constructor(e,t,n,a,i,r){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,a,r),this.serializer=i}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i="NO_CHANGE"===(a=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===a?1:"REMOVE"===a?2:"CURRENT"===a?3:"RESET"===a?4:xd(),r=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Td(void 0===t||"string"==typeof t),yh.fromBase64String(t||"")):(Td(void 0===t||t instanceof Uint8Array),yh.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(e){const t=void 0===e.code?Nd.UNKNOWN:Df(e.code);return new Vd(t,e.message||"")}(o);n=new qf(i,r,s,l||null)}else if("documentChange"in t){t.documentChange;const a=t.documentChange;a.document,a.document.name,a.document.updateTime;const i=ov(e,a.document.name),r=av(a.document.updateTime),s=a.document.createTime?av(a.document.createTime):Gd.min(),o=new zh({mapValue:{fields:a.document.fields}}),l=Hh.newFoundDocument(i,r,s,o),u=a.targetIds||[],c=a.removedTargetIds||[];n=new jf(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;const a=t.documentDelete;a.document;const i=ov(e,a.document),r=a.readTime?av(a.readTime):Gd.min(),s=Hh.newNoDocument(i,r),o=a.removedTargetIds||[];n=new jf([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const a=t.documentRemove;a.document;const i=ov(e,a.document),r=a.removedTargetIds||[];n=new jf([],r,i,null)}else{if(!("filter"in t))return xd();{t.filter;const e=t.filter;e.targetId;const{count:a=0,unchangedNames:i}=e,r=new Af(a,i),s=e.targetId;n=new zf(s,r)}}var a;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Gd.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Gd.min():t.readTime?av(t.readTime):Gd.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=uv(this.serializer),t.addTarget=function(e,t){let n;const a=t.target;if(n=gp(a)?{documents:hv(e,a)}:{query:pv(e,a)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=tv(e,t.resumeToken);const a=Zf(e,t.expectedCount);null!==a&&(n.expectedCount=a)}else if(t.snapshotVersion.compareTo(Gd.min())>0){n.readTime=ev(e,t.snapshotVersion.toTimestamp());const a=Zf(e,t.expectedCount);null!==a&&(n.expectedCount=a)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xd()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=uv(this.serializer),t.removeTarget=e,this.Wo(t)}}class fm extends hm{constructor(e,t,n,a,i,r){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,a,r),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(Td(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(Td(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?av(e.updateTime):av(t);return n.isEqual(Gd.min())&&(n=av(t)),new cf(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=av(e.commitTime);return this.listener.cu(n,t)}return Td(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=uv(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof bf)n={update:dv(e,t.key,t.value)};else if(t instanceof Cf)n={delete:sv(e,t.key)};else if(t instanceof wf)n={update:dv(e,t.key,t.data),updateMask:Iv(t.fieldMask)};else{if(!(t instanceof kf))return xd();n={verify:sv(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof ef)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof tf)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof af)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof sf)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw xd()}(0,e))),t.precondition.isNone||(n.currentDocument=(a=e,void 0!==(i=t.precondition).updateTime?{updateTime:nv(a,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:xd())),n;var a,i}(this.serializer,e))};this.Wo(t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm extends class{}{constructor(e,t,n,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=a,this.lu=!1}fu(){if(this.lu)throw new Vd(Nd.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,i])=>this.connection.Io(e,t,n,a,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Nd.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Vd(Nd.UNKNOWN,e.toString())})}vo(e,t,n,a){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,r])=>this.connection.vo(e,t,n,i,r,a)).catch(e=>{throw"FirebaseError"===e.name?(e.code===Nd.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Vd(Nd.UNKNOWN,e.toString())})}terminate(){this.lu=!0}}class mm{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Cd(t),this.mu=!1):Sd("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(e,t,n,a,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(e=>{n.enqueueAndForget(async()=>{Em(this)&&(Sd("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Ad(e);t.vu.add(4),await bm(t),t.bu.set("Unknown"),t.vu.delete(4),await ym(t)}(this))})}),this.bu=new mm(n,a)}}async function ym(e){if(Em(e))for(const t of e.Ru)await t(!0)}async function bm(e){for(const t of e.Ru)await t(!1)}function wm(e,t){const n=Ad(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),km(n)?Cm(n):zm(n).Ko()&&Im(n,t))}function _m(e,t){const n=Ad(e),a=zm(n);n.Au.delete(t),a.Ko()&&Sm(n,t),0===n.Au.size&&(a.Ko()?a.jo():Em(n)&&n.bu.set("Unknown"))}function Im(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Gd.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}zm(e).su(t)}function Sm(e,t){e.Vu.qt(t),zm(e).iu(t)}function Cm(e){e.Vu=new Gf({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),zm(e).start(),e.bu.gu()}function km(e){return Em(e)&&!zm(e).Uo()&&e.Au.size>0}function Em(e){return 0===Ad(e).vu.size}function xm(e){e.Vu=void 0}async function Tm(e){e.Au.forEach((t,n)=>{Im(e,t)})}async function Am(e,t){xm(e),km(e)?(e.bu.Iu(t),Cm(e)):e.bu.set("Unknown")}async function Nm(e,t,n){if(e.bu.set("Online"),t instanceof qf&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const a of t.targetIds)e.Au.has(a)&&(await e.remoteSyncer.rejectListen(a,n),e.Au.delete(a),e.Vu.removeTarget(a))}(e,t)}catch(a){Sd("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),a),await Vm(e,a)}else if(t instanceof jf?e.Vu.Ht(t):t instanceof zf?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(Gd.min()))try{const t=await Wv(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach((n,a)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Au.get(a);i&&e.Au.set(a,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const a=e.Au.get(t);if(!a)return;e.Au.set(t,a.withResumeToken(yh.EMPTY_BYTE_STRING,a.snapshotVersion)),Sm(e,t);const i=new Cv(a.target,t,n,a.sequenceNumber);Im(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(i){Sd("RemoteStore","Failed to raise snapshot:",i),await Vm(e,i)}}async function Vm(e,t,n){if(!ih(t))throw t;e.vu.add(1),await bm(e),e.bu.set("Offline"),n||(n=()=>Wv(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Sd("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await ym(e)})}function Dm(e,t){return t().catch(n=>Vm(e,n,t))}async function Mm(e){const t=Ad(e),n=qm(t);let a=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;Rm(t);)try{const e=await Xv(t.localStore,a);if(null===e){0===t.Eu.length&&n.jo();break}a=e.batchId,Pm(t,e)}catch(i){await Vm(t,i)}Om(t)&&Lm(t)}function Rm(e){return Em(e)&&e.Eu.length<10}function Pm(e,t){e.Eu.push(t);const n=qm(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function Om(e){return Em(e)&&!qm(e).Uo()&&e.Eu.length>0}function Lm(e){qm(e).start()}async function Fm(e){qm(e).hu()}async function Bm(e){const t=qm(e);for(const n of e.Eu)t.uu(n.mutations)}async function Um(e,t,n){const a=e.Eu.shift(),i=xf.from(a,t,n);await Dm(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await Mm(e)}async function $m(e,t){t&&qm(e).ou&&await async function(e,t){if(function(e){switch(e){default:return xd();case Nd.CANCELLED:case Nd.UNKNOWN:case Nd.DEADLINE_EXCEEDED:case Nd.RESOURCE_EXHAUSTED:case Nd.INTERNAL:case Nd.UNAVAILABLE:case Nd.UNAUTHENTICATED:return!1;case Nd.INVALID_ARGUMENT:case Nd.NOT_FOUND:case Nd.ALREADY_EXISTS:case Nd.PERMISSION_DENIED:case Nd.FAILED_PRECONDITION:case Nd.ABORTED:case Nd.OUT_OF_RANGE:case Nd.UNIMPLEMENTED:case Nd.DATA_LOSS:return!0}}(n=t.code)&&n!==Nd.ABORTED){const n=e.Eu.shift();qm(e).Qo(),await Dm(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Mm(e)}var n}(e,t),Om(e)&&Lm(e)}async function jm(e,t){const n=Ad(e);n.asyncQueue.verifyOperationInProgress(),Sd("RemoteStore","RemoteStore received new credentials");const a=Em(n);n.vu.add(3),await bm(n),a&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await ym(n)}function zm(e){return e.Su||(e.Su=function(e,t,n){const a=Ad(e);return a.fu(),new pm(t,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,n)}(e.datastore,e.asyncQueue,{uo:Tm.bind(null,e),ao:Am.bind(null,e),nu:Nm.bind(null,e)}),e.Ru.push(async t=>{t?(e.Su.Qo(),km(e)?Cm(e):e.bu.set("Unknown")):(await e.Su.stop(),xm(e))})),e.Su}function qm(e){return e.Du||(e.Du=function(e,t,n){const a=Ad(e);return a.fu(),new fm(t,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,n)}(e.datastore,e.asyncQueue,{uo:Fm.bind(null,e),ao:$m.bind(null,e),au:Bm.bind(null,e),cu:Um.bind(null,e)}),e.Ru.push(async t=>{t?(e.Du.Qo(),await Mm(e)):(await e.Du.stop(),e.Eu.length>0&&(Sd("RemoteStore",`Stopping write stream with ${e.Eu.length} pending writes`),e.Eu=[]))})),e.Du
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Hm{constructor(e,t,n,a,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=a,this.removalCallback=i,this.deferred=new Dd,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,a,i){const r=Date.now()+n,s=new Hm(e,t,r,a,i);return s.start(n),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Vd(Nd.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Gm(e,t){if(Cd("AsyncQueue",`${t}: ${e}`),ih(e))return new Vd(Nd.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Yd.comparator(t.key,n.key):(e,t)=>Yd.comparator(e.key,t.key),this.keyedMap=Fp(),this.sortedSet=new dh(this.comparator)}static emptySet(e){return new Km(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Km))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,a=n.getNext().key;if(!e.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Km;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(){this.Cu=new dh(Yd.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):xd():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class Qm{constructor(e,t,n,a,i,r,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=i,this.fromCache=r,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,a,i){const r=[];return t.forEach(e=>{r.push({type:0,doc:e})}),new Qm(e,t,Km.emptySet(t),r,n,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==n[a].type||!t[a].doc.isEqual(n[a].doc))return!1;return!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xm{constructor(){this.Nu=void 0,this.listeners=[]}}class Ym{constructor(){this.queries=new Rp(e=>Ap(e),Tp),this.onlineState="Unknown",this.ku=new Set}}function Jm(e,t){const n=Ad(e);let a=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.$u(i)&&(a=!0);t.Nu=i}}a&&eg(n)}function Zm(e,t,n){const a=Ad(e),i=a.queries.get(t);if(i)for(const r of i.listeners)r.onError(n);a.queries.delete(t)}function eg(e){e.ku.forEach(e=>{e.next()})}class tg{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Qm(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=Qm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this.key=e}}class ag{constructor(e){this.key=e}}class ig{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Hp(),this.mutatedKeys=Hp(),this.tc=Dp(e),this.ec=new Km(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new Wm,a=t?t.ec:this.ec;let i=t?t.mutatedKeys:this.mutatedKeys,r=a,s=!1;const o="F"===this.query.limitType&&a.size===this.query.limit?a.last():null,l="L"===this.query.limitType&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((e,t)=>{const u=a.get(e),c=Vp(this.query,t)?t:null,d=!!u&&this.mutatedKeys.has(u.key),h=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let p=!1;u&&c?u.data.isEqual(c.data)?d!==h&&(n.track({type:3,doc:c}),p=!0):this.rc(u,c)||(n.track({type:2,doc:c}),p=!0,(o&&this.tc(c,o)>0||l&&this.tc(c,l)<0)&&(s=!0)):!u&&c?(n.track({type:0,doc:c}),p=!0):u&&!c&&(n.track({type:1,doc:u}),p=!0,(o||l)&&(s=!0)),p&&(c?(r=r.add(c),i=h?i.add(e):i.delete(e)):(r=r.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;r.size>this.query.limit;){const e="F"===this.query.limitType?r.last():r.first();r=r.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{ec:r,ic:n,zi:s,mutatedKeys:i}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const a=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xd()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc)),this.oc(n);const r=t?this.uc():[],s=0===this.Zu.size&&this.current?1:0,o=s!==this.Xu;return this.Xu=s,0!==i.length||o?{snapshot:new Qm(this.query,e.ec,a,i,e.mutatedKeys,0===s,o,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:r}:{cc:r}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Wm,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(e=>this.Yu=this.Yu.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Yu=this.Yu.delete(e)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Hp(),this.ec.forEach(e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))});const t=[];return e.forEach(e=>{this.Zu.has(e)||t.push(new ag(e))}),this.Zu.forEach(n=>{e.has(n)||t.push(new ng(n))}),t}hc(e){this.Yu=e.ir,this.Zu=Hp();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return Qm.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class rg{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class sg{constructor(e){this.key=e,this.fc=!1}}class og{constructor(e,t,n,a,i,r){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=r,this.dc={},this.wc=new Rp(e=>Ap(e),Tp),this._c=new Map,this.mc=new Set,this.gc=new dh(Yd.comparator),this.yc=new Map,this.Ic=new Pv,this.Tc={},this.Ec=new Map,this.Ac=Av.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function lg(e,t){const n=function(e){const t=Ad(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=dg.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=kg.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=pg.bind(null,t),t.dc.nu=Jm.bind(null,t.eventManager),t.dc.Pc=Zm.bind(null,t.eventManager),t}(e);let a,i;const r=n.wc.get(t);if(r)a=r.targetId,n.sharedClientState.addLocalQueryTarget(a),i=r.view.lc();else{const e=await function(e,t){const n=Ad(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let a;return n.Bs.getTargetData(e,t).next(i=>i?(a=i,ah.resolve(a)):n.Bs.allocateTargetId(e).next(i=>(a=new Cv(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,a).next(()=>a))))}).then(e=>{const a=n.Ji.get(e.targetId);return(null===a||e.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e})}(n.localStore,kp(t)),r=n.sharedClientState.addLocalQueryTarget(e.targetId);a=e.targetId,i=await async function(e,t,n,a,i){e.Rc=(t,n,a)=>async function(e,t,n,a){let i=t.view.sc(n);i.zi&&(i=await Jv(e.localStore,t.query,!1).then(({documents:e})=>t.view.sc(e,i)));const r=a&&a.targetChanges.get(t.targetId),s=t.view.applyChanges(i,e.isPrimaryClient,r);return wg(e,t.targetId,s.cc),s.snapshot}(e,t,n,a);const r=await Jv(e.localStore,t,!0),s=new ig(t,r.ir),o=s.sc(r.documents),l=$f.createSynthesizedTargetChangeForCurrentChange(n,a&&"Offline"!==e.onlineState,i),u=s.applyChanges(o,e.isPrimaryClient,l);wg(e,n,u.cc);const c=new rg(t,n,s);return e.wc.set(t,c),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),u.snapshot}(n,t,a,"current"===r,e.resumeToken),n.isPrimaryClient&&wm(n.remoteStore,e)}return i}async function ug(e,t){const n=Ad(e),a=n.wc.get(t),i=n._c.get(a.targetId);if(i.length>1)return n._c.set(a.targetId,i.filter(e=>!Tp(e,t))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Yv(n.localStore,a.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(a.targetId),_m(n.remoteStore,a.targetId),yg(n,a.targetId)}).catch(nh)):(yg(n,a.targetId),await Yv(n.localStore,a.targetId,!0))}async function cg(e,t,n){const a=function(e){const t=Ad(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=fg.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=vg.bind(null,t),t}(e);try{const e=await function(e,t){const n=Ad(e),a=Hd.now(),i=t.reduce((e,t)=>e.add(t.key),Hp());let r,s;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Op(),l=Hp();return n.Zi.getEntries(e,i).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(i=>{r=i;const s=[];for(const e of t){const t=gf(e,r.get(e.key).overlayedDocument);null!=t&&s.push(new wf(e.key,t,qh(t.value.mapValue),df.exists(!0)))}return n.mutationQueue.addMutationBatch(e,a,s,t)}).next(t=>{s=t;const a=t.applyToLocalDocumentSet(r,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(()=>({batchId:s.batchId,changes:Bp(r)}))}(a.localStore,t);a.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let a=e.Tc[e.currentUser.toKey()];a||(a=new dh(zd)),a=a.insert(t,n),e.Tc[e.currentUser.toKey()]=a}(a,e.batchId,n),await Sg(a,e.changes),await Mm(a.remoteStore)}catch(i){const e=Gm(i,"Failed to persist write");n.reject(e)}}async function dg(e,t){const n=Ad(e);try{const e=await Qv(n.localStore,t);t.targetChanges.forEach((e,t)=>{const a=n.yc.get(t);a&&(Td(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?a.fc=!0:e.modifiedDocuments.size>0?Td(a.fc):e.removedDocuments.size>0&&(Td(a.fc),a.fc=!1))}),await Sg(n,e,t)}catch(a){await nh(a)}}function hg(e,t,n){const a=Ad(e);if(a.isPrimaryClient&&0===n||!a.isPrimaryClient&&1===n){const e=[];a.wc.forEach((n,a)=>{const i=a.view.Mu(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Ad(e);n.onlineState=t;let a=!1;n.queries.forEach((e,n)=>{for(const i of n.listeners)i.Mu(t)&&(a=!0)}),a&&eg(n)}(a.eventManager,t),e.length&&a.dc.nu(e),a.onlineState=t,a.isPrimaryClient&&a.sharedClientState.setOnlineState(t)}}async function pg(e,t,n){const a=Ad(e);a.sharedClientState.updateQueryState(t,"rejected",n);const i=a.yc.get(t),r=i&&i.key;if(r){let e=new dh(Yd.comparator);e=e.insert(r,Hh.newNoDocument(r,Gd.min()));const n=Hp().add(r),i=new Uf(Gd.min(),new Map,new dh(zd),e,n);await dg(a,i),a.gc=a.gc.remove(r),a.yc.delete(t),Ig(a)}else await Yv(a.localStore,t,!1).then(()=>yg(a,t,n)).catch(nh)}async function fg(e,t){const n=Ad(e),a=t.batch.batchId;try{const e=await function(e,t){const n=Ad(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const a=t.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,a){const i=n.batch,r=i.keys();let s=ah.resolve();return r.forEach(e=>{s=s.next(()=>a.getEntry(t,e)).next(t=>{const r=n.docVersions.get(e);Td(null!==r),t.version.compareTo(r)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),a.addEntry(t)))})}),s.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,a,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Hp();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,a))})}(n.localStore,t);gg(n,a,null),mg(n,a),n.sharedClientState.updateMutationState(a,"acknowledged"),await Sg(n,e)}catch(i){await nh(i)}}async function vg(e,t,n){const a=Ad(e);try{const e=await function(e,t){const n=Ad(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let a;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(Td(null!==t),a=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,a,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,a)).next(()=>n.localDocuments.getDocuments(e,a))})}(a.localStore,t);gg(a,t,n),mg(a,t),a.sharedClientState.updateMutationState(t,"rejected",n),await Sg(a,e)}catch(i){await nh(i)}}function mg(e,t){(e.Ec.get(t)||[]).forEach(e=>{e.resolve()}),e.Ec.delete(t)}function gg(e,t,n){const a=Ad(e);let i=a.Tc[a.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),a.Tc[a.currentUser.toKey()]=i}}function yg(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const a of e._c.get(t))e.wc.delete(a),n&&e.dc.Pc(a,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach(t=>{e.Ic.containsKey(t)||bg(e,t)})}function bg(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(_m(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),Ig(e))}function wg(e,t,n){for(const a of n)a instanceof ng?(e.Ic.addReference(a.key,t),_g(e,a)):a instanceof ag?(Sd("SyncEngine","Document no longer in limbo: "+a.key),e.Ic.removeReference(a.key,t),e.Ic.containsKey(a.key)||bg(e,a.key)):xd()}function _g(e,t){const n=t.key,a=n.path.canonicalString();e.gc.get(n)||e.mc.has(a)||(Sd("SyncEngine","New document in limbo: "+n),e.mc.add(a),Ig(e))}function Ig(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new Yd(Wd.fromString(t)),a=e.Ac.next();e.yc.set(a,new sg(n)),e.gc=e.gc.insert(n,a),wm(e.remoteStore,new Cv(kp(bp(n.path)),a,"TargetPurposeLimboResolution",rh.ct))}}async function Sg(e,t,n){const a=Ad(e),i=[],r=[],s=[];a.wc.isEmpty()||(a.wc.forEach((e,o)=>{s.push(a.Rc(o,t,n).then(e=>{if((e||n)&&a.isPrimaryClient&&a.sharedClientState.updateQueryState(o.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=qv.Li(o.targetId,e);r.push(t)}}))}),await Promise.all(s),a.dc.nu(i),await async function(e,t){const n=Ad(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>ah.forEach(t,t=>ah.forEach(t.Fi,a=>n.persistence.referenceDelegate.addReference(e,t.targetId,a)).next(()=>ah.forEach(t.Bi,a=>n.persistence.referenceDelegate.removeReference(e,t.targetId,a)))))}catch(a){if(!ih(a))throw a;Sd("LocalStore","Failed to update sequence numbers: "+a)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.Ji.get(e),a=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(a);n.Ji=n.Ji.insert(e,i)}}}(a.localStore,r))}async function Cg(e,t){const n=Ad(e);if(!n.currentUser.isEqual(t)){Sd("SyncEngine","User change. New user:",t.toKey());const e=await Kv(n.localStore,t);n.currentUser=t,(a=n).Ec.forEach(e=>{e.forEach(e=>{e.reject(new Vd(Nd.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.Ec.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Sg(n,e.er)}var a}function kg(e,t){const n=Ad(e),a=n.yc.get(t);if(a&&a.fc)return Hp().add(a.key);{let e=Hp();const a=n._c.get(t);if(!a)return e;for(const t of a){const a=n.wc.get(t);e=e.unionWith(a.view.nc)}return e}}class Eg{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=cm(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,n,a){return new Gv(e,t,n,a)}(this.persistence,new Hv,e.initialUser,this.serializer)}createPersistence(e){return new $v(zv.zs,this.serializer)}createSharedClientState(e){return new em}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class xg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>hg(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Cg.bind(null,this.syncEngine),await async function(e,t){const n=Ad(e);t?(n.vu.delete(2),await ym(n)):t||(n.vu.add(2),await bm(n),n.bu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ym}createDatastore(e){const t=cm(e.databaseInfo.databaseId),n=(a=e.databaseInfo,new lm(a));var a,i,r;return i=e.authCredentials,r=e.appCheckCredentials,new vm(i,r,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,a=e.asyncQueue,i=e=>hg(this.syncEngine,e,0),r=nm.D()?new nm:new tm,new gm(t,n,a,i,r);var t,n,a,i,r}createSyncEngine(e,t){return function(e,t,n,a,i,r,s){const o=new og(e,t,n,a,i,r);return s&&(o.vc=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Ad(e);Sd("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await bm(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tg{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Cd("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag{constructor(e,t,n,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=a,this.user=bd.UNAUTHENTICATED,this.clientId=jd.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async e=>{Sd("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Sd("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Vd(Nd.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dd;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Gm(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Ng(e,t){e.asyncQueue.verifyOperationInProgress(),Sd("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let a=n.initialUser;e.setCredentialChangeListener(async e=>{a.isEqual(e)||(await Kv(t.localStore,e),a=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Vg(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Sd("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ng(e,e._uninitializedComponentsProvider._offline)}catch(t){const a=t;if(!function(e){return"FirebaseError"===e.name?e.code===Nd.FAILED_PRECONDITION||e.code===Nd.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(a))throw a;kd("Error using user provided cache. Falling back to memory cache: "+a),await Ng(e,new Eg)}}else Sd("FirestoreClient","Using default OfflineComponentProvider"),await Ng(e,new Eg);return e._offlineComponents}(e);Sd("FirestoreClient","Initializing OnlineComponentProvider");const a=await e.getConfiguration();await t.initialize(n,a),e.setCredentialChangeListener(e=>jm(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>jm(t.remoteStore,n)),e._onlineComponents=t}async function Dg(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Sd("FirestoreClient","Using user provided OnlineComponentProvider"),await Vg(e,e._uninitializedComponentsProvider._online)):(Sd("FirestoreClient","Using default OnlineComponentProvider"),await Vg(e,new xg))),e._onlineComponents}async function Mg(e){const t=await Dg(e),n=t.eventManager;return n.onListen=lg.bind(null,t.syncEngine),n.onUnlisten=ug.bind(null,t.syncEngine),n}function Rg(e,t,n={}){const a=new Dd;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,a,i){const r=new Tg({next:n=>{t.enqueueAndForget(()=>async function(e,t){const n=Ad(e),a=t.query;let i=!1;const r=n.queries.get(a);if(r){const e=r.listeners.indexOf(t);e>=0&&(r.listeners.splice(e,1),i=0===r.listeners.length)}if(i)return n.queries.delete(a),n.onUnlisten(a)}(e,s)),n.fromCache&&"server"===a.source?i.reject(new Vd(Nd.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new tg(n,r,{includeMetadataChanges:!0,Ku:!0});return async function(t,n){const a=Ad(t),i=n.query;let r=!1,s=a.queries.get(i);if(s||(r=!0,s=new Xm),r)try{s.Nu=await a.onListen(i)}catch(e){const a=Gm(e,`Initialization of query '${Np(n.query)}' failed`);return void n.onError(a)}a.queries.set(i,s),s.listeners.push(n),n.Mu(a.onlineState),s.Nu&&n.$u(s.Nu)&&eg(a)}(e,s)}(await Mg(e),e.asyncQueue,t,n,a)),a.promise
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}function Pg(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const Og=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(e,t,n){if(!n)throw new Vd(Nd.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Fg(e){if(!Yd.isDocumentKey(e))throw new Vd(Nd.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Bg(e){if(Yd.isDocumentKey(e))throw new Vd(Nd.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Ug(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":xd()}function $g(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Vd(Nd.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ug(e);throw new Vd(Nd.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Vd(Nd.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Vd(Nd.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,a){if(!0===t&&!0===a)throw new Vd(Nd.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Pg(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Vd(Nd.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Vd(Nd.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Vd(Nd.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class zg{constructor(e,t,n,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Vd(Nd.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Vd(Nd.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jg(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Rd;switch(e.type){case"firstParty":return new Fd(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Vd(Nd.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Og.get(e);t&&(Sd("ComponentProvider","Removing Datastore"),Og.delete(e),t.terminate())}(this),Promise.resolve()}}function qg(e,t,n,a={}){var i;const r=(e=$g(e,zg))._getSettings(),s=`${t}:${n}`;if("firestore.googleapis.com"!==r.host&&r.host!==s&&kd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},r),{host:s,ssl:!1})),a.mockUserToken){let t,n;if("string"==typeof a.mockUserToken)t=a.mockUserToken,n=bd.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",a=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[wn(JSON.stringify({alg:"none",type:"JWT"})),wn(JSON.stringify(r)),""].join(".")}(a.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const r=a.mockUserToken.sub||a.mockUserToken.user_id;if(!r)throw new Vd(Nd.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new bd(r)}e._authCredentials=new Pd(new Md(t,n))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Kg(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hg(this.firestore,e,this._key)}}class Gg{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Gg(this.firestore,e,this._query)}}class Kg extends Gg{constructor(e,t,n){super(e,t,bp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hg(this.firestore,null,new Yd(e))}withConverter(e){return new Kg(this.firestore,e,this._path)}}function Wg(e,t,...n){if(e=Ln(e),Lg("collection","path",t),e instanceof zg){const a=Wd.fromString(t,...n);return Bg(a),new Kg(e,null,a)}{if(!(e instanceof Hg||e instanceof Kg))throw new Vd(Nd.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=e._path.child(Wd.fromString(t,...n));return Bg(a),new Kg(e.firestore,null,a)}}function Qg(e,t){if(e=$g(e,zg),Lg("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Vd(Nd.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Gg(e,null,(n=t,new yp(Wd.emptyPath(),n)));var n}function Xg(e,t,...n){if(e=Ln(e),1===arguments.length&&(t=jd.A()),Lg("doc","path",t),e instanceof zg){const a=Wd.fromString(t,...n);return Fg(a),new Hg(e,null,new Yd(a))}{if(!(e instanceof Hg||e instanceof Kg))throw new Vd(Nd.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=e._path.child(Wd.fromString(t,...n));return Fg(a),new Hg(e.firestore,e instanceof Kg?e.converter:null,new Yd(a))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new dm(this,"async_queue_retry"),this.Xc=()=>{const e=um();e&&Sd("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=um();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=um();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new Dd;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!ih(e))throw e;Sd("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(e=>{this.Wc=e,this.Hc=!1;throw Cd("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.Hc=!1,e))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const a=Hm.createAndSchedule(this,e,t,n,e=>this.na(e));return this.zc.push(a),a}Zc(){this.Wc&&xd()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}class Jg extends zg{constructor(e,t,n,a){super(e,t,n,a),this.type="firestore",this._queue=new Yg,this._persistenceKey=(null==a?void 0:a.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ty(this),this._firestoreClient.terminate()}}function Zg(e,t){const n="string"==typeof e?e:"(default)",a=Ha("object"==typeof e?e:Xa(),"firestore").getImmediate({identifier:n});if(!a._initialized){const e=(e=>{const t=Cn(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const a=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),a]:[t.substring(0,n),a]})("firestore");e&&qg(a,...e)}return a}function ey(e){return e._firestoreClient||ty(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ty(e){var t,n,a;const i=e._freezeSettings(),r=(s=e._databaseId,o=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",l=e._persistenceKey,new Eh(s,o,l,(u=i).host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,Pg(u.experimentalLongPollingOptions),u.useFetchStreams));var s,o,l,u;e._firestoreClient=new Ag(e._authCredentials,e._appCheckCredentials,e._queue,r),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(a=i.cache)||void 0===a?void 0:a._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ny(yh.fromBase64String(e))}catch(t){throw new Vd(Nd.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ny(yh.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Vd(Nd.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xd(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e){this._methodName=e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Vd(Nd.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Vd(Nd.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return zd(this._lat,e._lat)||zd(this._long,e._long)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sy=/^__.*__$/;class oy{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new wf(e,this.data,this.fieldMask,t,this.fieldTransforms):new bf(e,this.data,t,this.fieldTransforms)}}class ly{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new wf(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function uy(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xd()}}class cy{constructor(e,t,n,a,i,r){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=a,void 0===i&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=r||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new cy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),a=this.aa({path:n,la:!1});return a.fa(e),a}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),a=this.aa({path:n,la:!1});return a.ua(),a}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return ky(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(uy(this.ca)&&sy.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class dy{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||cm(e)}ya(e,t,n,a=!1){return new cy({ca:e,methodName:t,ga:n,path:Xd.emptyPath(),la:!1,ma:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function hy(e){const t=e._freezeSettings(),n=cm(e._databaseId);return new dy(e._databaseId,!!t.ignoreUndefinedProperties,n)}function py(e,t,n,a,i,r={}){const s=e.ya(r.merge||r.mergeFields?2:0,t,n,i);_y("Data must be an object, but it was:",s,a);const o=by(a,s);let l,u;if(r.merge)l=new mh(s.fieldMask),u=s.fieldTransforms;else if(r.mergeFields){const e=[];for(const a of r.mergeFields){const i=Iy(t,a,n);if(!s.contains(i))throw new Vd(Nd.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Ey(e,i)||e.push(i)}l=new mh(e),u=s.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,u=s.fieldTransforms;return new oy(new zh(o),l,u)}class fy extends iy{_toFieldTransform(e){if(2!==e.ca)throw 1===e.ca?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fy}}class vy extends iy{_toFieldTransform(e){return new uf(e.path,new ef)}isEqual(e){return e instanceof vy}}function my(e,t,n,a){const i=e.ya(1,t,n);_y("Data must be an object, but it was:",i,a);const r=[],s=zh.empty();uh(a,(e,a)=>{const o=Cy(t,e,n);a=Ln(a);const l=i.da(o);if(a instanceof fy)r.push(o);else{const e=yy(a,l);null!=e&&(r.push(o),s.set(o,e))}});const o=new mh(r);return new ly(s,o,i.fieldTransforms)}function gy(e,t,n,a,i,r){const s=e.ya(1,t,n),o=[Iy(t,a,n)],l=[i];if(r.length%2!=0)throw new Vd(Nd.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<r.length;h+=2)o.push(Iy(t,r[h])),l.push(r[h+1]);const u=[],c=zh.empty();for(let h=o.length-1;h>=0;--h)if(!Ey(u,o[h])){const e=o[h];let t=l[h];t=Ln(t);const n=s.da(e);if(t instanceof fy)u.push(e);else{const a=yy(t,n);null!=a&&(u.push(e),c.set(e,a))}}const d=new mh(u);return new ly(c,d,s.fieldTransforms)}function yy(e,t){if(wy(e=Ln(e)))return _y("Unsupported field value:",t,e),by(e,t);if(e instanceof iy)return function(e,t){if(!uy(t.ca))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let a=0;for(const i of e){let e=yy(i,t.wa(a));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),a++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Ln(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Qp(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Hd.fromDate(e);return{timestampValue:ev(t.serializer,n)}}if(e instanceof Hd){const n=new Hd(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ev(t.serializer,n)}}if(e instanceof ry)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof ny)return{bytesValue:tv(t.serializer,e._byteString)};if(e instanceof Hg){const n=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(n))throw t._a(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:iv(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${Ug(e)}`)}(e,t)}function by(e,t){const n={};return ch(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):uh(e,(e,a)=>{const i=yy(a,t.ha(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function wy(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Hd||e instanceof ry||e instanceof ny||e instanceof Hg||e instanceof iy)}function _y(e,t,n){if(!wy(n)||("object"!=typeof(a=n)||null===a||Object.getPrototypeOf(a)!==Object.prototype&&null!==Object.getPrototypeOf(a))){const a=Ug(n);throw"an object"===a?t._a(e+" a custom object"):t._a(e+" "+a)}var a}function Iy(e,t,n){if((t=Ln(t))instanceof ay)return t._internalPath;if("string"==typeof t)return Cy(e,t);throw ky("Field path arguments must be of type string or ",e,!1,void 0,n)}const Sy=new RegExp("[~\\*/\\[\\]]");function Cy(e,t,n){if(t.search(Sy)>=0)throw ky(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new ay(...t.split("."))._internalPath}catch(a){throw ky(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function ky(e,t,n,a,i){const r=a&&!a.isEmpty(),s=void 0!==i;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(r||s)&&(l+=" (found",r&&(l+=` in field ${a}`),s&&(l+=` in document ${i}`),l+=")"),new Vd(Nd.INVALID_ARGUMENT,o+e+l)}function Ey(e,t){return e.some(e=>e.isEqual(t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,t,n,a,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Hg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Ty(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ay("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Ty extends xy{data(){return super.data()}}function Ay(e,t){return"string"==typeof t?Cy(e,t):t instanceof ay?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{}class Vy extends Ny{}function Dy(e,t,...n){let a=[];t instanceof Ny&&a.push(t),a=a.concat(n),function(e){const t=e.filter(e=>e instanceof Py).length,n=e.filter(e=>e instanceof My).length;if(t>1||t>0&&n>0)throw new Vd(Nd.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(a);for(const i of a)e=i._apply(e);return e}class My extends Vy{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new My(e,t,n)}_apply(e){const t=this._parse(e);return Uy(e._query,t),new Gg(e.firestore,e.converter,Ep(e._query,t))}_parse(e){const t=hy(e.firestore),n=function(e,t,n,a,i,r,s){let o;if(i.isKeyField()){if("array-contains"===r||"array-contains-any"===r)throw new Vd(Nd.INVALID_ARGUMENT,`Invalid Query. You can't perform '${r}' queries on documentId().`);if("in"===r||"not-in"===r){By(s,r);const t=[];for(const n of s)t.push(Fy(a,e,n));o={arrayValue:{values:t}}}else o=Fy(a,e,s)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||By(s,r),o=function(e,t,n,a=!1){return yy(n,e.ya(a?4:3,t))}(n,"where",s,"in"===r||"not-in"===r);return Jh.create(i,r,o)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Ry(e,t,n){const a=t,i=Ay("where",e);return My._create(i,a,n)}class Py extends Ny{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Py(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Zh.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const a=t.getFlattenedFilters();for(const i of a)Uy(n,i),n=Ep(n,i)}(e._query,t),new Gg(e.firestore,e.converter,Ep(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Oy extends Vy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Oy(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Vd(Nd.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Vd(Nd.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const a=new Qh(t,n);return function(e,t){if(null===_p(e)){const n=Ip(e);null!==n&&$y(e,n,t.field)}}(e,a),a}(e._query,this._field,this._direction);return new Gg(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new yp(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Ly(e,t="asc"){const n=t,a=Ay("orderBy",e);return Oy._create(a,n)}function Fy(e,t,n){if("string"==typeof(n=Ln(n))){if(""===n)throw new Vd(Nd.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sp(t)&&-1!==n.indexOf("/"))throw new Vd(Nd.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const a=t.path.child(Wd.fromString(n));if(!Yd.isDocumentKey(a))throw new Vd(Nd.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return Oh(e,new Yd(a))}if(n instanceof Hg)return Oh(e,n._key);throw new Vd(Nd.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ug(n)}.`)}function By(e,t){if(!Array.isArray(e)||0===e.length)throw new Vd(Nd.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Uy(e,t){if(t.isInequality()){const n=Ip(e),a=t.field;if(null!==n&&!n.isEqual(a))throw new Vd(Nd.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${a.toString()}'`);const i=_p(e);null!==i&&$y(e,a,i)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Vd(Nd.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Vd(Nd.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function $y(e,t,n){if(!n.isEqual(t))throw new Vd(Nd.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class jy{convertValue(e,t="none"){switch(Ah(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _h(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ih(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw xd()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return uh(e,(e,a)=>{n[e]=this.convertValue(a,t)}),n}convertGeoPoint(e){return new ry(_h(e.latitude),_h(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ch(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(kh(e));default:return null}}convertTimestamp(e){const t=wh(e);return new Hd(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Wd.fromString(e);Td(Sv(n));const a=new xh(n.get(1),n.get(3)),i=new Yd(n.popFirst(5));return a.isEqual(t)||Cd(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zy(e,t,n){let a;return a=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,a
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class qy{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Hy extends xy{constructor(e,t,n,a,i,r){super(e,t,n,a,r),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Gy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Ay("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Gy extends Hy{data(e={}){return super.data(e)}}class Ky{constructor(e,t,n,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new qy(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Gy(this._firestore,this._userDataWriter,n.key,n,new qy(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Vd(Nd.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const a=new Gy(e._firestore,e._userDataWriter,n.doc.key,n.doc,new qy(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:a,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const a=new Gy(e._firestore,e._userDataWriter,t.doc.key,t.doc,new qy(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,r=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),r=n.indexOf(t.doc.key)),{type:Wy(t.type),doc:a,oldIndex:i,newIndex:r}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Wy(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xd()}}class Qy extends jy{constructor(e){super(),this.firestore=e}convertBytes(e){return new ny(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hg(this.firestore,null,t)}}function Xy(e){e=$g(e,Gg);const t=$g(e.firestore,Jg),n=ey(t),a=new Qy(t);return function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Vd(Nd.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),Rg(n,e._query).then(n=>new Ky(t,a,e,n))}function Yy(e,t,n,...a){e=$g(e,Hg);const i=$g(e.firestore,Jg),r=hy(i);let s;return s="string"==typeof(t=Ln(t))||t instanceof ay?gy(r,"updateDoc",e._key,t,n,a):my(r,"updateDoc",e._key,t),eb(i,[s.toMutation(e._key,df.exists(!0))])}function Jy(e){return eb($g(e.firestore,Jg),[new Cf(e._key,df.none())])}function Zy(e,t){const n=$g(e.firestore,Jg),a=Xg(e),i=zy(e.converter,t);return eb(n,[py(hy(e.firestore),"addDoc",a._key,i,null!==e.converter,{}).toMutation(a._key,df.exists(!1))]).then(()=>a)}function eb(e,t){return function(e,t){const n=new Dd;return e.asyncQueue.enqueueAndForget(async()=>cg(await function(e){return Dg(e).then(e=>e.syncEngine)}(e),t,n)),n.promise}(ey(e),t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=hy(e)}set(e,t,n){this._verifyNotCommitted();const a=nb(e,this._firestore),i=zy(a.converter,t,n),r=py(this._dataReader,"WriteBatch.set",a._key,i,null!==a.converter,n);return this._mutations.push(r.toMutation(a._key,df.none())),this}update(e,t,n,...a){this._verifyNotCommitted();const i=nb(e,this._firestore);let r;return r="string"==typeof(t=Ln(t))||t instanceof ay?gy(this._dataReader,"WriteBatch.update",i._key,t,n,a):my(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(r.toMutation(i._key,df.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=nb(e,this._firestore);return this._mutations=this._mutations.concat(new Cf(t._key,df.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Vd(Nd.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function nb(e,t){if((e=Ln(e)).firestore!==t)throw new Vd(Nd.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function ab(){return new vy("serverTimestamp")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(e){return ey(e=$g(e,Jg)),new tb(e,t=>eb(e,t))}!function(e,t=!0){wd=Wa,qa(new Fn("firestore",(e,{instanceIdentifier:n,options:a})=>{const i=e.getProvider("app").getImmediate(),r=new Jg(new Od(e.getProvider("auth-internal")),new Ud(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Vd(Nd.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xh(e.options.projectId,t)}(i,n),i);return a=Object.assign({useFetchStreams:t},a),r._setSettings(a),r},"PUBLIC").setMultipleInstances(!0)),Ya(yd,"3.13.0",e),Ya(yd,"3.13.0","esm2017")}();const rb=async e=>{const[t,n,a,i,r,s]=await(async e=>{if(!e)throw new Error("User ID is required to load initial data.");try{const t=await Qs();return Promise.all([Xy(Wg(t,"accounts")),Xy(Wg(t,"character_masters")),Xy(Wg(t,"itemMasters")),Xy(Qg(t,"owned_characters")),Xy(Wg(t,"gachaMasters")),Xy(Dy(Wg(t,"teams"),Ry("userId","==",e),Ly("createdAt","desc")))])}catch(t){throw t}})(e),o=t.docs.map(e=>{const t=e.data();return{id:e.id,name:t.Name||`アカウント${t.id}`,numericId:t.id,indexNumber:t.indexNumber}}).sort((e,t)=>(e.numericId||999)-(t.numericId||999)),l=n.docs.map(e=>({...e.data(),id:e.id})).sort((e,t)=>(e.indexNumber||999999)-(t.indexNumber||999999)),u=new Map(l.map(e=>[e.id,e])),c=a.docs.map(e=>({...e.data(),id:Number(e.data().id)})).sort((e,t)=>e.id-t.id),d=new Map(c.map(e=>[e.id,e.name])),h=r.docs.map(e=>e.data()).sort((e,t)=>(e.id||0)-(t.id||0)),p=s.docs.map(e=>({...e.data(),id:e.id})),f=new Map,v=new Map;return i.forEach(e=>{var t,n;const a=e.data(),i=null==(t=e.ref.parent.parent)?void 0:t.id;if(!i)return;const r=`${a.characterMasterId}-${i}`;v.set(r,(v.get(r)||0)+1),f.has(i)||f.set(i,[]);const s=to(a.items);null==(n=f.get(i))||n.push({...a,items:s,id:e.id})}),{accounts:o,characterMasters:l,characterMastersMap:u,itemMasters:c,itemMastersMap:d,gachaMasters:h,teams:p,ownedCharactersData:f,ownedCountMap:v}},sb=async(e,t)=>Zy(Wg(await Qs(),"accounts",e,"owned_characters"),t),ob=async(e,t,n)=>Yy(Xg(await Qs(),"accounts",e,"owned_characters",t),{items:n}),lb=async(e,t)=>Jy(Xg(await Qs(),"accounts",e,"owned_characters",t)),ub=async(e,t,n)=>{const a=await Qs(),i=ib(a),r=Xg(a,"accounts",e,"owned_characters",t.id),s=Xg(a,"accounts",e,"owned_characters",n.id);return i.update(r,{items:t.items}),i.update(s,{items:n.items}),i.commit()},cb=async e=>Zy(Wg(await Qs(),"character_masters"),e),db=async(e,t)=>Yy(Xg(await Qs(),"character_masters",e),t),hb=async(e,t)=>{const n=await Qs();return e?Yy(Xg(n,"teams",e),t):Zy(Wg(n,"teams"),t)},pb=async e=>Jy(Xg(await Qs(),"teams",e)),fb=vn("data",{state:()=>({dataLoaded:!1,accounts:[],characterMasters:[],itemMasters:[],gachaMasters:[],teams:[],ownedCharactersData:new Map,ownedCountMap:new Map,characterMastersMap:new Map,itemMastersMap:new Map}),getters:{getOwnedCharactersByAccount:e=>t=>e.ownedCharactersData.get(t)||[],getOwnedCount:e=>(t,n)=>{const a=`${t}-${n}`;return e.ownedCountMap.get(a)||0},getCharacterMaster:e=>t=>e.characterMastersMap.get(t),getItemName:e=>t=>e.itemMastersMap.get(t)||`アイテム${t}`,getAccount:e=>t=>e.accounts.find(e=>e.id===t)},actions:{async loadInitialData(e){if(!this.dataLoaded)try{0;const t=await rb(e);this.accounts=t.accounts,this.characterMasters=t.characterMasters,this.characterMastersMap=t.characterMastersMap,this.itemMasters=t.itemMasters,this.itemMastersMap=t.itemMastersMap,this.gachaMasters=t.gachaMasters,this.teams=t.teams,this.ownedCharactersData=t.ownedCharactersData,this.ownedCountMap=t.ownedCountMap,this.dataLoaded=!0}catch(t){throw t}},updateOwnedCharactersForAccount(e,t){this.ownedCharactersData.set(e,t),t.forEach(t=>{const n=`${t.characterMasterId}-${e}`,a=this.ownedCountMap.get(n)||0;this.ownedCountMap.set(n,a)})},async addOwnedCharacter(e,t){try{const n=await sb(e,t),a=this.ownedCharactersData.get(e)||[],i={id:n.id,characterMasterId:t.characterMasterId||"",items:t.items||[],addedAt:new Date};a.push(i),this.ownedCharactersData.set(e,a);const r=`${i.characterMasterId}-${e}`;this.ownedCountMap.set(r,(this.ownedCountMap.get(r)||0)+1)}catch(n){throw n}},setTeams(e){this.teams=e},async saveTeam(e,t){try{if(await hb(e,t),e){const n=this.teams.findIndex(t=>t.id===e);-1!==n&&(this.teams[n]={...this.teams[n],...t})}0}catch(n){throw n}},async deleteTeam(e){try{await pb(e),this.teams=this.teams.filter(t=>t.id!==e)}catch(t){throw t}},resetData(){this.dataLoaded=!1,this.accounts=[],this.characterMasters=[],this.itemMasters=[],this.gachaMasters=[],this.teams=[],this.ownedCharactersData=new Map,this.ownedCountMap=new Map,this.characterMastersMap=new Map,this.itemMastersMap=new Map}}}),vb=vn("ui",{state:()=>({activeTab:"characters",selectedAccountId:null,loading:!1,snackbar:{show:!1,message:"",color:"success"},pinnedCharacterIds:[]}),getters:{isSnackbarVisible:e=>e.snackbar.show,isLoading:e=>e.loading,hasSelectedAccount:e=>null!==e.selectedAccountId},actions:{setActiveTab(e){this.activeTab=e},setSelectedAccountId(e){this.selectedAccountId=e},setLoading(e){this.loading=e},showSnackbar(e,t="success"){this.snackbar={show:!0,message:e,color:t}},showSuccess(e){this.showSnackbar(e,"success")},showError(e){this.showSnackbar(e,"error")},showInfo(e){this.showSnackbar(e,"info")},showWarning(e){this.showSnackbar(e,"warning")},hideSnackbar(){this.snackbar.show=!1},resetUI(){this.activeTab="characters",this.selectedAccountId=null,this.loading=!1,this.snackbar={show:!1,message:"",color:"success"},this.pinnedCharacterIds=[]},togglePinnedCharacter(e){const t=this.pinnedCharacterIds.indexOf(e);t>-1?this.pinnedCharacterIds.splice(t,1):this.pinnedCharacterIds.push(e)},isPinned(e){return this.pinnedCharacterIds.includes(e)},clearPinnedCharacters(){this.pinnedCharacterIds=[]}}}),mb=(e,t)=>{const n=e.__vccOpts||e;for(const[a,i]of t)n[a]=i;return n},gb=oe({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),yb=se(!1)({name:"VDefaultsProvider",props:gb(),setup(e,t){let{slots:n}=t;const{defaults:a,disabled:i,reset:r,root:s,scoped:o}=p(e);return le(a,{reset:r,root:s,scoped:o,disabled:i}),()=>{var e;return null==(e=n.default)?void 0:e.call(n)}}});function bb(e){return ue(()=>{const t=v(e),n=[],a={};if(t.background)if(ce(t.background)){if(a.backgroundColor=t.background,!t.text&&de(t.background)){const e=he(t.background);if(null==e.a||1===e.a){const t=pe(e);a.color=t,a.caretColor=t}}}else n.push(`bg-${t.background}`);return t.text&&(ce(t.text)?(a.color=t.text,a.caretColor=t.text):n.push(`text-${t.text}`)),{colorClasses:n,colorStyles:a}})}function wb(e){const{colorClasses:t,colorStyles:n}=bb(()=>({text:v(e)}));return{textColorClasses:t,textColorStyles:n}}function _b(e){const{colorClasses:t,colorStyles:n}=bb(()=>({background:v(e)}));return{backgroundColorClasses:t,backgroundColorStyles:n}}const Ib=["x-small","small","default","large","x-large"],Sb=oe({size:{type:[String,Number],default:"default"}},"size");function Cb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return ue(()=>{const n=e.size;let a,i;return ve(Ib,n)?a=`${t}--size-${n}`:n&&(i={width:me(n),height:me(n)}),{sizeClasses:a,sizeStyles:i}})}const kb=oe({tag:{type:[String,Object,Function],default:"div"}},"tag"),Eb=oe({color:String,disabled:Boolean,start:Boolean,end:Boolean,icon:Ie,opacity:[String,Number],..._e(),...Sb(),...kb({tag:"i"}),...we()},"VIcon"),xb=se()({name:"VIcon",props:Eb(),setup(e,t){let{attrs:n,slots:a}=t;const i=m(),{themeClasses:r}=ge(),{iconData:s}=ye(()=>i.value||e.icon),{sizeClasses:o}=Cb(e),{textColorClasses:l,textColorStyles:u}=wb(()=>e.color);return be(()=>{var t,c;const d=null==(t=a.default)?void 0:t.call(a);d&&(i.value=null==(c=Se(d).filter(e=>e.type===g&&e.children&&"string"==typeof e.children)[0])?void 0:c.children);const h=!(!n.onClick&&!n.onClickOnce);return y(s.value.component,{tag:e.tag,icon:s.value.icon,class:w(["v-icon","notranslate",r.value,o.value,l.value,{"v-icon--clickable":h,"v-icon--disabled":e.disabled,"v-icon--start":e.start,"v-icon--end":e.end},e.class]),style:b([{"--v-icon-opacity":e.opacity},o.value?void 0:{fontSize:me(e.size),height:me(e.size),width:me(e.size)},u.value,e.style]),role:h?"button":void 0,"aria-hidden":!h,tabindex:h?e.disabled?-1:0:void 0},{default:()=>[d]})}),{}}}),Tb=oe({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function Ab(e){return{dimensionStyles:f(()=>{const t={},n=me(e.height),a=me(e.maxHeight),i=me(e.maxWidth),r=me(e.minHeight),s=me(e.minWidth),o=me(e.width);return null!=n&&(t.height=n),null!=a&&(t.maxHeight=a),null!=i&&(t.maxWidth=i),null!=r&&(t.minHeight=r),null!=s&&(t.minWidth=s),null!=o&&(t.width=o),t})}}const Nb=oe({aspectRatio:[String,Number],contentClass:null,inline:Boolean,..._e(),...Tb()},"VResponsive"),Vb=se()({name:"VResponsive",props:Nb(),setup(e,t){let{slots:n}=t;const{aspectStyles:a}=function(e){return{aspectStyles:f(()=>{const t=Number(e.aspectRatio);return t?{paddingBottom:String(1/t*100)+"%"}:void 0})}}(e),{dimensionStyles:i}=Ab(e);return be(()=>{var t;return _("div",{class:w(["v-responsive",{"v-responsive--inline":e.inline},e.class]),style:b([i.value,e.style])},[_("div",{class:"v-responsive__sizer",style:b(a.value)},null),null==(t=n.additional)?void 0:t.call(n),n.default&&_("div",{class:w(["v-responsive__content",e.contentClass])},[n.default()])])}),{}}}),Db=oe({rounded:{type:[Boolean,Number,String],default:void 0},tile:Boolean},"rounded");function Mb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{roundedClasses:f(()=>{const n=s(e)?e.value:e.rounded,a=s(e)?e.value:e.tile,i=[];if(!0===n||""===n)i.push(`${t}--rounded`);else if("string"==typeof n||0===n)for(const e of String(n).split(" "))i.push(`rounded-${e}`);else(a||!1===n)&&i.push("rounded-0");return i})}}const Rb=oe({transition:{type:null,default:"fade-transition",validator:e=>!0!==e}},"transition"),Pb=(e,t)=>{let{slots:n}=t;const{transition:a,disabled:i,group:r,...s}=e,{component:o=(r?I:S),...l}=Ce(a)?a:{};let u;return u=Ce(a)?C(l,ke({disabled:i,group:r}),s):C({name:i||!a?"":a},s),k(o,u,n)};function Ob(e,t){var n;const a=null==(n=e._observe)?void 0:n[t.instance.$.uid];a&&(a.observer.unobserve(e),delete e._observe[t.instance.$.uid])}const Lb={mounted:function(e,t){if(!Ee)return;const n=t.modifiers||{},a=t.value,{handler:i,options:r}="object"==typeof a?a:{handler:a,options:{}},s=new IntersectionObserver(function(){var a;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1?arguments[1]:void 0;const o=null==(a=e._observe)?void 0:a[t.instance.$.uid];if(!o)return;const l=r.some(e=>e.isIntersecting);!i||n.quiet&&!o.init||n.once&&!l&&!o.init||i(l,r,s),l&&n.once?Ob(e,t):o.init=!0},r);e._observe=Object(e._observe),e._observe[t.instance.$.uid]={init:!1,observer:s},s.observe(e)},unmounted:Ob},Fb=oe({absolute:Boolean,alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...Nb(),..._e(),...Db(),...Rb()},"VImg"),Bb=se()({name:"VImg",directives:{vIntersect:Lb},props:Fb(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,n){let{emit:a,slots:i}=n;const{backgroundColorClasses:r,backgroundColorStyles:s}=_b(()=>e.color),{roundedClasses:o}=Mb(e),l=xe("VImg"),u=m(""),c=t(),p=m(e.eager?"loading":"idle"),v=m(),g=m(),b=f(()=>e.src&&"object"==typeof e.src?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),I=f(()=>b.value.aspect||v.value/g.value||0);function S(t){if((!e.eager||!t)&&(!Ee||t||e.eager)){if(p.value="loading",b.value.lazySrc){const e=new Image;e.src=b.value.lazySrc,P(e,null)}b.value.src&&h(()=>{var e;a("loadstart",(null==(e=c.value)?void 0:e.currentSrc)||b.value.src),setTimeout(()=>{var e;if(!l.isUnmounted)if(null==(e=c.value)?void 0:e.complete){if(c.value.naturalWidth||D(),"error"===p.value)return;I.value||P(c.value,null),"loading"===p.value&&k()}else I.value||P(c.value),M()})})}}function k(){var e;l.isUnmounted||(M(),P(c.value),p.value="loaded",a("load",(null==(e=c.value)?void 0:e.currentSrc)||b.value.src))}function D(){var e;l.isUnmounted||(p.value="error",a("error",(null==(e=c.value)?void 0:e.currentSrc)||b.value.src))}function M(){const e=c.value;e&&(u.value=e.currentSrc||e.src)}d(()=>e.src,()=>{S("idle"!==p.value)}),d(I,(e,t)=>{!e&&t&&c.value&&P(c.value)}),E(()=>S());let R=-1;function P(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const n=()=>{if(clearTimeout(R),l.isUnmounted)return;const{naturalHeight:a,naturalWidth:i}=e;a||i?(v.value=i,g.value=a):e.complete||"loading"!==p.value||null==t?(e.currentSrc.endsWith(".svg")||e.currentSrc.startsWith("data:image/svg+xml"))&&(v.value=1,g.value=1):R=window.setTimeout(n,t)};n()}x(()=>{clearTimeout(R)});const O=T(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),L=()=>{var t;if(!b.value.src||"idle"===p.value)return null;const n=_("img",{class:w(["v-img__img",O.value]),style:{objectPosition:e.position},crossorigin:e.crossorigin,src:b.value.src,srcset:b.value.srcset,alt:e.alt,referrerpolicy:e.referrerpolicy,draggable:e.draggable,sizes:e.sizes,ref:c,onLoad:k,onError:D},null),a=null==(t=i.sources)?void 0:t.call(i);return y(Pb,{transition:e.transition,appear:!0},{default:()=>[A(a?_("picture",{class:"v-img__picture"},[a,n]):n,[[V,"loaded"===p.value]])]})},F=()=>y(Pb,{transition:e.transition},{default:()=>[b.value.lazySrc&&"loaded"!==p.value&&_("img",{class:w(["v-img__img","v-img__img--preload",O.value]),style:{objectPosition:e.position},crossorigin:e.crossorigin,src:b.value.lazySrc,alt:e.alt,referrerpolicy:e.referrerpolicy,draggable:e.draggable},null)]}),B=()=>i.placeholder?y(Pb,{transition:e.transition,appear:!0},{default:()=>[("loading"===p.value||"error"===p.value&&!i.error)&&_("div",{class:"v-img__placeholder"},[i.placeholder()])]}):null,U=()=>i.error?y(Pb,{transition:e.transition,appear:!0},{default:()=>["error"===p.value&&_("div",{class:"v-img__error"},[i.error()])]}):null,$=()=>e.gradient?_("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,j=m(!1);{const e=d(I,t=>{t&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{j.value=!0})}),e())})}return be(()=>{const t=Vb.filterProps(e);return A(y(Vb,C({class:["v-img",{"v-img--absolute":e.absolute,"v-img--booting":!j.value},r.value,o.value,e.class],style:[{width:me("auto"===e.width?v.value:e.width)},s.value,e.style]},t,{aspectRatio:I.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>_(N,null,[y(L,null,null),y(F,null,null),y($,null,null),y(B,null,null),y(U,null,null)]),default:i.default}),[[Lb,{handler:S,options:e.options},null,{once:!0}]])}),{currentSrc:u,image:c,state:p,naturalWidth:v,naturalHeight:g}}}),Ub=oe({border:[Boolean,Number,String]},"border");function $b(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{borderClasses:f(()=>{const n=e.border;return!0===n||""===n?`${t}--border`:"string"==typeof n||0===n?String(n).split(" ").map(e=>`border-${e}`):[]})}}const jb=[null,"default","comfortable","compact"],zb=oe({density:{type:String,default:"default",validator:e=>jb.includes(e)}},"density");function qb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{densityClasses:T(()=>`${t}--density-${e.density}`)}}const Hb=["elevated","flat","tonal","outlined","text","plain"];function Gb(e,t){return _(N,null,[e&&_("span",{key:"overlay",class:w(`${t}__overlay`)},null),_("span",{key:"underlay",class:w(`${t}__underlay`)},null)])}const Kb=oe({color:String,variant:{type:String,default:"elevated",validator:e=>Hb.includes(e)}},"variant");function Wb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();const n=T(()=>{const{variant:n}=v(e);return`${t}--variant-${n}`}),{colorClasses:a,colorStyles:i}=bb(()=>{const{variant:t,color:n}=v(e);return{[["elevated","flat"].includes(t)?"background":"text"]:n}});return{colorClasses:a,colorStyles:i,variantClasses:n}}const Qb=oe({start:Boolean,end:Boolean,icon:Ie,image:String,text:String,...Ub(),..._e(),...zb(),...Db(),...Sb(),...kb(),...we(),...Kb({variant:"flat"})},"VAvatar"),Xb=se()({name:"VAvatar",props:Qb(),setup(e,t){let{slots:n}=t;const{themeClasses:a}=Te(e),{borderClasses:i}=$b(e),{colorClasses:r,colorStyles:s,variantClasses:o}=Wb(e),{densityClasses:l}=qb(e),{roundedClasses:u}=Mb(e),{sizeClasses:c,sizeStyles:d}=Cb(e);return be(()=>y(e.tag,{class:w(["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},a.value,i.value,r.value,l.value,u.value,c.value,o.value,e.class]),style:b([s.value,d.value,e.style])},{default:()=>[n.default?y(yb,{key:"content-defaults",defaults:{VImg:{cover:!0,src:e.image},VIcon:{icon:e.icon}}},{default:()=>[n.default()]}):e.image?y(Bb,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?y(xb,{key:"icon",icon:e.icon},null):e.text,Gb(!1,"v-avatar")]})),{}}}),Yb=oe({elevation:{type:[Number,String],validator(e){const t=parseInt(e);return!isNaN(t)&&t>=0&&t<=24}}},"elevation");function Jb(e){return{elevationClasses:T(()=>{const t=s(e)?e.value:e.elevation;return null==t?[]:[`elevation-${t}`]})}}const Zb=oe({baseColor:String,divided:Boolean,direction:{type:String,default:"horizontal"},...Ub(),..._e(),...zb(),...Yb(),...Db(),...kb(),...we(),...Kb()},"VBtnGroup"),ew=se()({name:"VBtnGroup",props:Zb(),setup(e,t){let{slots:n}=t;const{themeClasses:a}=Te(e),{densityClasses:i}=qb(e),{borderClasses:r}=$b(e),{elevationClasses:s}=Jb(e),{roundedClasses:o}=Mb(e);le({VBtn:{height:T(()=>"horizontal"===e.direction?"auto":null),baseColor:T(()=>e.baseColor),color:T(()=>e.color),density:T(()=>e.density),flat:!0,variant:T(()=>e.variant)}}),be(()=>y(e.tag,{class:w(["v-btn-group",`v-btn-group--${e.direction}`,{"v-btn-group--divided":e.divided},a.value,r.value,i.value,s.value,o.value,e.class]),style:b(e.style)},n))}}),tw=oe({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),nw=oe({value:null,disabled:Boolean,selectedClass:String},"group-item");function aw(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=xe("useGroupItem");if(!i)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const r=R();P(Symbol.for(`${t.description}:id`),r);const s=a(t,null);if(!s){if(!n)return s;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${t.description}`)}const o=T(()=>e.value),l=f(()=>!(!s.disabled.value&&!e.disabled));s.register({id:r,value:o,disabled:l},i),x(()=>{s.unregister(r)});const u=f(()=>s.isSelected(r)),c=f(()=>s.items.value[0].id===r),h=f(()=>s.items.value[s.items.value.length-1].id===r),p=f(()=>u.value&&[s.selectedClass.value,e.selectedClass]);return d(u,e=>{i.emit("group:selected",{value:e})},{flush:"sync"}),{id:r,isSelected:u,isFirst:c,isLast:h,toggle:()=>s.select(r,!u.value),select:e=>s.select(r,e),selectedClass:p,value:o,disabled:l,group:s}}function iw(e,t){let n=!1;const a=r([]),i=Ae(e,"modelValue",[],e=>null==e?[]:rw(a,Ve(e)),t=>{const n=function(e,t){const n=[];return t.forEach(t=>{const a=e.findIndex(e=>e.id===t);if(~a){const t=e[a];n.push(null!=t.value?t.value:a)}}),n}(a,t);return e.multiple?n:n[0]}),s=xe("useGroup");function o(){const t=a.find(e=>!e.disabled);t&&"force"===e.mandatory&&!i.value.length&&(i.value=[t.id])}function l(t){if(e.multiple,i.value.length){const e=i.value[0],n=a.findIndex(t=>t.id===e);let r=(n+t)%a.length,s=a[r];for(;s.disabled&&r!==n;)r=(r+t)%a.length,s=a[r];if(s.disabled)return;i.value=[a[r].id]}else{const e=a.find(e=>!e.disabled);e&&(i.value=[e.id])}}D(()=>{o()}),x(()=>{n=!0}),M(()=>{for(let e=0;e<a.length;e++)a[e].useIndexAsValue&&(a[e].value=e)});const u={register:function(e,n){const i=e,r=Symbol.for(`${t.description}:id`),o=De(r,null==s?void 0:s.vnode).indexOf(n);null==O(i.value)&&(i.value=o,i.useIndexAsValue=!0),o>-1?a.splice(o,0,i):a.push(i)},unregister:function(e){if(n)return;o();const t=a.findIndex(t=>t.id===e);a.splice(t,1)},selected:i,select:function(t,n){const r=a.find(e=>e.id===t);if(!n||!(null==r?void 0:r.disabled))if(e.multiple){const a=i.value.slice(),r=a.findIndex(e=>e===t),s=~r;if(n=n??!s,s&&e.mandatory&&a.length<=1)return;if(!s&&null!=e.max&&a.length+1>e.max)return;r<0&&n?a.push(t):r>=0&&!n&&a.splice(r,1),i.value=a}else{const a=i.value.includes(t);if(e.mandatory&&a)return;if(!a&&!n)return;i.value=n??!a?[t]:[]}},disabled:T(()=>e.disabled),prev:()=>l(a.length-1),next:()=>l(1),isSelected:e=>i.value.includes(e),selectedClass:T(()=>e.selectedClass),items:T(()=>a),getItemIndex:e=>function(e,t){const n=rw(e,[t]);return n.length?e.findIndex(e=>e.id===n[0]):-1}(a,e)};return P(t,u),u}function rw(e,t){const n=[];return t.forEach(t=>{const a=e.find(e=>Ne(t,e.value)),i=e[t];null!=(null==a?void 0:a.value)?n.push(a.id):(null==i?void 0:i.useIndexAsValue)&&n.push(i.id)}),n}const sw=Symbol.for("vuetify:v-btn-toggle"),ow=oe({...Zb(),...tw()},"VBtnToggle"),lw=se()({name:"VBtnToggle",props:ow(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{isSelected:a,next:i,prev:r,select:s,selected:o}=iw(e,sw);return be(()=>{const t=ew.filterProps(e);return y(ew,C({class:["v-btn-toggle",e.class]},t,{style:e.style}),{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n,{isSelected:a,next:i,prev:r,select:s,selected:o})]}})}),{next:i,prev:r,select:s}}});function uw(e,n){const a=t(),i=m(!1);if(Ee){const e=new IntersectionObserver(e=>{i.value=!!e.find(e=>e.isIntersecting)},n);c(()=>{e.disconnect()}),d(a,(t,n)=>{n&&(e.unobserve(n),i.value=!1),t&&e.observe(t)},{flush:"post"})}return{intersectionRef:a,isIntersecting:i}}const cw=oe({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},..._e(),...Sb(),...kb({tag:"div"}),...we()},"VProgressCircular"),dw=se()({name:"VProgressCircular",props:cw(),setup(e,n){let{slots:a}=n;const i=2*Math.PI*20,r=t(),{themeClasses:s}=Te(e),{sizeClasses:o,sizeStyles:l}=Cb(e),{textColorClasses:u,textColorStyles:c}=wb(()=>e.color),{textColorClasses:d,textColorStyles:h}=wb(()=>e.bgColor),{intersectionRef:p,isIntersecting:f}=uw(),{resizeRef:v,contentRect:m}=Me(),g=T(()=>Re(parseFloat(e.modelValue),0,100)),I=T(()=>Number(e.width)),S=T(()=>l.value?Number(e.size):m.value?m.value.width:Math.max(I.value,32)),C=T(()=>20/(1-I.value/S.value)*2),k=T(()=>I.value/S.value*C.value),E=T(()=>me((100-g.value)/100*i));return L(()=>{p.value=r.value,v.value=r.value}),be(()=>y(e.tag,{ref:r,class:w(["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":f.value,"v-progress-circular--disable-shrink":"disable-shrink"===e.indeterminate},s.value,o.value,u.value,e.class]),style:b([l.value,c.value,e.style]),role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:g.value},{default:()=>[_("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${C.value} ${C.value}`},[_("circle",{class:w(["v-progress-circular__underlay",d.value]),style:b(h.value),fill:"transparent",cx:"50%",cy:"50%",r:20,"stroke-width":k.value,"stroke-dasharray":i,"stroke-dashoffset":0},null),_("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:20,"stroke-width":k.value,"stroke-dasharray":i,"stroke-dashoffset":E.value},null)]),a.default&&_("div",{class:"v-progress-circular__content"},[a.default({value:g.value})])]})),{}}}),hw={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},pw=oe({location:String},"location");function fw(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{isRtl:a}=Pe();return{locationStyles:f(()=>{if(!e.location)return{};const{side:i,align:r}=Oe(e.location.split(" ").length>1?e.location:`${e.location} center`,a.value);function s(e){return n?n(e):0}const o={};return"center"!==i&&(t?o[hw[i]]=`calc(100% - ${s(i)}px)`:o[i]=0),"center"!==r?t?o[hw[r]]=`calc(100% - ${s(r)}px)`:o[r]=0:("center"===i?o.top=o.left="50%":o[{top:"left",bottom:"left",left:"top",right:"top"}[i]]="50%",o.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[i]),o})}}const vw=oe({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},bufferColor:String,bufferOpacity:[Number,String],clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},opacity:[Number,String],reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,..._e(),...pw({location:"top"}),...Db(),...kb(),...we()},"VProgressLinear"),mw=se()({name:"VProgressLinear",props:vw(),emits:{"update:modelValue":e=>!0},setup(e,t){var n;let{slots:a}=t;const i=Ae(e,"modelValue"),{isRtl:r,rtlClasses:s}=Pe(),{themeClasses:o}=Te(e),{locationStyles:l}=fw(e),{textColorClasses:u,textColorStyles:c}=wb(()=>e.color),{backgroundColorClasses:d,backgroundColorStyles:h}=_b(()=>e.bgColor||e.color),{backgroundColorClasses:p,backgroundColorStyles:v}=_b(()=>e.bufferColor||e.bgColor||e.color),{backgroundColorClasses:m,backgroundColorStyles:g}=_b(()=>e.color),{roundedClasses:I}=Mb(e),{intersectionRef:C,isIntersecting:k}=uw(),E=f(()=>parseFloat(e.max)),x=f(()=>parseFloat(e.height)),T=f(()=>Re(parseFloat(e.bufferValue)/E.value*100,0,100)),A=f(()=>Re(parseFloat(i.value)/E.value*100,0,100)),N=f(()=>r.value!==e.reverse),V=f(()=>e.indeterminate?"fade-transition":"slide-x-transition"),D=Le&&(null==(n=window.matchMedia)?void 0:n.call(window,"(forced-colors: active)").matches);function M(e){if(!C.value)return;const{left:t,right:n,width:a}=C.value.getBoundingClientRect(),r=N.value?a-e.clientX+(n-a):e.clientX-t;i.value=Math.round(r/a*E.value)}return be(()=>y(e.tag,{ref:C,class:w(["v-progress-linear",{"v-progress-linear--absolute":e.absolute,"v-progress-linear--active":e.active&&k.value,"v-progress-linear--reverse":N.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped,"v-progress-linear--clickable":e.clickable},I.value,o.value,s.value,e.class]),style:b([{bottom:"bottom"===e.location?0:void 0,top:"top"===e.location?0:void 0,height:e.active?me(x.value):0,"--v-progress-linear-height":me(x.value),...e.absolute?l.value:{}},e.style]),role:"progressbar","aria-hidden":e.active?"false":"true","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:Math.min(parseFloat(i.value),E.value),onClick:e.clickable&&M},{default:()=>[e.stream&&_("div",{key:"stream",class:w(["v-progress-linear__stream",u.value]),style:{...c.value,[N.value?"left":"right"]:me(-x.value),borderTop:`${me(x.value/2)} dotted`,opacity:parseFloat(e.bufferOpacity),top:`calc(50% - ${me(x.value/4)})`,width:me(100-T.value,"%"),"--v-progress-linear-stream-to":me(x.value*(N.value?1:-1))}},null),_("div",{class:w(["v-progress-linear__background",D?void 0:d.value]),style:b([h.value,{opacity:parseFloat(e.bgOpacity),width:e.stream?0:void 0}])},null),_("div",{class:w(["v-progress-linear__buffer",D?void 0:p.value]),style:b([v.value,{opacity:parseFloat(e.bufferOpacity),width:me(T.value,"%")}])},null),y(S,{name:V.value},{default:()=>[e.indeterminate?_("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(e=>_("div",{key:e,class:w(["v-progress-linear__indeterminate",e,D?void 0:m.value]),style:b(g.value)},null))]):_("div",{class:w(["v-progress-linear__determinate",D?void 0:m.value]),style:b([g.value,{width:me(A.value,"%")}])},null)]}),a.default&&_("div",{class:"v-progress-linear__content"},[a.default({value:A.value,buffer:T.value})])]})),{}}}),gw=oe({loading:[Boolean,String]},"loader");function yw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{loaderClasses:T(()=>({[`${t}--loading`]:e.loading}))}}function bw(e,t){var n;let{slots:a}=t;return _("div",{class:w(`${e.name}__loader`)},[(null==(n=a.default)?void 0:n.call(a,{color:e.color,isActive:e.active}))||y(mw,{absolute:e.absolute,active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const ww=["static","relative","fixed","absolute","sticky"],_w=oe({position:{type:String,validator:e=>ww.includes(e)}},"position");function Iw(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{positionClasses:T(()=>e.position?`${t}--${e.position}`:void 0)}}function Sw(e,t){var n,a;const i=F("RouterLink"),s=T(()=>!(!e.href&&!e.to)),o=f(()=>(null==s?void 0:s.value)||Fe(t,"click")||Fe(e,"click"));if("string"==typeof i||!("useLink"in i)){const t=T(()=>e.href);return{isLink:s,isClickable:o,href:t,linkProps:r({href:t})}}const l=i.useLink({to:T(()=>e.to||""),replace:T(()=>e.replace)}),u=f(()=>e.to?l:void 0),c=function(){const e=xe("useRoute");return f(()=>{var t;return null==(t=null==e?void 0:e.proxy)?void 0:t.$route})}(),d=f(()=>{var t,n,a;return!!u.value&&(e.exact?c.value?(null==(a=u.value.isExactActive)?void 0:a.value)&&Ne(u.value.route.value.query,c.value.query):(null==(n=u.value.isExactActive)?void 0:n.value)??!1:(null==(t=u.value.isActive)?void 0:t.value)??!1)}),h=f(()=>{var t;return e.to?null==(t=u.value)?void 0:t.route.value.href:e.href});return{isLink:s,isClickable:o,isActive:d,route:null==(n=u.value)?void 0:n.route,navigate:null==(a=u.value)?void 0:a.navigate,href:h,linkProps:r({href:h,"aria-current":T(()=>d.value?"page":void 0)})}}const Cw=oe({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let kw=!1;const Ew=Symbol("rippleStop");function xw(e,t){e.style.transform=t,e.style.webkitTransform=t}function Tw(e){return"TouchEvent"===e.constructor.name}function Aw(e){return"KeyboardEvent"===e.constructor.name}const Nw={show(e,t){var n;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(null==(n=null==t?void 0:t._ripple)?void 0:n.enabled))return;const i=document.createElement("span"),r=document.createElement("span");i.appendChild(r),i.className="v-ripple__container",a.class&&(i.className+=` ${a.class}`);const{radius:s,scale:o,x:l,y:u,centerX:c,centerY:d}=function(e,t){var n;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=0,r=0;if(!Aw(e)){const n=t.getBoundingClientRect(),a=Tw(e)?e.touches[e.touches.length-1]:e;i=a.clientX-n.left,r=a.clientY-n.top}let s=0,o=.3;(null==(n=t._ripple)?void 0:n.circle)?(o=.15,s=t.clientWidth/2,s=a.center?s:s+Math.sqrt((i-s)**2+(r-s)**2)/4):s=Math.sqrt(t.clientWidth**2+t.clientHeight**2)/2;const l=(t.clientWidth-2*s)/2+"px",u=(t.clientHeight-2*s)/2+"px";return{radius:s,scale:o,x:a.center?l:i-s+"px",y:a.center?u:r-s+"px",centerX:l,centerY:u}}(e,t,a),h=2*s+"px";r.className="v-ripple__animation",r.style.width=h,r.style.height=h,t.appendChild(i);const p=window.getComputedStyle(t);p&&"static"===p.position&&(t.style.position="relative",t.dataset.previousPosition="static"),r.classList.add("v-ripple__animation--enter"),r.classList.add("v-ripple__animation--visible"),xw(r,`translate(${l}, ${u}) scale3d(${o},${o},${o})`),r.dataset.activated=String(performance.now()),requestAnimationFrame(()=>{requestAnimationFrame(()=>{r.classList.remove("v-ripple__animation--enter"),r.classList.add("v-ripple__animation--in"),xw(r,`translate(${c}, ${d}) scale3d(1,1,1)`)})})},hide(e){var t;if(!(null==(t=null==e?void 0:e._ripple)?void 0:t.enabled))return;const n=e.getElementsByClassName("v-ripple__animation");if(0===n.length)return;const a=Array.from(n).findLast(e=>!e.dataset.isHiding);if(!a)return;a.dataset.isHiding="true";const i=performance.now()-Number(a.dataset.activated),r=Math.max(250-i,0);setTimeout(()=>{a.classList.remove("v-ripple__animation--in"),a.classList.add("v-ripple__animation--out"),setTimeout(()=>{var t;1===e.getElementsByClassName("v-ripple__animation").length&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),(null==(t=a.parentNode)?void 0:t.parentNode)===e&&e.removeChild(a.parentNode)},300)},r)}};function Vw(e){return void 0===e||!!e}function Dw(e){const t={},n=e.currentTarget;if((null==n?void 0:n._ripple)&&!n._ripple.touched&&!e[Ew]){if(e[Ew]=!0,Tw(e))n._ripple.touched=!0,n._ripple.isTouch=!0;else if(n._ripple.isTouch)return;if(t.center=n._ripple.centered||Aw(e),n._ripple.class&&(t.class=n._ripple.class),Tw(e)){if(n._ripple.showTimerCommit)return;n._ripple.showTimerCommit=()=>{Nw.show(e,n,t)},n._ripple.showTimer=window.setTimeout(()=>{var e;(null==(e=null==n?void 0:n._ripple)?void 0:e.showTimerCommit)&&(n._ripple.showTimerCommit(),n._ripple.showTimerCommit=null)},80)}else Nw.show(e,n,t)}}function Mw(e){e[Ew]=!0}function Rw(e){const t=e.currentTarget;if(null==t?void 0:t._ripple){if(window.clearTimeout(t._ripple.showTimer),"touchend"===e.type&&t._ripple.showTimerCommit)return t._ripple.showTimerCommit(),t._ripple.showTimerCommit=null,void(t._ripple.showTimer=window.setTimeout(()=>{Rw(e)}));window.setTimeout(()=>{t._ripple&&(t._ripple.touched=!1)}),Nw.hide(t)}}function Pw(e){const t=e.currentTarget;(null==t?void 0:t._ripple)&&(t._ripple.showTimerCommit&&(t._ripple.showTimerCommit=null),window.clearTimeout(t._ripple.showTimer))}let Ow=!1;function Lw(e,t){!Ow&&t.includes(e.key)&&(Ow=!0,Dw(e))}function Fw(e){Ow=!1,Rw(e)}function Bw(e){Ow&&(Ow=!1,Rw(e))}function Uw(e,t,n){const{value:a,modifiers:i}=t,r=Vw(a);r||Nw.hide(e),e._ripple=e._ripple??{},e._ripple.enabled=r,e._ripple.centered=i.center,e._ripple.circle=i.circle;const s=Ce(a)?a:{};s.class&&(e._ripple.class=s.class);const o=s.keys??["Enter","Space"];if(e._ripple.keyDownHandler=e=>Lw(e,o),r&&!n){if(i.stop)return e.addEventListener("touchstart",Mw,{passive:!0}),void e.addEventListener("mousedown",Mw);e.addEventListener("touchstart",Dw,{passive:!0}),e.addEventListener("touchend",Rw,{passive:!0}),e.addEventListener("touchmove",Pw,{passive:!0}),e.addEventListener("touchcancel",Rw),e.addEventListener("mousedown",Dw),e.addEventListener("mouseup",Rw),e.addEventListener("mouseleave",Rw),e.addEventListener("keydown",e=>Lw(e,o)),e.addEventListener("keyup",Fw),e.addEventListener("blur",Bw),e.addEventListener("dragstart",Rw,{passive:!0})}else!r&&n&&$w(e)}function $w(e){var t;e.removeEventListener("mousedown",Dw),e.removeEventListener("touchstart",Dw),e.removeEventListener("touchend",Rw),e.removeEventListener("touchmove",Pw),e.removeEventListener("touchcancel",Rw),e.removeEventListener("mouseup",Rw),e.removeEventListener("mouseleave",Rw),(null==(t=e._ripple)?void 0:t.keyDownHandler)&&e.removeEventListener("keydown",e._ripple.keyDownHandler),e.removeEventListener("keyup",Fw),e.removeEventListener("dragstart",Rw),e.removeEventListener("blur",Bw)}const jw={mounted:function(e,t){Uw(e,t,!1)},unmounted:function(e){$w(e),delete e._ripple},updated:function(e,t){if(t.value===t.oldValue)return;Uw(e,t,Vw(t.oldValue))}},zw=oe({active:{type:Boolean,default:void 0},activeColor:String,baseColor:String,symbol:{type:null,default:sw},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:Ie,appendIcon:Ie,block:Boolean,readonly:Boolean,slim:Boolean,stacked:Boolean,ripple:{type:[Boolean,Object],default:!0},text:{type:[String,Number,Boolean],default:void 0},...Ub(),..._e(),...zb(),...Tb(),...Yb(),...nw(),...gw(),...pw(),..._w(),...Db(),...Cw(),...Sb(),...kb({tag:"button"}),...we(),...Kb({variant:"elevated"})},"VBtn"),qw=se()({name:"VBtn",props:zw(),emits:{"group:selected":e=>!0},setup(e,t){let{attrs:n,slots:a}=t;const{themeClasses:i}=Te(e),{borderClasses:r}=$b(e),{densityClasses:s}=qb(e),{dimensionStyles:o}=Ab(e),{elevationClasses:l}=Jb(e),{loaderClasses:u}=yw(e),{locationStyles:c}=fw(e),{positionClasses:p}=Iw(e),{roundedClasses:v}=Mb(e),{sizeClasses:m,sizeStyles:g}=Cb(e),b=aw(e,e.symbol,!1),w=Sw(e,n),I=f(()=>{var t;return void 0!==e.active?e.active:w.isLink.value?null==(t=w.isActive)?void 0:t.value:null==b?void 0:b.isSelected.value}),S=T(()=>I.value?e.activeColor??e.color:e.color),k=f(()=>{var t,n;return{color:(null==b?void 0:b.isSelected.value)&&(!w.isLink.value||(null==(t=w.isActive)?void 0:t.value))||!b||(null==(n=w.isActive)?void 0:n.value)?S.value??e.baseColor:e.baseColor,variant:e.variant}}),{colorClasses:E,colorStyles:x,variantClasses:N}=Wb(k),V=f(()=>(null==b?void 0:b.disabled.value)||e.disabled),D=T(()=>"elevated"===e.variant&&!(e.disabled||e.flat||e.border)),M=f(()=>{if(void 0!==e.value&&"symbol"!=typeof e.value)return Object(e.value)===e.value?JSON.stringify(e.value,null,0):e.value});function R(e){var t;V.value||w.isLink.value&&(e.metaKey||e.ctrlKey||e.shiftKey||0!==e.button||"_blank"===n.target)||(null==(t=w.navigate)||t.call(w,e),null==b||b.toggle())}return function(e,t){d(()=>{var t;return null==(t=e.isActive)?void 0:t.value},n=>{e.isLink.value&&null!=n&&t&&h(()=>{t(n)})},{immediate:!0})}(w,null==b?void 0:b.select),be(()=>{const t=w.isLink.value?"a":e.tag,n=!(!e.prependIcon&&!a.prepend),d=!(!e.appendIcon&&!a.append),h=!(!e.icon||!0===e.icon);return A(y(t,C({type:"a"===t?void 0:"button",class:["v-btn",null==b?void 0:b.selectedClass.value,{"v-btn--active":I.value,"v-btn--block":e.block,"v-btn--disabled":V.value,"v-btn--elevated":D.value,"v-btn--flat":e.flat,"v-btn--icon":!!e.icon,"v-btn--loading":e.loading,"v-btn--readonly":e.readonly,"v-btn--slim":e.slim,"v-btn--stacked":e.stacked},i.value,r.value,E.value,s.value,l.value,u.value,p.value,v.value,m.value,N.value,e.class],style:[x.value,o.value,c.value,g.value,e.style],"aria-busy":!!e.loading||void 0,disabled:V.value||void 0,tabindex:e.loading||e.readonly?-1:void 0,onClick:R,value:M.value},w.linkProps),{default:()=>{var t;return[Gb(!0,"v-btn"),!e.icon&&n&&_("span",{key:"prepend",class:"v-btn__prepend"},[a.prepend?y(yb,{key:"prepend-defaults",disabled:!e.prependIcon,defaults:{VIcon:{icon:e.prependIcon}}},a.prepend):y(xb,{key:"prepend-icon",icon:e.prependIcon},null)]),_("span",{class:"v-btn__content","data-no-activator":""},[!a.default&&h?y(xb,{key:"content-icon",icon:e.icon},null):y(yb,{key:"content-defaults",disabled:!h,defaults:{VIcon:{icon:e.icon}}},{default:()=>{var t;return[(null==(t=a.default)?void 0:t.call(a))??B(e.text)]}})]),!e.icon&&d&&_("span",{key:"append",class:"v-btn__append"},[a.append?y(yb,{key:"append-defaults",disabled:!e.appendIcon,defaults:{VIcon:{icon:e.appendIcon}}},a.append):y(xb,{key:"append-icon",icon:e.appendIcon},null)]),!!e.loading&&_("span",{key:"loader",class:"v-btn__loader"},[(null==(t=a.loader)?void 0:t.call(a))??y(dw,{color:"boolean"==typeof e.loading?void 0:e.loading,indeterminate:!0,width:"2"},null)])]}}),[[jw,!V.value&&e.ripple,"",{center:!!e.icon}]])}),{group:b}}}),Hw=oe({color:String,inset:Boolean,length:[Number,String],opacity:[Number,String],thickness:[Number,String],vertical:Boolean,..._e(),...we()},"VDivider"),Gw=se()({name:"VDivider",props:Hw(),setup(e,t){let{attrs:n,slots:a}=t;const{themeClasses:i}=Te(e),{textColorClasses:r,textColorStyles:s}=wb(()=>e.color),o=f(()=>{const t={};return e.length&&(t[e.vertical?"height":"width"]=me(e.length)),e.thickness&&(t[e.vertical?"borderRightWidth":"borderTopWidth"]=me(e.thickness)),t});return be(()=>{const t=_("hr",{class:w([{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},i.value,r.value,e.class]),style:b([o.value,s.value,{"--v-border-opacity":e.opacity},e.style]),"aria-orientation":n.role&&"separator"!==n.role?void 0:e.vertical?"vertical":"horizontal",role:`${n.role||"separator"}`},null);return a.default?_("div",{class:w(["v-divider__wrapper",{"v-divider__wrapper--vertical":e.vertical,"v-divider__wrapper--inset":e.inset}])},[t,_("div",{class:"v-divider__content"},[a.default()]),t]):t}),{}}}),Kw=oe({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function Ww(e,t,n){return se()({name:e,props:Kw({mode:n,origin:t}),setup(t,n){let{slots:a}=n;const i={onBeforeEnter(e){t.origin&&(e.style.transformOrigin=t.origin)},onLeave(e){if(t.leaveAbsolute){const{offsetTop:t,offsetLeft:n,offsetWidth:a,offsetHeight:i}=e;e._transitionInitialStyles={position:e.style.position,top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height},e.style.position="absolute",e.style.top=`${t}px`,e.style.left=`${n}px`,e.style.width=`${a}px`,e.style.height=`${i}px`}t.hideOnLeave&&e.style.setProperty("display","none","important")},onAfterLeave(e){if(t.leaveAbsolute&&(null==e?void 0:e._transitionInitialStyles)){const{position:t,top:n,left:a,width:i,height:r}=e._transitionInitialStyles;delete e._transitionInitialStyles,e.style.position=t||"",e.style.top=n||"",e.style.left=a||"",e.style.width=i||"",e.style.height=r||""}}};return()=>{const n=t.group?I:S;return k(n,{name:t.disabled?"":e,css:!t.disabled,...t.group?void 0:{mode:t.mode},...t.disabled?{}:i},a.default)}}})}function Qw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"in-out";return se()({name:e,props:{mode:{type:String,default:n},disabled:Boolean,group:Boolean},setup(n,a){let{slots:i}=a;const r=n.group?I:S;return()=>k(r,{name:n.disabled?"":e,css:!n.disabled,...n.disabled?{}:t},i.default)}})}function Xw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"width":"height",n=U(`offset-${t}`);return{onBeforeEnter(e){e._parent=e.parentNode,e._initialStyle={transition:e.style.transition,overflow:e.style.overflow,[t]:e.style[t]}},onEnter(a){const i=a._initialStyle;if(!i)return;a.style.setProperty("transition","none","important"),a.style.overflow="hidden";const r=`${a[n]}px`;a.style[t]="0",a.offsetHeight,a.style.transition=i.transition,e&&a._parent&&a._parent.classList.add(e),requestAnimationFrame(()=>{a.style[t]=r})},onAfterEnter:i,onEnterCancelled:i,onLeave(e){e._initialStyle={transition:"",overflow:e.style.overflow,[t]:e.style[t]},e.style.overflow="hidden",e.style[t]=`${e[n]}px`,e.offsetHeight,requestAnimationFrame(()=>e.style[t]="0")},onAfterLeave:a,onLeaveCancelled:a};function a(t){e&&t._parent&&t._parent.classList.remove(e),i(t)}function i(e){if(!e._initialStyle)return;const n=e._initialStyle[t];e.style.overflow=e._initialStyle.overflow,null!=n&&(e.style[t]=n),delete e._initialStyle}}const Yw=oe({target:[Object,Array]},"v-dialog-transition"),Jw=new WeakMap,Zw=se()({name:"VDialogTransition",props:Yw(),setup(e,t){let{slots:n}=t;const a={onBeforeEnter(e){e.style.pointerEvents="none",e.style.visibility="hidden"},async onEnter(t,n){var a;await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>requestAnimationFrame(e)),t.style.visibility="";const i=t_(e.target,t),{x:r,y:s,sx:o,sy:l,speed:u}=i;Jw.set(t,i);const c=Be(t,[{transform:`translate(${r}px, ${s}px) scale(${o}, ${l})`,opacity:0},{}],{duration:225*u,easing:je});null==(a=e_(t))||a.forEach(e=>{Be(e,[{opacity:0},{opacity:0,offset:.33},{}],{duration:450*u,easing:$e})}),c.finished.then(()=>n())},onAfterEnter(e){e.style.removeProperty("pointer-events")},onBeforeLeave(e){e.style.pointerEvents="none"},async onLeave(t,n){var a;let i;await new Promise(e=>requestAnimationFrame(e)),i=!Jw.has(t)||Array.isArray(e.target)||e.target.offsetParent||e.target.getClientRects().length?t_(e.target,t):Jw.get(t);const{x:r,y:s,sx:o,sy:l,speed:u}=i;Be(t,[{},{transform:`translate(${r}px, ${s}px) scale(${o}, ${l})`,opacity:0}],{duration:125*u,easing:Ue}).finished.then(()=>n()),null==(a=e_(t))||a.forEach(e=>{Be(e,[{},{opacity:0,offset:.2},{opacity:0}],{duration:250*u,easing:$e})})},onAfterLeave(e){e.style.removeProperty("pointer-events")}};return()=>e.target?y(S,C({name:"dialog-transition"},a,{css:!1}),n):y(S,{name:"dialog-transition"},n)}});function e_(e){var t;const n=null==(t=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))?void 0:t.children;return n&&[...n]}function t_(e,t){const n=ze(e),a=qe(t),[i,r]=getComputedStyle(t).transformOrigin.split(" ").map(e=>parseFloat(e)),[s,o]=getComputedStyle(t).getPropertyValue("--v-overlay-anchor-origin").split(" ");let l=n.left+n.width/2;"left"===s||"left"===o?l-=n.width/2:"right"!==s&&"right"!==o||(l+=n.width/2);let u=n.top+n.height/2;"top"===s||"top"===o?u-=n.height/2:"bottom"!==s&&"bottom"!==o||(u+=n.height/2);const c=n.width/a.width,d=n.height/a.height,h=Math.max(1,c,d),p=c/h||0,f=d/h||0,v=a.width*a.height/(window.innerWidth*window.innerHeight),m=v>.12?Math.min(1.5,10*(v-.12)+1):1;return{x:l-(i+a.left),y:u-(r+a.top),sx:p,sy:f,speed:m}}Ww("fab-transition","center center","out-in"),Ww("dialog-bottom-transition"),Ww("dialog-top-transition");const n_=Ww("fade-transition");Ww("scale-transition"),Ww("scroll-x-transition"),Ww("scroll-x-reverse-transition"),Ww("scroll-y-transition"),Ww("scroll-y-reverse-transition"),Ww("slide-x-transition"),Ww("slide-x-reverse-transition");const a_=Ww("slide-y-transition");Ww("slide-y-reverse-transition");const i_=Qw("expand-transition",Xw()),r_=Qw("expand-x-transition",Xw("",!0)),s_=Symbol.for("vuetify:list");function o_(){let{filterable:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{filterable:!1};const t=a(s_,{filterable:!1,hasPrepend:m(!1),updateHasPrepend:()=>null}),n={filterable:t.filterable||e,hasPrepend:m(!1),updateHasPrepend:e=>{e&&(n.hasPrepend.value=e)}};return P(s_,n),t}function l_(){return a(s_,null)}const u_=e=>{const t={activate:t=>{let{id:n,value:a,activated:i}=t;return n=l(n),e&&!a&&1===i.size&&i.has(n)||(a?i.add(n):i.delete(n)),i},in:(e,n,a)=>{let i=new Set;if(null!=e)for(const r of Ve(e))i=t.activate({id:r,value:!0,activated:new Set(i),children:n,parents:a});return i},out:e=>Array.from(e)};return t},c_=e=>{const t=u_(e);return{activate:e=>{let{activated:n,id:a,...i}=e;a=l(a);const r=n.has(a)?new Set([a]):new Set;return t.activate({...i,id:a,activated:r})},in:(e,n,a)=>{let i=new Set;if(null!=e){const r=Ve(e);r.length&&(i=t.in(r.slice(0,1),n,a))}return i},out:(e,n,a)=>t.out(e,n,a)}},d_={open:e=>{let{id:t,value:n,opened:a,parents:i}=e;if(n){const e=new Set;e.add(t);let n=i.get(t);for(;null!=n;)e.add(n),n=i.get(n);return e}return a.delete(t),a},select:()=>null},h_={open:e=>{let{id:t,value:n,opened:a,parents:i}=e;if(n){let e=i.get(t);for(a.add(t);null!=e&&e!==t;)a.add(e),e=i.get(e);return a}return a.delete(t),a},select:()=>null},p_={open:h_.open,select:e=>{let{id:t,value:n,opened:a,parents:i}=e;if(!n)return a;const r=[];let s=i.get(t);for(;null!=s;)r.push(s),s=i.get(s);return new Set(r)}},f_=e=>{const t={select:t=>{let{id:n,value:a,selected:i}=t;if(n=l(n),e&&!a){const e=Array.from(i.entries()).reduce((e,t)=>{let[n,a]=t;return"on"===a&&e.push(n),e},[]);if(1===e.length&&e[0]===n)return i}return i.set(n,a?"on":"off"),i},in:(e,n,a,i)=>{const r=new Map;for(const s of e||[])t.select({id:s,value:!0,selected:r,children:n,parents:a,disabled:i});return r},out:e=>{const t=[];for(const[n,a]of e.entries())"on"===a&&t.push(n);return t}};return t},v_=e=>{const t=f_(e);return{select:e=>{let{selected:n,id:a,...i}=e;a=l(a);const r=n.has(a)?new Map([[a,n.get(a)]]):new Map;return t.select({...i,id:a,selected:r})},in:(e,n,a,i)=>(null==e?void 0:e.length)?t.in(e.slice(0,1),n,a,i):new Map,out:(e,n,a)=>t.out(e,n,a)}},m_=e=>{const t={select:t=>{let{id:n,value:a,selected:i,children:r,parents:s,disabled:o}=t;n=l(n);const u=new Map(i),c=[n];for(;c.length;){const e=c.shift();o.has(e)||i.set(l(e),a?"on":"off"),r.has(e)&&c.push(...r.get(e))}let d=l(s.get(n));for(;d;){let e=!0,t=!0;for(const n of r.get(d)){const a=l(n);if(!o.has(a)&&("on"!==i.get(a)&&(e=!1),i.has(a)&&"off"!==i.get(a)&&(t=!1),!e&&!t))break}i.set(d,e?"on":t?"off":"indeterminate"),d=l(s.get(d))}if(e&&!a){if(0===Array.from(i.entries()).reduce((e,t)=>{let[n,a]=t;return"on"===a&&e.push(n),e},[]).length)return u}return i},in:(e,n,a,i)=>{let r=new Map;for(const s of e||[])r=t.select({id:s,value:!0,selected:r,children:n,parents:a,disabled:i});return r},out:(e,t)=>{const n=[];for(const[a,i]of e.entries())"on"!==i||t.has(a)||n.push(a);return n}};return t},g_=Symbol.for("vuetify:nested"),y_={id:m(),root:{register:()=>null,unregister:()=>null,children:t(new Map),parents:t(new Map),disabled:t(new Set),open:()=>null,openOnSelect:()=>null,activate:()=>null,select:()=>null,activatable:t(!1),selectable:t(!1),opened:t(new Set),activated:t(new Set),selected:t(new Map),selectedValues:t([]),getPath:()=>[]}},b_=oe({activatable:Boolean,selectable:Boolean,activeStrategy:[String,Function,Object],selectStrategy:[String,Function,Object],openStrategy:[String,Object],opened:null,activated:null,selected:null,mandatory:Boolean},"nested"),w_=e=>{let t=!1;const n=m(new Map),a=m(new Map),i=m(new Set),r=Ae(e,"opened",e.opened,e=>new Set(Array.isArray(e)?e.map(e=>l(e)):e),e=>[...e.values()]),s=f(()=>{if("object"==typeof e.activeStrategy)return e.activeStrategy;if("function"==typeof e.activeStrategy)return e.activeStrategy(e.mandatory);switch(e.activeStrategy){case"leaf":return(e=>{const t=u_(e);return{activate:e=>{let{id:n,activated:a,children:i,...r}=e;return n=l(n),i.has(n)?a:t.activate({id:n,activated:a,children:i,...r})},in:t.in,out:t.out}})(e.mandatory);case"single-leaf":return(e=>{const t=c_(e);return{activate:e=>{let{id:n,activated:a,children:i,...r}=e;return n=l(n),i.has(n)?a:t.activate({id:n,activated:a,children:i,...r})},in:t.in,out:t.out}})(e.mandatory);case"independent":return u_(e.mandatory);default:return c_(e.mandatory)}}),o=f(()=>{if("object"==typeof e.selectStrategy)return e.selectStrategy;if("function"==typeof e.selectStrategy)return e.selectStrategy(e.mandatory);switch(e.selectStrategy){case"single-leaf":return(e=>{const t=v_(e);return{select:e=>{let{id:n,selected:a,children:i,...r}=e;return n=l(n),i.has(n)?a:t.select({id:n,selected:a,children:i,...r})},in:t.in,out:t.out}})(e.mandatory);case"leaf":return(e=>{const t=f_(e);return{select:e=>{let{id:n,selected:a,children:i,...r}=e;return n=l(n),i.has(n)?a:t.select({id:n,selected:a,children:i,...r})},in:t.in,out:t.out}})(e.mandatory);case"independent":return f_(e.mandatory);case"single-independent":return v_(e.mandatory);case"trunk":return(e=>{const t=m_(e);return{select:t.select,in:t.in,out:(e,t,n)=>{const a=[];for(const[i,r]of e.entries())if("on"===r){if(n.has(i)){const t=n.get(i);if("on"===e.get(t))continue}a.push(i)}return a}}})(e.mandatory);default:return m_(e.mandatory)}}),u=f(()=>{if("object"==typeof e.openStrategy)return e.openStrategy;switch(e.openStrategy){case"list":return p_;case"single":return d_;default:return h_}}),c=Ae(e,"activated",e.activated,e=>s.value.in(e,n.value,a.value),e=>s.value.out(e,n.value,a.value)),d=Ae(e,"selected",e.selected,e=>o.value.in(e,n.value,a.value,i.value),e=>o.value.out(e,n.value,a.value));function h(e){const t=[];let n=l(e);for(;null!=n;)t.unshift(n),n=a.value.get(n);return t}x(()=>{t=!0});const p=xe("nested"),v=new Set,g={id:m(),root:{opened:r,activatable:T(()=>e.activatable),selectable:T(()=>e.selectable),activated:c,selected:d,selectedValues:f(()=>{const e=[];for(const[t,n]of d.value.entries())"on"===n&&e.push(t);return e}),register:(e,t,r,s)=>{if(v.has(e))return h(e).map(String).join(" -> "),void h(t).concat(e).map(String).join(" -> ");v.add(e),t&&e!==t&&a.value.set(e,t),r&&i.value.add(e),s&&n.value.set(e,[]),null!=t&&n.value.set(t,[...n.value.get(t)||[],e])},unregister:e=>{if(t)return;v.delete(e),n.value.delete(e),i.value.delete(e);const r=a.value.get(e);if(r){const t=n.value.get(r)??[];n.value.set(r,t.filter(t=>t!==e))}a.value.delete(e)},open:(e,t,i)=>{p.emit("click:open",{id:e,value:t,path:h(e),event:i});const s=u.value.open({id:e,value:t,opened:new Set(r.value),children:n.value,parents:a.value,event:i});s&&(r.value=s)},openOnSelect:(e,t,i)=>{const s=u.value.select({id:e,value:t,selected:new Map(d.value),opened:new Set(r.value),children:n.value,parents:a.value,event:i});s&&(r.value=s)},select:(e,t,r)=>{p.emit("click:select",{id:e,value:t,path:h(e),event:r});const s=o.value.select({id:e,value:t,selected:new Map(d.value),children:n.value,parents:a.value,disabled:i.value,event:r});s&&(d.value=s),g.root.openOnSelect(e,t,r)},activate:(t,i,r)=>{if(!e.activatable)return g.root.select(t,!0,r);p.emit("click:activate",{id:t,value:i,path:h(t),event:r});const o=s.value.activate({id:t,value:i,activated:new Set(c.value),children:n.value,parents:a.value,event:r});if(o.size!==c.value.size)c.value=o;else{for(const e of o)if(!c.value.has(e))return void(c.value=o);for(const e of c.value)if(!o.has(e))return void(c.value=o)}},children:n,parents:a,disabled:i,getPath:h}};return P(g_,g),g.root},__=(e,t,n)=>{const i=a(g_,y_),r=Symbol("nested item"),s=f(()=>l(v(e))??r),o={...i,id:s,open:(e,t)=>i.root.open(s.value,e,t),openOnSelect:(e,t)=>i.root.openOnSelect(s.value,e,t),isOpen:f(()=>i.root.opened.value.has(s.value)),parent:f(()=>i.root.parents.value.get(s.value)),activate:(e,t)=>i.root.activate(s.value,e,t),isActivated:f(()=>i.root.activated.value.has(s.value)),select:(e,t)=>i.root.select(s.value,e,t),isSelected:f(()=>"on"===i.root.selected.value.get(s.value)),isIndeterminate:f(()=>"indeterminate"===i.root.selected.value.get(s.value)),isLeaf:f(()=>!i.root.children.value.get(s.value)),isGroupActivator:i.isGroupActivator};return E(()=>{i.isGroupActivator||i.root.register(s.value,i.id.value,v(t),n)}),x(()=>{i.isGroupActivator||i.root.unregister(s.value)}),n&&P(g_,o),o};function I_(){const e=m(!1);D(()=>{window.requestAnimationFrame(()=>{e.value=!0})});return{ssrBootStyles:T(()=>e.value?void 0:{transition:"none !important"}),isBooted:$(e)}}const S_=He({name:"VListGroupActivator",setup(e,t){let{slots:n}=t;return(()=>{const e=a(g_,y_);P(g_,{...e,isGroupActivator:!0})})(),()=>{var e;return null==(e=n.default)?void 0:e.call(n)}}}),C_=oe({activeColor:String,baseColor:String,color:String,collapseIcon:{type:Ie,default:"$collapse"},disabled:Boolean,expandIcon:{type:Ie,default:"$expand"},rawId:[String,Number],prependIcon:Ie,appendIcon:Ie,fluid:Boolean,subgroup:Boolean,title:String,value:null,..._e(),...kb()},"VListGroup"),k_=se()({name:"VListGroup",props:C_(),setup(e,t){let{slots:n}=t;const{isOpen:a,open:i,id:r}=__(()=>e.value,()=>e.disabled,!0),s=f(()=>`v-list-group--id-${String(e.rawId??r.value)}`),o=l_(),{isBooted:l}=I_();function u(e){var t;["INPUT","TEXTAREA"].includes(null==(t=e.target)?void 0:t.tagName)||i(!a.value,e)}const c=f(()=>({onClick:u,class:"v-list-group__header",id:s.value})),d=f(()=>a.value?e.collapseIcon:e.expandIcon),h=f(()=>({VListItem:{activeColor:e.activeColor,baseColor:e.baseColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&d.value,appendIcon:e.appendIcon||!e.subgroup&&d.value,title:e.title,value:e.value}}));return be(()=>y(e.tag,{class:w(["v-list-group",{"v-list-group--prepend":null==o?void 0:o.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup,"v-list-group--open":a.value},e.class]),style:b(e.style)},{default:()=>[n.activator&&y(yb,{defaults:h.value},{default:()=>[y(S_,null,{default:()=>[n.activator({props:c.value,isOpen:a.value})]})]}),y(Pb,{transition:{component:i_},disabled:!l.value},{default:()=>{var e;return[A(_("div",{class:"v-list-group__items",role:"group","aria-labelledby":s.value},[null==(e=n.default)?void 0:e.call(n)]),[[V,a.value]])]}})]})),{isOpen:a}}}),E_=oe({opacity:[Number,String],..._e(),...kb()},"VListItemSubtitle"),x_=se()({name:"VListItemSubtitle",props:E_(),setup(e,t){let{slots:n}=t;return be(()=>y(e.tag,{class:w(["v-list-item-subtitle",e.class]),style:b([{"--v-list-item-subtitle-opacity":e.opacity},e.style])},n)),{}}}),T_=Ge("v-list-item-title"),A_=oe({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:Ie,baseColor:String,disabled:Boolean,lines:[Boolean,String],link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:Ie,ripple:{type:[Boolean,Object],default:!0},slim:Boolean,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},value:null,onClick:We(),onClickOnce:We(),...Ub(),..._e(),...zb(),...Tb(),...Yb(),...Db(),...Cw(),...kb(),...we(),...Kb({variant:"text"})},"VListItem"),N_=se()({name:"VListItem",directives:{vRipple:jw},props:A_(),emits:{click:e=>!0},setup(e,t){let{attrs:n,slots:a,emit:i}=t;const r=Sw(e,n),s=f(()=>void 0===e.value?r.href.value:e.value),{activate:o,isActivated:l,select:u,isOpen:c,isSelected:h,isIndeterminate:p,isGroupActivator:v,root:m,parent:g,openOnSelect:b,id:w}=__(s,()=>e.disabled,!1),I=l_(),S=f(()=>{var t;return!1!==e.active&&(e.active||(null==(t=r.isActive)?void 0:t.value)||(m.activatable.value?l.value:h.value))}),k=T(()=>!1!==e.link&&r.isLink.value),x=f(()=>!!I&&(m.selectable.value||m.activatable.value||null!=e.value)),V=f(()=>!e.disabled&&!1!==e.link&&(e.link||r.isClickable.value||x.value)),D=T(()=>e.rounded||e.nav),M=T(()=>e.color??e.activeColor),R=T(()=>({color:S.value?M.value??e.baseColor:e.baseColor,variant:e.variant}));function P(){null!=g.value&&m.open(g.value,!0),b(!0)}d(()=>{var e;return null==(e=r.isActive)?void 0:e.value},e=>{e&&P()}),E(()=>{var e;(null==(e=r.isActive)?void 0:e.value)&&P()});const{themeClasses:O}=Te(e),{borderClasses:L}=$b(e),{colorClasses:F,colorStyles:U,variantClasses:$}=Wb(R),{densityClasses:j}=qb(e),{dimensionStyles:z}=Ab(e),{elevationClasses:q}=Jb(e),{roundedClasses:H}=Mb(D),G=T(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),K=T(()=>void 0!==e.ripple&&e.ripple&&(null==I?void 0:I.filterable)?{keys:["Enter"]}:e.ripple),W=f(()=>({isActive:S.value,select:u,isOpen:c.value,isSelected:h.value,isIndeterminate:p.value}));function Q(t){var n,a;i("click",t),["INPUT","TEXTAREA"].includes(null==(n=t.target)?void 0:n.tagName)||V.value&&(null==(a=r.navigate)||a.call(r,t),v||(m.activatable.value?o(!l.value,t):(m.selectable.value||null!=e.value)&&u(!h.value,t)))}function X(e){const t=e.target;["INPUT","TEXTAREA"].includes(t.tagName)||("Enter"===e.key||" "===e.key&&!(null==I?void 0:I.filterable))&&(e.preventDefault(),e.stopPropagation(),e.target.dispatchEvent(new MouseEvent("click",e)))}return be(()=>{const t=k.value?"a":e.tag,n=a.title||null!=e.title,i=a.subtitle||null!=e.subtitle,s=!(!e.appendAvatar&&!e.appendIcon),o=!(!s&&!a.append),u=!(!e.prependAvatar&&!e.prependIcon),c=!(!u&&!a.prepend);return null==I||I.updateHasPrepend(c),e.activeColor&&Ke("active-color",["color","base-color"]),A(y(t,C({class:["v-list-item",{"v-list-item--active":S.value,"v-list-item--disabled":e.disabled,"v-list-item--link":V.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!c&&(null==I?void 0:I.hasPrepend.value),"v-list-item--slim":e.slim,[`${e.activeClass}`]:e.activeClass&&S.value},O.value,L.value,F.value,j.value,q.value,G.value,H.value,$.value,e.class],style:[U.value,z.value,e.style],tabindex:V.value?I?-2:0:void 0,"aria-selected":x.value?m.activatable.value?l.value:m.selectable.value?h.value:S.value:void 0,onClick:Q,onKeydown:V.value&&!k.value&&X},r.linkProps),{default:()=>{var t;return[Gb(V.value||S.value,"v-list-item"),c&&_("div",{key:"prepend",class:"v-list-item__prepend"},[a.prepend?y(yb,{key:"prepend-defaults",disabled:!u,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var e;return[null==(e=a.prepend)?void 0:e.call(a,W.value)]}}):_(N,null,[e.prependAvatar&&y(Xb,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&y(xb,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)]),_("div",{class:"v-list-item__spacer"},null)]),_("div",{class:"v-list-item__content","data-no-activator":""},[n&&y(T_,{key:"title"},{default:()=>{var t;return[(null==(t=a.title)?void 0:t.call(a,{title:e.title}))??B(e.title)]}}),i&&y(x_,{key:"subtitle"},{default:()=>{var t;return[(null==(t=a.subtitle)?void 0:t.call(a,{subtitle:e.subtitle}))??B(e.subtitle)]}}),null==(t=a.default)?void 0:t.call(a,W.value)]),o&&_("div",{key:"append",class:"v-list-item__append"},[a.append?y(yb,{key:"append-defaults",disabled:!s,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var e;return[null==(e=a.append)?void 0:e.call(a,W.value)]}}):_(N,null,[e.appendIcon&&y(xb,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&y(Xb,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)]),_("div",{class:"v-list-item__spacer"},null)])]}}),[[jw,V.value&&K.value]])}),{activate:o,isActivated:l,isGroupActivator:v,isSelected:h,list:I,select:u,root:m,id:w,link:r}}}),V_=oe({color:String,inset:Boolean,sticky:Boolean,title:String,..._e(),...kb()},"VListSubheader"),D_=se()({name:"VListSubheader",props:V_(),setup(e,t){let{slots:n}=t;const{textColorClasses:a,textColorStyles:i}=wb(()=>e.color);return be(()=>{const t=!(!n.default&&!e.title);return y(e.tag,{class:w(["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},a.value,e.class]),style:b([{textColorStyles:i},e.style])},{default:()=>{var a;return[t&&_("div",{class:"v-list-subheader__text"},[(null==(a=n.default)?void 0:a.call(n))??e.title])]}})}),{}}}),M_=oe({items:Array,returnObject:Boolean},"VListChildren"),R_=se()({name:"VListChildren",props:M_(),setup(e,t){let{slots:n}=t;return o_(),()=>{var t,a;return(null==(t=n.default)?void 0:t.call(n))??(null==(a=e.items)?void 0:a.map(t=>{var a,i;let{children:r,props:s,type:o,raw:l}=t;if("divider"===o)return(null==(a=n.divider)?void 0:a.call(n,{props:s}))??y(Gw,s,null);if("subheader"===o)return(null==(i=n.subheader)?void 0:i.call(n,{props:s}))??y(D_,s,null);const u={subtitle:n.subtitle?e=>{var t;return null==(t=n.subtitle)?void 0:t.call(n,{...e,item:l})}:void 0,prepend:n.prepend?e=>{var t;return null==(t=n.prepend)?void 0:t.call(n,{...e,item:l})}:void 0,append:n.append?e=>{var t;return null==(t=n.append)?void 0:t.call(n,{...e,item:l})}:void 0,title:n.title?e=>{var t;return null==(t=n.title)?void 0:t.call(n,{...e,item:l})}:void 0},c=k_.filterProps(s);return r?y(k_,C(c,{value:e.returnObject?l:null==s?void 0:s.value,rawId:null==s?void 0:s.value}),{activator:t=>{let{props:a}=t;const i=C(s,a,{value:e.returnObject?l:s.value});return n.header?n.header({props:i}):y(N_,i,u)},default:()=>y(R_,{items:r,returnObject:e.returnObject},n)}):n.item?n.item({props:s}):y(N_,C(s,{value:e.returnObject?l:s.value}),u)}))}}}),P_=oe({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},itemType:{type:[Boolean,String,Array,Function],default:"type"},returnObject:Boolean,valueComparator:Function},"list-items"),O_=new Set(["item","divider","subheader"]);function L_(e,t){const n=Ye(t,e.itemTitle,t),a=Ye(t,e.itemValue,n),i=Ye(t,e.itemChildren),r=!0===e.itemProps?"object"!=typeof t||null==t||Array.isArray(t)?void 0:"children"in t?Je(t,["children"]):t:Ye(t,e.itemProps);let s=Ye(t,e.itemType,"item");O_.has(s)||(s="item");const o={title:n,value:a,...r};return{type:s,title:String(o.title??""),value:o.value,props:o,children:"item"===s&&Array.isArray(i)?F_(e,i):void 0,raw:t}}function F_(e,t){const n=Xe(e,L_.neededProps),a=[];for(const i of t)a.push(L_(n,i));return a}function B_(e){const t=f(()=>F_(e,e.items)),n=f(()=>t.value.some(e=>null===e.value)),a=m(new Map),i=m([]);return L(()=>{const e=t.value,n=new Map,r=[];for(let t=0;t<e.length;t++){const a=e[t];if(Qe(a.value)||null===a.value){let e=n.get(a.value);e||(e=[],n.set(a.value,e)),e.push(a)}else r.push(a)}a.value=n,i.value=r}),{items:t,transformIn:function(r){const s=a.value,o=t.value,l=i.value,u=n.value,c=e.returnObject,d=!!e.valueComparator,h=e.valueComparator||Ne,p=Xe(e,L_.neededProps),f=[];e:for(const e of r){if(!u&&null===e)continue;if(c&&"string"==typeof e){f.push(L_(p,e));continue}const t=s.get(e);if(!d&&t)f.push(...t);else{for(const t of d?o:l)if(h(e,t.value)){f.push(t);continue e}f.push(L_(p,e))}}return f},transformOut:function(t){return e.returnObject?t.map(e=>{let{raw:t}=e;return t}):t.map(e=>{let{value:t}=e;return t})}}}L_.neededProps=["itemTitle","itemValue","itemChildren","itemProps","itemType"];const U_=new Set(["item","divider","subheader"]);function $_(e,t){const n=Qe(t)?t:Ye(t,e.itemTitle),a=Qe(t)?t:Ye(t,e.itemValue,void 0),i=Ye(t,e.itemChildren),r=!0===e.itemProps?Je(t,["children"]):Ye(t,e.itemProps);let s=Ye(t,e.itemType,"item");U_.has(s)||(s="item");const o={title:n,value:a,...r};return{type:s,title:o.title,value:o.value,props:o,children:"item"===s&&i?j_(e,i):void 0,raw:t}}function j_(e,t){const n=[];for(const a of t)n.push($_(e,a));return n}const z_=oe({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,filterable:Boolean,expandIcon:Ie,collapseIcon:Ie,lines:{type:[Boolean,String],default:"one"},slim:Boolean,nav:Boolean,"onClick:open":We(),"onClick:select":We(),"onUpdate:opened":We(),...b_({selectStrategy:"single-leaf",openStrategy:"list"}),...Ub(),..._e(),...zb(),...Tb(),...Yb(),...P_(),...Db(),...kb(),...we(),...Kb({variant:"text"})},"VList"),q_=se()({name:"VList",props:z_(),emits:{"update:selected":e=>!0,"update:activated":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:activate":e=>!0,"click:select":e=>!0},setup(e,n){let{slots:a}=n;const{items:i}=function(e){return{items:f(()=>j_(e,e.items))}}(e),{themeClasses:r}=Te(e),{backgroundColorClasses:s,backgroundColorStyles:o}=_b(()=>e.bgColor),{borderClasses:l}=$b(e),{densityClasses:u}=qb(e),{dimensionStyles:c}=Ab(e),{elevationClasses:d}=Jb(e),{roundedClasses:h}=Mb(e),{children:p,open:v,parents:g,select:_,getPath:I}=w_(e),S=T(()=>e.lines?`v-list--${e.lines}-line`:void 0),C=T(()=>e.activeColor),k=T(()=>e.baseColor),E=T(()=>e.color);o_({filterable:e.filterable}),le({VListGroup:{activeColor:C,baseColor:k,color:E,expandIcon:T(()=>e.expandIcon),collapseIcon:T(()=>e.collapseIcon)},VListItem:{activeClass:T(()=>e.activeClass),activeColor:C,baseColor:k,color:E,density:T(()=>e.density),disabled:T(()=>e.disabled),lines:T(()=>e.lines),nav:T(()=>e.nav),slim:T(()=>e.slim),variant:T(()=>e.variant)}});const x=m(!1),A=t();function N(e){x.value=!0}function V(e){x.value=!1}function D(e){var t;x.value||e.relatedTarget&&(null==(t=A.value)?void 0:t.contains(e.relatedTarget))||P()}function M(e){const t=e.target;if(A.value&&("INPUT"!==t.tagName||!["Home","End"].includes(e.key))&&"TEXTAREA"!==t.tagName){if("ArrowDown"===e.key)P("next");else if("ArrowUp"===e.key)P("prev");else if("Home"===e.key)P("first");else{if("End"!==e.key)return;P("last")}e.preventDefault()}}function R(e){x.value=!0}function P(e){if(A.value)return Ze(A.value,e)}return be(()=>y(e.tag,{ref:A,class:w(["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav,"v-list--slim":e.slim},r.value,s.value,l.value,u.value,d.value,S.value,h.value,e.class]),style:b([o.value,c.value,e.style]),tabindex:e.disabled?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:N,onFocusout:V,onFocus:D,onKeydown:M,onMousedown:R},{default:()=>[y(R_,{items:i.value,returnObject:e.returnObject},a)]})),{open:v,select:_,focus:P,children:p,parents:g,getPath:I}}});function H_(e,t){return{x:e.x+t.x,y:e.y+t.y}}function G_(e,t){if("top"===e.side||"bottom"===e.side){const{side:n,align:a}=e;return H_({x:"left"===a?0:"center"===a?t.width/2:"right"===a?t.width:a,y:"top"===n?0:"bottom"===n?t.height:n},t)}if("left"===e.side||"right"===e.side){const{side:n,align:a}=e;return H_({x:"left"===n?0:"right"===n?t.width:n,y:"top"===a?0:"center"===a?t.height/2:"bottom"===a?t.height:a},t)}return H_({x:t.width/2,y:t.height/2},t)}const K_={static:function(){},connected:function(e,t,n){(Array.isArray(e.target.value)||tt(e.target.value))&&Object.assign(n.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:a,preferredOrigin:i}=ue(()=>{const n=Oe(t.location,e.isRtl.value),a="overlap"===t.origin?n:"auto"===t.origin?nt(n):Oe(t.origin,e.isRtl.value);return n.side===a.side&&n.align===at(a).align?{preferredAnchor:it(n),preferredOrigin:it(a)}:{preferredAnchor:n,preferredOrigin:a}}),[r,s,o,l]=["minWidth","minHeight","maxWidth","maxHeight"].map(e=>f(()=>{const n=parseFloat(t[e]);return isNaN(n)?1/0:n})),u=f(()=>{if(Array.isArray(t.offset))return t.offset;if("string"==typeof t.offset){const e=t.offset.split(" ").map(parseFloat);return e.length<2&&e.push(0),e}return"number"==typeof t.offset?[t.offset,0]:[0,0]});let p=!1,v=-1;const m=new rt(4),g=new ResizeObserver(()=>{if(!p)return;if(requestAnimationFrame(e=>{e!==v&&m.clear(),requestAnimationFrame(e=>{v=e})}),m.isFull){const e=m.values();if(Ne(e.at(-1),e.at(-3))&&!Ne(e.at(-1),e.at(-2)))return}const e=b();e&&m.push(e.flipped)});let y=new st({x:0,y:0,width:0,height:0});function b(){if(p=!1,requestAnimationFrame(()=>p=!0),!e.target.value||!e.contentEl.value)return;(Array.isArray(e.target.value)||e.target.value.offsetParent||e.target.value.getClientRects().length)&&(y=ze(e.target.value));const t=function(e,t){const n=qe(e);t?n.x+=parseFloat(e.style.right||0):n.x-=parseFloat(e.style.left||0);return n.y-=parseFloat(e.style.top||0),n}(e.contentEl.value,e.isRtl.value),c=ot(e.contentEl.value);c.length||(c.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(t.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),t.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const d=c.reduce((e,t)=>{const n=lt(t);return e?new st({x:Math.max(e.left,n.left),y:Math.max(e.top,n.top),width:Math.min(e.right,n.right)-Math.max(e.left,n.left),height:Math.min(e.bottom,n.bottom)-Math.max(e.top,n.top)}):n},void 0);d.x+=12,d.y+=12,d.width-=24,d.height-=24;let h={anchor:a.value,origin:i.value};function f(e){const n=new st(t),a=G_(e.anchor,y),i=G_(e.origin,n);let{x:r,y:s}=function(e,t){return{x:e.x-t.x,y:e.y-t.y}}(a,i);switch(e.anchor.side){case"top":s-=u.value[0];break;case"bottom":s+=u.value[0];break;case"left":r-=u.value[0];break;case"right":r+=u.value[0]}switch(e.anchor.align){case"top":s-=u.value[1];break;case"bottom":s+=u.value[1];break;case"left":r-=u.value[1];break;case"right":r+=u.value[1]}n.x+=r,n.y+=s,n.width=Math.min(n.width,o.value),n.height=Math.min(n.height,l.value);return{overflows:ct(n,d),x:r,y:s}}let v=0,m=0;const g={x:0,y:0},b={x:!1,y:!1};let w=-1;for(;!(w++>10);){const{x:e,y:n,overflows:a}=f(h);v+=e,m+=n,t.x+=e,t.y+=n;{const e=ut(h.anchor),t=a.x.before||a.x.after,n=a.y.before||a.y.after;let i=!1;if(["x","y"].forEach(r=>{if("x"===r&&t&&!b.x||"y"===r&&n&&!b.y){const t={anchor:{...h.anchor},origin:{...h.origin}},n="x"===r?"y"===e?at:nt:"y"===e?nt:at;t.anchor=n(t.anchor),t.origin=n(t.origin);const{overflows:s}=f(t);(s[r].before<=a[r].before&&s[r].after<=a[r].after||s[r].before+s[r].after<(a[r].before+a[r].after)/2)&&(h=t,i=b[r]=!0)}}),i)continue}a.x.before&&(v+=a.x.before,t.x+=a.x.before),a.x.after&&(v-=a.x.after,t.x-=a.x.after),a.y.before&&(m+=a.y.before,t.y+=a.y.before),a.y.after&&(m-=a.y.after,t.y-=a.y.after);{const e=ct(t,d);g.x=d.width-e.x.before-e.x.after,g.y=d.height-e.y.before-e.y.after,v+=e.x.before,t.x+=e.x.before,m+=e.y.before,t.y+=e.y.before}break}const _=ut(h.anchor);return Object.assign(n.value,{"--v-overlay-anchor-origin":`${h.anchor.side} ${h.anchor.align}`,transformOrigin:`${h.origin.side} ${h.origin.align}`,top:me(Q_(m)),left:e.isRtl.value?void 0:me(Q_(v)),right:e.isRtl.value?me(Q_(-v)):void 0,minWidth:me("y"===_?Math.min(r.value,y.width):r.value),maxWidth:me(X_(Re(g.x,r.value===1/0?0:r.value,o.value))),maxHeight:me(X_(Re(g.y,s.value===1/0?0:s.value,l.value)))}),{available:g,contentBox:t,flipped:b}}return d(e.target,(e,t)=>{t&&!Array.isArray(t)&&g.unobserve(t),Array.isArray(e)?Ne(e,t)||b():e&&g.observe(e)},{immediate:!0}),d(e.contentEl,(e,t)=>{t&&g.unobserve(t),e&&g.observe(e)},{immediate:!0}),c(()=>{g.disconnect()}),d(()=>[a.value,i.value,t.offset,t.minWidth,t.minHeight,t.maxWidth,t.maxHeight],()=>b()),h(()=>{const e=b();if(!e)return;const{available:t,contentBox:n}=e;n.height>t.y&&requestAnimationFrame(()=>{b(),requestAnimationFrame(()=>{b()})})}),{updateLocation:b}}},W_=oe({locationStrategy:{type:[String,Function],default:"static",validator:e=>"function"==typeof e||e in K_},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function Q_(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function X_(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let Y_=!0;const J_=[];let Z_=-1;function eI(){cancelAnimationFrame(Z_),Z_=requestAnimationFrame(()=>{const e=J_.shift();e&&e(),J_.length?eI():Y_=!0})}const tI={none:null,close:function(e){iI(aI(e.target.value,e.contentEl.value),function(t){e.isActive.value=!1})},block:function(e,t){var n;const a=null==(n=e.root.value)?void 0:n.offsetParent,i=aI(e.target.value,e.contentEl.value),r=[...new Set([...ot(i,t.contained?a:void 0),...ot(e.contentEl.value,t.contained?a:void 0)])].filter(e=>!e.classList.contains("v-overlay-scroll-blocked")),s=window.innerWidth-document.documentElement.offsetWidth,o=(l=a||document.documentElement,dt(l)&&l);var l;o&&e.root.value.classList.add("v-overlay--scroll-blocked");r.forEach((e,t)=>{e.style.setProperty("--v-body-scroll-x",me(-e.scrollLeft)),e.style.setProperty("--v-body-scroll-y",me(-e.scrollTop)),e!==document.documentElement&&e.style.setProperty("--v-scrollbar-offset",me(s)),e.classList.add("v-overlay-scroll-blocked")}),c(()=>{r.forEach((e,t)=>{const n=parseFloat(e.style.getPropertyValue("--v-body-scroll-x")),a=parseFloat(e.style.getPropertyValue("--v-body-scroll-y")),i=e.style.scrollBehavior;e.style.scrollBehavior="auto",e.style.removeProperty("--v-body-scroll-x"),e.style.removeProperty("--v-body-scroll-y"),e.style.removeProperty("--v-scrollbar-offset"),e.classList.remove("v-overlay-scroll-blocked"),e.scrollLeft=-n,e.scrollTop=-a,e.style.scrollBehavior=i}),o&&e.root.value.classList.remove("v-overlay--scroll-blocked")})},reposition:function(e,t,n){let a=!1,i=-1,r=-1;function s(t){var n;n=()=>{var n,i;const r=performance.now();null==(i=(n=e.updateLocation).value)||i.call(n,t);const s=performance.now()-r;a=s/(1e3/60)>2},!Y_||J_.length?(J_.push(n),eI()):(Y_=!1,n(),eI())}r=("undefined"==typeof requestIdleCallback?e=>e():requestIdleCallback)(()=>{n.run(()=>{iI(aI(e.target.value,e.contentEl.value),e=>{a?(cancelAnimationFrame(i),i=requestAnimationFrame(()=>{i=requestAnimationFrame(()=>{s(e)})})):s(e)})})}),c(()=>{"undefined"!=typeof cancelIdleCallback&&cancelIdleCallback(r),cancelAnimationFrame(i)})}},nI=oe({scrollStrategy:{type:[String,Function],default:"block",validator:e=>"function"==typeof e||e in tI}},"VOverlay-scroll-strategies");function aI(e,t){return Array.isArray(e)?document.elementsFromPoint(...e).find(e=>!(null==t?void 0:t.contains(e))):e??t}function iI(e,t){const n=[document,...ot(e)];n.forEach(e=>{e.addEventListener("scroll",t,{passive:!0})}),c(()=>{n.forEach(e=>{e.removeEventListener("scroll",t)})})}const rI=Symbol.for("vuetify:v-menu"),sI=oe({closeDelay:[Number,String],openDelay:[Number,String]},"delay");const oI=oe({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...sI()},"VOverlay-activator");function lI(n,i){let{isActive:r,isTop:s,contentEl:o}=i;const l=xe("useActivator"),u=t();let p=!1,v=!1,m=!0;const g=f(()=>n.openOnFocus||null==n.openOnFocus&&n.openOnHover),y=f(()=>n.openOnClick||null==n.openOnClick&&!n.openOnHover&&!g.value),{runOpenDelay:b,runCloseDelay:w}=function(e,t){let n=()=>{};function a(a){null==n||n();const i=Number(a?e.openDelay:e.closeDelay);return new Promise(e=>{n=ht(i,()=>{null==t||t(a),e(a)})})}return{clearDelay:n,runOpenDelay:function(){return a(!0)},runCloseDelay:function(){return a(!1)}}}(n,e=>{e!==(n.openOnHover&&p||g.value&&v)||n.openOnHover&&r.value&&!s.value||(r.value!==e&&(m=!0),r.value=e)}),_=t(),I=e=>{e.stopPropagation(),u.value=e.currentTarget||e.target,r.value||(_.value=[e.clientX,e.clientY]),r.value=!r.value},S=e=>{var t;(null==(t=e.sourceCapabilities)?void 0:t.firesTouchEvents)||(p=!0,u.value=e.currentTarget||e.target,b())},k=e=>{p=!1,w()},E=e=>{!1!==ft(e.target,":focus-visible")&&(v=!0,e.stopPropagation(),u.value=e.currentTarget||e.target,b())},x=e=>{v=!1,e.stopPropagation(),w()},T=f(()=>{const e={};return y.value&&(e.onClick=I),n.openOnHover&&(e.onMouseenter=S,e.onMouseleave=k),g.value&&(e.onFocus=E,e.onBlur=x),e}),A=f(()=>{const e={};if(n.openOnHover&&(e.onMouseenter=()=>{p=!0,b()},e.onMouseleave=()=>{p=!1,w()}),g.value&&(e.onFocusin=()=>{v=!0,b()},e.onFocusout=()=>{v=!1,w()}),n.closeOnContentClick){const t=a(rI,null);e.onClick=()=>{r.value=!1,null==t||t.closeParents()}}return e}),N=f(()=>{const e={};return n.openOnHover&&(e.onMouseenter=()=>{m&&(p=!0,m=!1,b())},e.onMouseleave=()=>{p=!1,w()}),e});d(s,e=>{var t;!e||(!n.openOnHover||p||g.value&&v)&&(!g.value||v||n.openOnHover&&p)||(null==(t=o.value)?void 0:t.contains(document.activeElement))||(r.value=!1)}),d(r,e=>{e||setTimeout(()=>{_.value=void 0})},{flush:"post"});const V=pt();L(()=>{V.value&&h(()=>{u.value=V.el})});const D=pt(),M=f(()=>"cursor"===n.target&&_.value?_.value:D.value?D.el:uI(n.target,l)||u.value),R=f(()=>Array.isArray(M.value)?void 0:M.value);let P;return d(()=>!!n.activator,t=>{t&&Le?(P=e(),P.run(()=>{!function(e,t,n){let{activatorEl:a,activatorEvents:i}=n;function r(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.activatorProps;t&&vt(t,C(i.value,n))}function s(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.activatorProps;t&&mt(t,C(i.value,n))}function o(){const n=uI(arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.activator,t);return a.value=(null==n?void 0:n.nodeType)===Node.ELEMENT_NODE?n:void 0,a.value}d(()=>e.activator,(e,t)=>{if(t&&e!==t){const e=o(t);e&&s(e)}e&&h(()=>r())},{immediate:!0}),d(()=>e.activatorProps,()=>{r()}),c(()=>{s()})}(n,l,{activatorEl:u,activatorEvents:T})})):P&&P.stop()},{flush:"post",immediate:!0}),c(()=>{null==P||P.stop()}),{activatorEl:u,activatorRef:V,target:M,targetEl:R,targetRef:D,activatorEvents:T,contentEvents:A,scrimEvents:N}}function uI(e,t){var n,a;if(!e)return;let i;if("parent"===e){let e=null==(a=null==(n=null==t?void 0:t.proxy)?void 0:n.$el)?void 0:a.parentNode;for(;null==e?void 0:e.hasAttribute("data-no-activator");)e=e.parentNode;i=e}else i="string"==typeof e?document.querySelector(e):"$el"in e?e.$el:e;return i}const cI=oe({eager:Boolean},"lazy");function dI(e,t){const n=m(!1),a=T(()=>n.value||e.eager||t.value);return d(t,()=>n.value=!0),{isBooted:n,hasContent:a,onAfterLeave:function(){e.eager||(n.value=!1)}}}function hI(){const e=xe("useScopeId").vnode.scopeId;return{scopeId:e?{[e]:""}:void 0}}const pI=Symbol.for("vuetify:stack"),fI=r([]);function vI(){return!0}function mI(e,t,n){if(!e||!1===gI(e,n))return!1;const a=yt(t);if("undefined"!=typeof ShadowRoot&&a instanceof ShadowRoot&&a.host===e.target)return!1;const i=("object"==typeof n.value&&n.value.include||(()=>[]))();return i.push(t),!i.some(t=>null==t?void 0:t.contains(e.target))}function gI(e,t){return("object"==typeof t.value&&t.value.closeConditional||vI)(e)}function yI(e,t){const n=yt(e);t(document),"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot&&t(n)}const bI={mounted(e,t){const n=n=>function(e,t,n){const a="function"==typeof n.value?n.value:n.value.handler;e.shadowTarget=e.target,t._clickOutside.lastMousedownWasOutside&&mI(e,t,n)&&setTimeout(()=>{gI(e,n)&&a&&a(e)},0)}(n,e,t),a=n=>{e._clickOutside.lastMousedownWasOutside=mI(n,e,t)};yI(e,e=>{e.addEventListener("click",n,!0),e.addEventListener("mousedown",a,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!1}),e._clickOutside[t.instance.$.uid]={onClick:n,onMousedown:a}},beforeUnmount(e,t){e._clickOutside&&(yI(e,n=>{var a;if(!n||!(null==(a=e._clickOutside)?void 0:a[t.instance.$.uid]))return;const{onClick:i,onMousedown:r}=e._clickOutside[t.instance.$.uid];n.removeEventListener("click",i,!0),n.removeEventListener("mousedown",r,!0)}),delete e._clickOutside[t.instance.$.uid])}};function wI(e){const{modelValue:t,color:n,...a}=e;return y(S,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&_("div",C({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},a),null)]})}const _I=oe({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,opacity:[Number,String],noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...oI(),..._e(),...Tb(),...cI(),...W_(),...nI(),...we(),...Rb()},"VOverlay"),II=se()({name:"VOverlay",directives:{vClickOutside:bI},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,..._I()},emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,keydown:e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(n,i){let{slots:s,attrs:o,emit:u}=i;const p=xe("VOverlay"),g=t(),b=t(),w=t(),I=Ae(n,"modelValue"),S=f({get:()=>I.value,set:e=>{e&&n.disabled||(I.value=e)}}),{themeClasses:k}=Te(n),{rtlClasses:E,isRtl:M}=Pe(),{hasContent:R,onAfterLeave:O}=dI(n,S),F=_b(()=>"string"==typeof n.scrim?n.scrim:null),{globalTop:B,localTop:U,stackStyles:z}=function(e,t,n){const i=xe("useStack"),s=!n,o=a(pI,void 0),u=r({activeChildren:new Set});P(pI,u);const d=m(Number(v(t)));et(e,()=>{var e;const n=null==(e=fI.at(-1))?void 0:e[1];d.value=n?n+10:Number(v(t)),s&&fI.push([i.uid,d.value]),null==o||o.activeChildren.add(i.uid),c(()=>{if(s){const e=l(fI).findIndex(e=>e[0]===i.uid);fI.splice(e,1)}null==o||o.activeChildren.delete(i.uid)})});const h=m(!0);s&&L(()=>{var e;const t=(null==(e=fI.at(-1))?void 0:e[0])===i.uid;setTimeout(()=>h.value=t)});const p=T(()=>!u.activeChildren.size);return{globalTop:$(h),localTop:p,stackStyles:T(()=>({zIndex:d.value}))}}(S,()=>n.zIndex,n._disableGlobalStack),{activatorEl:q,activatorRef:H,target:G,targetEl:K,targetRef:W,activatorEvents:Q,contentEvents:X,scrimEvents:Y}=lI(n,{isActive:S,isTop:U,contentEl:w}),{teleportTarget:J}=function(e){return{teleportTarget:f(()=>{const t=e();if(!0===t||!Le)return;const n=!1===t?document.body:"string"==typeof t?document.querySelector(t):t;if(null==n)return;let a=[...n.children].find(e=>e.matches(".v-overlay-container"));return a||(a=document.createElement("div"),a.className="v-overlay-container",n.appendChild(a)),a})}}(()=>{var e,t,a;const i=n.attach||n.contained;if(i)return i;const r=(null==(e=null==q?void 0:q.value)?void 0:e.getRootNode())||(null==(a=null==(t=p.proxy)?void 0:t.$el)?void 0:a.getRootNode());return r instanceof ShadowRoot&&r}),{dimensionStyles:Z}=Ab(n),ee=function(){if(!Le)return m(!1);const{ssr:e}=gt();if(e){const e=m(!1);return D(()=>{e.value=!0}),e}return m(!0)}(),{scopeId:te}=hI();d(()=>n.disabled,e=>{e&&(S.value=!1)});const{contentStyles:ne,updateLocation:ae}=function(e,n){const a=t({}),i=t();function r(e){var t;null==(t=i.value)||t.call(i,e)}function s(e){var t;null==(t=i.value)||t.call(i,e)}function o(e){var t;null==(t=i.value)||t.call(i,e)}return Le&&et(()=>!(!n.isActive.value||!e.locationStrategy),t=>{var l,u;d(()=>e.locationStrategy,t),c(()=>{window.removeEventListener("resize",r),null==visualViewport||visualViewport.removeEventListener("resize",s),null==visualViewport||visualViewport.removeEventListener("scroll",o),i.value=void 0}),window.addEventListener("resize",r,{passive:!0}),null==visualViewport||visualViewport.addEventListener("resize",s,{passive:!0}),null==visualViewport||visualViewport.addEventListener("scroll",o,{passive:!0}),"function"==typeof e.locationStrategy?i.value=null==(l=e.locationStrategy(n,e,a))?void 0:l.updateLocation:i.value=null==(u=K_[e.locationStrategy](n,e,a))?void 0:u.updateLocation}),{contentStyles:a,updateLocation:i}}(n,{isRtl:M,contentEl:w,target:G,isActive:S});function ie(e){u("click:outside",e),n.persistent?he():S.value=!1}function re(e){return S.value&&B.value&&(!n.scrim||e.target===b.value||e instanceof MouseEvent&&e.shadowTarget===b.value)}function se(e){var t,a,i;"Escape"===e.key&&B.value&&((null==(t=w.value)?void 0:t.contains(document.activeElement))||u("keydown",e),n.persistent?he():(S.value=!1,(null==(a=w.value)?void 0:a.contains(document.activeElement))&&(null==(i=q.value)||i.focus())))}function oe(e){("Escape"!==e.key||B.value)&&u("keydown",e)}!function(t,n){if(!Le)return;let a;L(async()=>{null==a||a.stop(),n.isActive.value&&t.scrollStrategy&&(a=e(),await new Promise(e=>setTimeout(e)),a.active&&a.run(()=>{var e;"function"==typeof t.scrollStrategy?t.scrollStrategy(n,t,a):null==(e=tI[t.scrollStrategy])||e.call(tI,n,t,a)}))}),c(()=>{null==a||a.stop()})}(n,{root:g,contentEl:w,targetEl:K,target:G,isActive:S,updateLocation:ae}),Le&&d(S,e=>{e?window.addEventListener("keydown",se):window.removeEventListener("keydown",se)},{immediate:!0}),x(()=>{Le&&window.removeEventListener("keydown",se)});const le=null==(ce=null==(ue=xe("useRouter"))?void 0:ue.proxy)?void 0:ce.$router;var ue,ce;et(()=>n.closeOnBack,()=>{!function(e,t){let n,a,i=!1;function r(e){var t;(null==(t=e.state)?void 0:t.replaced)||(i=!0,setTimeout(()=>i=!1))}Le&&(null==e?void 0:e.beforeEach)&&(h(()=>{window.addEventListener("popstate",r),n=e.beforeEach((e,n,a)=>{kw?i?t(a):a():setTimeout(()=>i?t(a):a()),kw=!0}),a=null==e?void 0:e.afterEach(()=>{kw=!1})}),c(()=>{window.removeEventListener("popstate",r),null==n||n(),null==a||a()}))}(le,e=>{B.value&&S.value?(e(!1),n.persistent?he():S.value=!1):e()})});const de=t();function he(){n.noClickAnimation||w.value&&Be(w.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:$e})}function pe(){u("afterEnter")}function fe(){O(),u("afterLeave")}return d(()=>S.value&&(n.absolute||n.contained)&&null==J.value,e=>{if(e){const e=bt(g.value);e&&e!==document.scrollingElement&&(de.value=e.scrollTop)}}),be(()=>{var e;return _(N,null,[null==(e=s.activator)?void 0:e.call(s,{isActive:S.value,targetRef:W,props:C({ref:H},Q.value,n.activatorProps)}),ee.value&&R.value&&y(j,{disabled:!J.value,to:J.value},{default:()=>[_("div",C({class:["v-overlay",{"v-overlay--absolute":n.absolute||n.contained,"v-overlay--active":S.value,"v-overlay--contained":n.contained},k.value,E.value,n.class],style:[z.value,{"--v-overlay-opacity":n.opacity,top:me(de.value)},n.style],ref:g,onKeydown:oe},te,o),[y(wI,C({color:F,modelValue:S.value&&!!n.scrim,ref:b},Y.value),null),y(Pb,{appear:!0,persisted:!0,transition:n.transition,target:G.value,onAfterEnter:pe,onAfterLeave:fe},{default:()=>{var e;return[A(_("div",C({ref:w,class:["v-overlay__content",n.contentClass],style:[Z.value,ne.value]},X.value,n.contentProps),[null==(e=s.default)?void 0:e.call(s,{isActive:S})]),[[V,S.value],[bI,{handler:ie,closeConditional:re,include:()=>[q.value]}]])]}})])]})])}),{activatorEl:q,scrimEl:b,target:G,animateClick:he,contentEl:w,globalTop:B,localTop:U,updateLocation:ae}}}),SI=Symbol("Forwarded refs");function CI(e,t){let n=e;for(;n;){const e=Reflect.getOwnPropertyDescriptor(n,t);if(e)return e;n=Object.getPrototypeOf(n)}}function kI(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return e[SI]=n,new Proxy(e,{get(e,t){if(Reflect.has(e,t))return Reflect.get(e,t);if("symbol"!=typeof t&&!t.startsWith("$")&&!t.startsWith("__"))for(const a of n)if(a.value&&Reflect.has(a.value,t)){const e=Reflect.get(a.value,t);return"function"==typeof e?e.bind(a.value):e}},has(e,t){if(Reflect.has(e,t))return!0;if("symbol"==typeof t||t.startsWith("$")||t.startsWith("__"))return!1;for(const a of n)if(a.value&&Reflect.has(a.value,t))return!0;return!1},set(e,t,a){if(Reflect.has(e,t))return Reflect.set(e,t,a);if("symbol"==typeof t||t.startsWith("$")||t.startsWith("__"))return!1;for(const i of n)if(i.value&&Reflect.has(i.value,t))return Reflect.set(i.value,t,a);return!1},getOwnPropertyDescriptor(e,t){var a;const i=Reflect.getOwnPropertyDescriptor(e,t);if(i)return i;if("symbol"!=typeof t&&!t.startsWith("$")&&!t.startsWith("__")){for(const e of n){if(!e.value)continue;const n=CI(e.value,t)??("_"in e.value?CI(null==(a=e.value._)?void 0:a.setupState,t):void 0);if(n)return n}for(const e of n){const n=e.value&&e.value[SI];if(!n)continue;const a=n.slice();for(;a.length;){const e=a.shift(),n=CI(e.value,t);if(n)return n;const i=e.value&&e.value[SI];i&&a.push(...i)}}}}})}const EI=oe({id:String,submenu:Boolean,disableInitialFocus:Boolean,...Je(_I({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:Zw}}),["absolute"])},"VMenu"),xI=se()({name:"VMenu",props:EI(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:i}=n;const r=Ae(e,"modelValue"),{scopeId:s}=hI(),{isRtl:o}=Pe(),l=R(),u=T(()=>e.id||`v-menu-${l}`),c=t(),p=a(rI,null),v=m(new Set);async function g(e){var t,n,a;const i=e.relatedTarget,s=e.target;if(await h(),r.value&&i!==s&&(null==(t=c.value)?void 0:t.contentEl)&&(null==(n=c.value)?void 0:n.globalTop)&&![document,c.value.contentEl].includes(s)&&!c.value.contentEl.contains(s)){null==(a=wt(c.value.contentEl)[0])||a.focus()}}function b(e){null==p||p.closeParents(e)}function w(t){var n,a,i,s,l;if(!e.disabled)if("Tab"===t.key||"Enter"===t.key&&!e.closeOnContentClick){if("Enter"===t.key&&(t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLInputElement&&t.target.closest("form")))return;"Enter"===t.key&&t.preventDefault();_t(wt(null==(n=c.value)?void 0:n.contentEl,!1),t.shiftKey?"prev":"next",e=>e.tabIndex>=0)||(r.value=!1,null==(i=null==(a=c.value)?void 0:a.activatorEl)||i.focus())}else e.submenu&&t.key===(o.value?"ArrowRight":"ArrowLeft")&&(r.value=!1,null==(l=null==(s=c.value)?void 0:s.activatorEl)||l.focus())}function _(t){var n;if(e.disabled)return;const a=null==(n=c.value)?void 0:n.contentEl;a&&r.value?"ArrowDown"===t.key?(t.preventDefault(),t.stopImmediatePropagation(),Ze(a,"next")):"ArrowUp"===t.key?(t.preventDefault(),t.stopImmediatePropagation(),Ze(a,"prev")):e.submenu&&(t.key===(o.value?"ArrowRight":"ArrowLeft")?r.value=!1:t.key===(o.value?"ArrowLeft":"ArrowRight")&&(t.preventDefault(),Ze(a,"first"))):(e.submenu?t.key===(o.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(t.key))&&(r.value=!0,t.preventDefault(),setTimeout(()=>setTimeout(()=>_(t))))}P(rI,{register(){v.value.add(l)},unregister(){v.value.delete(l)},closeParents(t){setTimeout(()=>{var n;v.value.size||e.persistent||null!=t&&(!(null==(n=c.value)?void 0:n.contentEl)||It(t,c.value.contentEl))||(r.value=!1,null==p||p.closeParents())},40)}}),x(()=>{null==p||p.unregister(),document.removeEventListener("focusin",g)}),z(()=>r.value=!1),d(r,t=>{t?(null==p||p.register(),Le&&!e.disableInitialFocus&&document.addEventListener("focusin",g,{once:!0})):(null==p||p.unregister(),Le&&document.removeEventListener("focusin",g))},{immediate:!0});const I=f(()=>C({"aria-haspopup":"menu","aria-expanded":String(r.value),"aria-controls":u.value,onKeydown:_},e.activatorProps));return be(()=>{const t=II.filterProps(e);return y(II,C({ref:c,id:u.value,class:["v-menu",e.class],style:e.style},t,{modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,absolute:!0,activatorProps:I.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":b,onKeydown:w},s),{activator:i.activator,default:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return y(yb,{root:"VMenu"},{default:()=>{var e;return[null==(e=i.default)?void 0:e.call(i,...t)]}})}})}),kI({id:u,"ΨopenChildren":v},c)}}),TI={key:0},AI={key:1,class:"text-body-2 font-weight-medium"},NI={key:1},VI=mb({__name:"AuthStatus",props:{user:{type:Object,default:null}},emits:["login","logout"],setup(e,{emit:t}){const n=t,a=()=>{n("login")},i=()=>{n("logout")};return(t,n)=>(H(),q("div",null,[e.user?(H(),q("div",TI,[y(xI,{location:"bottom"},{activator:G(({props:t})=>[y(qw,C({icon:""},t,{variant:"text",class:"minimal-user-button"}),{default:G(()=>[y(Xb,{color:"primary",size:"32",class:"minimal-avatar"},{default:G(()=>{var t;return[e.user.photoURL?(H(),W(Bb,{key:0,src:e.user.photoURL,alt:e.user.displayName},null,8,["src","alt"])):(H(),q("span",AI,B(null==(t=e.user.displayName)?void 0:t.charAt(0)),1))]}),_:1})]),_:2},1040)]),default:G(()=>[y(q_,{class:"minimal-menu"},{default:G(()=>[y(N_,{title:e.user.displayName,subtitle:e.user.email,class:"minimal-menu-item"},null,8,["title","subtitle"]),y(Gw,{class:"minimal-divider"}),y(N_,{onClick:i,"prepend-icon":"mdi-logout",class:"minimal-menu-item"},{default:G(()=>[y(T_,{class:"text-body-2"},{default:G(()=>n[0]||(n[0]=[K("ログアウト",-1)])),_:1,__:[0]})]),_:1})]),_:1})]),_:1})])):(H(),q("div",NI,[y(qw,{onClick:a,"prepend-icon":"mdi-google",variant:"outlined",color:"primary",class:"minimal-login-button"},{default:G(()=>n[1]||(n[1]=[K(" Googleでログイン ",-1)])),_:1,__:[1]})]))]))}},[["__scopeId","data-v-91d386da"]]),DI=oe({text:String,onClick:We(),..._e(),...we()},"VLabel"),MI=se()({name:"VLabel",props:DI(),setup(e,t){let{slots:n}=t;return be(()=>{var t;return _("label",{class:w(["v-label",{"v-label--clickable":!!e.onClick},e.class]),style:b(e.style),onClick:e.onClick},[e.text,null==(t=n.default)?void 0:t.call(n)])}),{}}}),RI=Symbol.for("vuetify:selection-control-group"),PI=oe({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:Ie,trueIcon:Ie,ripple:{type:[Boolean,Object],default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:Ne},..._e(),...zb(),...we()},"SelectionControlGroup"),OI=oe({...PI({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");se()({name:"VSelectionControlGroup",props:OI(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const a=Ae(e,"modelValue"),i=R(),r=T(()=>e.id||`v-selection-control-group-${i}`),s=T(()=>e.name||r.value),o=new Set;return P(RI,{modelValue:a,forceUpdate:()=>{o.forEach(e=>e())},onForceUpdate:e=>{o.add(e),c(()=>{o.delete(e)})}}),le({[e.defaultsTarget]:{color:T(()=>e.color),disabled:T(()=>e.disabled),density:T(()=>e.density),error:T(()=>e.error),inline:T(()=>e.inline),modelValue:a,multiple:T(()=>!!e.multiple||null==e.multiple&&Array.isArray(a.value)),name:s,falseIcon:T(()=>e.falseIcon),trueIcon:T(()=>e.trueIcon),readonly:T(()=>e.readonly),ripple:T(()=>e.ripple),type:T(()=>e.type),valueComparator:T(()=>e.valueComparator)}}),be(()=>{var t;return _("div",{class:w(["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class]),style:b(e.style),role:"radio"===e.type?"radiogroup":void 0},[null==(t=n.default)?void 0:t.call(n)])}),{}}});const LI=oe({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,..._e(),...PI()},"VSelectionControl");const FI=se()({name:"VSelectionControl",directives:{vRipple:jw},inheritAttrs:!1,props:LI(),emits:{"update:modelValue":e=>!0},setup(e,n){let{attrs:i,slots:r}=n;const{group:s,densityClasses:o,icon:l,model:u,textColorClasses:c,textColorStyles:d,backgroundColorClasses:p,backgroundColorStyles:v,trueValue:g}=function(e){const t=a(RI,void 0),{densityClasses:n}=qb(e),i=Ae(e,"modelValue"),r=f(()=>void 0!==e.trueValue?e.trueValue:void 0===e.value||e.value),s=f(()=>void 0!==e.falseValue&&e.falseValue),o=f(()=>!!e.multiple||null==e.multiple&&Array.isArray(i.value)),l=f({get(){const n=t?t.modelValue.value:i.value;return o.value?Ve(n).some(t=>e.valueComparator(t,r.value)):e.valueComparator(n,r.value)},set(n){if(e.readonly)return;const a=n?r.value:s.value;let l=a;o.value&&(l=n?[...Ve(i.value),a]:Ve(i.value).filter(t=>!e.valueComparator(t,r.value))),t?t.modelValue.value=l:i.value=l}}),{textColorClasses:u,textColorStyles:c}=wb(()=>{if(!e.error&&!e.disabled)return l.value?e.color:e.baseColor}),{backgroundColorClasses:d,backgroundColorStyles:h}=_b(()=>!l.value||e.error||e.disabled?e.baseColor:e.color),p=f(()=>l.value?e.trueIcon:e.falseIcon);return{group:t,densityClasses:n,trueValue:r,falseValue:s,model:l,textColorClasses:u,textColorStyles:c,backgroundColorClasses:d,backgroundColorStyles:h,icon:p}}(e),I=R(),S=m(!1),k=m(!1),E=t(),x=T(()=>e.id||`input-${I}`),V=T(()=>!e.disabled&&!e.readonly);function D(e){V.value&&(S.value=!0,!1!==ft(e.target,":focus-visible")&&(k.value=!0))}function M(){S.value=!1,k.value=!1}function P(e){e.stopPropagation()}function O(t){V.value?(e.readonly&&s&&h(()=>s.forceUpdate()),u.value=t.target.checked):E.value&&(E.value.checked=u.value)}return null==s||s.onForceUpdate(()=>{E.value&&(E.value.checked=u.value)}),be(()=>{var t,n;const a=r.label?r.label({label:e.label,props:{for:x.value}}):e.label,[s,h]=St(i),f=_("input",C({ref:E,checked:u.value,disabled:!!e.disabled,id:x.value,onBlur:M,onFocus:D,onInput:O,"aria-disabled":!!e.disabled,"aria-label":e.label,type:e.type,value:g.value,name:e.name,"aria-checked":"checkbox"===e.type?u.value:void 0},h),null);return _("div",C({class:["v-selection-control",{"v-selection-control--dirty":u.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":S.value,"v-selection-control--focus-visible":k.value,"v-selection-control--inline":e.inline},o.value,e.class]},s,{style:e.style}),[_("div",{class:w(["v-selection-control__wrapper",c.value]),style:b(d.value)},[null==(t=r.default)?void 0:t.call(r,{backgroundColorClasses:p,backgroundColorStyles:v}),A(_("div",{class:w(["v-selection-control__input"])},[(null==(n=r.input)?void 0:n.call(r,{model:u,textColorClasses:c,textColorStyles:d,backgroundColorClasses:p,backgroundColorStyles:v,inputNode:f,icon:l.value,props:{onFocus:D,onBlur:M,id:x.value}}))??_(N,null,[l.value&&y(xb,{key:"icon",icon:l.value},null),f])]),[[jw,!e.disabled&&!e.readonly&&e.ripple,null,{center:!0,circle:!0}]])]),a&&y(MI,{for:x.value,onClick:P},{default:()=>[a]})])}),{isFocused:S,input:E}}}),BI=oe({indeterminate:Boolean,indeterminateIcon:{type:Ie,default:"$checkboxIndeterminate"},...LI({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),UI=se()({name:"VCheckboxBtn",props:BI(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,t){let{slots:n}=t;const a=Ae(e,"indeterminate"),i=Ae(e,"modelValue");function r(e){a.value&&(a.value=!1)}const s=T(()=>a.value?e.indeterminateIcon:e.falseIcon),o=T(()=>a.value?e.indeterminateIcon:e.trueIcon);return be(()=>{const t=Je(FI.filterProps(e),["modelValue"]);return y(FI,C(t,{modelValue:i.value,"onUpdate:modelValue":[e=>i.value=e,r],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:s.value,trueIcon:o.value,"aria-checked":a.value?"mixed":void 0}),n)}),{}}});function $I(e){const{t:t}=Ct();return{InputIcon:function(n){let{name:a,color:i,...r}=n;const s={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[a],o=e[`onClick:${a}`],l=o&&s?t(`$vuetify.input.${s}`,e.label??""):void 0;return y(xb,C({icon:e[`${a}Icon`],"aria-label":l,onClick:o,onKeydown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),kt(o,new PointerEvent("click",e)))},color:i},r),null)}}}const jI=oe({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},..._e(),...Rb({transition:{component:a_,leaveAbsolute:!0,group:!0}})},"VMessages"),zI=se()({name:"VMessages",props:jI(),setup(e,t){let{slots:n}=t;const a=f(()=>Ve(e.messages)),{textColorClasses:i,textColorStyles:r}=wb(()=>e.color);return be(()=>y(Pb,{transition:e.transition,tag:"div",class:w(["v-messages",i.value,e.class]),style:b([r.value,e.style])},{default:()=>[e.active&&a.value.map((e,t)=>_("div",{class:"v-messages__message",key:`${t}-${a.value}`},[n.message?n.message({message:e}):e]))]})),{}}}),qI=oe({focused:Boolean,"onUpdate:focused":We()},"focus");function HI(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();const n=Ae(e,"focused");return{focusClasses:T(()=>({[`${t}--focused`]:n.value})),isFocused:n,focus:function(){n.value=!0},blur:function(){n.value=!1}}}const GI=Symbol.for("vuetify:form"),KI=oe({disabled:Boolean,fastFail:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function WI(e){const t=a(GI,null);return{...t,isReadonly:f(()=>!!((null==e?void 0:e.readonly)??(null==t?void 0:t.isReadonly.value))),isDisabled:f(()=>!!((null==e?void 0:e.disabled)??(null==t?void 0:t.isDisabled.value)))}}const QI=Symbol.for("vuetify:rules");const XI=oe({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...qI()},"validation");function YI(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R();const r=Ae(e,"modelValue"),s=f(()=>void 0===e.validationValue?r.value:e.validationValue),o=WI(e),l=function(e){const t=a(QI,null);if(!e){if(!t)throw new Error("Could not find Vuetify rules injection");return t.aliases}return(null==t?void 0:t.resolve(e))??T(e)}(()=>e.rules),u=t([]),c=m(!0),p=f(()=>!(!Ve(""===r.value?null:r.value).length&&!Ve(""===s.value?null:s.value).length)),v=f(()=>{var t;return(null==(t=e.errorMessages)?void 0:t.length)?Ve(e.errorMessages).concat(u.value).slice(0,Math.max(0,Number(e.maxErrors))):u.value}),g=f(()=>{var t;let n=(e.validateOn??(null==(t=o.validateOn)?void 0:t.value))||"input";"lazy"===n&&(n="input lazy"),"eager"===n&&(n="input eager");const a=new Set((null==n?void 0:n.split(" "))??[]);return{input:a.has("input"),blur:a.has("blur")||a.has("input")||a.has("invalid-input"),invalidInput:a.has("invalid-input"),lazy:a.has("lazy"),eager:a.has("eager")}}),y=f(()=>{var t;return!e.error&&!(null==(t=e.errorMessages)?void 0:t.length)&&(!e.rules.length||(c.value?!u.value.length&&!g.value.lazy||null:!u.value.length))}),b=m(!1),w=f(()=>({[`${n}--error`]:!1===y.value,[`${n}--dirty`]:p.value,[`${n}--disabled`]:o.isDisabled.value,[`${n}--readonly`]:o.isReadonly.value})),_=xe("validation"),I=f(()=>e.name??O(i));async function S(){r.value=null,await h(),await C()}async function C(){c.value=!0,g.value.lazy?u.value=[]:await k(!g.value.eager)}async function k(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=[];b.value=!0;for(const a of l.value){if(n.length>=Number(e.maxErrors??1))break;const t="function"==typeof a?a:()=>a,i=await t(s.value);!0!==i&&(!1!==i&&"string"!=typeof i||n.push(i||""))}return u.value=n,b.value=!1,c.value=t,u.value}return E(()=>{var e;null==(e=o.register)||e.call(o,{id:I.value,vm:_,validate:k,reset:S,resetValidation:C})}),x(()=>{var e;null==(e=o.unregister)||e.call(o,I.value)}),D(async()=>{var e;g.value.lazy||await k(!g.value.eager),null==(e=o.update)||e.call(o,I.value,y.value,v.value)}),et(()=>g.value.input||g.value.invalidInput&&!1===y.value,()=>{d(s,()=>{if(null!=s.value)k();else if(e.focused){const t=d(()=>e.focused,e=>{e||k(),t()})}})}),et(()=>g.value.blur,()=>{d(()=>e.focused,e=>{e||k()})}),d([y,v],()=>{var e;null==(e=o.update)||e.call(o,I.value,y.value,v.value)}),{errorMessages:v,isDirty:p,isDisabled:o.isDisabled,isReadonly:o.isReadonly,isPristine:c,isValid:y,isValidating:b,reset:S,resetValidation:C,validate:k,validationClasses:w}}const JI=oe({id:String,appendIcon:Ie,baseColor:String,centerAffix:{type:Boolean,default:!0},color:String,glow:Boolean,iconColor:[Boolean,String],prependIcon:Ie,hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":We(),"onClick:append":We(),..._e(),...zb(),...Xe(Tb(),["maxWidth","minWidth","width"]),...we(),...XI()},"VInput"),ZI=se()({name:"VInput",props:{...JI()},emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:a,emit:i}=t;const{densityClasses:r}=qb(e),{dimensionStyles:s}=Ab(e),{themeClasses:o}=Te(e),{rtlClasses:l}=Pe(),{InputIcon:u}=$I(e),c=R(),d=f(()=>e.id||`input-${c}`),{errorMessages:h,isDirty:p,isDisabled:v,isReadonly:m,isPristine:g,isValid:I,isValidating:S,reset:C,resetValidation:k,validate:E,validationClasses:x}=YI(e,"v-input",d),A=f(()=>{var t;return(null==(t=e.errorMessages)?void 0:t.length)||!g.value&&h.value.length?h.value:e.hint&&(e.persistentHint||e.focused)?e.hint:e.messages}),N=T(()=>A.value.length>0),V=T(()=>!e.hideDetails||"auto"===e.hideDetails&&(N.value||!!a.details)),D=f(()=>V.value?`${d.value}-messages`:void 0),M=f(()=>({id:d,messagesId:D,isDirty:p,isDisabled:v,isReadonly:m,isPristine:g,isValid:I,isValidating:S,hasDetails:V,reset:C,resetValidation:k,validate:E})),P=T(()=>e.error||e.disabled?void 0:e.focused?e.color:e.baseColor),O=T(()=>{if(e.iconColor)return!0===e.iconColor?P.value:e.iconColor});return be(()=>{var t,n,i,c;const d=!(!a.prepend&&!e.prependIcon),h=!(!a.append&&!e.appendIcon);return _("div",{class:w(["v-input",`v-input--${e.direction}`,{"v-input--center-affix":e.centerAffix,"v-input--focused":e.focused,"v-input--glow":e.glow,"v-input--hide-spin-buttons":e.hideSpinButtons},r.value,o.value,l.value,x.value,e.class]),style:b([s.value,e.style])},[d&&_("div",{key:"prepend",class:"v-input__prepend"},[null==(t=a.prepend)?void 0:t.call(a,M.value),e.prependIcon&&y(u,{key:"prepend-icon",name:"prepend",color:O.value},null)]),a.default&&_("div",{class:"v-input__control"},[null==(n=a.default)?void 0:n.call(a,M.value)]),h&&_("div",{key:"append",class:"v-input__append"},[e.appendIcon&&y(u,{key:"append-icon",name:"append",color:O.value},null),null==(i=a.append)?void 0:i.call(a,M.value)]),V.value&&_("div",{id:D.value,class:"v-input__details",role:"alert","aria-live":"polite"},[y(zI,{active:N.value,messages:A.value},{message:a.message}),null==(c=a.details)?void 0:c.call(a,M.value)])])}),{reset:C,resetValidation:k,validate:E,isValid:I,errorMessages:h}}}),eS=oe({...JI(),...Je(BI(),["inline"])},"VCheckbox"),tS=se()({name:"VCheckbox",inheritAttrs:!1,props:eS(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,n){let{attrs:a,slots:i}=n;const r=Ae(e,"modelValue"),{isFocused:s,focus:o,blur:l}=HI(e),u=t(),c=R();return be(()=>{const[t,n]=St(a),d=ZI.filterProps(e),h=UI.filterProps(e);return y(ZI,C({ref:u,class:["v-checkbox",e.class]},t,d,{modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,id:e.id||`checkbox-${c}`,focused:s.value,style:e.style}),{...i,default:e=>{let{id:t,messagesId:a,isDisabled:s,isReadonly:u,isValid:c}=e;return y(UI,C(h,{id:t.value,"aria-describedby":a.value,disabled:s.value,readonly:u.value},n,{error:!1===c.value,modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,onFocus:o,onBlur:l}),i)}})}),kI({},u)}});function nS(e,t){return(null==t?void 0:t[e?"scrollWidth":"scrollHeight"])||0}function aS(e,t,n){if(!n)return 0;const{scrollLeft:a,offsetWidth:i,scrollWidth:r}=n;return e?t?r-i+a:a:n.scrollTop}function iS(e,t){return(null==t?void 0:t[e?"offsetWidth":"offsetHeight"])||0}function rS(e,t){return(null==t?void 0:t[e?"offsetLeft":"offsetTop"])||0}const sS=Symbol.for("vuetify:v-slide-group"),oS=oe({centerActive:Boolean,contentClass:null,direction:{type:String,default:"horizontal"},symbol:{type:null,default:sS},nextIcon:{type:Ie,default:"$next"},prevIcon:{type:Ie,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>"boolean"==typeof e||["always","desktop","mobile"].includes(e)},..._e(),...Et({mobile:null}),...kb(),...tw({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),lS=se()({name:"VSlideGroup",props:oS(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{isRtl:a}=Pe(),{displayClasses:i,mobile:r}=gt(e),s=iw(e,e.symbol),o=m(!1),l=m(0),u=m(0),c=m(0),h=f(()=>"horizontal"===e.direction),{resizeRef:p,contentRect:v}=Me(),{resizeRef:g,contentRect:I}=Me(),S=xt(),C=f(()=>({container:p.el,duration:200,easing:"easeOutQuart"})),k=f(()=>s.selected.value.length?s.items.value.findIndex(e=>e.id===s.selected.value[0]):-1),E=f(()=>s.selected.value.length?s.items.value.findIndex(e=>e.id===s.selected.value[s.selected.value.length-1]):-1);if(Le){let t=-1;d(()=>[s.selected.value,v.value,I.value,h.value],()=>{cancelAnimationFrame(t),t=requestAnimationFrame(()=>{if(v.value&&I.value){const e=h.value?"width":"height";u.value=v.value[e],c.value=I.value[e],o.value=u.value+1<c.value}if(k.value>=0&&g.el){T(g.el.children[E.value],e.centerActive)}})})}const x=m(!1);function T(e,t){let n=0;n=t?function(e){let{selectedElement:t,containerElement:n,isHorizontal:a}=e;const i=iS(a,n);return rS(a,t)-i/2+iS(a,t)/2}({containerElement:p.el,isHorizontal:h.value,selectedElement:e}):function(e){let{selectedElement:t,containerElement:n,isRtl:a,isHorizontal:i}=e;const r=iS(i,n),s=aS(i,a,n),o=iS(i,t),l=rS(i,t),u=.4*o;return s>l?l-u:s+r<l+o?l-r+o+u:s}({containerElement:p.el,isHorizontal:h.value,isRtl:a.value,selectedElement:e}),A(n)}function A(e){if(!Le||!p.el)return;const t=iS(h.value,p.el),n=aS(h.value,a.value,p.el);if(!(nS(h.value,p.el)<=t||Math.abs(e-n)<16)){if(h.value&&a.value&&p.el){const{scrollWidth:t,offsetWidth:n}=p.el;e=t-n-e}h.value?S.horizontal(e,C.value):S(e,C.value)}}function N(e){const{scrollTop:t,scrollLeft:n}=e.target;l.value=h.value?n:t}function V(e){if(x.value=!0,o.value&&g.el)for(const t of e.composedPath())for(const e of g.el.children)if(e===t)return void T(e)}function D(e){x.value=!1}let M=!1;function R(e){var t;M||x.value||e.relatedTarget&&(null==(t=g.el)?void 0:t.contains(e.relatedTarget))||F(),M=!1}function P(){M=!0}function O(e){function t(t){e.preventDefault(),F(t)}g.el&&(h.value?"ArrowRight"===e.key?t(a.value?"prev":"next"):"ArrowLeft"===e.key&&t(a.value?"next":"prev"):"ArrowDown"===e.key?t("next"):"ArrowUp"===e.key&&t("prev"),"Home"===e.key?t("first"):"End"===e.key&&t("last"))}function L(e,t){if(!e)return;let n=e;do{n=null==n?void 0:n["next"===t?"nextElementSibling":"previousElementSibling"]}while(null==n?void 0:n.hasAttribute("disabled"));return n}function F(e){if(!g.el)return;let t;if(e)if("next"===e){if(t=L(g.el.querySelector(":focus"),e),!t)return F("first")}else if("prev"===e){if(t=L(g.el.querySelector(":focus"),e),!t)return F("last")}else"first"===e?(t=g.el.firstElementChild,(null==t?void 0:t.hasAttribute("disabled"))&&(t=L(t,"next"))):"last"===e&&(t=g.el.lastElementChild,(null==t?void 0:t.hasAttribute("disabled"))&&(t=L(t,"prev")));else{t=wt(g.el)[0]}t&&t.focus({preventScroll:!0})}function B(e){const t=h.value&&a.value?-1:1,n=("prev"===e?-t:t)*u.value;let i=l.value+n;if(h.value&&a.value&&p.el){const{scrollWidth:e,offsetWidth:t}=p.el;i+=e-t}A(i)}const U=f(()=>({next:s.next,prev:s.prev,select:s.select,isSelected:s.isSelected})),$=f(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!r.value;case!0:return o.value||Math.abs(l.value)>0;case"mobile":return r.value||o.value||Math.abs(l.value)>0;default:return!r.value&&(o.value||Math.abs(l.value)>0)}}),j=f(()=>Math.abs(l.value)>1),z=f(()=>{if(!p.value)return!1;const e=nS(h.value,p.el),t=function(e,t){return(null==t?void 0:t[e?"clientWidth":"clientHeight"])||0}(h.value,p.el);return e-t-Math.abs(l.value)>1});return be(()=>y(e.tag,{class:w(["v-slide-group",{"v-slide-group--vertical":!h.value,"v-slide-group--has-affixes":$.value,"v-slide-group--is-overflowing":o.value},i.value,e.class]),style:b(e.style),tabindex:x.value||s.selected.value.length?-1:0,onFocus:R},{default:()=>{var t,i,r;return[$.value&&_("div",{key:"prev",class:w(["v-slide-group__prev",{"v-slide-group__prev--disabled":!j.value}]),onMousedown:P,onClick:()=>j.value&&B("prev")},[(null==(t=n.prev)?void 0:t.call(n,U.value))??y(n_,null,{default:()=>[y(xb,{icon:a.value?e.nextIcon:e.prevIcon},null)]})]),_("div",{key:"container",ref:p,class:w(["v-slide-group__container",e.contentClass]),onScroll:N},[_("div",{ref:g,class:"v-slide-group__content",onFocusin:V,onFocusout:D,onKeydown:O},[null==(i=n.default)?void 0:i.call(n,U.value)])]),$.value&&_("div",{key:"next",class:w(["v-slide-group__next",{"v-slide-group__next--disabled":!z.value}]),onMousedown:P,onClick:()=>z.value&&B("next")},[(null==(r=n.next)?void 0:r.call(n,U.value))??y(n_,null,{default:()=>[y(xb,{icon:a.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:s.selected,scrollTo:B,scrollOffset:l,focus:F,hasPrev:j,hasNext:z}}}),uS=Symbol.for("vuetify:v-chip-group"),cS=oe({baseColor:String,column:Boolean,filter:Boolean,valueComparator:{type:Function,default:Ne},...oS(),..._e(),...tw({selectedClass:"v-chip--selected"}),...kb(),...we(),...Kb({variant:"tonal"})},"VChipGroup");se()({name:"VChipGroup",props:cS(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{themeClasses:a}=Te(e),{isSelected:i,select:r,next:s,prev:o,selected:l}=iw(e,uS);return le({VChip:{baseColor:T(()=>e.baseColor),color:T(()=>e.color),disabled:T(()=>e.disabled),filter:T(()=>e.filter),variant:T(()=>e.variant)}}),be(()=>{const t=lS.filterProps(e);return y(lS,C(t,{class:["v-chip-group",{"v-chip-group--column":e.column},a.value,e.class],style:e.style}),{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n,{isSelected:i,select:r,next:s,prev:o,selected:l.value})]}})}),{}}});const dS=oe({activeClass:String,appendAvatar:String,appendIcon:Ie,baseColor:String,closable:Boolean,closeIcon:{type:Ie,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:Ie,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:Ie,ripple:{type:[Boolean,Object],default:!0},text:{type:[String,Number,Boolean],default:void 0},modelValue:{type:Boolean,default:!0},onClick:We(),onClickOnce:We(),...Ub(),..._e(),...zb(),...Yb(),...nw(),...Db(),...Cw(),...Sb(),...kb({tag:"span"}),...we(),...Kb({variant:"tonal"})},"VChip"),hS=se()({name:"VChip",directives:{vRipple:jw},props:dS(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,t){let{attrs:n,emit:a,slots:i}=t;const{t:r}=Ct(),{borderClasses:s}=$b(e),{densityClasses:o}=qb(e),{elevationClasses:l}=Jb(e),{roundedClasses:u}=Mb(e),{sizeClasses:c}=Cb(e),{themeClasses:d}=Te(e),h=Ae(e,"modelValue"),p=aw(e,uS,!1),v=Sw(e,n),m=T(()=>!1!==e.link&&v.isLink.value),g=f(()=>!e.disabled&&!1!==e.link&&(!!p||e.link||v.isClickable.value)),b=T(()=>({"aria-label":r(e.closeLabel),disabled:e.disabled,onClick(e){e.preventDefault(),e.stopPropagation(),h.value=!1,a("click:close",e)}})),{colorClasses:w,colorStyles:I,variantClasses:S}=Wb(()=>({color:!p||p.isSelected.value?e.color??e.baseColor:e.baseColor,variant:e.variant}));function k(e){var t;a("click",e),g.value&&(null==(t=v.navigate)||t.call(v,e),null==p||p.toggle())}function E(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),k(e))}return()=>{var t;const n=v.isLink.value?"a":e.tag,a=!(!e.appendIcon&&!e.appendAvatar),r=!(!a&&!i.append),f=!(!i.close&&!e.closable),x=!(!i.filter&&!e.filter)&&p,T=!(!e.prependIcon&&!e.prependAvatar),D=!(!T&&!i.prepend);return h.value&&A(y(n,C({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":g.value,"v-chip--filter":x,"v-chip--pill":e.pill,[`${e.activeClass}`]:e.activeClass&&(null==(t=v.isActive)?void 0:t.value)},d.value,s.value,w.value,o.value,l.value,u.value,c.value,S.value,null==p?void 0:p.selectedClass.value,e.class],style:[I.value,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:g.value?0:void 0,onClick:k,onKeydown:g.value&&!m.value&&E},v.linkProps),{default:()=>{var t;return[Gb(g.value,"v-chip"),x&&y(r_,{key:"filter"},{default:()=>[A(_("div",{class:"v-chip__filter"},[i.filter?y(yb,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},i.filter):y(xb,{key:"filter-icon",icon:e.filterIcon},null)]),[[V,p.isSelected.value]])]}),D&&_("div",{key:"prepend",class:"v-chip__prepend"},[i.prepend?y(yb,{key:"prepend-defaults",disabled:!T,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},i.prepend):_(N,null,[e.prependIcon&&y(xb,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&y(Xb,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),_("div",{class:"v-chip__content","data-no-activator":""},[(null==(t=i.default)?void 0:t.call(i,{isSelected:null==p?void 0:p.isSelected.value,selectedClass:null==p?void 0:p.selectedClass.value,select:null==p?void 0:p.select,toggle:null==p?void 0:p.toggle,value:null==p?void 0:p.value.value,disabled:e.disabled}))??B(e.text)]),r&&_("div",{key:"append",class:"v-chip__append"},[i.append?y(yb,{key:"append-defaults",disabled:!a,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},i.append):_(N,null,[e.appendIcon&&y(xb,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&y(Xb,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),f&&_("button",C({key:"close",class:"v-chip__close",type:"button","data-testid":"close-chip"},b.value),[i.close?y(yb,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},i.close):y(xb,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[jw,g.value&&e.ripple,null]])}}}),pS=oe({active:Boolean,disabled:Boolean,max:[Number,String],value:{type:[Number,String],default:0},..._e(),...Rb({transition:{component:a_}})},"VCounter"),fS=se()({name:"VCounter",functional:!0,props:pS(),setup(e,t){let{slots:n}=t;const a=T(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return be(()=>y(Pb,{transition:e.transition},{default:()=>[A(_("div",{class:w(["v-counter",{"text-error":e.max&&!e.disabled&&parseFloat(e.value)>parseFloat(e.max)},e.class]),style:b(e.style)},[n.default?n.default({counter:a.value,max:e.max,value:e.value}):a.value]),[[V,e.active]])]})),{}}}),vS=oe({floating:Boolean,..._e()},"VFieldLabel"),mS=se()({name:"VFieldLabel",props:vS(),setup(e,t){let{slots:n}=t;return be(()=>y(MI,{class:w(["v-field-label",{"v-field-label--floating":e.floating},e.class]),style:b(e.style)},n)),{}}}),gS=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],yS=oe({appendInnerIcon:Ie,bgColor:String,clearable:Boolean,clearIcon:{type:Ie,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,details:Boolean,dirty:Boolean,disabled:{type:Boolean,default:null},glow:Boolean,error:Boolean,flat:Boolean,iconColor:[Boolean,String],label:String,persistentClear:Boolean,prependInnerIcon:Ie,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>gS.includes(e)},"onClick:clear":We(),"onClick:appendInner":We(),"onClick:prependInner":We(),..._e(),...gw(),...Db(),...we()},"VField"),bS=se()({name:"VField",inheritAttrs:!1,props:{id:String,...qI(),...yS()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:a,emit:i,slots:r}=n;const{themeClasses:s}=Te(e),{loaderClasses:o}=yw(e),{focusClasses:l,isFocused:u,focus:c,blur:h}=HI(e),{InputIcon:p}=$I(e),{roundedClasses:v}=Mb(e),{rtlClasses:m}=Pe(),g=T(()=>e.dirty||e.active),I=T(()=>!(!e.label&&!r.label)),S=T(()=>!e.singleLine&&I.value),k=R(),E=f(()=>e.id||`input-${k}`),x=T(()=>e.details?`${E.value}-messages`:void 0),D=t(),M=t(),P=t(),O=f(()=>["plain","underlined"].includes(e.variant)),L=f(()=>e.error||e.disabled?void 0:g.value&&u.value?e.color:e.baseColor),F=f(()=>{if(e.iconColor&&(!e.glow||u.value))return!0===e.iconColor?L.value:e.iconColor}),{backgroundColorClasses:B,backgroundColorStyles:U}=_b(()=>e.bgColor),{textColorClasses:$,textColorStyles:j}=wb(L);d(g,e=>{if(S.value){const t=D.value.$el,n=M.value.$el;requestAnimationFrame(()=>{const a=qe(t),i=n.getBoundingClientRect(),r=i.x-a.x,s=i.y-a.y-(a.height/2-i.height/2),o=i.width/.75,l=Math.abs(o-a.width)>1?{maxWidth:me(o)}:void 0,u=getComputedStyle(t),c=getComputedStyle(n),d=1e3*parseFloat(u.transitionDuration)||150,h=parseFloat(c.getPropertyValue("--v-field-label-scale")),p=c.getPropertyValue("color");t.style.visibility="visible",n.style.visibility="hidden",Be(t,{transform:`translate(${r}px, ${s}px) scale(${h})`,color:p,...l},{duration:d,easing:$e,direction:e?"normal":"reverse"}).finished.then(()=>{t.style.removeProperty("visibility"),n.style.removeProperty("visibility")})})}},{flush:"post"});const z=f(()=>({isActive:g,isFocused:u,controlRef:P,blur:h,focus:c}));function q(e){e.target!==document.activeElement&&e.preventDefault()}return be(()=>{var t,n,i;const u="outlined"===e.variant,d=!(!r["prepend-inner"]&&!e.prependInnerIcon),f=!(!e.clearable&&!r.clear||e.disabled),k=!!(r["append-inner"]||e.appendInnerIcon||f),T=()=>r.label?r.label({...z.value,label:e.label,props:{for:E.value}}):e.label;return _("div",C({class:["v-field",{"v-field--active":g.value,"v-field--appended":k,"v-field--center-affix":e.centerAffix??!O.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--glow":e.glow,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":d,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!T(),[`v-field--variant-${e.variant}`]:!0},s.value,B.value,l.value,o.value,v.value,m.value,e.class],style:[U.value,e.style],onClick:q},a),[_("div",{class:"v-field__overlay"},null),y(bw,{name:"v-field",active:!!e.loading,color:e.error?"error":"string"==typeof e.loading?e.loading:e.color},{default:r.loader}),d&&_("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&y(p,{key:"prepend-icon",name:"prependInner",color:F.value},null),null==(t=r["prepend-inner"])?void 0:t.call(r,z.value)]),_("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&S.value&&y(mS,{key:"floating-label",ref:M,class:w([$.value]),floating:!0,for:E.value,"aria-hidden":!g.value,style:b(j.value)},{default:()=>[T()]}),I.value&&y(mS,{key:"label",ref:D,for:E.value},{default:()=>[T()]}),(null==(n=r.default)?void 0:n.call(r,{...z.value,props:{id:E.value,class:"v-field__input","aria-describedby":x.value},focus:c,blur:h}))??_("div",{id:E.value,class:"v-field__input","aria-describedby":x.value},null)]),f&&y(r_,{key:"clear"},{default:()=>[A(_("div",{class:"v-field__clearable",onMousedown:e=>{e.preventDefault(),e.stopPropagation()}},[y(yb,{defaults:{VIcon:{icon:e.clearIcon}}},{default:()=>[r.clear?r.clear({...z.value,props:{onFocus:c,onBlur:h,onClick:e["onClick:clear"],tabindex:-1}}):y(p,{name:"clear",onFocus:c,onBlur:h,tabindex:-1},null)]})]),[[V,e.dirty]])]}),k&&_("div",{key:"append",class:"v-field__append-inner"},[null==(i=r["append-inner"])?void 0:i.call(r,z.value),e.appendInnerIcon&&y(p,{key:"append-icon",name:"appendInner",color:F.value},null)]),_("div",{class:w(["v-field__outline",$.value]),style:b(j.value)},[u&&_(N,null,[_("div",{class:"v-field__outline__start"},null),S.value&&_("div",{class:"v-field__outline__notch"},[y(mS,{ref:M,floating:!0,for:E.value,"aria-hidden":!g.value},{default:()=>[T()]})]),_("div",{class:"v-field__outline__end"},null)]),O.value&&S.value&&y(mS,{ref:M,floating:!0,for:E.value,"aria-hidden":!g.value},{default:()=>[T()]})])])}),{controlRef:P,fieldIconColor:F}}});const wS=["color","file","time","date","datetime-local","week","month"],_S=oe({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:[Number,Function],prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...JI(),...yS()},"VTextField"),IS=se()({name:"VTextField",directives:{vIntersect:Lb},inheritAttrs:!1,props:_S(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:a,emit:i,slots:r}=n;const s=Ae(e,"modelValue"),{isFocused:o,focus:l,blur:u}=HI(e),{onIntersect:c}=function(e){return{onIntersect:function(t,n){var a,i;e.autofocus&&t&&(null==(i=null==(a=n[0].target)?void 0:a.focus)||i.call(a))}}}(e),d=f(()=>"function"==typeof e.counterValue?e.counterValue(s.value):"number"==typeof e.counterValue?e.counterValue:(s.value??"").toString().length),p=f(()=>a.maxlength?a.maxlength:!e.counter||"number"!=typeof e.counter&&"string"!=typeof e.counter?void 0:e.counter),v=f(()=>["plain","underlined"].includes(e.variant)),m=t(),g=t(),b=t(),I=f(()=>wS.includes(e.type)||e.persistentPlaceholder||o.value||e.active);function S(){o.value||l(),h(()=>{var e;b.value!==document.activeElement&&(null==(e=b.value)||e.focus())})}function k(e){i("mousedown:control",e),e.target!==b.value&&(S(),e.preventDefault())}function E(e){i("click:control",e)}function x(t){var n;const a=t.target;if(s.value=a.value,(null==(n=e.modelModifiers)?void 0:n.trim)&&["text","search","password","tel","url"].includes(e.type)){const e=[a.selectionStart,a.selectionEnd];h(()=>{a.selectionStart=e[0],a.selectionEnd=e[1]})}}return be(()=>{const t=!!(r.counter||!1!==e.counter&&null!=e.counter),n=!(!t&&!r.details),[i,f]=St(a),{modelValue:T,...V}=ZI.filterProps(e),D=bS.filterProps(e);return y(ZI,C({ref:m,modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-input--plain-underlined":v.value},e.class],style:e.style},i,V,{centerAffix:!v.value,focused:o.value}),{...r,default:t=>{let{id:n,isDisabled:a,isDirty:i,isReadonly:d,isValid:p,hasDetails:v,reset:m}=t;return y(bS,C({ref:g,onMousedown:k,onClick:E,"onClick:clear":t=>function(t,n){t.stopPropagation(),S(),h(()=>{s.value=null,n(),kt(e["onClick:clear"],t)})}(t,m),"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:e.role},D,{id:n.value,active:I.value||i.value,dirty:i.value||e.dirty,disabled:a.value,focused:o.value,details:v.value,error:!1===p.value}),{...r,default:t=>{let{props:{class:n,...i}}=t;const o=A(_("input",C({ref:b,value:s.value,onInput:x,autofocus:e.autofocus,readonly:d.value,disabled:a.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:l,onBlur:u},i,f),null),[[Lb,{handler:c},null,{once:!0}]]);return _(N,null,[e.prefix&&_("span",{class:"v-text-field__prefix"},[_("span",{class:"v-text-field__prefix__text"},[e.prefix])]),r.default?_("div",{class:w(n),"data-no-activator":""},[r.default(),o]):Q(o,{class:n}),e.suffix&&_("span",{class:"v-text-field__suffix"},[_("span",{class:"v-text-field__suffix__text"},[e.suffix])])])}})},details:n?n=>{var a;return _(N,null,[null==(a=r.details)?void 0:a.call(r,n),t&&_(N,null,[_("span",null,null),y(fS,{active:e.persistentCounter||o.value,value:d.value,max:p.value,disabled:e.disabled},r.counter)])])}:void 0})}),kI({},m,g,b)}}),SS=oe({renderless:Boolean,..._e()},"VVirtualScrollItem"),CS=se()({name:"VVirtualScrollItem",inheritAttrs:!1,props:SS(),emits:{"update:height":e=>!0},setup(e,t){let{attrs:n,emit:a,slots:i}=t;const{resizeRef:r,contentRect:s}=Me(void 0,"border");d(()=>{var e;return null==(e=s.value)?void 0:e.height},e=>{null!=e&&a("update:height",e)}),be(()=>{var t,a;return e.renderless?_(N,null,[null==(t=i.default)?void 0:t.call(i,{itemRef:r})]):_("div",C({ref:r,class:["v-virtual-scroll__item",e.class],style:e.style},n),[null==(a=i.default)?void 0:a.call(i)])})}}),kS=oe({itemHeight:{type:[Number,String],default:null},itemKey:{type:[String,Array,Function],default:null},height:[Number,String]},"virtual");function ES(e,n){const a=gt(),i=m(0);L(()=>{i.value=parseFloat(e.itemHeight||0)});const r=m(0),s=m(Math.ceil((parseInt(e.height)||a.height.value)/(i.value||16))||1),o=m(0),l=m(0),u=t(),p=t();let v=0;const{resizeRef:g,contentRect:y}=Me();L(()=>{g.value=u.value});const b=f(()=>{var t;return u.value===document.documentElement?a.height.value:(null==(t=y.value)?void 0:t.height)||parseInt(e.height)||0}),w=f(()=>!!(u.value&&p.value&&b.value&&i.value));let _=Array.from({length:n.value.length}),I=Array.from({length:n.value.length});const S=m(0);let C=-1;function k(e){return _[e]||i.value}const E=Tt(()=>{const e=performance.now();I[0]=0;const t=n.value.length;for(let n=1;n<=t-1;n++)I[n]=(I[n-1]||0)+k(n-1);S.value=Math.max(S.value,performance.now()-e)},S),x=d(w,e=>{e&&(x(),v=p.value.offsetTop,E.immediate(),O(),~C&&h(()=>{Le&&window.requestAnimationFrame(()=>{B(C),C=-1})}))});function T(e){e=Re(e,0,n.value.length-1);const t=Math.floor(e),a=e%1,i=t+1,r=I[t]||0;return r+((I[i]||r)-r)*a}function A(e){return function(e,t){let n=e.length-1,a=0,i=0,r=null,s=-1;if(e[n]<t)return n;for(;a<=n;)if(i=a+n>>1,r=e[i],r>t)n=i-1;else{if(!(r<t))return r===t?i:a;s=i,a=i+1}return s}(I,e)}c(()=>{E.clear()});let N=0,V=0,D=0;d(b,(e,t)=>{t&&(O(),e<t&&requestAnimationFrame(()=>{V=0,O()}))});let M=-1;function R(){u.value&&p.value&&(V=0,D=0,window.clearTimeout(M),O())}let P=-1;function O(){cancelAnimationFrame(P),P=requestAnimationFrame(F)}function F(){if(!u.value||!b.value||!i.value)return;const e=N-v,t=Math.sign(V),a=Math.max(0,e-100),c=Re(A(a),0,n.value.length),d=e+b.value+100,h=Re(A(d)+1,c+1,n.value.length);if((-1!==t||c<r.value)&&(1!==t||h>s.value)){const e=T(r.value)-T(c),t=T(h)-T(s.value);Math.max(e,t)>100?(r.value=c,s.value=h):(c<=0&&(r.value=c),h>=n.value.length&&(s.value=h))}o.value=T(r.value),l.value=T(n.value.length)-T(s.value)}function B(e){const t=T(e);!u.value||e&&!t?C=e:u.value.scrollTop=t}const U=f(()=>n.value.slice(r.value,s.value).map((t,n)=>{const a=n+r.value;return{raw:t,index:a,key:Ye(t,e.itemKey,a)}}));return d(n,()=>{_=Array.from({length:n.value.length}),I=Array.from({length:n.value.length}),E.immediate(),O()},{deep:1}),{calculateVisibleItems:O,containerRef:u,markerRef:p,computedItems:U,paddingTop:o,paddingBottom:l,scrollToIndex:B,handleScroll:function(){if(!u.value||!p.value)return;const e=u.value.scrollTop,t=performance.now();t-D>500?(V=Math.sign(e-N),v=p.value.offsetTop):V=e-N,N=e,D=t,window.clearTimeout(M),M=window.setTimeout(R,500),O()},handleScrollend:R,handleItemResize:function(e,t){const n=_[e],a=i.value;i.value=a?Math.min(i.value,t):t,n===t&&a===i.value||(_[e]=t,E())}}}const xS=oe({items:{type:Array,default:()=>[]},renderless:Boolean,...kS(),..._e(),...Tb()},"VVirtualScroll"),TS=se()({name:"VVirtualScroll",props:xS(),setup(e,t){let{slots:n}=t;const a=xe("VVirtualScroll"),{dimensionStyles:i}=Ab(e),{calculateVisibleItems:r,containerRef:s,markerRef:o,handleScroll:l,handleScrollend:u,handleItemResize:d,scrollToIndex:h,paddingTop:p,paddingBottom:f,computedItems:v}=ES(e,T(()=>e.items));return et(()=>e.renderless,()=>{function e(){var e,t;const n=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"addEventListener":"removeEventListener";s.value===document.documentElement?(document[n]("scroll",l,{passive:!0}),document[n]("scrollend",u)):(null==(e=s.value)||e[n]("scroll",l,{passive:!0}),null==(t=s.value)||t[n]("scrollend",u))}D(()=>{s.value=bt(a.vnode.el,!0),e(!0)}),c(e)}),be(()=>{const t=v.value.map(t=>y(CS,{key:t.key,renderless:e.renderless,"onUpdate:height":e=>d(t.index,e)},{default:e=>{var a;return null==(a=n.default)?void 0:a.call(n,{item:t.raw,index:t.index,...e})}}));return e.renderless?_(N,null,[_("div",{ref:o,class:"v-virtual-scroll__spacer",style:{paddingTop:me(p.value)}},null),t,_("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:me(f.value)}},null)]):_("div",{ref:s,class:w(["v-virtual-scroll",e.class]),onScrollPassive:l,onScrollend:u,style:b([i.value,e.style])},[_("div",{ref:o,class:"v-virtual-scroll__container",style:{paddingTop:me(p.value),paddingBottom:me(f.value)}},[t])])}),{calculateVisibleItems:r,scrollToIndex:h}}});function AS(e,t){const n=m(!1);let a;return{onScrollPassive:function(e){cancelAnimationFrame(a),n.value=!0,a=requestAnimationFrame(()=>{a=requestAnimationFrame(()=>{n.value=!1})})},onKeydown:async function(a){var i,r;if("Tab"===a.key&&(null==(i=t.value)||i.focus()),!["PageDown","PageUp","Home","End"].includes(a.key))return;const s=null==(r=e.value)?void 0:r.$el;if(!s)return;"Home"!==a.key&&"End"!==a.key||s.scrollTo({top:"Home"===a.key?0:s.scrollHeight,behavior:"smooth"}),await async function(){await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>{if(n.value){const t=d(n,()=>{t(),e()})}else e()})}();const o=s.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if("PageDown"===a.key||"Home"===a.key){const e=s.getBoundingClientRect().top;for(const t of o)if(t.getBoundingClientRect().top>=e){t.focus();break}}else{const e=s.getBoundingClientRect().bottom;for(const t of[...o].reverse())if(t.getBoundingClientRect().bottom<=e){t.focus();break}}}}}const NS=oe({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:Ie,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,noAutoScroll:Boolean,...P_({itemChildren:!1})},"Select"),VS=oe({...NS(),...Je(_S({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Rb({transition:{component:Zw}})},"VSelect"),DS=se()({name:"VSelect",props:VS(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{slots:a}=n;const{t:i}=Ct(),r=t(),s=t(),o=t(),{items:l,transformIn:u,transformOut:c}=B_(e),p=Ae(e,"modelValue",[],e=>u(null===e?[null]:Ve(e)),t=>{const n=c(t);return e.multiple?n:n[0]??null}),v=f(()=>"function"==typeof e.counterValue?e.counterValue(p.value):"number"==typeof e.counterValue?e.counterValue:p.value.length),g=WI(e),b=f(()=>p.value.map(e=>e.value)),w=m(!1);let I,S="",k=-1;const E=f(()=>e.hideSelected?l.value.filter(t=>!p.value.some(n=>(e.valueComparator||Ne)(n,t))):l.value),x=f(()=>e.hideNoData&&!E.value.length||g.isReadonly.value||g.isDisabled.value),A=Ae(e,"menu"),V=f({get:()=>A.value,set:e=>{var t;A.value&&!e&&(null==(t=s.value)?void 0:t.ΨopenChildren.size)||e&&x.value||(A.value=e)}}),D=T(()=>V.value?e.closeText:e.openText),M=f(()=>{var t;return{...e.menuProps,activatorProps:{...(null==(t=e.menuProps)?void 0:t.activatorProps)||{},"aria-haspopup":"listbox"}}}),R=t(),P=AS(R,r);function O(t){e.openOnClear&&(V.value=!0)}function L(){x.value||(V.value=!V.value)}function F(e){Vt(e)&&B(e)}function B(t){var n,a,i;if(!t.key||g.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"," "].includes(t.key)&&(V.value=!0),["Escape","Tab"].includes(t.key)&&(V.value=!1),"Home"===t.key?null==(n=R.value)||n.focus("first"):"End"===t.key&&(null==(a=R.value)||a.focus("last"));if(!Vt(t))return;const r=performance.now();r-I>1e3&&(S="",k=-1),S+=t.key.toLowerCase(),I=r;const s=E.value;function o(){for(let e=k+1;e<s.length;e++){const t=s[e];if(t.title.toLowerCase().startsWith(S))return[t,e]}}const l=function(){let e=o();return e||(S.at(-1)===S.at(-2)&&(S=S.slice(0,-1),e=o(),e)?e:(k=-1,e=o(),e||(S=t.key.toLowerCase(),o())))}();if(!l)return;const[u,c]=l;k=c,null==(i=R.value)||i.focus(c),e.multiple||(p.value=[u])}function U(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t.props.disabled)if(e.multiple){const a=p.value.findIndex(n=>(e.valueComparator||Ne)(n.value,t.value)),i=null==n?!~a:n;if(~a){const e=i?[...p.value,t]:[...p.value];e.splice(a,1),p.value=e}else i&&(p.value=[...p.value,t])}else{const e=!1!==n;p.value=e?[t]:[],h(()=>{V.value=!1})}}function $(e){var t;(null==(t=R.value)?void 0:t.$el.contains(e.relatedTarget))||(V.value=!1)}function j(){var t;e.eager&&(null==(t=o.value)||t.calculateVisibleItems())}function z(){var e;w.value&&(null==(e=r.value)||e.focus())}function q(e){w.value=!0}function H(e){if(null==e)p.value=[];else if(ft(r.value,":autofill")||ft(r.value,":-webkit-autofill")){const t=l.value.find(t=>t.title===e);t&&U(t)}else r.value&&(r.value.value="")}return d(V,()=>{if(!e.hideSelected&&V.value&&p.value.length){const t=E.value.findIndex(t=>p.value.some(n=>(e.valueComparator||Ne)(n.value,t.value)));Le&&!e.noAutoScroll&&window.requestAnimationFrame(()=>{var e;t>=0&&(null==(e=o.value)||e.scrollToIndex(t))})}}),d(()=>e.items,(t,n)=>{V.value||w.value&&e.hideNoData&&!n.length&&t.length&&(V.value=!0)}),be(()=>{const t=!(!e.chips&&!a.chip),n=!!(!e.hideNoData||E.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),l=p.value.length>0,u=IS.filterProps(e),c=l||!w.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return y(IS,C({ref:r},u,{modelValue:p.value.map(e=>e.props.value).join(", "),"onUpdate:modelValue":H,focused:w.value,"onUpdate:focused":e=>w.value=e,validationValue:p.externalValue,counterValue:v.value,dirty:l,class:["v-select",{"v-select--active-menu":V.value,"v-select--chips":!!e.chips,["v-select--"+(e.multiple?"multiple":"single")]:!0,"v-select--selected":p.value.length,"v-select--selection-slot":!!a.selection},e.class],style:e.style,inputmode:"none",placeholder:c,"onClick:clear":O,"onMousedown:control":L,onBlur:$,onKeydown:B,"aria-label":i(D.value),title:i(D.value)}),{...a,default:()=>_(N,null,[y(xI,C({ref:s,modelValue:V.value,"onUpdate:modelValue":e=>V.value=e,activator:"parent",contentClass:"v-select__content",disabled:x.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:j,onAfterLeave:z},M.value),{default:()=>[n&&y(q_,C({ref:R,selected:b.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),onKeydown:F,onFocusin:q,tabindex:"-1","aria-live":"polite","aria-label":`${e.label}-list`,color:e.itemColor??e.color},P,e.listProps),{default:()=>{var t,n,r;return[null==(t=a["prepend-item"])?void 0:t.call(a),!E.value.length&&!e.hideNoData&&((null==(n=a["no-data"])?void 0:n.call(a))??y(N_,{key:"no-data",title:i(e.noDataText)},null)),y(TS,{ref:o,renderless:!0,items:E.value,itemKey:"value"},{default:t=>{var n,i,r;let{item:s,index:o,itemRef:l}=t;const u=At(s.props),c=C(s.props,{ref:l,key:s.value,onClick:()=>U(s,null)});return"divider"===s.type?(null==(n=a.divider)?void 0:n.call(a,{props:s.raw,index:o}))??y(Gw,C(s.props,{key:`divider-${o}`}),null):"subheader"===s.type?(null==(i=a.subheader)?void 0:i.call(a,{props:s.raw,index:o}))??y(D_,C(s.props,{key:`subheader-${o}`}),null):(null==(r=a.item)?void 0:r.call(a,{item:s,index:o,props:c}))??y(N_,C(c,{role:"option"}),{prepend:t=>{let{isSelected:n}=t;return _(N,null,[e.multiple&&!e.hideSelected?y(UI,{key:s.value,modelValue:n,ripple:!1,tabindex:"-1"},null):void 0,u.prependAvatar&&y(Xb,{image:u.prependAvatar},null),u.prependIcon&&y(xb,{icon:u.prependIcon},null)])}})}}),null==(r=a["append-item"])?void 0:r.call(a)]}})]}),p.value.map((n,i)=>{function r(e){e.stopPropagation(),e.preventDefault(),U(n,!1)}const s={"onClick:close":r,onKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),r(e))},onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},o=t?!!a.chip:!!a.selection,l=o?Nt(t?a.chip({item:n,index:i,props:s}):a.selection({item:n,index:i})):void 0;if(!o||l)return _("div",{key:n.value,class:"v-select__selection"},[t?a.chip?y(yb,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:n.title}}},{default:()=>[l]}):y(hS,C({key:"chip",closable:e.closableChips,size:"small",text:n.title,disabled:n.props.disabled},s),null):l??_("span",{class:"v-select__selection-text"},[n.title,e.multiple&&i<p.value.length-1&&_("span",{class:"v-select__selection-comma"},[K(",")])])])})]),"append-inner":function(){for(var t,n,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return _(N,null,[null==(t=a["append-inner"])?void 0:t.call(a,...s),e.menuIcon?y(xb,{class:"v-select__menu-icon",color:null==(n=r.value)?void 0:n.fieldIconColor,icon:e.menuIcon},null):void 0])}})}),kI({isFocused:w,menu:V,select:U},r)}}),MS={id:"account-controls",class:"minimal-account-selector"},RS=mb({__name:"AccountSelector",props:{accounts:{type:Array,required:!0},modelValue:{type:String,default:null},visible:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,a=t,i=f({get:()=>n.modelValue,set(e){a("update:modelValue",e)}});return(t,n)=>A((H(),q("div",MS,[y(DS,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=e=>i.value=e),items:e.accounts,"item-title":"name","item-value":"id",label:"管理対象アカウント",variant:"outlined",density:"compact",color:"primary","prepend-inner-icon":"mdi-account-multiple",class:"minimal-select","hide-details":""},null,8,["modelValue","items"])],512)),[[V,e.visible]])}},[["__scopeId","data-v-eb89f250"]]),PS=Ge("v-alert-title"),OS=oe({iconSize:[Number,String],iconSizes:{type:Array,default:()=>[["x-small",10],["small",16],["default",24],["large",28],["x-large",32]]}},"iconSize");const LS=["success","info","warning","error"],FS=oe({border:{type:[Boolean,String],validator:e=>"boolean"==typeof e||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:Ie,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>LS.includes(e)},..._e(),...zb(),...Tb(),...Yb(),...OS(),...pw(),..._w(),...Db(),...kb(),...we(),...Kb({variant:"flat"})},"VAlert"),BS=se()({name:"VAlert",props:FS(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{emit:n,slots:a}=t;const i=Ae(e,"modelValue"),r=T(()=>{if(!1!==e.icon)return e.type?e.icon??`$${e.type}`:e.icon}),{iconSize:s}=function(e,t){return{iconSize:f(()=>{const n=new Map(e.iconSizes),a=e.iconSize??t()??"default";return n.has(a)?n.get(a):a})}}(e,()=>e.prominent?44:void 0),{themeClasses:o}=Te(e),{colorClasses:l,colorStyles:u,variantClasses:c}=Wb(()=>({color:e.color??e.type,variant:e.variant})),{densityClasses:d}=qb(e),{dimensionStyles:h}=Ab(e),{elevationClasses:p}=Jb(e),{locationStyles:v}=fw(e),{positionClasses:m}=Iw(e),{roundedClasses:g}=Mb(e),{textColorClasses:I,textColorStyles:S}=wb(()=>e.borderColor),{t:k}=Ct(),E=T(()=>({"aria-label":k(e.closeLabel),onClick(e){i.value=!1,n("click:close",e)}}));return()=>{const t=!(!a.prepend&&!r.value),n=!(!a.title&&!e.title),f=!(!a.close&&!e.closable),k={density:e.density,icon:r.value,size:e.iconSize||e.prominent?s.value:void 0};return i.value&&y(e.tag,{class:w(["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${!0===e.border?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},o.value,l.value,d.value,p.value,m.value,g.value,c.value,e.class]),style:b([u.value,h.value,v.value,e.style]),role:"alert"},{default:()=>{var i,s;return[Gb(!1,"v-alert"),e.border&&_("div",{key:"border",class:w(["v-alert__border",I.value]),style:b(S.value)},null),t&&_("div",{key:"prepend",class:"v-alert__prepend"},[a.prepend?y(yb,{key:"prepend-defaults",disabled:!r.value,defaults:{VIcon:{...k}}},a.prepend):y(xb,C({key:"prepend-icon"},k),null)]),_("div",{class:"v-alert__content"},[n&&y(PS,{key:"title"},{default:()=>{var t;return[(null==(t=a.title)?void 0:t.call(a))??e.title]}}),(null==(i=a.text)?void 0:i.call(a))??e.text,null==(s=a.default)?void 0:s.call(a)]),a.append&&_("div",{key:"append",class:"v-alert__append"},[a.append()]),f&&_("div",{key:"close",class:"v-alert__close"},[a.close?y(yb,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var e;return[null==(e=a.close)?void 0:e.call(a,{props:E.value})]}}):y(qw,C({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},E.value),null)])]}})}}}),US=(e,t,n)=>{if(null==e||null==t)return-1;if(!t.length)return 0;e=e.toString().toLocaleLowerCase(),t=t.toString().toLocaleLowerCase();const a=[];let i=e.indexOf(t);for(;~i;)a.push([i,i+t.length]),i=e.indexOf(t,i+t.length);return a.length?a:-1};function $S(e,t){if(null!=e&&"boolean"!=typeof e&&-1!==e)return"number"==typeof e?[[e,e+t.length]]:Array.isArray(e[0])?e:[e]}const jS=oe({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function zS(e,t,n,a){const i=m([]),r=m(new Map),s=f(()=>(null==a?void 0:a.transform)?O(t).map(e=>[e,a.transform(e)]):O(t));return L(()=>{const o="function"==typeof n?n():O(n),l="string"!=typeof o&&"number"!=typeof o?"":String(o),u=function(e,t,n){var a;const i=[],r=(null==n?void 0:n.default)??US,s=!!(null==n?void 0:n.filterKeys)&&Ve(n.filterKeys),o=Object.keys((null==n?void 0:n.customKeyFilter)??{}).length;if(!(null==e?void 0:e.length))return i;e:for(let l=0;l<e.length;l++){const[u,c=u]=Ve(e[l]),d={},h={};let p=-1;if((t||o>0)&&!(null==n?void 0:n.noFilter)){if("object"==typeof u){if("divider"===u.type||"subheader"===u.type)continue;const e=s||Object.keys(c);for(const i of e){const e=Ye(c,i),s=null==(a=null==n?void 0:n.customKeyFilter)?void 0:a[i];if(p=s?s(e,t,u):r(e,t,u),-1!==p&&!1!==p)s?d[i]=$S(p,t):h[i]=$S(p,t);else if("every"===(null==n?void 0:n.filterMode))continue e}}else p=r(u,t,u),-1!==p&&!1!==p&&(h.title=$S(p,t));const e=Object.keys(h).length,i=Object.keys(d).length;if(!e&&!i)continue;if("union"===(null==n?void 0:n.filterMode)&&i!==o&&!e)continue;if("intersection"===(null==n?void 0:n.filterMode)&&(i!==o||!e))continue}i.push({index:l,matches:{...h,...d}})}return i}(s.value,l,{customKeyFilter:{...e.customKeyFilter,...O(null==a?void 0:a.customKeyFilter)},default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),c=O(t),d=[],h=new Map;u.forEach(e=>{let{index:t,matches:n}=e;const a=c[t];d.push(a),h.set(a.value,n)}),i.value=d,r.value=h}),{filteredItems:i,filteredMatches:r,getMatches:function(e){return r.value.get(e.value)}}}const qS=oe({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...jS({filterKeys:["title"]}),...NS(),...Je(_S({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Rb({transition:!1})},"VAutocomplete"),HS=se()({name:"VAutocomplete",props:qS(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{slots:a}=n;const{t:i}=Ct(),r=t(),s=m(!1),o=m(!0),l=m(!1),u=t(),c=t(),p=m(-1),{items:v,transformIn:g,transformOut:I}=B_(e),{textColorClasses:S,textColorStyles:k}=wb(()=>{var e;return null==(e=r.value)?void 0:e.color}),E=Ae(e,"search",""),x=Ae(e,"modelValue",[],e=>g(null===e?[null]:Ve(e)),t=>{const n=I(t);return e.multiple?n:n[0]??null}),T=f(()=>"function"==typeof e.counterValue?e.counterValue(x.value):"number"==typeof e.counterValue?e.counterValue:x.value.length),A=WI(e),{filteredItems:V,getMatches:D}=zS(e,v,()=>o.value?"":E.value),M=f(()=>e.hideSelected?V.value.filter(e=>!x.value.some(t=>t.value===e.value)):V.value),R=f(()=>!(!e.chips&&!a.chip)),P=f(()=>R.value||!!a.selection),O=f(()=>x.value.map(e=>e.props.value)),L=f(()=>{var t;return(!0===e.autoSelectFirst||"exact"===e.autoSelectFirst&&E.value===(null==(t=M.value[0])?void 0:t.title))&&M.value.length>0&&!o.value&&!l.value}),F=f(()=>e.hideNoData&&!M.value.length||A.isReadonly.value||A.isDisabled.value),B=Ae(e,"menu"),U=f({get:()=>B.value,set:e=>{var t;B.value&&!e&&(null==(t=u.value)?void 0:t.ΨopenChildren.size)||e&&F.value||(B.value=e)}}),$=f(()=>U.value?e.closeText:e.openText),j=t(),z=AS(j,r);function q(t){e.openOnClear&&(U.value=!0),E.value=""}function H(){F.value||(U.value=!0)}function G(e){F.value||(s.value&&(e.preventDefault(),e.stopPropagation()),U.value=!U.value)}function W(e){var t;(Vt(e)||"Backspace"===e.key)&&(null==(t=r.value)||t.focus())}function Q(t){var n,a,i,s,o;if(A.isReadonly.value)return;const l=null==(n=r.value)?void 0:n.selectionStart,u=x.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(U.value=!0),["Escape"].includes(t.key)&&(U.value=!1),L.value&&["Enter","Tab"].includes(t.key)&&!x.value.some(e=>{let{value:t}=e;return t===M.value[0].value})&&ae(M.value[0]),"ArrowDown"===t.key&&L.value&&(null==(a=j.value)||a.focus("next")),["Backspace","Delete"].includes(t.key)){if(!e.multiple&&P.value&&x.value.length>0&&!E.value)return ae(x.value[0],!1);if(~p.value){t.preventDefault();const e=p.value;ae(x.value[p.value],!1),p.value=e>=u-1?u-2:e}else"Backspace"!==t.key||E.value||(p.value=u-1)}else if(e.multiple)if("ArrowLeft"===t.key){if(p.value<0&&l&&l>0)return;const e=p.value>-1?p.value-1:u-1;if(x.value[e])p.value=e;else{const e=(null==(i=E.value)?void 0:i.length)??null;p.value=-1,null==(s=r.value)||s.setSelectionRange(e,e)}}else if("ArrowRight"===t.key){if(p.value<0)return;const e=p.value+1;x.value[e]?p.value=e:(p.value=-1,null==(o=r.value)||o.setSelectionRange(0,0))}else~p.value&&Vt(t)&&(p.value=-1)}function X(e){if(ft(r.value,":autofill")||ft(r.value,":-webkit-autofill")){const t=v.value.find(t=>t.title===e.target.value);t&&ae(t)}}function Y(){var t;e.eager&&(null==(t=c.value)||t.calculateVisibleItems())}function J(){var e;s.value&&(o.value=!0,null==(e=r.value)||e.focus())}function Z(e){s.value=!0,setTimeout(()=>{l.value=!0})}function ee(e){l.value=!1}function te(t){null!=t&&(""!==t||e.multiple||P.value)||(x.value=[])}const ne=m(!1);function ae(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t&&!t.props.disabled)if(e.multiple){const a=x.value.findIndex(n=>(e.valueComparator||Ne)(n.value,t.value)),i=null==n?!~a:n;if(~a){const e=i?[...x.value,t]:[...x.value];e.splice(a,1),x.value=e}else i&&(x.value=[...x.value,t]);e.clearOnSelect&&(E.value="")}else{const e=!1!==n;x.value=e?[t]:[],E.value=e&&!P.value?t.title:"",h(()=>{U.value=!1,o.value=!0})}}return d(s,(t,n)=>{var a;t!==n&&(t?(ne.value=!0,E.value=e.multiple||P.value?"":String((null==(a=x.value.at(-1))?void 0:a.props.title)??""),o.value=!0,h(()=>ne.value=!1)):(e.multiple||null!=E.value||(x.value=[]),U.value=!1,(e.multiple||P.value)&&(E.value=""),p.value=-1))}),d(E,e=>{s.value&&!ne.value&&(e&&(U.value=!0),o.value=!e)}),d(U,()=>{if(!e.hideSelected&&U.value&&x.value.length){const e=M.value.findIndex(e=>x.value.some(t=>e.value===t.value));Le&&window.requestAnimationFrame(()=>{var t;e>=0&&(null==(t=c.value)||t.scrollToIndex(e))})}}),d(()=>e.items,(e,t)=>{U.value||s.value&&!t.length&&e.length&&(U.value=!0)}),be(()=>{const t=!!(!e.hideNoData||M.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),n=x.value.length>0,l=IS.filterProps(e);return y(IS,C({ref:r},l,{modelValue:E.value,"onUpdate:modelValue":[e=>E.value=e,te],focused:s.value,"onUpdate:focused":e=>s.value=e,validationValue:x.externalValue,counterValue:T.value,dirty:n,onChange:X,class:["v-autocomplete","v-autocomplete--"+(e.multiple?"multiple":"single"),{"v-autocomplete--active-menu":U.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!P.value,"v-autocomplete--selecting-index":p.value>-1},e.class],style:e.style,readonly:A.isReadonly.value,placeholder:n?void 0:e.placeholder,"onClick:clear":q,"onMousedown:control":H,onKeydown:Q}),{...a,default:()=>_(N,null,[y(xI,C({ref:u,modelValue:U.value,"onUpdate:modelValue":e=>U.value=e,activator:"parent",contentClass:"v-autocomplete__content",disabled:F.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:Y,onAfterLeave:J},e.menuProps),{default:()=>[t&&y(q_,C({ref:j,filterable:!0,selected:O.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),onKeydown:W,onFocusin:Z,onFocusout:ee,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},z,e.listProps),{default:()=>{var t,n,r;return[null==(t=a["prepend-item"])?void 0:t.call(a),!M.value.length&&!e.hideNoData&&((null==(n=a["no-data"])?void 0:n.call(a))??y(N_,{key:"no-data",title:i(e.noDataText)},null)),y(TS,{ref:c,renderless:!0,items:M.value,itemKey:"value"},{default:t=>{var n,i,r;let{item:s,index:l,itemRef:u}=t;const c=C(s.props,{ref:u,key:s.value,active:!(!L.value||0!==l)||void 0,onClick:()=>ae(s,null)});return"divider"===s.type?(null==(n=a.divider)?void 0:n.call(a,{props:s.raw,index:l}))??y(Gw,C(s.props,{key:`divider-${l}`}),null):"subheader"===s.type?(null==(i=a.subheader)?void 0:i.call(a,{props:s.raw,index:l}))??y(D_,C(s.props,{key:`subheader-${l}`}),null):(null==(r=a.item)?void 0:r.call(a,{item:s,index:l,props:c}))??y(N_,C(c,{role:"option"}),{prepend:t=>{let{isSelected:n}=t;return _(N,null,[e.multiple&&!e.hideSelected?y(UI,{key:s.value,modelValue:n,ripple:!1,tabindex:"-1"},null):void 0,s.props.prependAvatar&&y(Xb,{image:s.props.prependAvatar},null),s.props.prependIcon&&y(xb,{icon:s.props.prependIcon},null)])},title:()=>{var e,t,n,a;return o.value?s.title:(t="v-autocomplete",n=s.title,null!=(a=null==(e=D(s))?void 0:e.title)&&a.length?a.map((e,i)=>{const r=0===i?0:a[i-1][1],s=[_("span",{class:w(`${t}__unmask`)},[n.slice(r,e[0])]),_("span",{class:w(`${t}__mask`)},[n.slice(e[0],e[1])])];return i===a.length-1&&s.push(_("span",{class:w(`${t}__unmask`)},[n.slice(e[1])])),_(N,null,[s])}):n)}})}}),null==(r=a["append-item"])?void 0:r.call(a)]}})]}),x.value.map((t,n)=>{function i(e){e.stopPropagation(),e.preventDefault(),ae(t,!1)}const r={"onClick:close":i,onKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),i(e))},onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},s=R.value?!!a.chip:!!a.selection,o=s?Nt(R.value?a.chip({item:t,index:n,props:r}):a.selection({item:t,index:n})):void 0;if(!s||o)return _("div",{key:t.value,class:w(["v-autocomplete__selection",n===p.value&&["v-autocomplete__selection--selected",S.value]]),style:b(n===p.value?k.value:{})},[R.value?a.chip?y(yb,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:t.title}}},{default:()=>[o]}):y(hS,C({key:"chip",closable:e.closableChips,size:"small",text:t.title,disabled:t.props.disabled},r),null):o??_("span",{class:"v-autocomplete__selection-text"},[t.title,e.multiple&&n<x.value.length-1&&_("span",{class:"v-autocomplete__selection-comma"},[K(",")])])])})]),"append-inner":function(){for(var t,n,s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];return _(N,null,[null==(t=a["append-inner"])?void 0:t.call(a,...o),e.menuIcon?y(xb,{class:"v-autocomplete__menu-icon",color:null==(n=r.value)?void 0:n.fieldIconColor,icon:e.menuIcon,onMousedown:G,onClick:Dt,"aria-label":i($.value),title:i($.value),tabindex:"-1"},null):void 0])}})}),kI({isFocused:s,isPristine:o,menu:U,search:E,filteredItems:V,select:ae},r)}}),GS=se()({name:"VCardActions",props:_e(),setup(e,t){let{slots:n}=t;return le({VBtn:{slim:!0,variant:"text"}}),be(()=>{var t;return _("div",{class:w(["v-card-actions",e.class]),style:b(e.style)},[null==(t=n.default)?void 0:t.call(n)])}),{}}}),KS=oe({opacity:[Number,String],..._e(),...kb()},"VCardSubtitle"),WS=se()({name:"VCardSubtitle",props:KS(),setup(e,t){let{slots:n}=t;return be(()=>y(e.tag,{class:w(["v-card-subtitle",e.class]),style:b([{"--v-card-subtitle-opacity":e.opacity},e.style])},n)),{}}}),QS=Ge("v-card-title"),XS=oe({appendAvatar:String,appendIcon:Ie,prependAvatar:String,prependIcon:Ie,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},..._e(),...zb()},"VCardItem"),YS=se()({name:"VCardItem",props:XS(),setup(e,t){let{slots:n}=t;return be(()=>{var t;const a=!(!e.prependAvatar&&!e.prependIcon),i=!(!a&&!n.prepend),r=!(!e.appendAvatar&&!e.appendIcon),s=!(!r&&!n.append),o=!(null==e.title&&!n.title),l=!(null==e.subtitle&&!n.subtitle);return _("div",{class:w(["v-card-item",e.class]),style:b(e.style)},[i&&_("div",{key:"prepend",class:"v-card-item__prepend"},[n.prepend?y(yb,{key:"prepend-defaults",disabled:!a,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},n.prepend):_(N,null,[e.prependAvatar&&y(Xb,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&y(xb,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),_("div",{class:"v-card-item__content"},[o&&y(QS,{key:"title"},{default:()=>{var t;return[(null==(t=n.title)?void 0:t.call(n))??B(e.title)]}}),l&&y(WS,{key:"subtitle"},{default:()=>{var t;return[(null==(t=n.subtitle)?void 0:t.call(n))??B(e.subtitle)]}}),null==(t=n.default)?void 0:t.call(n)]),s&&_("div",{key:"append",class:"v-card-item__append"},[n.append?y(yb,{key:"append-defaults",disabled:!r,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},n.append):_(N,null,[e.appendIcon&&y(xb,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&y(Xb,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),JS=oe({opacity:[Number,String],..._e(),...kb()},"VCardText"),ZS=se()({name:"VCardText",props:JS(),setup(e,t){let{slots:n}=t;return be(()=>y(e.tag,{class:w(["v-card-text",e.class]),style:b([{"--v-card-text-opacity":e.opacity},e.style])},n)),{}}}),eC=oe({appendAvatar:String,appendIcon:Ie,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:Ie,ripple:{type:[Boolean,Object],default:!0},subtitle:{type:[String,Number,Boolean],default:void 0},text:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...Ub(),..._e(),...zb(),...Tb(),...Yb(),...gw(),...pw(),..._w(),...Db(),...Cw(),...kb(),...we(),...Kb({variant:"elevated"})},"VCard"),tC=se()({name:"VCard",directives:{vRipple:jw},props:eC(),setup(e,t){let{attrs:n,slots:a}=t;const{themeClasses:i}=Te(e),{borderClasses:r}=$b(e),{colorClasses:s,colorStyles:o,variantClasses:l}=Wb(e),{densityClasses:u}=qb(e),{dimensionStyles:c}=Ab(e),{elevationClasses:d}=Jb(e),{loaderClasses:h}=yw(e),{locationStyles:p}=fw(e),{positionClasses:f}=Iw(e),{roundedClasses:v}=Mb(e),m=Sw(e,n);return be(()=>{const t=!1!==e.link&&m.isLink.value,n=!e.disabled&&!1!==e.link&&(e.link||m.isClickable.value),g=t?"a":e.tag,b=!(!a.title&&null==e.title),w=!(!a.subtitle&&null==e.subtitle),I=b||w,S=!!(a.append||e.appendAvatar||e.appendIcon),k=!!(a.prepend||e.prependAvatar||e.prependIcon),E=!(!a.image&&!e.image),x=I||k||S,T=!(!a.text&&null==e.text);return A(y(g,C({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":n},i.value,r.value,s.value,u.value,d.value,h.value,f.value,v.value,l.value,e.class],style:[o.value,c.value,p.value,e.style],onClick:n&&m.navigate,tabindex:e.disabled?-1:void 0},m.linkProps),{default:()=>{var t;return[E&&_("div",{key:"image",class:"v-card__image"},[a.image?y(yb,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},a.image):y(Bb,{key:"image-img",cover:!0,src:e.image},null)]),y(bw,{name:"v-card",active:!!e.loading,color:"boolean"==typeof e.loading?void 0:e.loading},{default:a.loader}),x&&y(YS,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:a.item,prepend:a.prepend,title:a.title,subtitle:a.subtitle,append:a.append}),T&&y(ZS,{key:"text"},{default:()=>{var t;return[(null==(t=a.text)?void 0:t.call(a))??e.text]}}),null==(t=a.default)?void 0:t.call(a),a.actions&&y(GS,null,{default:a.actions}),Gb(n,"v-card")]}}),[[jw,n&&e.ripple]])}),{}}}),nC=oe({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,..._I({origin:"center center",scrollStrategy:"block",transition:{component:Zw},zIndex:2400})},"VDialog"),aC=se()({name:"VDialog",props:nC(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,n){let{emit:a,slots:i}=n;const r=Ae(e,"modelValue"),{scopeId:s}=hI(),o=t();function l(e){var t,n;const a=e.relatedTarget,i=e.target;if(a!==i&&(null==(t=o.value)?void 0:t.contentEl)&&(null==(n=o.value)?void 0:n.globalTop)&&![document,o.value.contentEl].includes(i)&&!o.value.contentEl.contains(i)){const e=wt(o.value.contentEl);if(!e.length)return;const t=e[0],n=e[e.length-1];a===t?n.focus():t.focus()}}function u(){var t;a("afterEnter"),(e.scrim||e.retainFocus)&&(null==(t=o.value)?void 0:t.contentEl)&&!o.value.contentEl.contains(document.activeElement)&&o.value.contentEl.focus({preventScroll:!0})}function c(){a("afterLeave")}return x(()=>{document.removeEventListener("focusin",l)}),Le&&d(()=>r.value&&e.retainFocus,e=>{e?document.addEventListener("focusin",l):document.removeEventListener("focusin",l)},{immediate:!0}),d(r,async e=>{var t;e||(await h(),null==(t=o.value.activatorEl)||t.focus({preventScroll:!0}))}),be(()=>{const t=II.filterProps(e),n=C({"aria-haspopup":"dialog"},e.activatorProps),a=C({tabindex:-1},e.contentProps);return y(II,C({ref:o,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},t,{modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,"aria-modal":"true",activatorProps:n,contentProps:a,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:u,onAfterLeave:c},s),{activator:i.activator,default:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return y(yb,{root:"VDialog"},{default:()=>{var e;return[null==(e=i.default)?void 0:e.call(i,...t)]}})}})}),kI({},o)}}),iC=oe({fluid:{type:Boolean,default:!1},..._e(),...Tb(),...kb()},"VContainer"),rC=se()({name:"VContainer",props:iC(),setup(e,t){let{slots:n}=t;const{rtlClasses:a}=Pe(),{dimensionStyles:i}=Ab(e);return be(()=>y(e.tag,{class:w(["v-container",{"v-container--fluid":e.fluid},a.value,e.class]),style:b([i.value,e.style])},n)),{}}}),sC=Mt.reduce((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e),{}),oC=Mt.reduce((e,t)=>(e["offset"+X(t)]={type:[String,Number],default:null},e),{}),lC=Mt.reduce((e,t)=>(e["order"+X(t)]={type:[String,Number],default:null},e),{}),uC={col:Object.keys(sC),offset:Object.keys(oC),order:Object.keys(lC)};function cC(e,t,n){let a=e;if(null!=n&&!1!==n){if(t){a+=`-${t.replace(e,"")}`}return"col"===e&&(a="v-"+a),"col"!==e||""!==n&&!0!==n?(a+=`-${n}`,a.toLowerCase()):a.toLowerCase()}}const dC=["auto","start","end","center","baseline","stretch"],hC=oe({cols:{type:[Boolean,String,Number],default:!1},...sC,offset:{type:[String,Number],default:null},...oC,order:{type:[String,Number],default:null},...lC,alignSelf:{type:String,default:null,validator:e=>dC.includes(e)},..._e(),...kb()},"VCol"),pC=se()({name:"VCol",props:hC(),setup(e,t){let{slots:n}=t;const a=f(()=>{const t=[];let n;for(n in uC)uC[n].forEach(a=>{const i=e[a],r=cC(n,a,i);r&&t.push(r)});const a=t.some(e=>e.startsWith("v-col-"));return t.push({"v-col":!a||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),t});return()=>{var t;return k(e.tag,{class:[a.value,e.class],style:e.style},null==(t=n.default)?void 0:t.call(n))}}}),fC=["start","end","center"],vC=["space-between","space-around","space-evenly"];function mC(e,t){return Mt.reduce((n,a)=>(n[e+X(a)]=t(),n),{})}const gC=[...fC,"baseline","stretch"],yC=e=>gC.includes(e),bC=mC("align",()=>({type:String,default:null,validator:yC})),wC=[...fC,...vC],_C=e=>wC.includes(e),IC=mC("justify",()=>({type:String,default:null,validator:_C})),SC=[...fC,...vC,"stretch"],CC=e=>SC.includes(e),kC=mC("alignContent",()=>({type:String,default:null,validator:CC})),EC={align:Object.keys(bC),justify:Object.keys(IC),alignContent:Object.keys(kC)},xC={align:"align",justify:"justify",alignContent:"align-content"};function TC(e,t,n){let a=xC[e];if(null!=n){if(t){a+=`-${t.replace(e,"")}`}return a+=`-${n}`,a.toLowerCase()}}const AC=oe({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:yC},...bC,justify:{type:String,default:null,validator:_C},...IC,alignContent:{type:String,default:null,validator:CC},...kC,..._e(),...kb()},"VRow"),NC=se()({name:"VRow",props:AC(),setup(e,t){let{slots:n}=t;const a=f(()=>{const t=[];let n;for(n in EC)EC[n].forEach(a=>{const i=e[a],r=TC(n,a,i);r&&t.push(r)});return t.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),t});return()=>{var t;return k(e.tag,{class:["v-row",a.value,e.class],style:e.style},null==(t=n.default)?void 0:t.call(n))}}}),VC=Ge("v-spacer","div","VSpacer"),DC={key:0,class:"mb-4"},MC={class:"mt-4"},RC={class:"text-subtitle-2 mb-2 text-medium-emphasis"},PC={class:"d-flex flex-wrap ga-2"},OC={key:1,class:"mt-6"},LC={class:"text-h6 font-weight-medium mb-3"},FC={class:"d-flex align-center gap-2"},BC=mb({__name:"ItemEditModal",props:{modelValue:{type:Boolean,default:!1},character:{type:Object,default:null},isNewCharacter:{type:Boolean,default:!1}},emits:["update:modelValue","save"],setup(e,{emit:n}){const a=e,i=n,r=fb(),s=f({get:()=>a.modelValue,set:e=>i("update:modelValue",e)}),o=t([]),l=t([]),u=t(""),c=t(!1),h=f(()=>a.character?r.characterMastersMap.get(a.character.characterMasterId):null),p=f(()=>r.itemMasters.map(e=>({id:e.id,name:e.name}))),v=e=>{if(!e)return!0;const t=l.value.filter(e=>!e.isVirtual).length,n=l.value.filter(e=>e.isVirtual).length;return t>4?"実アイテムは最大4個までです":n>4?"仮アイテムは最大4個までです":!(e.length>8)||"アイテムは最大8個までです"},m=e=>{const t=l.value.find(t=>t.itemId===e);return t?t.isVirtual?"orange":"success":"primary"},g=e=>{const t=e.filter(e=>!l.value.some(t=>t.itemId===e));l.value=l.value.filter(t=>e.includes(t.itemId)),t.forEach(e=>{l.value.push({itemId:Number(e),isVirtual:!1,willRemove:!1})})},b=()=>{s.value=!1,u.value=""},w=e=>{o.value=e,g(e)},I=()=>{confirm("このキャラクターを未所持に戻しますか？")&&(i("remove-character",a.character),b())},S=async()=>{const e=l.value.filter(e=>!e.isVirtual).length,t=l.value.filter(e=>e.isVirtual).length;if(e>4)u.value="実アイテムは最大4個までです";else if(t>4)u.value="仮アイテムは最大4個までです";else if(l.value.length>8)u.value="アイテムは最大8個までです";else{c.value=!0;try{i("save",{character:a.character,items:l.value,isNew:a.isNewCharacter}),b()}catch(n){u.value=`保存に失敗しました: ${n.message}`}finally{c.value=!1}}};return d(()=>a.character,e=>{if(!e)return l.value=[],void(o.value=[]);const t=to(e.items||[]);l.value=t.map(e=>({itemId:e.itemId,isVirtual:e.isVirtual||!1,willRemove:e.willRemove||!1})),o.value=t.map(e=>e.itemId)},{immediate:!0}),(t,n)=>(H(),W(aC,{modelValue:s.value,"onUpdate:modelValue":n[7]||(n[7]=e=>s.value=e),"max-width":"600px",persistent:""},{default:G(()=>[y(tC,{class:"dialog-card"},{default:G(()=>[y(QS,{class:"bg-primary text-white pa-4"},{default:G(()=>[y(xb,{icon:e.isNewCharacter?"mdi-plus-circle":"mdi-pencil",class:"mr-2"},null,8,["icon"]),K(" "+B(e.isNewCharacter?"所持追加+アイテム設定":"アイテム編集"),1)]),_:1}),y(ZS,{class:"pa-6"},{default:G(()=>[h.value?(H(),q("div",DC,[y(hS,{color:"primary",variant:"tonal",class:"mb-2"},{default:G(()=>[K(B(h.value.monsterName),1)]),_:1})])):Y("",!0),y(HS,{modelValue:o.value,"onUpdate:modelValue":[n[0]||(n[0]=e=>o.value=e),g],items:p.value,"item-title":"name","item-value":"id",label:"アイテムを選択（実最大4個+仮最大4個=最大8個）",multiple:"",chips:"","closable-chips":"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-sword-cross",rules:[v]},{chip:G(({props:e,item:t})=>[y(hS,C(e,{color:m(t.value),closable:""}),{default:G(()=>[K(B(t.title),1)]),_:2},1040,["color"])]),_:1},8,["modelValue","items","rules"]),_("div",MC,[_("div",RC,[y(xb,{icon:"mdi-flash",size:"small",class:"mr-1"}),n[8]||(n[8]=K(" クイックテンプレート ",-1))]),_("div",PC,[y(qw,{onClick:n[1]||(n[1]=e=>w([1,2,3])),color:"primary",variant:"outlined",size:"default",class:"template-btn"},{default:G(()=>n[9]||(n[9]=[K(" 同族3 ",-1)])),_:1,__:[9]}),y(qw,{onClick:n[2]||(n[2]=e=>w([4,5,6])),color:"primary",variant:"outlined",size:"default",class:"template-btn"},{default:G(()=>n[10]||(n[10]=[K(" 戦型3 ",-1)])),_:1,__:[10]}),y(qw,{onClick:n[3]||(n[3]=e=>w([7,8,9])),color:"primary",variant:"outlined",size:"default",class:"template-btn"},{default:G(()=>n[11]||(n[11]=[K(" 撃種3 ",-1)])),_:1,__:[11]}),y(qw,{onClick:n[4]||(n[4]=e=>w([21,22])),color:"primary",variant:"outlined",size:"default",class:"template-btn"},{default:G(()=>n[12]||(n[12]=[K(" 削り ",-1)])),_:1,__:[12]}),y(qw,{onClick:n[5]||(n[5]=e=>w([20])),color:"primary",variant:"outlined",size:"default",class:"template-btn"},{default:G(()=>n[13]||(n[13]=[K(" 友撃 ",-1)])),_:1,__:[13]})])]),l.value.length>0?(H(),q("div",OC,[y(Gw,{class:"mb-4"}),_("h6",LC,[y(xb,{icon:"mdi-cog",class:"mr-2",color:"secondary"}),n[14]||(n[14]=K(" アイテム設定 ",-1))]),y(q_,null,{default:G(()=>[(H(!0),q(N,null,J(l.value,e=>(H(),W(N_,{key:e.itemId,class:"mb-2 border rounded"},{prepend:G(()=>[y(xb,{icon:e.isVirtual?"mdi-clipboard-text-outline":"mdi-check-circle",color:e.isVirtual?"orange":"success"},null,8,["icon","color"])]),append:G(()=>[_("div",FC,[y(lw,{"model-value":e.isVirtual?"virtual":"real","onUpdate:modelValue":t=>((e,t)=>{const n=l.value.find(t=>t.itemId===e);n&&(n.isVirtual="virtual"===t)})(e.itemId,t),mandatory:"",density:"compact",color:"primary"},{default:G(()=>[y(qw,{value:"real",size:"small"},{default:G(()=>[y(xb,{icon:"mdi-check",class:"mr-1"}),n[15]||(n[15]=K(" 実 ",-1))]),_:1,__:[15]}),y(qw,{value:"virtual",size:"small"},{default:G(()=>[y(xb,{icon:"mdi-clipboard-text-outline",class:"mr-1"}),n[16]||(n[16]=K(" 予定 ",-1))]),_:1,__:[16]})]),_:2},1032,["model-value","onUpdate:modelValue"]),e.isVirtual?Y("",!0):(H(),W(tS,{key:0,modelValue:e.willRemove,"onUpdate:modelValue":t=>e.willRemove=t,label:"外す予定",density:"compact","hide-details":"",color:"warning"},null,8,["modelValue","onUpdate:modelValue"]))])]),default:G(()=>[y(T_,null,{default:G(()=>{return[K(B((t=e.itemId,r.itemMastersMap.get(Number(t))||"不明")),1)];var t}),_:2},1024)]),_:2},1024))),128))]),_:1})])):Y("",!0),u.value?(H(),W(BS,{key:2,type:"error",variant:"tonal",class:"mt-4",closable:"","onClick:close":n[6]||(n[6]=e=>u.value="")},{default:G(()=>[K(B(u.value),1)]),_:1})):Y("",!0)]),_:1}),y(GS,{class:"pa-4"},{default:G(()=>[e.isNewCharacter?Y("",!0):(H(),W(qw,{key:0,onClick:I,variant:"text",color:"error"},{default:G(()=>n[17]||(n[17]=[K(" 未所持に戻す ",-1)])),_:1,__:[17]})),y(VC),y(qw,{onClick:b,variant:"outlined",color:"secondary"},{default:G(()=>n[18]||(n[18]=[K(" キャンセル ",-1)])),_:1,__:[18]}),y(qw,{onClick:S,variant:"elevated",color:"primary",loading:c.value},{default:G(()=>n[19]||(n[19]=[K(" 保存 ",-1)])),_:1,__:[19]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},[["__scopeId","data-v-af06ee34"]]),UC=e=>{const t=String(e);if(t.includes(",")||t.includes('"')||t.includes("\n")){return`"${t.replace(/"/g,'""')}"`}return t},$C=new Map([[1,"同族・加命撃"],[2,"同族・加撃速"],[3,"同族・加撃"],[4,"戦型・加命撃"],[5,"戦型・加撃速"],[6,"戦型・加撃"],[7,"撃種・加命撃"],[8,"撃種・加撃速"],[9,"撃種・加撃"],[10,"同族・加速"],[11,"同族・加命"],[12,"同族・加速命"],[13,"戦型・加速"],[14,"戦型・加速命"],[15,"戦型・加速命"],[16,"撃種・加速"],[17,"撃種・加命"],[18,"撃種・加速命"],[19,"熱き友撃"],[20,"ケガ減り"],[21,"将命削り"],[22,"兵命削り"],[23,"一撃失心"],[24,"速必殺"],[25,"毒がまん"],[26,"ちび癒し"],[27,"ハート"],[28,"学び"],[29,"荒稼ぎ"],[30,"スピクリ"],[31,"Sランク"],[32,"スコア稼ぎ"]]),jC=(e,t)=>{const n="string"==typeof e?parseInt(e,10):e,a=$C.get(n);return a||(t&&t.get(n)||`アイテム${e}`)};const zC=oe({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1==0},totalVisible:[Number,String],firstIcon:{type:Ie,default:"$first"},prevIcon:{type:Ie,default:"$prev"},nextIcon:{type:Ie,default:"$next"},lastIcon:{type:Ie,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...Ub(),..._e(),...zb(),...Yb(),...Db(),...Sb(),...kb({tag:"nav"}),...we(),...Kb({variant:"text"})},"VPagination"),qC=se()({name:"VPagination",props:zC(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,n){let{slots:a,emit:i}=n;const r=Ae(e,"modelValue"),{t:s,n:o}=Ct(),{isRtl:l}=Pe(),{themeClasses:u}=Te(e),{width:c}=gt(),d=m(-1);le(void 0,{scoped:!0});const{resizeRef:p}=Me(e=>{if(!e.length)return;const{target:t,contentRect:n}=e[0],a=t.querySelector(".v-pagination__list > *");if(!a)return;const i=n.width,r=a.offsetWidth+2*parseFloat(getComputedStyle(a).marginRight);d.value=S(i,r)}),v=f(()=>parseInt(e.length,10)),g=f(()=>parseInt(e.start,10)),I=f(()=>null!=e.totalVisible?parseInt(e.totalVisible,10):d.value>=0?d.value:S(c.value,58));function S(t,n){const a=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((t-n*a)/n).toFixed(2))))}const k=f(()=>{if(v.value<=0||isNaN(v.value)||v.value>Number.MAX_SAFE_INTEGER)return[];if(I.value<=0)return[];if(1===I.value)return[r.value];if(v.value<=I.value)return Rt(v.value,g.value);const t=I.value%2==0,n=t?I.value/2:Math.floor(I.value/2),a=t?n:n+1,i=v.value-n;if(a-r.value>=0)return[...Rt(Math.max(1,I.value-1),g.value),e.ellipsis,v.value];if(r.value-i>=(t?1:0)){const t=I.value-1,n=v.value-t+g.value;return[g.value,e.ellipsis,...Rt(t,n)]}{const t=Math.max(1,I.value-2),n=1===t?r.value:r.value-Math.ceil(t/2)+g.value;return[g.value,e.ellipsis,...Rt(t,n),e.ellipsis,v.value]}});function E(e,t,n){e.preventDefault(),r.value=t,n&&i(n,t)}const{refs:x,updateRef:A}=function(){const e=t([]);return Z(()=>e.value=[]),{refs:e,updateRef:function(t,n){e.value[n]=t}}}();le({VPaginationBtn:{color:T(()=>e.color),border:T(()=>e.border),density:T(()=>e.density),size:T(()=>e.size),variant:T(()=>e.variant),rounded:T(()=>e.rounded),elevation:T(()=>e.elevation)}});const N=f(()=>k.value.map((t,n)=>{const a=e=>A(e,n);if("string"==typeof t)return{isActive:!1,key:`ellipsis-${n}`,page:t,props:{ref:a,ellipsis:!0,icon:!0,disabled:!0}};{const n=t===r.value;return{isActive:n,key:t,page:o(t),props:{ref:a,ellipsis:!1,icon:!0,disabled:!!e.disabled||Number(e.length)<2,color:n?e.activeColor:e.color,"aria-current":n,"aria-label":s(n?e.currentPageAriaLabel:e.pageAriaLabel,t),onClick:e=>E(e,t)}}}})),V=f(()=>{const t=!!e.disabled||r.value<=g.value,n=!!e.disabled||r.value>=g.value+v.value-1;return{first:e.showFirstLastPage?{icon:l.value?e.lastIcon:e.firstIcon,onClick:e=>E(e,g.value,"first"),disabled:t,"aria-label":s(e.firstAriaLabel),"aria-disabled":t}:void 0,prev:{icon:l.value?e.nextIcon:e.prevIcon,onClick:e=>E(e,r.value-1,"prev"),disabled:t,"aria-label":s(e.previousAriaLabel),"aria-disabled":t},next:{icon:l.value?e.prevIcon:e.nextIcon,onClick:e=>E(e,r.value+1,"next"),disabled:n,"aria-label":s(e.nextAriaLabel),"aria-disabled":n},last:e.showFirstLastPage?{icon:l.value?e.firstIcon:e.lastIcon,onClick:e=>E(e,g.value+v.value-1,"last"),disabled:n,"aria-label":s(e.lastAriaLabel),"aria-disabled":n}:void 0}});function D(){var e;const t=r.value-g.value;null==(e=x.value[t])||e.$el.focus()}function M(t){t.key===Pt.left&&!e.disabled&&r.value>Number(e.start)?(r.value=r.value-1,h(D)):t.key===Pt.right&&!e.disabled&&r.value<g.value+v.value-1&&(r.value=r.value+1,h(D))}return be(()=>y(e.tag,{ref:p,class:w(["v-pagination",u.value,e.class]),style:b(e.style),role:"navigation","aria-label":s(e.ariaLabel),onKeydown:M,"data-test":"v-pagination-root"},{default:()=>[_("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&_("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[a.first?a.first(V.value.first):y(qw,C({_as:"VPaginationBtn"},V.value.first),null)]),_("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[a.prev?a.prev(V.value.prev):y(qw,C({_as:"VPaginationBtn"},V.value.prev),null)]),N.value.map((e,t)=>_("li",{key:e.key,class:w(["v-pagination__item",{"v-pagination__item--is-active":e.isActive}]),"data-test":"v-pagination-item"},[a.item?a.item(e):y(qw,C({_as:"VPaginationBtn"},e.props),{default:()=>[e.page]})])),_("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[a.next?a.next(V.value.next):y(qw,C({_as:"VPaginationBtn"},V.value.next),null)]),e.showFirstLastPage&&_("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[a.last?a.last(V.value.last):y(qw,C({_as:"VPaginationBtn"},V.value.last),null)])])]})),{}}}),HC=oe({page:{type:[Number,String],default:1},itemsPerPage:{type:[Number,String],default:10}},"DataTable-paginate"),GC=Symbol.for("vuetify:data-table-pagination");const KC=oe({prevIcon:{type:Ie,default:"$prev"},nextIcon:{type:Ie,default:"$next"},firstIcon:{type:Ie,default:"$first"},lastIcon:{type:Ie,default:"$last"},itemsPerPageText:{type:String,default:"$vuetify.dataFooter.itemsPerPageText"},pageText:{type:String,default:"$vuetify.dataFooter.pageText"},firstPageLabel:{type:String,default:"$vuetify.dataFooter.firstPage"},prevPageLabel:{type:String,default:"$vuetify.dataFooter.prevPage"},nextPageLabel:{type:String,default:"$vuetify.dataFooter.nextPage"},lastPageLabel:{type:String,default:"$vuetify.dataFooter.lastPage"},itemsPerPageOptions:{type:Array,default:()=>[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}]},showCurrentPage:Boolean},"VDataTableFooter"),WC=se()({name:"VDataTableFooter",props:KC(),setup(e,t){let{slots:n}=t;const{t:i}=Ct(),{page:r,pageCount:s,startIndex:o,stopIndex:l,itemsLength:u,itemsPerPage:c,setItemsPerPage:d}=function(){const e=a(GC);if(!e)throw new Error("Missing pagination!");return e}(),h=f(()=>e.itemsPerPageOptions.map(e=>"number"==typeof e?{value:e,title:-1===e?i("$vuetify.dataFooter.itemsPerPageAll"):String(e)}:{...e,title:isNaN(Number(e.title))?i(e.title):e.title}));return be(()=>{var t;const a=qC.filterProps(e);return _("div",{class:"v-data-table-footer"},[null==(t=n.prepend)?void 0:t.call(n),_("div",{class:"v-data-table-footer__items-per-page"},[_("span",{"aria-label":i(e.itemsPerPageText)},[i(e.itemsPerPageText)]),y(DS,{items:h.value,modelValue:c.value,"onUpdate:modelValue":e=>d(Number(e)),density:"compact",variant:"outlined",hideDetails:!0},null)]),_("div",{class:"v-data-table-footer__info"},[_("div",null,[i(e.pageText,u.value?o.value+1:0,l.value,u.value)])]),_("div",{class:"v-data-table-footer__pagination"},[y(qC,C({modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,density:"comfortable",firstAriaLabel:e.firstPageLabel,lastAriaLabel:e.lastPageLabel,length:s.value,nextAriaLabel:e.nextPageLabel,previousAriaLabel:e.prevPageLabel,rounded:!0,showFirstLastPage:!0,totalVisible:e.showCurrentPage?1:0,variant:"plain"},a),null)])])}),{}}}),QC=Ot({align:{type:String,default:"start"},fixed:{type:[Boolean,String],default:!1},fixedOffset:[Number,String],fixedEndOffset:[Number,String],height:[Number,String],lastFixed:Boolean,firstFixedEnd:Boolean,noPadding:Boolean,tag:String,width:[Number,String],maxWidth:[Number,String],nowrap:Boolean},(e,t)=>{let{slots:n}=t;const a=e.tag??"td",i="string"==typeof e.fixed?e.fixed:e.fixed?"start":"none";return y(a,{class:w(["v-data-table__td",{"v-data-table-column--fixed":"start"===i,"v-data-table-column--fixed-end":"end"===i,"v-data-table-column--last-fixed":e.lastFixed,"v-data-table-column--first-fixed-end":e.firstFixedEnd,"v-data-table-column--no-padding":e.noPadding,"v-data-table-column--nowrap":e.nowrap},`v-data-table-column--align-${e.align}`]),style:{height:me(e.height),width:me(e.width),maxWidth:me(e.maxWidth),left:"start"===i?me(e.fixedOffset||null):void 0,right:"end"===i?me(e.fixedEndOffset||null):void 0}},{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n)]}})}),XC=oe({headers:Array},"DataTable-header"),YC=Symbol.for("vuetify:data-table-headers"),JC={title:"",sortable:!1},ZC={...JC,width:48};function ek(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.children)for(const n of e.children)ek(n,t);else t.push(e);return t}function tk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;for(const n of e)n.key&&t.add(n.key),n.children&&tk(n.children,t);return t}function nk(e){if(e.key)return"data-table-group"===e.key?JC:["data-table-expand","data-table-select"].includes(e.key)?ZC:void 0}function ak(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.children?Math.max(t,...e.children.map(e=>ak(e,t+1))):t}function ik(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;if(e.children){e.fixedOffset=t;for(const n of e.children)t=ik(n,t)}else e.fixed&&"end"!==e.fixed&&(e.fixedOffset=t,t+=parseFloat(e.width||"0")||0);return t}function rk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;if(e.children){e.fixedEndOffset=t;for(const n of e.children)t=rk(n,t)}else"end"===e.fixed&&(e.fixedEndOffset=t,t+=parseFloat(e.width||"0")||0);return t}function sk(e,t){const n=[];let a=0;const i=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>({element:e,priority:0}));return{enqueue:(t,n)=>{let a=!1;for(let i=0;i<e.length;i++)if(e[i].priority>n){e.splice(i,0,{element:t,priority:n}),a=!0;break}a||e.push({element:t,priority:n})},size:()=>e.length,count:()=>{let t=0;if(!e.length)return 0;const n=Math.floor(e[0].priority);for(let a=0;a<e.length;a++)Math.floor(e[a].priority)===n&&(t+=1);return t},dequeue:()=>e.shift()}}(e);for(;i.size()>0;){let e=i.count();const r=[];let s=1;for(;e>0;){const{element:n,priority:o}=i.dequeue(),l=t-a-ak(n);if(r.push({...n,rowspan:l??1,colspan:n.children?ek(n).length:1}),n.children)for(const e of n.children){const t=o%1+s/Math.pow(10,a+2);i.enqueue(e,a+l+t)}s+=1,e-=1}a+=1,n.push(r)}return{columns:e.map(e=>ek(e)).flat(),headers:n}}function ok(e){const t=[];for(const n of e){const e={...nk(n),...n},a=e.key??("string"==typeof e.value?e.value:null),i=e.value??a??null,r={...e,key:a,value:i,sortable:e.sortable??(null!=e.key||!!e.sort),children:e.children?ok(e.children):void 0};t.push(r)}return t}function lk(e,n){const a=t([]),i=t([]),r=t({}),s=t({}),o=t({});L(()=>{var t,l,u;const c=(e.headers||Object.keys(e.items[0]??{}).map(e=>({key:e,title:X(e)}))).slice(),d=tk(c);(null==(t=null==n?void 0:n.groupBy)?void 0:t.value.length)&&!d.has("data-table-group")&&c.unshift({key:"data-table-group",title:"Group"}),(null==(l=null==n?void 0:n.showSelect)?void 0:l.value)&&!d.has("data-table-select")&&c.unshift({key:"data-table-select"}),(null==(u=null==n?void 0:n.showExpand)?void 0:u.value)&&!d.has("data-table-expand")&&c.push({key:"data-table-expand"});const h=ok(c);!function(e){let t=!1;function n(e,a){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none";if(e)if("none"!==i&&(e.fixed=i),!0===e.fixed&&(e.fixed="start"),e.fixed===a)if(e.children)if("start"===a)for(let t=e.children.length-1;t>=0;t--)n(e.children[t],a,a);else for(let t=0;t<e.children.length;t++)n(e.children[t],a,a);else t||"start"!==a?t||"end"!==a?isNaN(Number(e.width))?Lt(`Multiple fixed columns should have a static width (key: ${e.key})`):e.minWidth=Math.max(Number(e.width)||0,Number(e.minWidth)||0):e.firstFixedEnd=!0:e.lastFixed=!0,t=!0;else if(e.children)if("start"===a)for(let t=e.children.length-1;t>=0;t--)n(e.children[t],a);else for(let t=0;t<e.children.length;t++)n(e.children[t],a);else t=!1}for(let r=e.length-1;r>=0;r--)n(e[r],"start");for(let r=0;r<e.length;r++)n(e[r],"end");let a=0;for(let r=0;r<e.length;r++)a=ik(e[r],a);let i=0;for(let r=e.length-1;r>=0;r--)i=rk(e[r],i)}(h);const p=Math.max(...h.map(e=>ak(e)))+1,f=sk(h,p);a.value=f.headers,i.value=f.columns;const v=f.headers.flat(1);for(const e of v)e.key&&(e.sortable&&(e.sort&&(r.value[e.key]=e.sort),e.sortRaw&&(s.value[e.key]=e.sortRaw)),e.filter&&(o.value[e.key]=e.filter))});const l={headers:a,columns:i,sortFunctions:r,sortRawFunctions:s,filterFunctions:o};return P(YC,l),l}function uk(){const e=a(YC);if(!e)throw new Error("Missing headers!");return e}const ck={showSelectAll:!1,allSelected:()=>[],select:e=>{var t;let{items:n,value:a}=e;return new Set(a?[null==(t=n[0])?void 0:t.value]:[])},selectAll:e=>{let{selected:t}=e;return t}},dk={showSelectAll:!0,allSelected:e=>{let{currentPage:t}=e;return t},select:e=>{let{items:t,value:n,selected:a}=e;for(const i of t)n?a.add(i.value):a.delete(i.value);return a},selectAll:e=>{let{value:t,currentPage:n,selected:a}=e;return dk.select({items:n,value:t,selected:a})}},hk={showSelectAll:!0,allSelected:e=>{let{allItems:t}=e;return t},select:e=>{let{items:t,value:n,selected:a}=e;for(const i of t)n?a.add(i.value):a.delete(i.value);return a},selectAll:e=>{let{value:t,allItems:n,selected:a}=e;return hk.select({items:n,value:t,selected:a})}},pk=oe({showSelect:Boolean,selectStrategy:{type:[String,Object],default:"page"},modelValue:{type:Array,default:()=>[]},valueComparator:{type:Function,default:Ne}},"DataTable-select"),fk=Symbol.for("vuetify:data-table-selection");function vk(e,t){let{allItems:n,currentPage:a}=t;const i=Ae(e,"modelValue",e.modelValue,t=>new Set(Ve(t).map(t=>{var a;return(null==(a=n.value.find(n=>e.valueComparator(t,n.value)))?void 0:a.value)??t})),e=>[...e.values()]),r=f(()=>n.value.filter(e=>e.selectable)),s=f(()=>a.value.filter(e=>e.selectable)),o=f(()=>{if("object"==typeof e.selectStrategy)return e.selectStrategy;switch(e.selectStrategy){case"single":return ck;case"all":return hk;default:return dk}}),l=m(null);function u(e){return Ve(e).every(e=>i.value.has(e.value))}function c(e,t){const n=o.value.select({items:e,value:t,selected:new Set(i.value)});i.value=n}const d=f(()=>i.value.size>0),h=f(()=>{const e=o.value.allSelected({allItems:r.value,currentPage:s.value});return!!e.length&&u(e)}),p={toggleSelect:function(t,n,i){const r=[];if(n=n??a.value.findIndex(e=>e.value===t.value),"single"!==e.selectStrategy&&(null==i?void 0:i.shiftKey)&&null!==l.value){const[e,t]=[l.value,n].sort((e,t)=>e-t);r.push(...a.value.slice(e,t+1).filter(e=>e.selectable))}else r.push(t),l.value=n;c(r,!u([t]))},select:c,selectAll:function(e){const t=o.value.selectAll({value:e,allItems:r.value,currentPage:s.value,selected:new Set(i.value)});i.value=t},isSelected:u,isSomeSelected:function(e){return Ve(e).some(e=>i.value.has(e.value))},someSelected:d,allSelected:h,showSelectAll:T(()=>o.value.showSelectAll),lastSelectedIndex:l,selectStrategy:o};return P(fk,p),p}function mk(){const e=a(fk);if(!e)throw new Error("Missing selection!");return e}const gk=oe({sortBy:{type:Array,default:()=>[]},customKeySort:Object,multiSort:Boolean,mustSort:Boolean},"DataTable-sort"),yk=Symbol.for("vuetify:data-table-sort");function bk(e){return{sortBy:Ae(e,"sortBy"),mustSort:T(()=>e.mustSort),multiSort:T(()=>e.multiSort)}}function wk(e){const{sortBy:t,mustSort:n,multiSort:a,page:i}=e;const r={sortBy:t,toggleSort:e=>{if(null==e.key)return;let r=t.value.map(e=>({...e}))??[];const s=r.find(t=>t.key===e.key);s?"desc"===s.order?n.value&&1===r.length?s.order="asc":r=r.filter(t=>t.key!==e.key):s.order="desc":a.value?r.push({key:e.key,order:"asc"}):r=[{key:e.key,order:"asc"}],t.value=r,i&&(i.value=1)},isSorted:function(e){return!!t.value.find(t=>t.key===e.key)}};return P(yk,r),r}function _k(){const e=a(yk);if(!e)throw new Error("Missing sort!");return e}function Ik(e,t,n,a){const i=Ct(),r=f(()=>{var r,s;return n.value.length?function(e,t,n,a){const i=new Intl.Collator(n,{sensitivity:"accent",usage:"sort"}),r=e.map(e=>[e,(null==a?void 0:a.transform)?a.transform(e):e]);return r.sort((e,n)=>{var r,s;for(let o=0;o<t.length;o++){let l=!1;const u=t[o].key,c=t[o].order??"asc";if(!1===c)continue;let d=Ft(e[1],u),h=Ft(n[1],u),p=e[0].raw,f=n[0].raw;if("desc"===c&&([d,h]=[h,d],[p,f]=[f,p]),null==(r=null==a?void 0:a.sortRawFunctions)?void 0:r[u]){const e=a.sortRawFunctions[u](p,f);if(null==e)continue;if(l=!0,e)return e}if(null==(s=null==a?void 0:a.sortFunctions)?void 0:s[u]){const e=a.sortFunctions[u](d,h);if(null==e)continue;if(l=!0,e)return e}if(!l&&(d instanceof Date&&h instanceof Date&&(d=d.getTime(),h=h.getTime()),[d,h]=[d,h].map(e=>null!=e?e.toString().toLocaleLowerCase():e),d!==h))return Bt(d)&&Bt(h)?0:Bt(d)?-1:Bt(h)?1:isNaN(d)||isNaN(h)?i.compare(d,h):Number(d)-Number(h)}return 0}).map(e=>{let[t]=e;return t})}(t.value,n.value,i.current.value,{transform:null==a?void 0:a.transform,sortFunctions:{...e.customKeySort,...null==(r=null==a?void 0:a.sortFunctions)?void 0:r.value},sortRawFunctions:null==(s=null==a?void 0:a.sortRawFunctions)?void 0:s.value}):t.value});return{sortedItems:r}}const Sk=oe({color:String,disableSort:Boolean,fixedHeader:Boolean,multiSort:Boolean,sortAscIcon:{type:Ie,default:"$sortAsc"},sortDescIcon:{type:Ie,default:"$sortDesc"},headerProps:{type:Object},sticky:Boolean,...Et(),...gw()},"VDataTableHeaders"),Ck=se()({name:"VDataTableHeaders",props:Sk(),setup(e,t){let{slots:n}=t;const{t:a}=Ct(),{toggleSort:i,sortBy:r,isSorted:s}=_k(),{someSelected:o,allSelected:l,selectAll:u,showSelectAll:c}=mk(),{columns:d,headers:h}=uk(),{loaderClasses:p}=yw(e);function v(t,n){if(!e.sticky&&!e.fixedHeader&&!t.fixed)return;const a="string"==typeof t.fixed?t.fixed:t.fixed?"start":"none";return{position:"sticky",left:"start"===a?me(t.fixedOffset):void 0,right:"end"===a?me(t.fixedEndOffset):void 0,top:e.sticky||e.fixedHeader?`calc(var(--v-table-header-height) * ${n})`:void 0}}function m(t){const n=r.value.find(e=>e.key===t.key);return n?"asc"===n.order?e.sortAscIcon:e.sortDescIcon:e.sortAscIcon}const{backgroundColorClasses:g,backgroundColorStyles:I}=_b(()=>e.color),{displayClasses:S,mobile:k}=gt(e),E=f(()=>({headers:h.value,columns:d.value,toggleSort:i,isSorted:s,sortBy:r.value,someSelected:o.value,allSelected:l.value,selectAll:u,getSortIcon:m})),x=f(()=>["v-data-table__th",{"v-data-table__th--sticky":e.sticky||e.fixedHeader},S.value,p.value]),T=t=>{let{column:a,x:d,y:h}=t;const p="data-table-select"===a.key||"data-table-expand"===a.key,f=C(e.headerProps??{},a.headerProps??{});return y(QC,C({tag:"th",align:a.align,class:[{"v-data-table__th--sortable":a.sortable&&!e.disableSort,"v-data-table__th--sorted":s(a),"v-data-table__th--fixed":a.fixed},...x.value],style:{width:me(a.width),minWidth:me(a.minWidth),maxWidth:me(a.maxWidth),...v(a,h)},colspan:a.colspan,rowspan:a.rowspan,fixed:a.fixed,nowrap:a.nowrap,lastFixed:a.lastFixed,firstFixedEnd:a.firstFixedEnd,noPadding:p,tabindex:a.sortable?0:void 0,onClick:a.sortable?()=>i(a):void 0,onKeydown:a.sortable?t=>function(t,n){"Enter"!==t.key||e.disableSort||i(n)}(t,a):void 0},f),{default:()=>{var t;const d=`header.${a.key}`,h={column:a,selectAll:u,isSorted:s,toggleSort:i,sortBy:r.value,someSelected:o.value,allSelected:l.value,getSortIcon:m};return n[d]?n[d](h):"data-table-select"===a.key?(null==(t=n["header.data-table-select"])?void 0:t.call(n,h))??(c.value&&y(UI,{modelValue:l.value,indeterminate:o.value&&!l.value,"onUpdate:modelValue":u},null)):_("div",{class:"v-data-table-header__content"},[_("span",null,[a.title]),a.sortable&&!e.disableSort&&y(xb,{key:"icon",class:"v-data-table-header__sort-icon",icon:m(a)},null),e.multiSort&&s(a)&&_("div",{key:"badge",class:w(["v-data-table-header__sort-badge",...g.value]),style:b(I.value)},[r.value.findIndex(e=>e.key===a.key)+1])])}})},A=()=>{const t=f(()=>d.value.filter(t=>(null==t?void 0:t.sortable)&&!e.disableSort)),n=f(()=>{if(null!=d.value.find(e=>"data-table-select"===e.key))return l.value?"$checkboxOn":o.value?"$checkboxIndeterminate":"$checkboxOff"});return y(QC,C({tag:"th",class:[...x.value],colspan:h.value.length+1},e.headerProps),{default:()=>[_("div",{class:"v-data-table-header__content"},[y(DS,{chips:!0,class:"v-data-table__td-sort-select",clearable:!0,density:"default",items:t.value,label:a("$vuetify.dataTable.sortBy"),multiple:e.multiSort,variant:"underlined","onClick:clear":()=>r.value=[],appendIcon:n.value,"onClick:append":()=>u(!l.value)},{chip:e=>{var t;return y(hS,{onClick:(null==(t=e.item.raw)?void 0:t.sortable)?()=>i(e.item.raw):void 0,onMousedown:e=>{e.preventDefault(),e.stopPropagation()}},{default:()=>[e.item.title,y(xb,{class:w(["v-data-table__td-sort-icon",s(e.item.raw)&&"v-data-table__td-sort-icon-active"]),icon:m(e.item.raw),size:"small"},null)]})}})])]})};be(()=>k.value?_("tr",null,[y(A,null,null)]):_(N,null,[n.headers?n.headers(E.value):h.value.map((e,t)=>_("tr",null,[e.map((e,n)=>y(T,{column:e,x:n,y:t},null))])),e.loading&&_("tr",{class:"v-data-table-progress"},[_("th",{colspan:d.value.length},[y(bw,{name:"v-data-table-progress",absolute:!0,active:!0,color:"boolean"==typeof e.loading?void 0:e.loading,indeterminate:!0},{default:n.loader})])])]))}}),kk=oe({groupBy:{type:Array,default:()=>[]}},"DataTable-group"),Ek=Symbol.for("vuetify:data-table-group");function xk(e){return{groupBy:Ae(e,"groupBy")}}function Tk(e){const{disableSort:n,groupBy:a,sortBy:i}=e,r=t(new Set);function s(e){return r.value.has(e.id)}const o={sortByWithGroups:f(()=>a.value.map(e=>({...e,order:e.order??!1})).concat((null==n?void 0:n.value)?[]:i.value)),toggleGroup:function(e){const t=new Set(r.value);s(e)?t.delete(e.id):t.add(e.id),r.value=t},opened:r,groupBy:a,extractRows:function(e){return function e(t){const n=[];for(const a of t.items)"type"in a&&"group"===a.type?n.push(...e(a)):n.push(a);return[...new Set(n)]}({items:e})},isGroupOpen:s};return P(Ek,o),o}function Ak(){const e=a(Ek);if(!e)throw new Error("Missing group!");return e}function Nk(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"root";if(!t.length)return[];const i=function(e,t){if(!e.length)return[];const n=new Map;for(const a of e){const e=Ft(a.raw,t);n.has(e)||n.set(e,[]),n.get(e).push(a)}return n}(e,t[0]),r=[],s=t.slice(1);return i.forEach((e,i)=>{const o=t[0],l=`${a}_${o}_${i}`;r.push({depth:n,id:l,key:o,value:i,items:s.length?Nk(e,s,n+1,l):e,type:"group"})}),r}function Vk(e,t){const n=[];for(const a of e)"type"in a&&"group"===a.type?(null!=a.value&&n.push(a),(t.has(a.id)||null==a.value)&&n.push(...Vk(a.items,t))):n.push(a);return n}function Dk(e,t,n){return{flatItems:f(()=>{if(!t.value.length)return e.value;return Vk(Nk(e.value,t.value.map(e=>e.key)),n.value)})}}const Mk=oe({item:{type:Object,required:!0}},"VDataTableGroupHeaderRow"),Rk=se()({name:"VDataTableGroupHeaderRow",props:Mk(),setup(e,t){let{slots:n}=t;const{isGroupOpen:a,toggleGroup:i,extractRows:r}=Ak(),{isSelected:s,isSomeSelected:o,select:l}=mk(),{columns:u}=uk(),c=f(()=>r([e.item]));return()=>_("tr",{class:"v-data-table-group-header-row",style:{"--v-data-table-group-header-row-depth":e.item.depth}},[u.value.map(t=>{var r,u;if("data-table-group"===t.key){const t=a(e.item)?"$expand":"$next",s=()=>i(e.item);return(null==(r=n["data-table-group"])?void 0:r.call(n,{item:e.item,count:c.value.length,props:{icon:t,onClick:s}}))??y(QC,{class:"v-data-table-group-header-row__column"},{default:()=>[y(qw,{size:"small",variant:"text",icon:t,onClick:s},null),_("span",null,[e.item.value]),_("span",null,[K("("),c.value.length,K(")")])]})}if("data-table-select"===t.key){const e=s(c.value),t=o(c.value)&&!e,a=e=>l(c.value,e);return(null==(u=n["data-table-select"])?void 0:u.call(n,{props:{modelValue:e,indeterminate:t,"onUpdate:modelValue":a}}))??_("td",null,[y(UI,{modelValue:e,indeterminate:t,"onUpdate:modelValue":a},null)])}return _("td",null,null)})])}}),Pk=oe({expandOnClick:Boolean,showExpand:Boolean,expanded:{type:Array,default:()=>[]}},"DataTable-expand"),Ok=Symbol.for("vuetify:datatable:expanded");function Lk(e){const t=T(()=>e.expandOnClick),n=Ae(e,"expanded",e.expanded,e=>new Set(e),e=>[...e.values()]);function a(e,t){const a=new Set(n.value);t?a.add(e.value):a.delete(e.value),n.value=a}function i(e){return n.value.has(e.value)}const r={expand:a,expanded:n,expandOnClick:t,isExpanded:i,toggleExpand:function(e){a(e,!i(e))}};return P(Ok,r),r}function Fk(){const e=a(Ok);if(!e)throw new Error("foo");return e}const Bk=oe({index:Number,item:Object,cellProps:[Object,Function],onClick:We(),onContextmenu:We(),onDblclick:We(),...Et()},"VDataTableRow"),Uk=se()({name:"VDataTableRow",props:Bk(),setup(e,t){let{slots:n}=t;const{displayClasses:a,mobile:i}=gt(e,"v-data-table__tr"),{isSelected:r,toggleSelect:s,someSelected:o,allSelected:l,selectAll:u}=mk(),{isExpanded:c,toggleExpand:d}=Fk(),{toggleSort:h,sortBy:p,isSorted:f}=_k(),{columns:v}=uk();be(()=>_("tr",{class:w(["v-data-table__tr",{"v-data-table__tr--clickable":!!(e.onClick||e.onContextmenu||e.onDblclick)},a.value]),onClick:e.onClick,onContextmenu:e.onContextmenu,onDblclick:e.onDblclick},[e.item&&v.value.map((t,a)=>{const v=e.item,m=`item.${t.key}`,g=`header.${t.key}`,b={index:e.index,item:v.raw,internalItem:v,value:Ft(v.columns,t.key),column:t,isSelected:r,toggleSelect:s,isExpanded:c,toggleExpand:d},w={column:t,selectAll:u,isSorted:f,toggleSort:h,sortBy:p.value,someSelected:o.value,allSelected:l.value,getSortIcon:()=>""},I="function"==typeof e.cellProps?e.cellProps({index:b.index,item:b.item,internalItem:b.internalItem,value:b.value,column:t}):e.cellProps,S="function"==typeof t.cellProps?t.cellProps({index:b.index,item:b.item,internalItem:b.internalItem,value:b.value}):t.cellProps;return y(QC,C({align:t.align,class:{"v-data-table__td--expanded-row":"data-table-expand"===t.key,"v-data-table__td--select-row":"data-table-select"===t.key},fixed:t.fixed,fixedOffset:t.fixedOffset,fixedEndOffset:t.fixedEndOffset,lastFixed:t.lastFixed,firstFixedEnd:t.firstFixedEnd,maxWidth:i.value?void 0:t.maxWidth,noPadding:"data-table-select"===t.key||"data-table-expand"===t.key,nowrap:t.nowrap,width:i.value?void 0:t.width},I,S),{default:()=>{var a,o,l,u;if("data-table-select"===t.key)return(null==(a=n["item.data-table-select"])?void 0:a.call(n,{...b,props:{disabled:!v.selectable,modelValue:r([v]),onClick:ee(()=>s(v),["stop"])}}))??y(UI,{disabled:!v.selectable,modelValue:r([v]),onClick:ee(t=>s(v,e.index,t),["stop"])},null);if("data-table-expand"===t.key)return(null==(o=n["item.data-table-expand"])?void 0:o.call(n,{...b,props:{icon:c(v)?"$collapse":"$expand",size:"small",variant:"text",onClick:ee(()=>d(v),["stop"])}}))??y(qw,{icon:c(v)?"$collapse":"$expand",size:"small",variant:"text",onClick:ee(()=>d(v),["stop"])},null);if(n[m]&&!i.value)return n[m](b);const h=B(b.value);return i.value?_(N,null,[_("div",{class:"v-data-table__td-title"},[(null==(l=n[g])?void 0:l.call(n,w))??t.title]),_("div",{class:"v-data-table__td-value"},[(null==(u=n[m])?void 0:u.call(n,b))??h])]):h}})})]))}}),$k=oe({loading:[Boolean,String],loadingText:{type:String,default:"$vuetify.dataIterator.loadingText"},hideNoData:Boolean,items:{type:Array,default:()=>[]},noDataText:{type:String,default:"$vuetify.noDataText"},rowProps:[Object,Function],cellProps:[Object,Function],...Et()},"VDataTableRows"),jk=se()({name:"VDataTableRows",inheritAttrs:!1,props:$k(),setup(e,t){let{attrs:n,slots:a}=t;const{columns:i}=uk(),{expandOnClick:r,toggleExpand:s,isExpanded:o}=Fk(),{isSelected:l,toggleSelect:u}=mk(),{toggleGroup:c,isGroupOpen:d}=Ak(),{t:h}=Ct(),{mobile:p}=gt(e);return be(()=>{var t,f;return!e.loading||e.items.length&&!a.loading?e.loading||e.items.length||e.hideNoData?_(N,null,[e.items.map((t,h)=>{var f;if("group"===t.type){const e={index:h,item:t,columns:i.value,isExpanded:o,toggleExpand:s,isSelected:l,toggleSelect:u,toggleGroup:c,isGroupOpen:d};return a["group-header"]?a["group-header"](e):y(Rk,C({key:`group-header_${t.id}`,item:t},Ut(n,":group-header",()=>e)),a)}const v={index:h,item:t.raw,internalItem:t,columns:i.value,isExpanded:o,toggleExpand:s,isSelected:l,toggleSelect:u},m={...v,props:C({key:`item_${t.key??t.index}`,onClick:r.value?()=>{s(t)}:void 0,index:h,item:t,cellProps:e.cellProps,mobile:p.value},Ut(n,":row",()=>v),"function"==typeof e.rowProps?e.rowProps({item:v.item,index:v.index,internalItem:v.internalItem}):e.rowProps)};return _(N,{key:m.props.key},[a.item?a.item(m):y(Uk,m.props,a),o(t)&&(null==(f=a["expanded-row"])?void 0:f.call(a,v))])})]):_("tr",{class:"v-data-table-rows-no-data",key:"no-data"},[_("td",{colspan:i.value.length},[(null==(f=a["no-data"])?void 0:f.call(a))??h(e.noDataText)])]):_("tr",{class:"v-data-table-rows-loading",key:"loading"},[_("td",{colspan:i.value.length},[(null==(t=a.loading)?void 0:t.call(a))??h(e.loadingText)])])}),{}}}),zk=oe({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,striped:{type:String,default:null,validator:e=>["even","odd"].includes(e)},..._e(),...zb(),...kb(),...we()},"VTable"),qk=se()({name:"VTable",props:zk(),setup(e,t){let{slots:n,emit:a}=t;const{themeClasses:i}=Te(e),{densityClasses:r}=qb(e);return be(()=>{const t={VCheckboxBtn:{density:e.density}};return y(e.tag,{class:w(["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!n.top,"v-table--has-bottom":!!n.bottom,"v-table--hover":e.hover,"v-table--striped-even":"even"===e.striped,"v-table--striped-odd":"odd"===e.striped},i.value,r.value,e.class]),style:b(e.style)},{default:()=>{var a,i;return[null==(a=n.top)?void 0:a.call(n),y(yb,{defaults:t},{default:()=>{var t;return[n.default?_("div",{class:"v-table__wrapper",style:{height:me(e.height)}},[_("table",null,[n.default()])]):null==(t=n.wrapper)?void 0:t.call(n)]}}),null==(i=n.bottom)?void 0:i.call(n)]}})}),{}}}),Hk=oe({items:{type:Array,default:()=>[]},itemValue:{type:[String,Array,Function],default:"id"},itemSelectable:{type:[String,Array,Function],default:null},rowProps:[Object,Function],cellProps:[Object,Function],returnObject:Boolean},"DataTable-items");function Gk(e,t,n){return t.map((t,a)=>function(e,t,n,a){const i=e.returnObject?t:Ye(t,e.itemValue),r=Ye(t,e.itemSelectable,!0),s=a.reduce((e,n)=>(null!=n.key&&(e[n.key]=Ye(t,n.value)),e),{});return{type:"item",key:e.returnObject?Ye(t,e.itemValue):i,index:n,value:i,selectable:r,columns:s,raw:t}}(e,t,a,n))}function Kk(e,t){return{items:f(()=>Gk(e,e.items,t.value))}}function Wk(e){let{page:t,itemsPerPage:n,sortBy:a,groupBy:i,search:r}=e;const s=xe("VDataTable");let o=null;d(()=>({page:t.value,itemsPerPage:n.value,sortBy:a.value,groupBy:i.value,search:r.value}),e=>{Ne(o,e)||(o&&o.search!==e.search&&(t.value=1),s.emit("update:options",e),o=e)},{deep:!0,immediate:!0})}const Qk=oe({...$k(),hideDefaultBody:Boolean,hideDefaultFooter:Boolean,hideDefaultHeader:Boolean,width:[String,Number],search:String,...Pk(),...kk(),...XC(),...Hk(),...pk(),...gk(),...Sk(),...zk()},"DataTable"),Xk=oe({...HC(),...Qk(),...jS(),...KC()},"VDataTable");se()({name:"VDataTable",props:Xk(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0,"update:currentItems":e=>!0},setup(e,t){let{attrs:n,slots:a}=t;const{groupBy:i}=xk(e),{sortBy:r,multiSort:s,mustSort:o}=bk(e),{page:l,itemsPerPage:u}=function(e){return{page:Ae(e,"page",void 0,e=>Number(e??1)),itemsPerPage:Ae(e,"itemsPerPage",void 0,e=>Number(e??10))}}(e),{disableSort:c}=p(e),{columns:h,headers:v,sortFunctions:m,sortRawFunctions:g,filterFunctions:b}=lk(e,{groupBy:i,showSelect:T(()=>e.showSelect),showExpand:T(()=>e.showExpand)}),{items:w}=Kk(e,h),I=T(()=>e.search),{filteredItems:S}=zS(e,w,I,{transform:e=>e.columns,customKeyFilter:b}),{toggleSort:k}=wk({sortBy:r,multiSort:s,mustSort:o,page:l}),{sortByWithGroups:E,opened:x,extractRows:A,isGroupOpen:V,toggleGroup:D}=Tk({groupBy:i,sortBy:r,disableSort:c}),{sortedItems:M}=Ik(e,S,E,{transform:e=>({...e.raw,...e.columns}),sortFunctions:m,sortRawFunctions:g}),{flatItems:R}=Dk(M,i,x),O=f(()=>R.value.length),{startIndex:L,stopIndex:F,pageCount:B,setItemsPerPage:U}=function(e){const{page:t,itemsPerPage:n,itemsLength:a}=e,i=f(()=>-1===n.value?0:n.value*(t.value-1)),r=f(()=>-1===n.value?a.value:Math.min(a.value,i.value+n.value)),s=f(()=>-1===n.value||0===a.value?1:Math.ceil(a.value/n.value));d([t,s],()=>{t.value>s.value&&(t.value=s.value)});const o={page:t,itemsPerPage:n,startIndex:i,stopIndex:r,pageCount:s,itemsLength:a,nextPage:function(){t.value=Re(t.value+1,1,s.value)},prevPage:function(){t.value=Re(t.value-1,1,s.value)},setPage:function(e){t.value=Re(e,1,s.value)},setItemsPerPage:function(e){n.value=e,t.value=1}};return P(GC,o),o}({page:l,itemsPerPage:u,itemsLength:O}),{paginatedItems:$}=function(e){const t=xe("usePaginatedItems"),{items:n,startIndex:a,stopIndex:i,itemsPerPage:r}=e,s=f(()=>r.value<=0?n.value:n.value.slice(a.value,i.value));return d(s,e=>{t.emit("update:currentItems",e)},{immediate:!0}),{paginatedItems:s}}({items:R,startIndex:L,stopIndex:F,itemsPerPage:u}),j=f(()=>A($.value)),{isSelected:z,select:q,selectAll:H,toggleSelect:G,someSelected:K,allSelected:W}=vk(e,{allItems:w,currentPage:j}),{isExpanded:Q,toggleExpand:X}=Lk(e);Wk({page:l,itemsPerPage:u,sortBy:r,groupBy:i,search:I}),le({VDataTableRows:{hideNoData:T(()=>e.hideNoData),noDataText:T(()=>e.noDataText),loading:T(()=>e.loading),loadingText:T(()=>e.loadingText)}});const Y=f(()=>({page:l.value,itemsPerPage:u.value,sortBy:r.value,pageCount:B.value,toggleSort:k,setItemsPerPage:U,someSelected:K.value,allSelected:W.value,isSelected:z,select:q,selectAll:H,toggleSelect:G,isExpanded:Q,toggleExpand:X,isGroupOpen:V,toggleGroup:D,items:j.value.map(e=>e.raw),internalItems:j.value,groupedItems:$.value,columns:h.value,headers:v.value}));return be(()=>{const t=WC.filterProps(e),i=Ck.filterProps(e),r=jk.filterProps(e),s=qk.filterProps(e);return y(qk,C({class:["v-data-table",{"v-data-table--show-select":e.showSelect,"v-data-table--loading":e.loading},e.class],style:e.style},s,{fixedHeader:e.fixedHeader||e.sticky}),{top:()=>{var e;return null==(e=a.top)?void 0:e.call(a,Y.value)},default:()=>{var t,s,o,l,u,c;return a.default?a.default(Y.value):_(N,null,[null==(t=a.colgroup)?void 0:t.call(a,Y.value),!e.hideDefaultHeader&&_("thead",{key:"thead"},[y(Ck,i,a)]),null==(s=a.thead)?void 0:s.call(a,Y.value),!e.hideDefaultBody&&_("tbody",null,[null==(o=a["body.prepend"])?void 0:o.call(a,Y.value),a.body?a.body(Y.value):y(jk,C(n,r,{items:$.value}),a),null==(l=a["body.append"])?void 0:l.call(a,Y.value)]),null==(u=a.tbody)?void 0:u.call(a,Y.value),null==(c=a.tfoot)?void 0:c.call(a,Y.value)])},bottom:()=>a.bottom?a.bottom(Y.value):!e.hideDefaultFooter&&_(N,null,[y(Gw,null,null),y(WC,t,{prepend:a["footer.prepend"]})])})}),{}}});const Yk=oe({...Je(Qk(),["hideDefaultFooter"]),...kk(),...kS(),...jS()},"VDataTableVirtual"),Jk=se()({name:"VDataTableVirtual",props:Yk(),emits:{"update:modelValue":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0},setup(e,t){let{attrs:n,slots:a}=t;const{groupBy:i}=xk(e),{sortBy:r,multiSort:s,mustSort:o}=bk(e),{disableSort:l}=p(e),{columns:u,headers:c,filterFunctions:d,sortFunctions:h,sortRawFunctions:v}=lk(e,{groupBy:i,showSelect:T(()=>e.showSelect),showExpand:T(()=>e.showExpand)}),{items:g}=Kk(e,u),b=T(()=>e.search),{filteredItems:w}=zS(e,g,b,{transform:e=>e.columns,customKeyFilter:d}),{toggleSort:I}=wk({sortBy:r,multiSort:s,mustSort:o}),{sortByWithGroups:S,opened:k,extractRows:E,isGroupOpen:x,toggleGroup:A}=Tk({groupBy:i,sortBy:r,disableSort:l}),{sortedItems:N}=Ik(e,w,S,{transform:e=>({...e.raw,...e.columns}),sortFunctions:h,sortRawFunctions:v}),{flatItems:V}=Dk(N,i,k),D=f(()=>E(V.value)),{isSelected:M,select:R,selectAll:P,toggleSelect:O,someSelected:L,allSelected:F}=vk(e,{allItems:D,currentPage:D}),{isExpanded:B,toggleExpand:U}=Lk(e),{containerRef:$,markerRef:j,paddingTop:z,paddingBottom:q,computedItems:H,handleItemResize:G,handleScroll:K,handleScrollend:W,calculateVisibleItems:Q,scrollToIndex:X}=ES(e,V),Y=f(()=>H.value.map(e=>e.raw));Wk({sortBy:r,page:m(1),itemsPerPage:m(-1),groupBy:i,search:b}),le({VDataTableRows:{hideNoData:T(()=>e.hideNoData),noDataText:T(()=>e.noDataText),loading:T(()=>e.loading),loadingText:T(()=>e.loadingText)}});const J=f(()=>({sortBy:r.value,toggleSort:I,someSelected:L.value,allSelected:F.value,isSelected:M,select:R,selectAll:P,toggleSelect:O,isExpanded:B,toggleExpand:U,isGroupOpen:x,toggleGroup:A,items:D.value.map(e=>e.raw),internalItems:D.value,groupedItems:V.value,columns:u.value,headers:c.value}));return be(()=>{const t=Ck.filterProps(e),i=jk.filterProps(e),r=qk.filterProps(e);return y(qk,C({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},r,{fixedHeader:e.fixedHeader||e.sticky}),{top:()=>{var e;return null==(e=a.top)?void 0:e.call(a,J.value)},wrapper:()=>{var r,s,o,l,c,d;return _("div",{ref:$,onScrollPassive:K,onScrollend:W,class:"v-table__wrapper",style:{height:me(e.height)}},[_("table",null,[null==(r=a.colgroup)?void 0:r.call(a,J.value),!e.hideDefaultHeader&&_("thead",{key:"thead"},[y(Ck,t,a)]),null==(s=a.thead)?void 0:s.call(a,J.value),!e.hideDefaultBody&&_("tbody",{key:"tbody"},[_("tr",{ref:j,style:{height:me(z.value),border:0}},[_("td",{colspan:u.value.length,style:{height:0,border:0}},null)]),null==(o=a["body.prepend"])?void 0:o.call(a,J.value),y(jk,C(n,i,{items:Y.value}),{...a,item:e=>y(CS,{key:e.internalItem.index,renderless:!0,"onUpdate:height":t=>G(e.internalItem.index,t)},{default:t=>{var n;let{itemRef:i}=t;return(null==(n=a.item)?void 0:n.call(a,{...e,itemRef:i}))??y(Uk,C(e.props,{ref:i,key:e.internalItem.index,index:e.internalItem.index}),a)}})}),null==(l=a["body.append"])?void 0:l.call(a,J.value),_("tr",{style:{height:me(q.value),border:0}},[_("td",{colspan:u.value.length,style:{height:0,border:0}},null)])]),null==(c=a.tbody)?void 0:c.call(a,J.value),null==(d=a.tfoot)?void 0:d.call(a,J.value)])])},bottom:()=>{var e;return null==(e=a.bottom)?void 0:e.call(a,J.value)}})}),{calculateVisibleItems:Q,scrollToIndex:X}}}),Zk=Symbol.for("vuetify:v-expansion-panel"),eE=oe({..._e(),...cI()},"VExpansionPanelText"),tE=se()({name:"VExpansionPanelText",props:eE(),setup(e,t){let{slots:n}=t;const i=a(Zk);if(!i)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:r,onAfterLeave:s}=dI(e,i.isSelected);return be(()=>y(i_,{onAfterLeave:s},{default:()=>{var t;return[A(_("div",{class:w(["v-expansion-panel-text",e.class]),style:b(e.style)},[n.default&&r.value&&_("div",{class:"v-expansion-panel-text__wrapper"},[null==(t=n.default)?void 0:t.call(n)])]),[[V,i.isSelected.value]])]}})),{}}}),nE=oe({color:String,expandIcon:{type:Ie,default:"$expand"},collapseIcon:{type:Ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,..._e(),...Tb()},"VExpansionPanelTitle"),aE=se()({name:"VExpansionPanelTitle",directives:{vRipple:jw},props:nE(),setup(e,t){let{slots:n}=t;const i=a(Zk);if(!i)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:r,backgroundColorStyles:s}=_b(()=>e.color),{dimensionStyles:o}=Ab(e),l=f(()=>({collapseIcon:e.collapseIcon,disabled:i.disabled.value,expanded:i.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly})),u=T(()=>i.isSelected.value?e.collapseIcon:e.expandIcon);return be(()=>{var t;return A(_("button",{class:w(["v-expansion-panel-title",{"v-expansion-panel-title--active":i.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},r.value,e.class]),style:b([s.value,o.value,e.style]),type:"button",tabindex:i.disabled.value?-1:void 0,disabled:i.disabled.value,"aria-expanded":i.isSelected.value,onClick:e.readonly?void 0:i.toggle},[_("span",{class:"v-expansion-panel-title__overlay"},null),null==(t=n.default)?void 0:t.call(n,l.value),!e.hideActions&&y(yb,{defaults:{VIcon:{icon:u.value}}},{default:()=>{var e;return[_("span",{class:"v-expansion-panel-title__icon"},[(null==(e=n.actions)?void 0:e.call(n,l.value))??y(xb,null,null)])]}})]),[[jw,e.ripple]])}),{}}}),iE=oe({title:String,text:String,bgColor:String,...Yb(),...nw(),...Db(),...kb(),...nE(),...eE()},"VExpansionPanel"),rE=se()({name:"VExpansionPanel",props:iE(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const a=aw(e,Zk),{backgroundColorClasses:i,backgroundColorStyles:r}=_b(()=>e.bgColor),{elevationClasses:s}=Jb(e),{roundedClasses:o}=Mb(e),l=T(()=>(null==a?void 0:a.disabled.value)||e.disabled),u=f(()=>a.group.items.value.reduce((e,t,n)=>(a.group.selected.value.includes(t.id)&&e.push(n),e),[])),c=f(()=>{const e=a.group.items.value.findIndex(e=>e.id===a.id);return!a.isSelected.value&&u.value.some(t=>t-e===1)}),d=f(()=>{const e=a.group.items.value.findIndex(e=>e.id===a.id);return!a.isSelected.value&&u.value.some(t=>t-e===-1)});return P(Zk,a),be(()=>{const t=!(!n.text&&!e.text),u=!(!n.title&&!e.title),h=aE.filterProps(e),p=tE.filterProps(e);return y(e.tag,{class:w(["v-expansion-panel",{"v-expansion-panel--active":a.isSelected.value,"v-expansion-panel--before-active":c.value,"v-expansion-panel--after-active":d.value,"v-expansion-panel--disabled":l.value},o.value,i.value,e.class]),style:b([r.value,e.style])},{default:()=>[_("div",{class:w(["v-expansion-panel__shadow",...s.value])},null),y(yb,{defaults:{VExpansionPanelTitle:{...h},VExpansionPanelText:{...p}}},{default:()=>{var a;return[u&&y(aE,{key:"title"},{default:()=>[n.title?n.title():e.title]}),t&&y(tE,{key:"text"},{default:()=>[n.text?n.text():e.text]}),null==(a=n.default)?void 0:a.call(n)]}})]})}),{groupItem:a}}}),sE=["default","accordion","inset","popout"],oE=oe({flat:Boolean,...tw(),...Xe(iE(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...we(),..._e(),...kb(),variant:{type:String,default:"default",validator:e=>sE.includes(e)}},"VExpansionPanels"),lE=se()({name:"VExpansionPanels",props:oE(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{next:a,prev:i}=iw(e,Zk),{themeClasses:r}=Te(e),s=T(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return le({VExpansionPanel:{bgColor:T(()=>e.bgColor),collapseIcon:T(()=>e.collapseIcon),color:T(()=>e.color),eager:T(()=>e.eager),elevation:T(()=>e.elevation),expandIcon:T(()=>e.expandIcon),focusable:T(()=>e.focusable),hideActions:T(()=>e.hideActions),readonly:T(()=>e.readonly),ripple:T(()=>e.ripple),rounded:T(()=>e.rounded),static:T(()=>e.static)}}),be(()=>y(e.tag,{class:w(["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},r.value,s.value,e.class]),style:b(e.style)},{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n,{prev:i,next:a})]}})),{next:a,prev:i}}}),uE=oe({id:String,interactive:Boolean,text:String,...Je(_I({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:null}),["absolute","persistent"])},"VTooltip"),cE=se()({name:"VTooltip",props:uE(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:a}=n;const i=Ae(e,"modelValue"),{scopeId:r}=hI(),s=R(),o=T(()=>e.id||`v-tooltip-${s}`),l=t(),u=f(()=>e.location.split(" ").length>1?e.location:e.location+" center"),c=f(()=>"auto"===e.origin||"overlap"===e.origin||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center"),d=T(()=>null!=e.transition?e.transition:i.value?"scale-transition":"fade-transition"),h=f(()=>C({"aria-describedby":o.value},e.activatorProps));return be(()=>{const t=II.filterProps(e);return y(II,C({ref:l,class:["v-tooltip",{"v-tooltip--interactive":e.interactive},e.class],style:e.style,id:o.value},t,{modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,transition:d.value,absolute:!0,location:u.value,origin:c.value,persistent:!0,role:"tooltip",activatorProps:h.value,_disableGlobalStack:!0},r),{activator:a.activator,default:function(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(null==(t=a.default)?void 0:t.call(a,...i))??e.text}})}),kI({},l)}}),dE={class:"pa-6"},hE={class:"d-flex align-center mb-6"},pE={class:"d-flex align-center mb-3"},fE={class:"d-flex justify-space-between align-center"},vE={class:"d-flex align-center gap-4"},mE={class:"d-flex align-center"},gE={class:"text-body-1 font-weight-medium"},yE={class:"d-flex align-center gap-2"},bE={class:"character-name-cell"},wE={class:"d-flex align-center"},_E={class:"text-caption text-white font-weight-bold"},IE={class:"character-name"},SE={class:"ml-1"},CE={class:"text-caption"},kE=["onClick"],EE=["innerHTML"],xE=["innerHTML"],TE=["onClick"],AE=["innerHTML"],NE=["innerHTML"],VE={__name:"ViewAllCharactersTab",emits:["items-updated","character-deleted"],setup(e,{expose:n,emit:a}){const i=fb(),s=vb(),o=a,l=t(!1),u=t(!1),c=t(!1),h=t(null),p=t(null),v=t(new Map),m=t("current");d(m,e=>{i.characterMasters.forEach(t=>{Q(t.id)&&v.value.set(t.id,e)})});const g=r({charSearch:"",element:[],itemSearch:[],type:[],gachaSearch:[],totalOwnership:[],account:"",ownership:"",columnFilter:[]}),b=f(()=>i.characterMasters),I=f(()=>i.accounts),S=f(()=>i.itemMasters),k=f(()=>i.gachaMasters);f(()=>i.itemMastersMap),f(()=>i.characterMastersMap);const E=f(()=>i.dataLoaded),x=f(()=>Array.from(new Set(i.characterMasters.map(e=>e.type).filter(Boolean))).sort()),T=f(()=>{const e=[{title:"図鑑No.",key:"indexNumber",align:"center",sortable:!0,width:80},{title:"キャラ名",key:"monsterName",align:"start",sortable:!0,width:200}];return u.value&&e.push({title:"属性",key:"element",align:"center",sortable:!0,width:100},{title:"分類",key:"type",align:"center",sortable:!0,width:100},{title:"排出ガチャ",key:"ejectionGacha",align:"center",sortable:!0,width:100}),i.accounts.forEach(t=>{var n;const a=t.indexNumber||(null==(n=t.name.match(/\d+/))?void 0:n[0])||t.id;e.push({title:`${a}-1`,key:`account_${t.id}_1`,align:"center",sortable:!1,width:78},{title:`${a}-2`,key:`account_${t.id}_2`,align:"center",sortable:!1,width:78})}),e}),A=f(()=>{if(!i.dataLoaded)return[];const{charSearch:e,element:t,itemSearch:n,type:a,gachaSearch:r,totalOwnership:s,account:o,ownership:l,columnFilter:u}=g,c=e.toLowerCase(),d=n.map(e=>Number(e));return i.characterMasters.filter(e=>{if(c&&!e.monsterName.toLowerCase().includes(c)&&!(e.indexNumber+"").includes(c))return!1;if(t.length>0&&!t.includes(e.element))return!1;if(a.length>0){let t=!1;for(const n of a)if("恒常_or_限定"===n){if("恒常"===e.type||"限定"===e.type){t=!0;break}}else if(e.type===n){t=!0;break}if(!t)return!1}if(r.length>0&&!r.includes(e.ejectionGacha||""))return!1;if(d.length>0){let t=!1;const n=o||null;for(const a of d)if(n){if((i.ownedCharactersData.get(n)||[]).some(t=>{if(t.characterMasterId!==e.id)return!1;if(!t.items||0===t.items.length)return!1;return to(t.items).some(e=>e.itemId===a)})){t=!0;break}}else{let n=!1;for(const t of i.ownedCharactersData.values())if(t.some(t=>{if(t.characterMasterId!==e.id)return!1;if(!t.items||0===t.items.length)return!1;return to(t.items).some(e=>e.itemId===a)})){n=!0;break}if(n){t=!0;break}}if(!t)return!1}if(s&&s.length>0){const t=i.accounts.reduce((t,n)=>t+R(e.id,n.id),0);let n=!1;for(const a of s){if("all_unowned"===a&&0===t){n=!0;break}if("one_total"===a&&1===t){n=!0;break}if("two_total"===a&&2===t){n=!0;break}if("three_total"===a&&3===t){n=!0;break}if("four_total"===a&&4===t){n=!0;break}if("five_or_more"===a&&t>=5){n=!0;break}if("one_in_each"===a&&i.accounts.every(t=>R(e.id,t.id)>=1)){n=!0;break}}if(!n)return!1}if(o&&l){const t=R(e.id,o);if("owned"===l&&0===t)return!1;if("unowned"===l&&t>0)return!1;if("one"===l&&1!==t)return!1;if("two"===l&&2!==t)return!1}if(u&&u.length>0){let t=!1;for(const n of u){let a=!1;for(const t of i.accounts){const r=(i.ownedCharactersData.get(t.id)||[]).filter(t=>t.characterMasterId===e.id);if("has_zero_item_character"===n&&r.some(e=>!e.items||0===e.items.length)){a=!0;break}if("has_one_item_character"===n&&r.some(e=>e.items&&1===e.items.length)){a=!0;break}if("has_two_item_character"===n&&r.some(e=>e.items&&2===e.items.length)){a=!0;break}if("has_three_item_character"===n&&r.some(e=>e.items&&3===e.items.length)){a=!0;break}if("has_virtual_item_character"===n&&r.some(e=>(e.items||[]).some(e=>"object"==typeof e&&!0===e.isVirtual))){a=!0;break}}if(a){t=!0;break}}if(!t)return!1}return!0})}),N=f(()=>A.value.filter(e=>s.isPinned(e.id))),V=f(()=>A.value.filter(e=>!s.isPinned(e.id))),D=f(()=>[...N.value,...V.value]),M=e=>s.isPinned(e.id)?"pinned-row":"",R=(e,t)=>i.ownedCountMap.get(`${e}-${t}`)||0,P=(e,t,n)=>{const a=(i.ownedCharactersData.get(t)||[]).filter(t=>t.characterMasterId===e);if(!a||a.length<=n)return"—";const r=a[n].items||[],s=X(e),o=r.filter(e=>{const t="object"==typeof e&&e.isVirtual,n="object"==typeof e&&e.willRemove;return"current"===s?!t:!n}).map(e=>{const t="object"==typeof e?e.itemId:e,n="object"==typeof e&&e.isVirtual,a="object"==typeof e&&e.willRemove,r="object"==typeof e&&e.isEL,o=i.itemMastersMap.get(Number(t));if(!o)return null;const l=r?' <span class="el-badge">EL</span>':"";return"current"===s&&a?`<span class="will-remove-item item-name">${o}${l}</span>`:n?`<span class="virtual-item item-name">${o}${l}</span>`:`<span class="item-name">${o}${l}</span>`}).filter(Boolean).join("<br>");return o?`✔️<br>${o}`:"✔️"},L=(e,t,n)=>{const a=(i.ownedCharactersData.get(t)||[]).filter(t=>t.characterMasterId===e);if(!a||a.length<=n)return"未所持";return(a[n].items||[]).map(e=>{const t="object"==typeof e?e.itemId:e,n=("object"==typeof e&&e.isVirtual,i.itemMastersMap.get(Number(t)));return n||null}).filter(Boolean).join("<br>")||"アイテムなし"},F=(e,t,n)=>R(e,t)>=n?"status-owned":"status-unowned",U=e=>({"火":"red","水":"blue","木":"green","光":"amber","闇":"deep-purple"}[e]||"grey"),$=()=>{Object.assign(g,{charSearch:"",element:[],itemSearch:[],type:[],gachaSearch:[],totalOwnership:[],account:"",ownership:"",columnFilter:[]})},j=e=>v.value.get(e)||"current",z=e=>{const t="current"===j(e)?"planned":"current";v.value.set(e,t)},Q=e=>{for(const t of i.accounts){const n=(i.ownedCharactersData.get(t.id)||[]).filter(t=>t.characterMasterId===e);for(const e of n){if((e.items||[]).some(e=>"object"==typeof e&&!0===e.isVirtual))return!0}}return!1},X=(e,t,n)=>j(e),Z=(e,t,n)=>{const a=(i.ownedCharactersData.get(t)||[]).filter(t=>t.characterMasterId===e);if(!a||a.length<=n)return h.value={characterMasterId:e,accountId:t,items:[],isNew:!0},p.value=t,void(c.value=!0);h.value=a[n],p.value=t,c.value=!0},ae=async({character:e,items:t,isNew:n})=>{o("items-updated",n?{accountId:p.value,characterMasterId:e.characterMasterId,items:t,isNew:!0}:{accountId:p.value,ownedCharacterId:e.id,items:t,isNew:!1})},ie=async e=>{var t;e&&((null==(t=h.value)?void 0:t.isNew)||o("character-deleted",{accountId:p.value,ownedCharacterId:e.id,characterMasterId:e.characterMasterId}),c.value=!1)},re=async()=>{try{l.value=!0;const e=[];i.accounts.forEach(t=>{(i.ownedCharactersData.get(t.id)||[]).forEach(n=>{e.push({...n,accountName:t.name})})});const t=(e=>{const{characterMasters:t,ownedCharacters:n,accountName:a,itemMastersMap:i}=e,r=new Map;t.forEach(e=>{r.set(e.id,e)});const s=[];s.push("図鑑No,名前,属性,種類,アカウント,わくわく1,レベル1,わくわく2,レベル2,わくわく3,レベル3,わくわく4,レベル4");const o=[...n].sort((e,t)=>{const n=r.get(e.characterMasterId),a=r.get(t.characterMasterId);return n?a?(n.indexNumber??Number.MAX_SAFE_INTEGER)-(a.indexNumber??Number.MAX_SAFE_INTEGER):-1:1});return o.forEach(e=>{const t=r.get(e.characterMasterId);if(!t)return;const n=e.items.filter(e=>!e.isVirtual).slice(0,4).map(e=>({name:jC(e.itemId,i),level:e.isEL?"EL":"L"}));for(;n.length<4;)n.push({name:"",level:""});const o=(e=>e.startsWith("アカウント")?e.substring(5):e)(e.accountName||a),l=[void 0!==t.indexNumber?t.indexNumber:"",(u=t.monsterName||t.name,`"${u.replace(/"/g,'""')}"`),t.element||"",t.type||"",UC(o),UC(n[0].name),UC(n[0].level),UC(n[1].name),UC(n[1].level),UC(n[2].name),UC(n[2].level),UC(n[3].name),UC(n[3].level)].join(",");var u;s.push(l)}),"\ufeff"+s.join("\n")})({characterMasters:i.characterMasters,ownedCharacters:e,accountName:"",itemMastersMap:i.itemMastersMap}),n=new Date,a=`${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}`,r=`${String(n.getHours()).padStart(2,"0")}${String(n.getMinutes()).padStart(2,"0")}`;((e,t)=>{const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)})(t,`characters_export_${a}_${r}.csv`),s.showSuccess("CSVエクスポートが完了しました")}catch(e){s.showError("CSVエクスポートに失敗しました")}finally{l.value=!1}};return n({rowDisplayModes:v,cellDisplayModes:v,getRowDisplayMode:j,getCellDisplayMode:X,toggleRowDisplayMode:z,toggleCellDisplayMode:(e,t,n)=>{z(e)},isModalOpen:c,editingCharacter:h,filters:g,exportToCSV:re}),(e,t)=>{var n;const a=te("v-subheader");return H(),q("div",dE,[_("div",hE,[y(xb,{icon:"mdi-account-multiple",size:"28",color:"primary",class:"mr-3"}),t[12]||(t[12]=_("h2",{class:"text-h5 font-weight-medium text-primary"},"所持状況一覧",-1))]),y(tC,{class:"mb-6 minimal-filter-card"},{default:G(()=>[y(QS,{class:"minimal-card-title pa-4"},{default:G(()=>[y(xb,{icon:"mdi-filter-variant",class:"mr-2",size:"20"}),t[13]||(t[13]=K(" フィルターとオプション ",-1))]),_:1,__:[13]}),y(lE,null,{default:G(()=>[y(rE,null,{default:G(()=>[y(aE,{class:"pa-4 minimal-panel-title"},{default:G(()=>[y(xb,{start:"",icon:"mdi-filter-variant",color:"primary",size:"20"}),t[14]||(t[14]=_("span",{class:"text-body-1 font-weight-medium"},"詳細フィルターを開く",-1))]),_:1,__:[14]}),y(tE,{class:"pa-6"},{default:G(()=>[y(rC,null,{default:G(()=>[y(NC,null,{default:G(()=>[y(pC,{cols:"12",md:"4"},{default:G(()=>[y(IS,{modelValue:g.charSearch,"onUpdate:modelValue":t[0]||(t[0]=e=>g.charSearch=e),modelModifiers:{lazy:!0},label:"キャラクター名 or 図鑑番号",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-account-search",class:"minimal-input"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"4"},{default:G(()=>[y(DS,{modelValue:g.element,"onUpdate:modelValue":t[1]||(t[1]=e=>g.element=e),items:["火","水","木","光","闇"],label:"属性",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-fire",class:"minimal-select",multiple:""},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"4"},{default:G(()=>[y(DS,{modelValue:g.itemSearch,"onUpdate:modelValue":t[2]||(t[2]=e=>g.itemSearch=e),items:S.value,"item-title":"name","item-value":"id",label:"アイテム名",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-sword-cross",class:"minimal-select",multiple:""},null,8,["modelValue","items"])]),_:1}),y(pC,{cols:"12",md:"4"},{default:G(()=>[y(DS,{modelValue:g.type,"onUpdate:modelValue":t[3]||(t[3]=e=>g.type=e),items:["恒常_or_限定",...x.value],label:"分類 (Type)",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-tag",class:"minimal-select",multiple:""},null,8,["modelValue","items"])]),_:1}),y(pC,{cols:"12",md:"4"},{default:G(()=>[y(DS,{modelValue:g.gachaSearch,"onUpdate:modelValue":t[4]||(t[4]=e=>g.gachaSearch=e),items:k.value,"item-title":"name","item-value":"name",label:"排出ガチャ",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-gift",class:"minimal-select",multiple:""},null,8,["modelValue","items"])]),_:1}),y(pC,{cols:"12",md:"4"},{default:G(()=>[y(DS,{modelValue:g.totalOwnership,"onUpdate:modelValue":t[5]||(t[5]=e=>g.totalOwnership=e),items:[{value:"all_unowned",title:"未所持"},{value:"one_total",title:"合計1体"},{value:"two_total",title:"合計2体"},{value:"three_total",title:"合計3体"},{value:"four_total",title:"合計4体"},{value:"five_or_more",title:"合計それ以上（5体以上）"},{value:"one_in_each",title:"各アカウントで1体以上所持"}],multiple:"",label:"全体の所持状況",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-account-group",class:"minimal-select"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(DS,{modelValue:g.columnFilter,"onUpdate:modelValue":t[6]||(t[6]=e=>g.columnFilter=e),items:[{value:"has_zero_item_character",title:"アイテム0つ所持キャラが居る列"},{value:"has_one_item_character",title:"アイテム1つ所持キャラが居る列"},{value:"has_two_item_character",title:"アイテム2つ所持キャラが居る列"},{value:"has_three_item_character",title:"アイテム3つ所持キャラが居る列"},{value:"has_virtual_item_character",title:"仮想アイテム所持キャラが居る列"}],multiple:"",label:"列単位での絞り込み",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-view-column",class:"minimal-select"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12"},{default:G(()=>[y(Gw,{class:"my-4 minimal-divider"}),_("div",pE,[y(xb,{icon:"mdi-account",color:"secondary",class:"mr-2",size:"20"}),y(a,{class:"text-body-1 font-weight-medium"},{default:G(()=>t[15]||(t[15]=[K("単一アカウントでの絞り込み",-1)])),_:1,__:[15]})])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(DS,{modelValue:g.account,"onUpdate:modelValue":t[7]||(t[7]=e=>g.account=e),items:I.value,"item-title":"name","item-value":"id",label:"アカウント",variant:"outlined",density:"compact",clearable:"",color:"secondary","prepend-inner-icon":"mdi-account",class:"minimal-select"},null,8,["modelValue","items"])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(DS,{modelValue:g.ownership,"onUpdate:modelValue":t[8]||(t[8]=e=>g.ownership=e),items:[{value:"owned",title:"所持"},{value:"unowned",title:"未所持"},{value:"one",title:"1体所持"},{value:"two",title:"2体所持"}],label:"所持状況 (指定アカウント内)",variant:"outlined",density:"compact",clearable:"",color:"secondary","prepend-inner-icon":"mdi-check-circle",class:"minimal-select"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),y(GS,{class:"pa-4 minimal-actions"},{default:G(()=>[y(qw,{onClick:t[9]||(t[9]=e=>u.value=!u.value),variant:"outlined",color:"info","prepend-icon":"mdi-eye",class:"minimal-button"},{default:G(()=>[K(B(u.value?"詳細を非表示":"詳細を表示"),1)]),_:1}),y(VC),y(qw,{onClick:$,color:"secondary",variant:"outlined","prepend-icon":"mdi-refresh",class:"minimal-button"},{default:G(()=>t[16]||(t[16]=[K(" リセット ",-1)])),_:1,__:[16]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),y(tC,{class:"mb-4 minimal-stats-card"},{default:G(()=>[y(ZS,{class:"pa-4"},{default:G(()=>[_("div",fE,[_("div",vE,[_("div",mE,[y(xb,{icon:"mdi-chart-bar",color:"primary",class:"mr-2",size:"20"}),_("span",gE,"表示件数: "+B(A.value.length)+" / "+B(b.value.length),1)]),y(lw,{modelValue:m.value,"onUpdate:modelValue":t[10]||(t[10]=e=>m.value=e),mandatory:"",density:"comfortable",color:"primary"},{default:G(()=>[y(qw,{value:"current",size:"small"},{default:G(()=>[y(xb,{size:"small",class:"mr-1"},{default:G(()=>t[17]||(t[17]=[K("mdi-eye",-1)])),_:1,__:[17]}),t[18]||(t[18]=K(" 全て現在 ",-1))]),_:1,__:[18]}),y(qw,{value:"planned",size:"small"},{default:G(()=>[y(xb,{size:"small",class:"mr-1"},{default:G(()=>t[19]||(t[19]=[K("mdi-eye-outline",-1)])),_:1,__:[19]}),t[20]||(t[20]=K(" 全て予定後 ",-1))]),_:1,__:[20]})]),_:1},8,["modelValue"])]),_("div",yE,[y(qw,{onClick:re,loading:l.value,color:"success",variant:"outlined","prepend-icon":"mdi-file-export",class:"minimal-button"},{default:G(()=>t[21]||(t[21]=[K(" CSVエクスポート ",-1)])),_:1,__:[21]},8,["loading"]),y(hS,{color:A.value.length===b.value.length?"success":"warning",variant:"outlined",class:"minimal-chip"},{default:G(()=>[K(B(A.value.length===b.value.length?"全件表示":"フィルター適用中"),1)]),_:1},8,["color"])])])]),_:1})]),_:1}),y(tC,{elevation:"3",rounded:"lg"},{default:G(()=>[y(QS,{class:"bg-primary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-table",class:"mr-2"}),t[22]||(t[22]=K(" キャラクター所持状況 ",-1))]),_:1,__:[22]}),y(ZS,{class:"pa-0"},{default:G(()=>[y(Jk,{items:D.value,headers:T.value,loading:!E.value,height:"70vh",density:"compact","fixed-header":"",class:"table-fixed","fixed-columns":!0,"item-class":M},ne({"item.monsterName":G(({item:e})=>[_("div",bE,[_("div",wE,[y(Xb,{size:"32",color:U(e.element),class:"mr-2"},{default:G(()=>[_("span",_E,B(e.element||"?"),1)]),_:2},1032,["color"]),_("span",IE,B(e.monsterName||"—"),1),y(qw,{onClick:ee(t=>O(s).togglePinnedCharacter(e.id),["stop"]),icon:O(s).isPinned(e.id)?"mdi-pin":"mdi-pin-outline",color:O(s).isPinned(e.id)?"amber":"grey",variant:"text",size:"x-small",density:"compact",class:"ml-1 pin-btn"},null,8,["onClick","icon","color"])]),Q(e.id)?(H(),W(qw,{key:0,onClick:ee(t=>z(e.id),["stop"]),color:"current"===j(e.id)?"primary":"orange",variant:"tonal",size:"x-small",class:"row-toggle-btn mt-1"},{default:G(()=>[y(xb,{size:"x-small"},{default:G(()=>[K(B("current"===j(e.id)?"mdi-eye":"mdi-eye-outline"),1)]),_:2},1024),_("span",SE,B("current"===j(e.id)?"現在":"予定後"),1)]),_:2},1032,["onClick","color"])):Y("",!0)])]),"item.element":G(({item:e})=>[y(hS,{color:U(e.element),variant:"tonal",size:"small"},{default:G(()=>[K(B(e.element||"—"),1)]),_:2},1032,["color"])]),"item.type":G(({item:e})=>{return[y(hS,{color:(t=e.type,{"恒常":"success","限定":"warning","コラボ":"info","イベント":"secondary"}[t]||"grey"),variant:"tonal",size:"small"},{default:G(()=>[K(B(e.type||"—"),1)]),_:2},1032,["color"])];var t}),"item.ejectionGacha":G(({item:e})=>[_("span",CE,B(e.ejectionGacha||"—"),1)]),_:2},[J(I.value,e=>({name:`item.account_${e.id}_1`,fn:G(({item:t})=>[_("div",{class:w([[F(t.id,e.id,1),"account-cell"],"text-center"]),onClick:n=>Z(t.id,e.id,0),style:{cursor:"pointer"}},[y(cE,{location:"bottom"},{activator:G(({props:n})=>[_("div",C(n,{class:"cell-content",innerHTML:P(t.id,e.id,0)}),null,16,EE)]),default:G(()=>[_("span",{innerHTML:L(t.id,e.id,0)},null,8,xE)]),_:2},1024)],10,kE)])})),J(I.value,e=>({name:`item.account_${e.id}_2`,fn:G(({item:t})=>[_("div",{class:w([[F(t.id,e.id,2),"account-cell"],"text-center"]),onClick:n=>Z(t.id,e.id,1),style:{cursor:"pointer"}},[y(cE,{location:"bottom"},{activator:G(({props:n})=>[_("div",C(n,{class:"cell-content",innerHTML:P(t.id,e.id,1)}),null,16,AE)]),default:G(()=>[_("span",{innerHTML:L(t.id,e.id,1)},null,8,NE)]),_:2},1024)],10,TE)])}))]),1032,["items","headers","loading"])]),_:1})]),_:1}),y(BC,{modelValue:c.value,"onUpdate:modelValue":t[11]||(t[11]=e=>c.value=e),character:h.value,"is-new-character":(null==(n=h.value)?void 0:n.isNew)||!1,onSave:ae,onRemoveCharacter:ie},null,8,["modelValue","character","is-new-character"])])}}},DE=mb(VE,[["__scopeId","data-v-aa65ad66"]]),ME={class:"text-h6"},RE={class:"d-flex align-center w-100"},PE={class:"flex-grow-1 premium-text-content"},OE={class:"d-flex align-center"},LE=mb({__name:"CharacterSelector",props:{modelValue:{type:[String,null],required:!0},items:{type:Array,required:!0},itemTitle:{type:[String,Function],default:"monsterName"},disabledItems:{type:Array,default:()=>[]},label:{type:String,default:"キャラクター名で検索"},variant:{type:String,default:"outlined"},clearable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},prependInnerIcon:{type:String,default:"mdi-magnify"},listHeight:{type:[String,Number],default:"400px"},listCardVariant:{type:String,default:"elevated"},noDataText:{type:String,default:"該当するキャラクターがいません"},density:{type:String,default:"comfortable"},listDensity:{type:String,default:"compact"},primaryColor:{type:String,default:"primary"},searchBgColor:{type:String,default:"grey-lighten-5"},cardElevation:{type:[Number,String],default:2},cardBorder:{type:[Boolean,String],default:!0}},emits:["update:modelValue"],setup(e,{emit:n}){const a=e,i=n,r=t(""),s=t(!1),o=f(()=>{if(!r.value)return a.items;const e=r.value.toLowerCase();return a.items.filter(t=>l(t).toLowerCase().includes(e))}),l=e=>"function"==typeof a.itemTitle?a.itemTitle(e):e[a.itemTitle]||"",u=e=>a.modelValue===e.id?a.primaryColor:a.disabledItems.includes(e.id)?"grey-lighten-3":"primary-lighten-5",c=e=>"player"===e.type?"mdi-account":"monster"===e.type?"mdi-dragon":"npc"===e.type?"mdi-account-tie":"mdi-account-circle",d=e=>{const t=e.length>0?e[0]:null;a.modelValue!==t&&i("update:modelValue",t)};return(t,n)=>(H(),q(N,null,[y(IS,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e),label:e.label,variant:e.variant,clearable:e.clearable,"prepend-inner-icon":e.prependInnerIcon,disabled:e.disabled,"hide-details":"",class:"mb-4 character-selector-search premium-search",density:e.density,color:e.primaryColor,"bg-color":e.searchBgColor,focused:s.value,onFocus:n[1]||(n[1]=e=>s.value=!0),onBlur:n[2]||(n[2]=e=>s.value=!1)},{"prepend-inner":G(()=>[y(xb,{color:s.value?e.primaryColor:"grey",icon:e.prependInnerIcon,size:"20",class:"search-icon"},null,8,["color","icon"])]),_:1},8,["modelValue","label","variant","clearable","prepend-inner-icon","disabled","density","color","bg-color","focused"]),y(tC,{variant:e.listCardVariant,height:e.listHeight,disabled:e.disabled,class:"character-selector-card premium-card",elevation:e.cardElevation,border:e.cardBorder,style:{display:"flex","flex-direction":"column"}},{default:G(()=>[e.modelValue?(H(),W(QS,{key:0,class:"d-flex align-center justify-end pa-4 pb-3 premium-card-header"},{default:G(()=>[y(hS,{size:"small",color:"success",variant:"tonal",class:"premium-chip"},{default:G(()=>n[3]||(n[3]=[K(" 選択中 ",-1)])),_:1,__:[3]})]),_:1})):Y("",!0),y(q_,{"model-value":[e.modelValue],"onUpdate:selected":d,class:"character-selector-list premium-list",density:e.listDensity,style:{"overflow-y":"auto","max-height":"calc(100% - 60px)"}},{default:G(()=>[0===o.value.length?(H(),W(N_,{key:0,class:"no-data-item premium-no-data"},{default:G(()=>[y(T_,{class:"text-center text-grey-darken-1 py-12"},{default:G(()=>[y(xb,{icon:"mdi-information-outline",size:"64",class:"mb-4 no-data-icon",color:"grey-lighten-1"}),_("div",ME,B(e.noDataText),1)]),_:1})]),_:1})):Y("",!0),(H(!0),q(N,null,J(o.value,(r,s)=>(H(),W(N_,{key:r.id,value:r.id,disabled:e.disabledItems.includes(r.id),class:w(["character-item premium-item",{"character-item--selected":e.modelValue===r.id,"character-item--disabled":e.disabledItems.includes(r.id)}]),onClick:e=>(e=>{a.disabledItems.includes(e.id)||i("update:modelValue",e.id)})(r)},{default:G(()=>[ae(t.$slots,"item",{item:r},()=>[_("div",RE,[y(Xb,{size:"40",class:w(["mr-4 premium-avatar",{"selected-avatar":e.modelValue===r.id}]),color:u(r)},{default:G(()=>[y(xb,{icon:c(r),color:e.modelValue===r.id?"white":"primary",size:"20",class:"avatar-icon"},null,8,["icon","color"])]),_:2},1032,["color","class"]),_("div",PE,[y(T_,{class:w(["font-weight-bold text-h6",{"text-primary":e.modelValue===r.id}])},{default:G(()=>[K(B(l(r)),1)]),_:2},1032,["class"]),r.subtitle?(H(),W(x_,{key:0,class:"text-body-2 text-grey-darken-1 mt-1"},{default:G(()=>[K(B(r.subtitle),1)]),_:2},1024)):Y("",!0)])])],!0)]),append:G(()=>[_("div",OE,[e.disabledItems.includes(r.id)?(H(),W(hS,{key:0,size:"small",color:"warning",variant:"tonal",class:"mr-3 premium-status-chip"},{default:G(()=>n[4]||(n[4]=[K(" 選択済 ",-1)])),_:1,__:[4]})):Y("",!0),e.modelValue===r.id?(H(),W(xb,{key:1,icon:"mdi-check-circle",color:"success",size:"24",class:"selection-indicator premium-check"})):Y("",!0)])]),_:2},1032,["value","disabled","class","onClick"]))),128))]),_:3},8,["model-value","density"])]),_:3},8,["variant","height","disabled","elevation","border"])],64))}},[["__scopeId","data-v-a7887c2a"]]),FE=oe({..._e(),...KI()},"VForm"),BE=se()({name:"VForm",props:FE(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,a){let{slots:i,emit:r}=a;const s=function(e){const a=Ae(e,"modelValue"),i=T(()=>e.disabled),r=T(()=>e.readonly),s=m(!1),o=t([]),l=t([]);return d(o,()=>{let e=0,t=0;const n=[];for(const a of o.value)!1===a.isValid?(t++,n.push({id:a.id,errorMessages:a.errorMessages})):!0===a.isValid&&e++;l.value=n,a.value=!(t>0)&&(e===o.value.length||null)},{deep:!0,flush:"post"}),P(GI,{register:e=>{let{id:t,vm:a,validate:i,reset:r,resetValidation:s}=e;o.value.some(e=>e.id===t),o.value.push({id:t,validate:i,reset:r,resetValidation:s,vm:n(a),isValid:null,errorMessages:[]})},unregister:e=>{o.value=o.value.filter(t=>t.id!==e)},update:(e,t,n)=>{const a=o.value.find(t=>t.id===e);a&&(a.isValid=t,a.errorMessages=n)},isDisabled:i,isReadonly:r,isValidating:s,isValid:a,items:o,validateOn:T(()=>e.validateOn)}),{errors:l,isDisabled:i,isReadonly:r,isValidating:s,isValid:a,items:o,validate:async function(){const t=[];let n=!0;l.value=[],s.value=!0;for(const a of o.value){const i=await a.validate();if(i.length>0&&(n=!1,t.push({id:a.id,errorMessages:i})),!n&&e.fastFail)break}return l.value=t,s.value=!1,{valid:n,errors:l.value}},reset:function(){o.value.forEach(e=>e.reset())},resetValidation:function(){o.value.forEach(e=>e.resetValidation())}}}(e),o=t();function l(e){e.preventDefault(),s.reset()}function u(e){const t=e,n=s.validate();t.then=n.then.bind(n),t.catch=n.catch.bind(n),t.finally=n.finally.bind(n),r("submit",t),t.defaultPrevented||n.then(e=>{var t;let{valid:n}=e;n&&(null==(t=o.value)||t.submit())}),t.preventDefault()}return be(()=>{var t;return _("form",{ref:o,class:w(["v-form",e.class]),style:b(e.style),novalidate:!0,onReset:l,onSubmit:u},[null==(t=i.default)?void 0:t.call(i,s)])}),kI(s,o)}}),UE={class:"pa-6"},$E={class:"d-flex align-center mb-6"},jE={class:"mb-4"},zE={class:"d-flex align-center mb-3"},qE={__name:"AddOwnedCharacterTab",emits:["character-added"],setup(e,{emit:n}){const a=fb(),i=vb(),r=n,s=t(null),o=t(!1),l=f(()=>i.selectedAccountId?a.characterMasters.filter(e=>u(e.id)<2):[]);d(()=>i.selectedAccountId,()=>{s.value=null});const u=e=>i.selectedAccountId&&a.ownedCountMap.get(`${e}-${i.selectedAccountId}`)||0,c=e=>{const t=u(e.id);return`[${e.indexNumber||"?"}] ${e.monsterName} | 所持数: ${t} / 2`},h=async()=>{if(!s.value||!i.selectedAccountId)return alert("追加するキャラとアカウントを選択してください。");if(u(s.value)>=2)return alert("このキャラは既に2体所持しています。");o.value=!0;try{const e=a.characterMastersMap.get(s.value);if(!e)throw new Error("キャラのマスター情報が見つかりません。");const t={characterMasterId:s.value,monsterName:e.monsterName,items:[],createdAt:ab()},n=await sb(i.selectedAccountId,t),o={...t,id:n.id,createdAt:{toDate:()=>new Date}};r("character-added",{accountId:i.selectedAccountId,newCharacter:o}),alert(`「${e.monsterName}」を所持リストに追加しました。`),s.value=null}catch(e){alert("エラー: "+e.message)}finally{o.value=!1}};return(e,t)=>(H(),q("div",UE,[_("div",$E,[y(xb,{icon:"mdi-account-plus",size:"32",color:"primary",class:"mr-3"}),t[1]||(t[1]=_("h2",{class:"text-h4 font-weight-bold text-primary"}," 所持キャラクター追加 ",-1))]),y(BE,{onSubmit:ee(h,["prevent"])},{default:G(()=>[y(tC,{elevation:"3",rounded:"lg"},{default:G(()=>[y(QS,{class:"bg-primary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-account-search",class:"mr-2"}),t[2]||(t[2]=K(" キャラクター選択 ",-1))]),_:1,__:[2]}),y(ZS,{class:"pa-6"},{default:G(()=>[y(rC,{class:"pa-0"},{default:G(()=>[y(NC,null,{default:G(()=>[y(pC,{cols:"12"},{default:G(()=>[_("div",jE,[_("div",zE,[y(xb,{icon:"mdi-account-search",color:"primary",class:"mr-2"}),t[3]||(t[3]=_("h6",{class:"text-h6 font-weight-medium"}," 追加するキャラクター ",-1))]),y(LE,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),items:l.value,"item-title":c,label:"追加するキャラクター名で検索","list-height":"400px","no-data-text":"追加できるキャラクターがいません",color:"primary","prepend-inner-icon":"mdi-account-search"},null,8,["modelValue","items"])])]),_:1})]),_:1})]),_:1})]),_:1}),y(GS,{class:"pa-6 bg-grey-lighten-5"},{default:G(()=>[y(VC),y(qw,{loading:o.value,disabled:!s.value||o.value,onClick:h,color:"primary",size:"large",variant:"elevated","prepend-icon":"mdi-account-plus",class:"px-8"},{default:G(()=>[K(B(o.value?"追加中...":"このキャラクターを所持リストに追加"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]))}},HE=(e,t,n,a,i,r=null)=>{if(!e)return"キャラクター情報なし";const s=n.get(e.characterMasterId),o=s?s.monsterName:"不明",l=e.accountId||r;if(!l)return`${o} (アカウント不明)`;const u=(a.get(l)||[]).filter(t=>t.characterMasterId===e.characterMasterId).findIndex(t=>t.id===e.id);let c=`${o} (${u>=0?u+1:"？"}体目)`;if(t){const t=no(e.items||[]).map(e=>i.get(e.itemId)).filter(Boolean).join("、");t&&(c+=`[${t}]`)}return c},GE={key:0,class:"mt-8"},KE={class:"d-flex align-center mb-6"},WE={class:"mb-4"},QE={class:"d-flex align-center justify-space-between mb-2"},XE={class:"text-subtitle-1 font-weight-bold text-warning"},YE={key:0,class:"d-flex flex-wrap gap-2"},JE={key:1,class:"text-body-2 text-medium-emphasis"},ZE={class:"d-flex align-center justify-space-between mb-2"},ex={class:"text-subtitle-1 font-weight-bold text-success"},tx={key:0,class:"d-flex flex-wrap gap-2"},nx={key:1,class:"text-body-2 text-medium-emphasis"},ax=mb({__name:"ItemSummaryCards",props:{selectedAccountId:{type:String,default:null},ownedCharactersData:{type:Map,required:!0},characterMastersMap:{type:Map,required:!0},itemMasters:{type:Array,required:!0},itemMastersMap:{type:Map,required:!0}},setup(e){const t=e,n=f(()=>{if(!t.selectedAccountId)return[];const e=t.ownedCharactersData.get(t.selectedAccountId)||[];return t.itemMasters.map(n=>{const a=Number(n.id),i=n.name,r=e.filter(e=>to(e.items||[]).some(e=>Number(e.itemId)===a&&!e.isVirtual&&!0===e.willRemove)).map(e=>({id:e.id,displayName:HE(e,!1,t.characterMastersMap,t.ownedCharactersData,t.itemMastersMap,t.selectedAccountId)})),s=e.filter(e=>to(e.items||[]).some(e=>Number(e.itemId)===a&&!0===e.isVirtual)).map(e=>({id:e.id,displayName:HE(e,!1,t.characterMastersMap,t.ownedCharactersData,t.itemMastersMap,t.selectedAccountId)}));return{itemId:a,itemName:i,willRemoveChars:r,willRemoveCount:r.length,virtualChars:s,virtualCount:s.length}})});return(t,a)=>e.selectedAccountId?(H(),q("div",GE,[_("div",KE,[y(xb,{icon:"mdi-clipboard-list-outline",size:"32",color:"info",class:"mr-3"}),a[0]||(a[0]=_("h2",{class:"text-h4 font-weight-bold text-info"},"アイテム移動予定サマリー",-1))]),y(NC,null,{default:G(()=>[(H(!0),q(N,null,J(n.value,e=>(H(),W(pC,{key:e.itemId,cols:"12",md:"6",lg:"4"},{default:G(()=>[y(tC,{elevation:"2",rounded:"lg",class:"h-100"},{default:G(()=>[y(QS,{class:"bg-info text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-sword-cross",class:"mr-2"}),K(" "+B(e.itemName),1)]),_:2},1024),y(ZS,{class:"pa-4"},{default:G(()=>[_("div",WE,[_("div",QE,[_("h6",XE,[y(xb,{icon:"mdi-minus-circle",size:"small",class:"mr-1"}),a[1]||(a[1]=K(" 外す予定 ",-1))]),y(hS,{color:e.willRemoveCount>0?"warning":"grey",size:"small",variant:"tonal"},{default:G(()=>[K(B(e.willRemoveCount)+"体 ",1)]),_:2},1032,["color"])]),e.willRemoveChars.length>0?(H(),q("div",YE,[(H(!0),q(N,null,J(e.willRemoveChars,e=>(H(),W(hS,{key:e.id,size:"small",color:"warning",variant:"outlined"},{default:G(()=>[K(B(e.displayName),1)]),_:2},1024))),128))])):(H(),q("div",JE," なし "))]),y(Gw,{class:"my-3"}),_("div",null,[_("div",ZE,[_("h6",ex,[y(xb,{icon:"mdi-plus-circle",size:"small",class:"mr-1"}),a[2]||(a[2]=K(" つける予定 ",-1))]),y(hS,{color:e.virtualCount>0?"success":"grey",size:"small",variant:"tonal"},{default:G(()=>[K(B(e.virtualCount)+"体 ",1)]),_:2},1032,["color"])]),e.virtualChars.length>0?(H(),q("div",tx,[(H(!0),q(N,null,J(e.virtualChars,e=>(H(),W(hS,{key:e.id,size:"small",color:"success",variant:"outlined"},{default:G(()=>[K(B(e.displayName),1)]),_:2},1024))),128))])):(H(),q("div",nx," なし "))])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):Y("",!0)}},[["__scopeId","data-v-90455a64"]]),ix={class:"pa-6"},rx={class:"d-flex align-center mb-6"},sx={class:"mb-4"},ox={class:"d-flex align-center mb-3"},lx={class:"mb-4"},ux={class:"d-flex align-center mb-3"},cx={class:"text-center mb-4"},dx={class:"text-center mb-4"},hx={key:0,class:"text-center pa-4"},px={key:1,class:"text-center pa-4"},fx={key:2},vx={class:"mb-3"},mx={class:"text-center mb-4"},gx={class:"d-flex justify-center"},yx={__name:"ManageItemsTab",emits:["items-updated","items-moved"],setup(e,{emit:n}){const a=fb(),i=vb(),s=n,o=r({selectedOwnedId:null,items:[]}),l=r({from:{selectedId:null},to:{selectedId:null},selectedItemIds:[],itemFilter:null}),u=t(!1),c=t(!1),h=f(()=>{if(!i.selectedAccountId||!a.ownedCharactersData.has(i.selectedAccountId))return[];return(a.ownedCharactersData.get(i.selectedAccountId)||[]).map(e=>{const t=a.characterMastersMap.get(e.characterMasterId);return{...e,id:e.id,indexNumber:(null==t?void 0:t.indexNumber)||999999,monsterName:(null==t?void 0:t.monsterName)||"不明"}}).sort((e,t)=>e.indexNumber-t.indexNumber)}),p=f(()=>{let e=[...h.value];if(l.itemFilter){const t=Number(l.itemFilter);e=e.filter(e=>{if(!e.items||0===e.items.length)return!1;return to(e.items).some(e=>e.itemId===t&&!e.isVirtual)}),e.sort((e,n)=>{const a=to(e.items||[]),i=to(n.items||[]),r=a.find(e=>e.itemId===t),s=i.find(e=>e.itemId===t),o=(null==r?void 0:r.willRemove)||!1,l=(null==s?void 0:s.willRemove)||!1;return o&&!l?-1:!o&&l?1:e.indexNumber-n.indexNumber})}return e}),v=f(()=>h.value),m=f(()=>{if(!l.from.selectedId)return[];const e=v.value.find(e=>e.id===l.from.selectedId);if(!e||!e.items)return[];return no(e.items).map(e=>({id:e.itemId,name:a.itemMastersMap.get(e.itemId)||`不明(ID:${e.itemId})`}))});d(()=>i.selectedAccountId,()=>{Object.assign(o,{selectedOwnedId:null,items:[]}),Object.assign(l,{from:{selectedId:null},to:{selectedId:null},selectedItemIds:[]})}),d(()=>o.selectedOwnedId,e=>{if(!e)return void(o.items=[]);const t=v.value.find(t=>t.id===e),n=no((null==t?void 0:t.items)||[]);o.items=n.map(e=>e.itemId)}),d(()=>l.from.selectedId,()=>{l.selectedItemIds=[]});const g=async()=>{if(o.selectedOwnedId){if(o.items.length>4)return alert("アイテムは4つまでです。");u.value=!0;try{const e=o.items.map(e=>({itemId:Number(e),isVirtual:!1}));await ob(i.selectedAccountId,o.selectedOwnedId,e),s("items-updated",{accountId:i.selectedAccountId,ownedCharacterId:o.selectedOwnedId,items:e}),alert("アイテムを更新しました。")}catch(e){alert("エラー: "+e.message)}finally{u.value=!1}}},b=async()=>{c.value=!0;try{const e=l.from.selectedId,t=l.to.selectedId,n=l.selectedItemIds;if(e===t||!e||!t)throw new Error("有効な移動元と移動先を選択してください。");if(0===n.length)throw new Error("移動するアイテムを選択してください。");const a=v.value.find(t=>t.id===e),r=v.value.find(e=>e.id===t);if(!a||!r)throw new Error("キャラクター情報が見つかりません。");const o=no(a.items||[]),u=no(r.items||[]);if(u.length+n.length>4)throw new Error("移動先のアイテム所持数が上限を超えます。");const c=o.filter(e=>!n.includes(e.itemId)).map(e=>({itemId:e.itemId,isVirtual:!1})),d=[...u.map(e=>({itemId:e.itemId,isVirtual:!1})),...n.map(e=>({itemId:Number(e),isVirtual:!1}))];await ub(i.selectedAccountId,{id:e,items:c},{id:t,items:d}),s("items-moved",{accountId:i.selectedAccountId,from:{id:e,items:c},to:{id:t,items:d}}),alert("アイテムを移動しました。"),l.from.selectedId=null,l.to.selectedId=null,l.selectedItemIds=[]}catch(e){alert(`エラー: ${e.message}`)}finally{c.value=!1}},w=(e,t)=>HE(e,t,a.characterMastersMap,a.ownedCharactersData,a.itemMastersMap,i.selectedAccountId);return(e,t)=>(H(),q("div",ix,[_("div",rx,[y(xb,{icon:"mdi-sword-cross",size:"32",color:"primary",class:"mr-3"}),t[6]||(t[6]=_("h2",{class:"text-h4 font-weight-bold text-primary"},"アイテム管理",-1))]),y(BE,null,{default:G(()=>[y(tC,{elevation:"3",rounded:"lg",class:"mb-6"},{default:G(()=>[y(QS,{class:"bg-primary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-update",class:"mr-2"}),t[7]||(t[7]=K(" 所持キャラクターのアイテムを変更 ",-1))]),_:1,__:[7]}),y(ZS,{class:"pa-6"},{default:G(()=>[y(rC,null,{default:G(()=>[y(NC,null,{default:G(()=>[y(pC,{cols:"12",md:"6"},{default:G(()=>[_("div",sx,[_("div",ox,[y(xb,{icon:"mdi-account-search",color:"primary",class:"mr-2"}),t[8]||(t[8]=_("h6",{class:"text-h6 font-weight-medium"},"対象キャラクター",-1))]),y(LE,{modelValue:o.selectedOwnedId,"onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedOwnedId=e),items:v.value,label:"変更対象のキャラクターを検索","list-height":"300px",color:"primary","prepend-inner-icon":"mdi-account-search"},{item:G(({item:e})=>[y(T_,null,{default:G(()=>[K(B(w(e,!0)),1)]),_:2},1024)]),_:1},8,["modelValue","items"])])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[_("div",lx,[_("div",ux,[y(xb,{icon:"mdi-sword-cross",color:"primary",class:"mr-2"}),t[9]||(t[9]=_("h6",{class:"text-h6 font-weight-medium"},"アイテム選択",-1))]),y(DS,{modelValue:o.items,"onUpdate:modelValue":t[1]||(t[1]=e=>o.items=e),items:O(a).itemMasters,"item-title":"name","item-value":"id",label:"アイテム (最大4つまで)",multiple:"",chips:"",clearable:"",variant:"outlined",disabled:!o.selectedOwnedId,color:"primary","prepend-inner-icon":"mdi-sword-cross"},null,8,["modelValue","items","disabled"]),y(qw,{loading:u.value,disabled:!o.selectedOwnedId||u.value||o.items.length>4,onClick:g,color:"primary",block:"",size:"large",variant:"elevated","prepend-icon":"mdi-update",class:"mt-4"},{default:G(()=>[K(B(u.value?"更新中...":"アイテムを更新"),1)]),_:1},8,["loading","disabled"]),o.items.length>4?(H(),W(BS,{key:0,type:"error",variant:"tonal",class:"mt-3","prepend-icon":"mdi-alert-circle"},{default:G(()=>t[10]||(t[10]=[K(" アイテムは4つまでしか選択できません。 ",-1)])),_:1,__:[10]})):Y("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),y(tC,{elevation:"3",rounded:"lg"},{default:G(()=>[y(QS,{class:"bg-secondary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-swap-horizontal",class:"mr-2"}),t[11]||(t[11]=K(" キャラクター間でアイテムを移動 ",-1))]),_:1,__:[11]}),y(ZS,{class:"pa-6"},{default:G(()=>[y(rC,null,{default:G(()=>[y(NC,{class:"mb-4"},{default:G(()=>[y(pC,{cols:"12"},{default:G(()=>[y(DS,{modelValue:l.itemFilter,"onUpdate:modelValue":t[2]||(t[2]=e=>l.itemFilter=e),items:O(a).itemMasters,"item-title":"name","item-value":"id",label:"アイテムでフィルタ（外す予定のキャラを優先表示）",clearable:"",variant:"outlined",color:"secondary","prepend-inner-icon":"mdi-filter",density:"comfortable"},{"prepend-inner":G(()=>[y(xb,{icon:"mdi-filter",color:"secondary"})]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),y(NC,null,{default:G(()=>[y(pC,{cols:"12",md:"4"},{default:G(()=>[_("div",cx,[y(Xb,{size:"48",color:"secondary",class:"mb-2"},{default:G(()=>[y(xb,{icon:"mdi-arrow-left",size:"24",color:"white"})]),_:1}),t[12]||(t[12]=_("h6",{class:"text-h6 font-weight-bold text-secondary"}," 移動元 ",-1))]),y(LE,{modelValue:l.from.selectedId,"onUpdate:modelValue":t[3]||(t[3]=e=>l.from.selectedId=e),items:p.value,label:"移動元キャラクターを検索","list-height":"250px","disabled-items":[l.to.selectedId].filter(Boolean),color:"secondary","prepend-inner-icon":"mdi-account-arrow-left"},{item:G(({item:e})=>[y(T_,null,{default:G(()=>[K(B(w(e,!0)),1)]),_:2},1024)]),_:1},8,["modelValue","items","disabled-items"])]),_:1}),y(pC,{cols:"12",md:"4"},{default:G(()=>[_("div",dx,[y(Xb,{size:"48",color:"info",class:"mb-2"},{default:G(()=>[y(xb,{icon:"mdi-sword-cross",size:"24",color:"white"})]),_:1}),t[13]||(t[13]=_("h6",{class:"text-h6 font-weight-bold text-info"}," 移動するアイテム ",-1))]),y(tC,{elevation:"2",rounded:"lg",style:{height:"318px","overflow-y":"auto"},class:"border-info border"},{default:G(()=>[y(ZS,{class:"pa-4"},{default:G(()=>[l.from.selectedId?m.value.length?(H(),q("div",fx,[_("div",vx,[y(hS,{color:"info",variant:"tonal",size:"small",class:"mb-2"},{default:G(()=>[K(B(m.value.length)+"個のアイテム ",1)]),_:1})]),(H(!0),q(N,null,J(m.value,e=>(H(),W(tS,{key:e.id,modelValue:l.selectedItemIds,"onUpdate:modelValue":t[4]||(t[4]=e=>l.selectedItemIds=e),label:e.name,value:e.id,density:"compact","hide-details":"",color:"info",class:"mb-2"},null,8,["modelValue","label","value"]))),128))])):(H(),q("div",px,[y(xb,{icon:"mdi-inbox-outline",size:"48",color:"grey-lighten-1"}),t[15]||(t[15]=_("div",{class:"mt-2 text-body-2 text-medium-emphasis"}," 移動できるアイテムがありません。 ",-1))])):(H(),q("div",hx,[y(xb,{icon:"mdi-information",size:"48",color:"grey-lighten-1"}),t[14]||(t[14]=_("div",{class:"mt-2 text-body-2 text-medium-emphasis"}," 移動元キャラクターを選択してください。 ",-1))]))]),_:1})]),_:1})]),_:1}),y(pC,{cols:"12",md:"4"},{default:G(()=>[_("div",mx,[y(Xb,{size:"48",color:"success",class:"mb-2"},{default:G(()=>[y(xb,{icon:"mdi-arrow-right",size:"24",color:"white"})]),_:1}),t[16]||(t[16]=_("h6",{class:"text-h6 font-weight-bold text-success"},"移動先",-1))]),y(LE,{modelValue:l.to.selectedId,"onUpdate:modelValue":t[5]||(t[5]=e=>l.to.selectedId=e),items:h.value,label:"移動先キャラクターを検索","list-height":"250px","disabled-items":[l.from.selectedId].filter(Boolean),color:"success","prepend-inner-icon":"mdi-account-arrow-right"},{item:G(({item:e})=>[y(T_,null,{default:G(()=>[K(B(w(e,!0)),1)]),_:2},1024)]),_:1},8,["modelValue","items","disabled-items"])]),_:1})]),_:1}),y(NC,{class:"mt-6"},{default:G(()=>[y(pC,null,{default:G(()=>[_("div",gx,[y(qw,{loading:c.value,disabled:!l.from.selectedId||!l.to.selectedId||0===l.selectedItemIds.length||c.value,onClick:b,color:"success",size:"large",variant:"elevated","prepend-icon":"mdi-swap-horizontal",class:"px-8"},{default:G(()=>[K(B(c.value?"移動中...":"選択したアイテムを移動"),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),y(ax,{"selected-account-id":O(i).selectedAccountId,"owned-characters-data":O(a).ownedCharactersData,"character-masters-map":O(a).characterMastersMap,"item-masters":O(a).itemMasters,"item-masters-map":O(a).itemMastersMap},null,8,["selected-account-id","owned-characters-data","character-masters-map","item-masters","item-masters-map"])]))}},bx={class:"team-list-container",style:{height:"65vh","overflow-y":"auto"}},wx={key:0,class:"text-center pa-8"},_x={key:1,class:"text-center pa-8"},Ix=["onClick"],Sx={class:"d-flex align-center justify-space-between mb-3"},Cx={class:"flex-grow-1"},kx={class:"text-h6 font-weight-bold text-primary mb-1"},Ex=["title"],xx=["title"],Tx=["title"],Ax={__name:"TeamList",props:{dataLoaded:{type:Boolean,required:!0},teams:{type:Array,required:!0},accounts:{type:Array,required:!0},ownedCharactersData:{type:Map,required:!0},characterMastersMap:{type:Map,required:!0},itemMastersMap:{type:Map,required:!0},selectedTeamId:{type:String,default:null}},emits:["select-team","delete-team"],setup(e,{emit:t}){const n=e,a=t,i=["禁忌","天魔(試練)","天魔(庭園)","星墓","轟絶","黎絶"],s=r({type:""}),o=f(()=>s.type?n.teams.filter(e=>e.type===s.type):n.teams),l=(e,t)=>{if(!e.characters||!n.dataLoaded||t>=e.characters.length)return{characterName:"—",accountName:"—",items:[]};const a=e.characters[t],i=n.accounts.find(e=>e.id===a.accountId),r=(n.ownedCharactersData.get(a.accountId)||[]).find(e=>e.id===a.ownedCharacterId);if(!r)return{characterName:"キャラ不明",accountName:(null==i?void 0:i.name)||"不明",items:[]};const s=n.characterMastersMap.get(r.characterMasterId),o=no(r.items||[]).map(e=>{const t=n.itemMastersMap.get(e.itemId)||`不明ID:${e.itemId}`;return e.isEL?`${t}（EL）`:t}).filter(Boolean);return{characterName:(null==s?void 0:s.monsterName)||"不明",accountName:(null==i?void 0:i.name)||"不明",items:o}};return(t,n)=>(H(),W(tC,{class:"h-100",elevation:"3",rounded:"lg"},{default:G(()=>[y(QS,{class:"bg-primary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-format-list-bulleted",class:"mr-2"}),n[1]||(n[1]=K(" 編成一覧 ",-1))]),_:1,__:[1]}),y(ZS,{class:"pa-4"},{default:G(()=>[y(DS,{modelValue:s.type,"onUpdate:modelValue":n[0]||(n[0]=e=>s.type=e),items:["",...i],label:"タイプで絞り込み",variant:"outlined",clearable:"",density:"compact","prepend-inner-icon":"mdi-filter",class:"mb-4",color:"primary"},null,8,["modelValue","items"]),_("div",bx,[e.dataLoaded?0===o.value.length?(H(),q("div",_x,[y(xb,{icon:"mdi-inbox-outline",size:"64",color:"grey-lighten-1"}),n[3]||(n[3]=_("div",{class:"mt-3 text-body-1 text-medium-emphasis"}," 該当する編成がありません ",-1))])):Y("",!0):(H(),q("div",wx,[y(dw,{indeterminate:"",color:"primary",size:"48"}),n[2]||(n[2]=_("div",{class:"mt-3 text-body-1 text-medium-emphasis"}," データを読み込んでいます... ",-1))])),(H(!0),q(N,null,J(o.value,t=>{return H(),q("div",{key:t.id,onClick:e=>(e=>{a("select-team",e)})(t),class:w(["team-item mb-3 pa-4 rounded-lg cursor-pointer transition-all",e.selectedTeamId===t.id?"bg-primary-lighten-5 border-primary border-2":"bg-grey-lighten-5 border-grey-lighten-3 border"]),style:{"min-height":"120px"}},[_("div",Sx,[_("div",Cx,[_("h3",kx,B(t.name),1),y(hS,{color:(n=t.type,{"禁忌":"deep-purple","天魔(試練)":"red-darken-2","天魔(庭園)":"green-darken-2","星墓":"blue-darken-2","轟絶":"orange-darken-2","黎絶":"blue-darken-2"}[n]||"grey"),size:"small",variant:"tonal",class:"font-weight-medium"},{default:G(()=>[K(B(t.type),1)]),_:2},1032,["color"])]),y(qw,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:ee(e=>{return n=t.id,void a("delete-team",n);var n},["stop"]),class:"ml-2"},null,8,["onClick"])]),y(NC,{dense:""},{default:G(()=>[(H(!0),q(N,null,J(Array(4),(e,n)=>(H(),W(pC,{key:n,cols:"3"},{default:G(()=>[_("div",{class:w(["character-slot pa-2 rounded text-center","—"!==l(t,n).characterName?"bg-white":"bg-grey-lighten-4"])},[_("div",{class:"text-caption font-weight-bold text-truncate mb-1",title:l(t,n).characterName},B(l(t,n).characterName),9,Ex),_("div",{class:"text-caption text-truncate mb-1",title:l(t,n).accountName},B(l(t,n).accountName),9,xx),y(Gw,{class:"my-1"}),(H(),q(N,null,J(4,e=>_("div",{key:e,class:"text-caption text-truncate",title:l(t,n).items[e-1]},B(l(t,n).items[e-1]||"—"),9,Tx)),64))],2)]),_:2},1024))),128))]),_:2},1024)],10,Ix);var n}),128))])]),_:1})]),_:1}))}},Nx={class:"character-formation-section"},Vx={class:"d-flex align-center mb-4"},Dx={class:"d-flex align-center mb-4"},Mx={class:"text-white font-weight-bold"},Rx={class:"text-h6 font-weight-bold"},Px={key:1,class:"pa-8 text-center"},Ox={__name:"TeamForm",props:{team:{type:Object,required:!0},accounts:{type:Array,required:!0},ownedCharactersData:{type:Map,required:!0},characterMastersMap:{type:Map,required:!0},itemMastersMap:{type:Map,required:!0},isSaving:{type:Boolean,default:!1}},emits:["save-team","reset-form","update:team"],setup(e,{emit:t}){const n=e,a=t,i=(e,t)=>{const i=JSON.parse(JSON.stringify(n.team));i[e]=t,a("update:team",i)},r=(e,t,i)=>{const r={...n.team,slots:n.team.slots.map((n,a)=>a===e?{...n,[t]:i}:n)};"selectedAccountId"===t&&(r.slots[e].selectedOwnedId=null),a("update:team",r)},s=["禁忌","天魔(試練)","天魔(庭園)","星墓","轟絶","黎絶"],o=f(()=>n.team.name&&n.team.type&&n.team.slots.every(e=>e.selectedAccountId&&e.selectedOwnedId)),l=e=>{if(!e.selectedAccountId)return[];return(n.ownedCharactersData.get(e.selectedAccountId)||[]).map(t=>{const a=n.characterMastersMap.get(t.characterMasterId);return{...t,accountId:e.selectedAccountId,indexNumber:(null==a?void 0:a.indexNumber)||999999,monsterName:(null==a?void 0:a.monsterName)||"不明"}}).sort((e,t)=>e.indexNumber-t.indexNumber)};return(t,a)=>(H(),W(tC,{class:"h-100",elevation:"3",rounded:"lg"},{default:G(()=>[y(QS,{class:"bg-primary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-account-edit",class:"mr-2"}),K(" "+B(e.team.id?"編成編集":"新規編成作成"),1)]),_:1}),y(WS,{class:"pa-4 bg-grey-lighten-5"},{default:G(()=>[y(qw,{onClick:a[0]||(a[0]=e=>t.$emit("reset-form")),size:"small",variant:"tonal",color:"primary","prepend-icon":"mdi-plus"},{default:G(()=>a[4]||(a[4]=[K(" 新規作成フォームを開く ",-1)])),_:1,__:[4]})]),_:1}),e.accounts.length>0&&e.ownedCharactersData.size>0&&e.characterMastersMap.size>0?(H(),q(N,{key:0},[y(ZS,{class:"pa-6"},{default:G(()=>[y(IS,{"model-value":e.team.name,"onUpdate:modelValue":a[1]||(a[1]=e=>i("name",e)),label:"編成名",variant:"outlined",placeholder:"例: 天魔の孤城 第1の間",class:"mb-6",color:"primary","prepend-inner-icon":"mdi-format-title"},null,8,["model-value"]),y(DS,{"model-value":e.team.type,"onUpdate:modelValue":a[2]||(a[2]=e=>i("type",e)),items:s,label:"タイプ",variant:"outlined",class:"mb-8",color:"primary","prepend-inner-icon":"mdi-tag"},null,8,["model-value"]),_("div",Nx,[_("div",Vx,[y(xb,{icon:"mdi-account-multiple",color:"primary",class:"mr-2"}),a[5]||(a[5]=_("h4",{class:"text-h5 font-weight-bold text-primary"}," キャラクター編成 (4体) ",-1))]),y(NC,null,{default:G(()=>[(H(!0),q(N,null,J(e.team.slots,(t,a)=>(H(),W(pC,{key:a,cols:"12",md:"6"},{default:G(()=>[y(tC,{elevation:"2",class:w(["pa-4 h-100 character-slot-card",t.selectedAccountId?"border-primary border-2":"border-grey-lighten-3 border"]),rounded:"lg",style:{"min-height":"400px"}},{default:G(()=>{return[_("div",Dx,[y(Xb,{size:"32",color:"primary",class:"mr-3"},{default:G(()=>[_("span",Mx,B(a+1),1)]),_:2},1024),_("h5",Rx," スロット "+B(a+1),1)]),y(DS,{"model-value":t.selectedAccountId,"onUpdate:modelValue":e=>r(a,"selectedAccountId",e),items:e.accounts,"item-title":"name","item-value":"id",label:"アカウント",variant:"outlined",density:"compact",class:"mb-3",color:"primary","prepend-inner-icon":"mdi-account"},null,8,["model-value","onUpdate:modelValue","items"]),y(LE,{"model-value":t.selectedOwnedId,"onUpdate:modelValue":e=>((e,t)=>{r(e,"selectedOwnedId",t)})(a,e),items:l(t),label:"キャラクターを選択","list-height":"280px",variant:"filled",disabled:!t.selectedAccountId,"disabled-items":(i=a,n.team.slots.filter((e,t)=>t!==i&&e.selectedOwnedId).map(e=>e.selectedOwnedId)),"no-data-text":"先にアカウントを選択",density:"comfortable","list-density":"comfortable","primary-color":"primary","search-bg-color":"grey-lighten-5","card-elevation":2,"prepend-inner-icon":"mdi-account-search"},{item:G(({item:e})=>[y(T_,null,{default:G(()=>{return[K(B((t=e,a=!0,HE(t,a,n.characterMastersMap,n.ownedCharactersData,n.itemMastersMap,t.accountId))),1)];var t,a}),_:2},1024)]),_:2},1032,["model-value","onUpdate:modelValue","items","disabled","disabled-items"])];var i}),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})])]),_:1}),y(GS,{class:"pa-6 bg-grey-lighten-5"},{default:G(()=>[y(VC),y(qw,{loading:e.isSaving,disabled:!o.value||e.isSaving,onClick:a[3]||(a[3]=e=>t.$emit("save-team")),color:"primary",size:"large",variant:"elevated","prepend-icon":"mdi-content-save",class:"px-8"},{default:G(()=>[K(B(e.isSaving?"保存中...":e.team.id?"編成を更新":"編成を保存"),1)]),_:1},8,["loading","disabled"])]),_:1})],64)):(H(),q("div",Px,[y(dw,{indeterminate:"",color:"primary",size:"48"}),a[6]||(a[6]=_("div",{class:"mt-3 text-body-1 text-medium-emphasis"}," データを読み込んでいます... ",-1))]))]),_:1}))}},Lx={class:"pa-6"},Fx={class:"d-flex align-center mb-6"},Bx=mb({__name:"ManageTeamsTab",emits:["team-added","team-updated","team-deleted"],setup(e,{emit:n}){const a=fb();vb();const i=eo(),s=n,o=t(!1),l=()=>({id:null,name:"",type:"",slots:Array(4).fill().map(()=>({selectedAccountId:"",selectedOwnedId:"",characterSearch:""}))}),u=r(l()),c=e=>{Object.assign(u,e)},d=e=>{Object.assign(u,{id:e.id,name:e.name,type:e.type,slots:JSON.parse(JSON.stringify(e.characters.map(e=>({selectedAccountId:e.accountId,selectedOwnedId:e.ownedCharacterId,characterSearch:""}))))})},h=()=>{Object.assign(u,l())},p=async()=>{if(!(u.name&&u.type&&u.slots.every(e=>e.selectedAccountId&&e.selectedOwnedId)))return void alert("編成名、タイプ、4体のキャラを全て選択してください。");o.value=!0;const e={userId:i.userId,name:u.name,type:u.type,characters:u.slots.map(e=>({accountId:e.selectedAccountId,ownedCharacterId:e.selectedOwnedId}))};try{const t=u.id;Object.assign(e,t?{updatedAt:ab()}:{createdAt:ab()});const n=await hb(t,e);if(t)s("team-updated",{...e,id:t}),alert("編成を更新しました。");else{const t={...e,id:n.id,createdAt:{toDate:()=>new Date}};s("team-added",t),alert("編成を保存しました。"),h()}}catch(t){alert("エラー: "+t.message)}finally{o.value=!1}},f=async e=>{if(confirm("この編成を本当に削除しますか？"))try{await pb(e),s("team-deleted",e),alert("編成を削除しました。"),u.id===e&&h()}catch(t){alert("エラー: "+t.message)}};return(e,t)=>(H(),q("div",Lx,[_("div",Fx,[y(xb,{icon:"mdi-account-group",size:"32",color:"primary",class:"mr-3"}),t[0]||(t[0]=_("h2",{class:"text-h4 font-weight-bold text-primary"},"編成管理",-1))]),y(NC,null,{default:G(()=>[y(pC,{cols:"12",lg:"5"},{default:G(()=>[y(Ax,{"data-loaded":O(a).dataLoaded,teams:O(a).teams,accounts:O(a).accounts,"owned-characters-data":O(a).ownedCharactersData,"character-masters-map":O(a).characterMastersMap,"item-masters-map":O(a).itemMastersMap,"selected-team-id":u.id,onSelectTeam:d,onDeleteTeam:f},null,8,["data-loaded","teams","accounts","owned-characters-data","character-masters-map","item-masters-map","selected-team-id"])]),_:1}),y(pC,{cols:"12",lg:"7"},{default:G(()=>[y(Ox,{team:u,accounts:O(a).accounts,"owned-characters-data":O(a).ownedCharactersData,"character-masters-map":O(a).characterMastersMap,"item-masters-map":O(a).itemMastersMap,"is-saving":o.value,onSaveTeam:p,onResetForm:h,"onUpdate:team":c},null,8,["team","accounts","owned-characters-data","character-masters-map","item-masters-map","is-saving"])]),_:1})]),_:1})]))}},[["__scopeId","data-v-b6817dbf"]]),Ux={class:"pa-6"},$x={class:"d-flex align-center mb-6"},jx={__name:"AddMasterCharacterTab",emits:["master-added"],setup(e,{emit:n}){const a=fb();vb();const i=n,s=r({no:"",name:"",element:"",type:"恒常",gacha:""}),o=t(!1),l=async()=>{if(!s.name)return alert("キャラクター名は必須です。");o.value=!0;try{const e={indexNumber:s.no?Number(s.no):0,monsterName:s.name,element:s.element||"",type:s.type||"恒常",ejectionGacha:s.gacha||""};await cb(e),alert("マスターを追加しました。ページをリロードして反映してください。"),i("master-added")}catch(e){alert("エラー: "+e.message)}finally{o.value=!1}};return(e,t)=>(H(),q("div",Ux,[_("div",$x,[y(xb,{icon:"mdi-account-plus",size:"32",color:"primary",class:"mr-3"}),t[5]||(t[5]=_("h2",{class:"text-h4 font-weight-bold text-primary"}," キャラクターマスター新規追加 ",-1))]),y(BE,{onSubmit:ee(l,["prevent"])},{default:G(()=>[y(tC,{elevation:"3",rounded:"lg"},{default:G(()=>[y(QS,{class:"bg-primary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-account-plus",class:"mr-2"}),t[6]||(t[6]=K(" 新規キャラクター情報 ",-1))]),_:1,__:[6]}),y(ZS,{class:"pa-6"},{default:G(()=>[y(rC,null,{default:G(()=>[y(NC,null,{default:G(()=>[y(pC,{cols:"12",md:"6"},{default:G(()=>[y(IS,{modelValue:s.no,"onUpdate:modelValue":t[0]||(t[0]=e=>s.no=e),modelModifiers:{number:!0},label:"図鑑番号",type:"number",placeholder:"例: 1234",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-numeric",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(IS,{modelValue:s.name,"onUpdate:modelValue":t[1]||(t[1]=e=>s.name=e),modelModifiers:{trim:!0},label:"キャラクター名",required:"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-account",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(DS,{modelValue:s.element,"onUpdate:modelValue":t[2]||(t[2]=e=>s.element=e),items:["火","水","木","光","闇"],label:"属性",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-fire",clearable:"",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(DS,{modelValue:s.type,"onUpdate:modelValue":t[3]||(t[3]=e=>s.type=e),items:["恒常","限定","コラボ","α"],label:"分類",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-tag",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12"},{default:G(()=>[y(DS,{modelValue:s.gacha,"onUpdate:modelValue":t[4]||(t[4]=e=>s.gacha=e),items:O(a).gachaMasters,"item-title":"name","item-value":"name",label:"排出ガチャ (限定の場合)",placeholder:"(限定ではない/その他)",clearable:"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-gift",class:"mb-4"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),y(GS,{class:"pa-6 bg-grey-lighten-5"},{default:G(()=>[y(VC),y(qw,{loading:o.value,disabled:!s.name||o.value,onClick:l,color:"primary",size:"large",variant:"elevated","prepend-icon":"mdi-content-save",class:"px-8"},{default:G(()=>[K(B(o.value?"追加中...":"マスターリストに新規追加"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]))}},zx={class:"pa-6"},qx={class:"d-flex align-center mb-6"},Hx={__name:"EditMasterCharacterTab",emits:["master-updated"],setup(e,{emit:n}){const a=fb();vb();const i=n,s=r({search:"",selectedMasterId:null,no:"",name:"",element:"",type:"",gacha:""}),o=t(!1);d(()=>s.selectedMasterId,e=>{if(!e)return void Object.assign(s,{name:"",no:"",element:"",type:"",gacha:""});const t=a.characterMastersMap.get(e);t&&Object.assign(s,{name:t.monsterName,no:t.indexNumber,element:t.element,type:t.type,gacha:t.ejectionGacha})});const l=async()=>{if(!s.selectedMasterId||!s.name)return alert("キャラを選択し名前を入力してください。");o.value=!0;try{const e={monsterName:s.name,indexNumber:s.no?Number(s.no):0,element:s.element,type:s.type,ejectionGacha:s.gacha};await db(s.selectedMasterId,e),alert("マスター情報を更新しました。ページをリロードしてください。"),i("master-updated")}catch(e){alert("更新に失敗: "+e.message)}finally{o.value=!1}};return(e,t)=>(H(),q("div",zx,[_("div",qx,[y(xb,{icon:"mdi-account-edit",size:"32",color:"primary",class:"mr-3"}),t[6]||(t[6]=_("h2",{class:"text-h4 font-weight-bold text-primary"}," キャラクターマスター編集 ",-1))]),y(BE,null,{default:G(()=>[y(rC,{class:"pa-0"},{default:G(()=>[y(NC,null,{default:G(()=>[y(pC,{cols:"12"},{default:G(()=>[y(tC,{elevation:"2",rounded:"lg",class:"mb-4"},{default:G(()=>[y(QS,{class:"bg-primary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-account-search",class:"mr-2"}),t[7]||(t[7]=K(" 編集対象キャラクター選択 ",-1))]),_:1,__:[7]}),y(ZS,{class:"pa-4"},{default:G(()=>[y(LE,{modelValue:s.selectedMasterId,"onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedMasterId=e),items:O(a).characterMasters,"item-title":e=>`[${e.indexNumber||"?"}] ${e.monsterName}`,label:"編集したいキャラクター名で検索","list-height":"300px",color:"primary","prepend-inner-icon":"mdi-account-search"},null,8,["modelValue","items","item-title"])]),_:1})]),_:1})]),_:1})]),_:1}),s.selectedMasterId?(H(),W(NC,{key:0,class:"mt-4"},{default:G(()=>[y(pC,{cols:"12"},{default:G(()=>[y(tC,{elevation:"3",rounded:"lg"},{default:G(()=>[y(QS,{class:"bg-secondary text-white pa-4"},{default:G(()=>[y(xb,{icon:"mdi-account-edit",class:"mr-2"}),t[8]||(t[8]=K(" 編集フォーム ",-1))]),_:1,__:[8]}),y(ZS,{class:"pa-6"},{default:G(()=>[y(rC,null,{default:G(()=>[y(NC,null,{default:G(()=>[y(pC,{cols:"12",md:"6"},{default:G(()=>[y(IS,{modelValue:s.no,"onUpdate:modelValue":t[1]||(t[1]=e=>s.no=e),modelModifiers:{number:!0},label:"図鑑番号",type:"number",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-numeric",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(IS,{modelValue:s.name,"onUpdate:modelValue":t[2]||(t[2]=e=>s.name=e),modelModifiers:{trim:!0},label:"キャラクター名",required:"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-account",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(DS,{modelValue:s.element,"onUpdate:modelValue":t[3]||(t[3]=e=>s.element=e),items:["火","水","木","光","闇"],label:"属性",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-fire",clearable:"",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12",md:"6"},{default:G(()=>[y(DS,{modelValue:s.type,"onUpdate:modelValue":t[4]||(t[4]=e=>s.type=e),items:["恒常","限定","コラボ","イベント"],label:"分類",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-tag",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(pC,{cols:"12"},{default:G(()=>[y(DS,{modelValue:s.gacha,"onUpdate:modelValue":t[5]||(t[5]=e=>s.gacha=e),items:O(a).gachaMasters,"item-title":"name","item-value":"name",label:"排出ガチャ (限定の場合)",placeholder:"(限定ではない/その他)",clearable:"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-gift",class:"mb-4"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),y(GS,{class:"pa-6 bg-grey-lighten-5"},{default:G(()=>[y(VC),y(qw,{loading:o.value,disabled:!s.selectedMasterId||o.value,onClick:l,color:"primary",size:"large",variant:"elevated","prepend-icon":"mdi-content-save",class:"px-8"},{default:G(()=>[K(B(o.value?"更新中...":"マスター情報を更新"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})):Y("",!0)]),_:1})]),_:1})]))}},Gx=oe({..._e(),...Je(jt(),["fullHeight"]),...we()},"VApp"),Kx=se()({name:"VApp",props:Gx(),setup(e,t){let{slots:n}=t;const a=Te(e),{layoutClasses:i,getLayoutItem:r,items:s,layoutRef:o}=$t({...e,fullHeight:!0}),{rtlClasses:l}=Pe();return be(()=>{var t;return _("div",{ref:o,class:w(["v-application",a.themeClasses.value,i.value,l.value,e.class]),style:b([e.style])},[_("div",{class:"v-application__wrap"},[null==(t=n.default)?void 0:t.call(n)])])}),{getLayoutItem:r,items:s,theme:a}}}),Wx=oe({text:String,..._e(),...kb()},"VToolbarTitle"),Qx=se()({name:"VToolbarTitle",props:Wx(),setup(e,t){let{slots:n}=t;return be(()=>{const t=!!(n.default||n.text||e.text);return y(e.tag,{class:w(["v-toolbar-title",e.class]),style:b(e.style)},{default:()=>{var a;return[t&&_("div",{class:"v-toolbar-title__placeholder"},[n.text?n.text():e.text,null==(a=n.default)?void 0:a.call(n)])]}})}),{}}}),Xx=[null,"prominent","default","comfortable","compact"],Yx=oe({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>Xx.includes(e)},extended:{type:Boolean,default:null},extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...Ub(),..._e(),...Yb(),...Db(),...kb({tag:"header"}),...we()},"VToolbar"),Jx=se()({name:"VToolbar",props:Yx(),setup(e,t){var n;let{slots:a}=t;const{backgroundColorClasses:i,backgroundColorStyles:r}=_b(()=>e.color),{borderClasses:s}=$b(e),{elevationClasses:o}=Jb(e),{roundedClasses:l}=Mb(e),{themeClasses:u}=Te(e),{rtlClasses:c}=Pe(),d=m(null===e.extended?!!(null==(n=a.extension)?void 0:n.call(a)):e.extended),h=f(()=>parseInt(Number(e.height)+("prominent"===e.density?Number(e.height):0)-("comfortable"===e.density?8:0)-("compact"===e.density?16:0),10)),p=f(()=>d.value?parseInt(Number(e.extensionHeight)+("prominent"===e.density?Number(e.extensionHeight):0)-("comfortable"===e.density?4:0)-("compact"===e.density?8:0),10):0);return le({VBtn:{variant:"text"}}),be(()=>{var t;const n=!(!e.title&&!a.title),f=!(!a.image&&!e.image),v=null==(t=a.extension)?void 0:t.call(a);return d.value=null===e.extended?!!v:e.extended,y(e.tag,{class:w(["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},i.value,s.value,o.value,l.value,u.value,c.value,e.class]),style:b([r.value,e.style])},{default:()=>[f&&_("div",{key:"image",class:"v-toolbar__image"},[a.image?y(yb,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},a.image):y(Bb,{key:"image-img",cover:!0,src:e.image},null)]),y(yb,{defaults:{VTabs:{height:me(h.value)}}},{default:()=>{var t,i,r;return[_("div",{class:"v-toolbar__content",style:{height:me(h.value)}},[a.prepend&&_("div",{class:"v-toolbar__prepend"},[null==(t=a.prepend)?void 0:t.call(a)]),n&&y(Qx,{key:"title",text:e.title},{text:a.title}),null==(i=a.default)?void 0:i.call(a),a.append&&_("div",{class:"v-toolbar__append"},[null==(r=a.append)?void 0:r.call(a)])])]}}),y(yb,{defaults:{VTabs:{height:me(p.value)}}},{default:()=>[y(i_,null,{default:()=>[d.value&&_("div",{class:"v-toolbar__extension",style:{height:me(p.value)}},[v])]})]})]})}),{contentHeight:h,extensionHeight:p}}}),Zx=oe({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");const eT=oe({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...Yx(),...qt(),...Zx(),height:{type:[Number,String],default:64}},"VAppBar"),tT=se()({name:"VAppBar",props:eT(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:a}=n;const i=t(),r=Ae(e,"modelValue"),s=f(()=>{var t;const n=new Set((null==(t=e.scrollBehavior)?void 0:t.split(" "))??[]);return{hide:n.has("hide"),fullyHide:n.has("fully-hide"),inverted:n.has("inverted"),collapse:n.has("collapse"),elevate:n.has("elevate"),fadeImage:n.has("fade-image")}}),o=f(()=>{const e=s.value;return e.hide||e.fullyHide||e.inverted||e.collapse||e.elevate||e.fadeImage||!r.value}),{currentScroll:l,scrollThreshold:u,isScrollingUp:c,scrollRatio:h}=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{canScroll:a}=n;let i=0,r=0;const s=t(null),o=m(0),l=m(0),u=m(0),c=m(!1),h=m(!1),p=f(()=>Number(e.scrollThreshold)),v=f(()=>Re((p.value-o.value)/p.value||0)),g=()=>{const e=s.value;if(!e||a&&!a.value)return;i=o.value,o.value="window"in e?e.pageYOffset:e.scrollTop;const t=e instanceof Window?document.documentElement.scrollHeight:e.scrollHeight;r===t?(h.value=o.value<i,u.value=Math.abs(o.value-p.value)):r=t};return d(h,()=>{l.value=l.value||o.value}),d(c,()=>{l.value=0}),D(()=>{d(()=>e.scrollTarget,e=>{var t;const n=e?document.querySelector(e):window;n&&n!==s.value&&(null==(t=s.value)||t.removeEventListener("scroll",g),s.value=n,s.value.addEventListener("scroll",g,{passive:!0}))},{immediate:!0})}),x(()=>{var e;null==(e=s.value)||e.removeEventListener("scroll",g)}),a&&d(a,g,{immediate:!0}),{scrollThreshold:p,currentScroll:o,currentThreshold:u,isScrollActive:c,scrollRatio:v,isScrollingUp:h,savedScroll:l}}(e,{canScroll:o}),p=T(()=>s.value.hide||s.value.fullyHide),v=f(()=>e.collapse||s.value.collapse&&(s.value.inverted?h.value>0:0===h.value)),g=f(()=>e.flat||s.value.fullyHide&&!r.value||s.value.elevate&&(s.value.inverted?l.value>0:0===l.value)),b=f(()=>s.value.fadeImage?s.value.inverted?1-h.value:h.value:void 0),w=f(()=>{var e,t;if(s.value.hide&&s.value.inverted)return 0;const n=(null==(e=i.value)?void 0:e.contentHeight)??0,a=(null==(t=i.value)?void 0:t.extensionHeight)??0;return p.value?l.value<u.value||s.value.fullyHide?n+a:n:n+a});et(()=>!!e.scrollBehavior,()=>{L(()=>{p.value?s.value.inverted?r.value=l.value>u.value:r.value=c.value||l.value<u.value:r.value=!0})});const{ssrBootStyles:_}=I_(),{layoutItemStyles:I}=zt({id:e.name,order:f(()=>parseInt(e.order,10)),position:T(()=>e.location),layoutSize:w,elementSize:m(void 0),active:r,absolute:T(()=>e.absolute)});return be(()=>{const t=Jx.filterProps(e);return y(Jx,C({ref:i,class:["v-app-bar",{"v-app-bar--bottom":"bottom"===e.location},e.class],style:[{...I.value,"--v-toolbar-image-opacity":b.value,height:void 0,..._.value},e.style]},t,{collapse:v.value,flat:g.value}),a)}),{}}}),nT=oe({scrollable:Boolean,..._e(),...Tb(),...kb({tag:"main"})},"VMain"),aT=se()({name:"VMain",props:nT(),setup(e,t){let{slots:n}=t;const{dimensionStyles:a}=Ab(e),{mainStyles:i}=Ht(),{ssrBootStyles:r}=I_();return be(()=>y(e.tag,{class:w(["v-main",{"v-main--scrollable":e.scrollable},e.class]),style:b([i.value,r.value,a.value,e.style])},{default:()=>{var t,a;return[e.scrollable?_("div",{class:"v-main__scroller"},[null==(t=n.default)?void 0:t.call(n)]):null==(a=n.default)?void 0:a.call(n)]}})),{}}});const iT=oe({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...pw({location:"bottom"}),..._w(),...Db(),...Kb(),...we(),...Je(_I({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),rT=se()({name:"VSnackbar",props:iT(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:i}=n;const r=Ae(e,"modelValue"),{positionClasses:s}=Iw(e),{scopeId:o}=hI(),{themeClasses:l}=Te(e),{colorClasses:u,colorStyles:p,variantClasses:v}=Wb(e),{roundedClasses:g}=Mb(e),b=function(e){const t=m(e());let n=-1;function a(){clearInterval(n)}return c(a),{clear:a,time:t,start:function(i){const r=i?getComputedStyle(i):{transitionDuration:.2},s=1e3*parseFloat(r.transitionDuration)||200;if(a(),t.value<=0)return;const o=performance.now();n=window.setInterval(()=>{const n=performance.now()-o+s;t.value=Math.max(e()-n,0),t.value<=0&&a()},s)},reset:function(){a(),h(()=>t.value=e())}}}(()=>Number(e.timeout)),w=t(),I=t(),S=m(!1),k=m(0),E=t(),x=a(Gt,void 0);et(()=>!!x,()=>{const e=Ht();L(()=>{E.value=e.mainStyles.value})}),d(r,A),d(()=>e.timeout,A),D(()=>{r.value&&A()});let T=-1;function A(){b.reset(),window.clearTimeout(T);const t=Number(e.timeout);if(!r.value||-1===t)return;const n=Kt(I.value);b.start(n),T=window.setTimeout(()=>{r.value=!1},t)}function N(){S.value=!0,b.reset(),window.clearTimeout(T)}function V(){S.value=!1,A()}function M(e){k.value=e.touches[0].clientY}function R(e){Math.abs(k.value-e.changedTouches[0].clientY)>50&&(r.value=!1)}function P(){S.value&&V()}const O=f(()=>e.location.split(" ").reduce((e,t)=>(e[`v-snackbar--${t}`]=!0,e),{}));return be(()=>{const t=II.filterProps(e),n=!!(i.default||i.text||e.text);return y(II,C({ref:w,class:["v-snackbar",{"v-snackbar--active":r.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},O.value,s.value,e.class],style:[E.value,e.style]},t,{modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,contentProps:C({class:["v-snackbar__wrapper",l.value,u.value,g.value,v.value],style:[p.value],onPointerenter:N,onPointerleave:V},t.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:M,onTouchend:R,onAfterLeave:P},o),{default:()=>{var t,a;return[Gb(!1,"v-snackbar"),e.timer&&!S.value&&_("div",{key:"timer",class:"v-snackbar__timer"},[y(mw,{ref:I,color:"string"==typeof e.timer?e.timer:"info",max:e.timeout,modelValue:b.time.value},null)]),n&&_("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[(null==(t=i.text)?void 0:t.call(i))??e.text,null==(a=i.default)?void 0:a.call(i)]),i.actions&&y(yb,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[_("div",{class:"v-snackbar__actions"},[i.actions({isActive:r})])]})]},activator:i.activator})}),kI({},w)}}),sT=Symbol.for("vuetify:v-tabs"),oT=oe({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Je(zw({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),lT=se()({name:"VTab",props:oT(),setup(e,n){let{slots:a,attrs:i}=n;const{textColorClasses:r,textColorStyles:s}=wb(()=>e.sliderColor),o=t(),l=t(),u=f(()=>"horizontal"===e.direction),c=f(()=>{var e,t;return(null==(t=null==(e=o.value)?void 0:e.group)?void 0:t.isSelected.value)??!1});function d(e){var t,n;let{value:a}=e;if(a){const e=null==(n=null==(t=o.value)?void 0:t.$el.parentElement)?void 0:n.querySelector(".v-tab--selected .v-tab__slider"),a=l.value;if(!e||!a)return;const i=getComputedStyle(e).color,r=e.getBoundingClientRect(),s=a.getBoundingClientRect(),c=u.value?"x":"y",d=u.value?"X":"Y",h=u.value?"right":"bottom",p=u.value?"width":"height",f=r[c]>s[c]?r[h]-s[h]:r[c]-s[c],v=Math.sign(f)>0?u.value?"right":"bottom":Math.sign(f)<0?u.value?"left":"top":"center",m=(Math.abs(f)+(Math.sign(f)<0?r[p]:s[p]))/Math.max(r[p],s[p])||0,g=r[p]/s[p]||0,y=1.5;Be(a,{backgroundColor:[i,"currentcolor"],transform:[`translate${d}(${f}px) scale${d}(${g})`,`translate${d}(${f/y}px) scale${d}(${(m-1)/y+1})`,"none"],transformOrigin:Array(3).fill(v)},{duration:225,easing:$e})}}return be(()=>{const t=qw.filterProps(e);return y(qw,C({symbol:sT,ref:o,class:["v-tab",e.class],style:e.style,tabindex:c.value?0:-1,role:"tab","aria-selected":String(c.value),active:!1},t,i,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":d}),{...a,default:()=>{var t;return _(N,null,[(null==(t=a.default)?void 0:t.call(a))??e.text,!e.hideSlider&&_("div",{ref:l,class:w(["v-tab__slider",r.value]),style:b(s.value)},null)])}})}),kI({},o)}});function uT(e,t){var n;const a=e.changedTouches[0];t.touchendX=a.clientX,t.touchendY=a.clientY,null==(n=t.end)||n.call(t,{originalEvent:e,...t}),(e=>{const{touchstartX:t,touchendX:n,touchstartY:a,touchendY:i}=e;e.offsetX=n-t,e.offsetY=i-a,Math.abs(e.offsetY)<.5*Math.abs(e.offsetX)&&(e.left&&n<t-16&&e.left(e),e.right&&n>t+16&&e.right(e)),Math.abs(e.offsetX)<.5*Math.abs(e.offsetY)&&(e.up&&i<a-16&&e.up(e),e.down&&i>a+16&&e.down(e))})(t)}const cT={mounted:function(e,t){var n;const a=t.value,i=(null==a?void 0:a.parent)?e.parentElement:e,r=(null==a?void 0:a.options)??{passive:!0},s=null==(n=t.instance)?void 0:n.$.uid;if(!i||!s)return;const o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:e=>function(e,t){var n;const a=e.changedTouches[0];t.touchstartX=a.clientX,t.touchstartY=a.clientY,null==(n=t.start)||n.call(t,{originalEvent:e,...t})}(e,t),touchend:e=>uT(e,t),touchmove:e=>function(e,t){var n;const a=e.changedTouches[0];t.touchmoveX=a.clientX,t.touchmoveY=a.clientY,null==(n=t.move)||n.call(t,{originalEvent:e,...t})}(e,t)}}(t.value);i._touchHandlers=i._touchHandlers??Object.create(null),i._touchHandlers[s]=o,Wt(o).forEach(e=>{i.addEventListener(e,o[e],r)})},unmounted:function(e,t){var n,a;const i=(null==(n=t.value)?void 0:n.parent)?e.parentElement:e,r=null==(a=t.instance)?void 0:a.$.uid;if(!(null==i?void 0:i._touchHandlers)||!r)return;const s=i._touchHandlers[r];Wt(s).forEach(e=>{i.removeEventListener(e,s[e])}),delete i._touchHandlers[r]}},dT=Symbol.for("vuetify:v-window"),hT=Symbol.for("vuetify:v-window-group"),pT=oe({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>"boolean"==typeof e||"hover"===e},verticalArrows:[Boolean,String],touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},..._e(),...kb(),...we()},"VWindow"),fT=se()({name:"VWindow",directives:{vTouch:cT},props:pT(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:a}=n;const{themeClasses:i}=Te(e),{isRtl:r}=Pe(),{t:s}=Ct(),o=iw(e,hT),l=t(),u=f(()=>r.value?!e.reverse:e.reverse),c=m(!1),h=f(()=>`v-window-${"vertical"===e.direction?"y":"x"}${(u.value?!c.value:c.value)?"-reverse":""}-transition`),p=m(0),v=t(void 0),g=f(()=>o.items.value.findIndex(e=>o.selected.value.includes(e.id)));d(g,(e,t)=>{const n=o.items.value.length,a=n-1;c.value=n<=2?e<t:e===a&&0===t||(0!==e||t!==a)&&e<t}),P(dT,{transition:h,isReversed:c,transitionCount:p,transitionHeight:v,rootRef:l});const I=T(()=>e.continuous||0!==g.value),S=T(()=>e.continuous||g.value!==o.items.value.length-1);function C(){I.value&&o.prev()}function k(){S.value&&o.next()}const E=f(()=>{const t=[],n={icon:r.value?e.nextIcon:e.prevIcon,class:"v-window__"+(u.value?"right":"left"),onClick:o.prev,"aria-label":s("$vuetify.carousel.prev")};t.push(I.value?a.prev?a.prev({props:n}):y(qw,n,null):_("div",null,null));const i={icon:r.value?e.prevIcon:e.nextIcon,class:"v-window__"+(u.value?"left":"right"),onClick:o.next,"aria-label":s("$vuetify.carousel.next")};return t.push(S.value?a.next?a.next({props:i}):y(qw,i,null):_("div",null,null)),t}),x=f(()=>{if(!1===e.touch)return e.touch;return{...{left:()=>{u.value?C():k()},right:()=>{u.value?k():C()},start:e=>{let{originalEvent:t}=e;t.stopPropagation()}},...!0===e.touch?{}:e.touch}});return be(()=>A(y(e.tag,{ref:l,class:w(["v-window",{"v-window--show-arrows-on-hover":"hover"===e.showArrows,"v-window--vertical-arrows":!!e.verticalArrows},i.value,e.class]),style:b(e.style)},{default:()=>{var t,n;return[_("div",{class:"v-window__container",style:{height:v.value}},[null==(t=a.default)?void 0:t.call(a,{group:o}),!1!==e.showArrows&&_("div",{class:w(["v-window__controls",{"v-window__controls--left":"left"===e.verticalArrows||!0===e.verticalArrows},{"v-window__controls--right":"right"===e.verticalArrows}])},[E.value])]),null==(n=a.additional)?void 0:n.call(a,{group:o})]}}),[[cT,x.value]])),{group:o}}}),vT=oe({...Je(pT(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),mT=se()({name:"VTabsWindow",props:vT(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const i=a(sT,null),r=Ae(e,"modelValue"),s=f({get(){var e;return null==r.value&&i?null==(e=i.items.value.find(e=>i.selected.value.includes(e.id)))?void 0:e.value:r.value},set(e){r.value=e}});return be(()=>{const t=fT.filterProps(e);return y(fT,C({_as:"VTabsWindow"},t,{modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),n)}),{}}}),gT=oe({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},..._e(),...nw(),...cI()},"VWindowItem"),yT=se()({name:"VWindowItem",directives:{vTouch:cT},props:gT(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const i=a(dT),r=aw(e,hT),{isBooted:s}=I_();if(!i||!r)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const o=m(!1),l=f(()=>s.value&&(i.isReversed.value?!1!==e.reverseTransition:!1!==e.transition));function u(){o.value&&i&&(o.value=!1,i.transitionCount.value>0&&(i.transitionCount.value-=1,0===i.transitionCount.value&&(i.transitionHeight.value=void 0)))}function c(){var e;!o.value&&i&&(o.value=!0,0===i.transitionCount.value&&(i.transitionHeight.value=me(null==(e=i.rootRef.value)?void 0:e.clientHeight)),i.transitionCount.value+=1)}function d(){u()}function p(e){o.value&&h(()=>{l.value&&o.value&&i&&(i.transitionHeight.value=me(e.clientHeight))})}const v=f(()=>{const t=i.isReversed.value?e.reverseTransition:e.transition;return!!l.value&&{name:"string"!=typeof t?i.transition.value:t,onBeforeEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:c,onAfterLeave:u,onLeaveCancelled:d,onEnter:p}}),{hasContent:g}=dI(e,r.isSelected);return be(()=>y(Pb,{transition:v.value,disabled:!s.value},{default:()=>{var t;return[A(_("div",{class:w(["v-window-item",r.selectedClass.value,e.class]),style:b(e.style)},[g.value&&(null==(t=n.default)?void 0:t.call(n))]),[[V,r.isSelected.value]])]}})),{groupItem:r}}}),bT=oe({...gT()},"VTabsWindowItem"),wT=se()({name:"VTabsWindowItem",props:bT(),setup(e,t){let{slots:n}=t;return be(()=>{const t=yT.filterProps(e);return y(yT,C({_as:"VTabsWindowItem"},t,{class:["v-tabs-window-item",e.class],style:e.style}),n)}),{}}});const _T=oe({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...oS({mandatory:"force",selectedClass:"v-tab-item--selected"}),...zb(),...kb()},"VTabs"),IT=se()({name:"VTabs",props:_T(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:a}=t;const i=Ae(e,"modelValue"),r=f(()=>function(e){return e?e.map(e=>Ce(e)?e:{text:e,value:e}):[]}(e.items)),{densityClasses:s}=qb(e),{backgroundColorClasses:o,backgroundColorStyles:l}=_b(()=>e.bgColor),{scopeId:u}=hI();return le({VTab:{color:T(()=>e.color),direction:T(()=>e.direction),stacked:T(()=>e.stacked),fixed:T(()=>e.fixedTabs),sliderColor:T(()=>e.sliderColor),hideSlider:T(()=>e.hideSlider)}}),be(()=>{const t=lS.filterProps(e),c=!!(a.window||e.items.length>0);return _(N,null,[y(lS,C(t,{modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},s.value,o.value,e.class],style:[{"--v-tabs-height":me(e.height)},l.value,e.style],role:"tablist",symbol:sT},u,n),{default:()=>{var e;return[(null==(e=a.default)?void 0:e.call(a))??r.value.map(e=>{var t;return(null==(t=a.tab)?void 0:t.call(a,{item:e}))??y(lT,C(e,{key:e.text,value:e.value}),{default:a[`tab.${e.value}`]?()=>{var t;return null==(t=a[`tab.${e.value}`])?void 0:t.call(a,{item:e})}:void 0})})]}}),c&&y(mT,C({modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,key:"tabs-window"},u),{default:()=>{var e;return[r.value.map(e=>{var t;return(null==(t=a.item)?void 0:t.call(a,{item:e}))??y(wT,{value:e.value},{default:()=>{var t;return null==(t=a[`item.${e.value}`])?void 0:t.call(a,{item:e})}})}),null==(e=a.window)?void 0:e.call(a)]}})])}),{}}}),ST={class:"d-flex align-center w-100"},CT={class:"d-flex align-center mr-8"},kT={class:"w-100 minimal-tabs-container"},ET={key:0},xT={key:1,class:"text-center pa-16 minimal-loading"},TT={key:1,class:"text-center pa-16 minimal-welcome"},AT=mb(ie({__name:"App",setup(e){const n=eo(),a=fb(),i=vb(),r=t([{id:"view-all",name:"所持状況一覧",icon:"mdi-account-multiple"},{id:"add-owned",name:"所持キャラ追加",icon:"mdi-account-plus"},{id:"manage-items",name:"アイテム管理",icon:"mdi-sword-cross"},{id:"manage-teams",name:"編成管理",icon:"mdi-account-group"},{id:"add-master",name:"マスター追加",icon:"mdi-database-plus"},{id:"edit-master",name:"マスター編集",icon:"mdi-database-edit"}]),s=f(()=>"add-owned"===i.activeTab||"manage-items"===i.activeTab);D(()=>{n.initAuthListener()}),d(()=>n.user,e=>{e&&n.userId?async function(){if(a.dataLoaded)return;if(!n.userId)return;try{i.setLoading(!0),await a.loadInitialData(n.userId),a.accounts.length>0&&i.setSelectedAccountId(a.accounts[0].id)}catch(e){i.showError(`データ読み込みエラー: ${e.message}`)}finally{i.setLoading(!1)}}():(a.resetData(),i.resetUI())});const o=async()=>{try{await n.loginWithGoogle()}catch(e){i.showError("ログインに失敗しました")}},l=async()=>{await n.logout()};const u=async({accountId:e,newCharacter:t})=>{const n=a.ownedCharactersData.get(e)||[];n.push(t),a.updateOwnedCharactersForAccount(e,n),i.showSuccess("キャラクターを追加しました")},c=async({accountId:e,ownedCharacterId:t,characterMasterId:n,items:r,isNew:s})=>{try{if(s)await a.addOwnedCharacter(e,{characterMasterId:n,items:r}),i.showSuccess("キャラクターを追加しました");else{if(!t)throw new Error("ownedCharacterIdが必要です");await ob(e,t,r);const n=a.ownedCharactersData.get(e)||[],s=n.find(e=>e.id===t);s&&(s.items=r),a.updateOwnedCharactersForAccount(e,n),i.showSuccess("アイテムを更新しました")}}catch(o){i.showError(`アイテム更新エラー: ${o.message}`)}},h=async({accountId:e,ownedCharacterId:t})=>{try{await lb(e,t);const n=(a.ownedCharactersData.get(e)||[]).filter(e=>e.id!==t);a.updateOwnedCharactersForAccount(e,n),i.showSuccess("キャラクターを未所持に戻しました")}catch(n){i.showError(`キャラクター削除エラー: ${n.message}`)}},p=({accountId:e,from:t,to:n})=>{const i=a.ownedCharactersData.get(e)||[],r=i.find(e=>e.id===t.id),s=i.find(e=>e.id===n.id);r&&(r.items=t.items),s&&(s.items=n.items),a.updateOwnedCharactersForAccount(e,i)},v=e=>{const t=[e,...a.teams];a.setTeams(t),i.showSuccess("チームを追加しました")},m=e=>{const t=a.teams.map(t=>t.id===e.id?{...t,...e}:t);a.setTeams(t),i.showSuccess("チームを更新しました")},g=e=>{const t=a.teams.filter(t=>t.id!==e);a.setTeams(t),i.showSuccess("チームを削除しました")},b=()=>{location.reload()};return(e,t)=>(H(),W(Kx,null,{default:G(()=>[y(tT,{app:"",color:"white",elevation:"0",class:"minimal-header",height:"64"},ne({default:G(()=>[_("div",ST,[_("div",CT,[y(xb,{icon:"mdi-dragon",size:"28",class:"mr-3",color:"primary"}),y(Qx,{class:"text-h5 font-weight-medium text-primary"},{default:G(()=>t[4]||(t[4]=[K(" キャラクター管理 ",-1)])),_:1,__:[4]})]),y(VC),y(VI,{user:O(n).user,onLogin:o,onLogout:l,class:"mr-4"},null,8,["user"])])]),_:2},[O(n).isLoggedIn?{name:"extension",fn:G(()=>[_("div",kT,[y(IT,{modelValue:O(i).activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>O(i).activeTab=e),"align-with-title":"",color:"primary",class:"minimal-tabs",height:"48"},{default:G(()=>[(H(!0),q(N,null,J(r.value,e=>(H(),W(lT,{key:e.id,value:e.id,class:"minimal-tab"},{default:G(()=>[y(xb,{icon:e.icon,class:"mr-2",size:"20"},null,8,["icon"]),K(" "+B(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),key:"0"}:void 0]),1024),y(aT,null,{default:G(()=>[y(rC,{class:"pa-6 main-container"},{default:G(()=>[O(n).isLoggedIn?(H(),q("div",ET,[y(RS,{accounts:O(a).accounts,modelValue:O(i).selectedAccountId,"onUpdate:modelValue":t[1]||(t[1]=e=>O(i).selectedAccountId=e),visible:s.value,class:"mb-6 minimal-account-selector"},null,8,["accounts","modelValue","visible"]),O(a).dataLoaded?(H(),W(fT,{key:0,modelValue:O(i).activeTab,"onUpdate:modelValue":t[2]||(t[2]=e=>O(i).activeTab=e),class:"minimal-window"},{default:G(()=>[y(yT,{value:"view-all",key:"view-all"},{default:G(()=>[y(DE,{onItemsUpdated:c,onCharacterDeleted:h})]),_:1}),y(yT,{value:"add-owned",key:"add-owned"},{default:G(()=>[y(qE,{onCharacterAdded:u})]),_:1}),y(yT,{value:"manage-items",key:"manage-items"},{default:G(()=>[y(yx,{onItemsUpdated:c,onItemsMoved:p})]),_:1}),y(yT,{value:"manage-teams",key:"manage-teams"},{default:G(()=>[y(Bx,{onTeamAdded:v,onTeamUpdated:m,onTeamDeleted:g})]),_:1}),y(yT,{value:"add-master",key:"add-master"},{default:G(()=>[y(jx,{onMasterAdded:b})]),_:1}),y(yT,{value:"edit-master",key:"edit-master"},{default:G(()=>[y(Hx,{onMasterUpdated:b})]),_:1})]),_:1},8,["modelValue"])):(H(),q("div",xT,[y(dw,{indeterminate:"",color:"primary",size:"64",width:"4",class:"mb-6"}),t[5]||(t[5]=_("p",{class:"text-body-1 text-grey-darken-1"}," データを読み込んでいます... ",-1))]))])):(H(),q("div",TT,[y(xb,{icon:"mdi-dragon",size:"80",color:"primary",class:"mb-6"}),t[7]||(t[7]=_("h1",{class:"text-h4 font-weight-medium text-primary mb-4"}," キャラクター管理システム ",-1)),t[8]||(t[8]=_("p",{class:"text-body-1 text-grey-darken-1 mb-8"}," ログインして、あなたのキャラクターを管理しましょう ",-1)),y(qw,{color:"primary",size:"large",variant:"outlined",class:"px-8",onClick:o},{default:G(()=>[y(xb,{icon:"mdi-login",class:"mr-2"}),t[6]||(t[6]=K(" ログイン ",-1))]),_:1,__:[6]})]))]),_:1})]),_:1}),y(rT,{modelValue:O(i).snackbar.show,"onUpdate:modelValue":t[3]||(t[3]=e=>O(i).snackbar.show=e),color:O(i).snackbar.color,timeout:3e3},{actions:G(()=>[y(qw,{variant:"text",onClick:O(i).hideSnackbar},{default:G(()=>t[9]||(t[9]=[K(" 閉じる ",-1)])),_:1,__:[9]},8,["onClick"])]),default:G(()=>[K(B(O(i).snackbar.message)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}}),[["__scopeId","data-v-a1af8ae5"]]),NT=Qt({theme:{defaultTheme:"light",themes:{light:{colors:{primary:"#1976d2",secondary:"#424242",accent:"#42a5f5",success:"#4caf50",warning:"#ff9800",error:"#f44336",info:"#2196f3",surface:"#ffffff",background:"#fafafa","on-surface":"#212121","on-background":"#212121"}}}},defaults:{VCard:{variant:"outlined",elevation:0,rounded:"md"},VBtn:{variant:"outlined",rounded:"md",class:"text-none font-weight-medium"},VTextField:{variant:"outlined",density:"compact",rounded:"md"},VSelect:{variant:"outlined",density:"compact",rounded:"md"},VList:{density:"compact"},VListItem:{rounded:"sm"},VChip:{rounded:"md",variant:"outlined"},VAvatar:{rounded:"md"},VIcon:{size:"20"}}});const VT=new class{constructor(){this.markers=new Map,this.measures=new Map}startMarker(e){this.markers.set(e,performance.now()),performance.mark(`${e}-start`)}endMarker(e){const t=this.markers.get(e);if(t){const n=performance.now()-t;return performance.mark(`${e}-end`),performance.measure(e,`${e}-start`,`${e}-end`),this.measures.set(e,n),n}return 0}getMeasure(e){return this.measures.get(e)}getAllMeasures(){return Object.fromEntries(this.measures)}clear(){this.markers.clear(),this.measures.clear()}};VT.startMarker("app-init");const DT=re(AT),MT=function(){const a=e(!0),i=a.run(()=>t({}));let r=[],s=[];const o=n({install(e){Yt(o),o._a=e,e.provide(Jt,o),e.config.globalProperties.$pinia=o,s.forEach(e=>r.push(e)),s=[]},use(e){return this._a?r.push(e):s.push(e),this},_p:r,_a:null,_e:a,_s:new Map,state:i});return o}();DT.use(MT),DT.use(NT),((e={})=>{const{loadTime:t=3e3,memoryUsage:n=50}=e;window.addEventListener("load",()=>{performance.now()});const a=performance;a.memory&&setInterval(()=>{const e=a.memory;e&&(e.usedJSHeapSize,e.jsHeapSizeLimit)},1e4)})({loadTime:2e3,memoryUsage:60}),DT.mount("#app"),VT.endMarker("app-init");export{Zg as P,Dy as R,ib as W,Wg as _,Xg as a,Ry as b,Yy as c,Xy as d,Hs as g,Qa as i,Qg as m,Zy as p,Ly as x,Jy as y};
