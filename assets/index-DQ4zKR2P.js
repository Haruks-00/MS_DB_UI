const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/firebase-init-C9_oyObH.js","assets/vue-B_P1t2xt.js","assets/vuetify-11KXpVxS.js"])))=>i.map(i=>d[i]);
import{x as e,b as t,J as n,d as r,K as i,r as s,L as a,M as o,y as l,q as u,v as c,o as d,I as h,B as p,e as f,l as m,s as v,T as g,j as y,N as b,n as w,k as _,O as I,P as S,m as k,h as T,Q as C,z as E,t as x,R as A,F as N,S as D,H as P,U as R,D as V,p as O,u as M,w as L,V as F,W as B,c as U,A as $,X as j,E as z,Y as q,Z as G,_ as K,$ as H,a0 as W,a1 as Q,a as Y,a2 as X,a3 as J,a4 as Z,a5 as ee,a6 as te,a7 as ne,a8 as re,f as ie,a9 as se}from"./vue-B_P1t2xt.js";import{g as ae,p as oe,a as le,d as ue,i as ce,b as de,c as he,e as pe,f as fe,h as me,j as ve,u as ge,k as ye,l as be,m as we,n as _e,I as Ie,o as Se,q as ke,r as Te,S as Ce,s as Ee,t as xe,v as Ae,w as Ne,x as De,y as Pe,z as Re,A as Ve,B as Oe,C as Me,D as Le,E as Fe,F as Be,G as Ue,H as $e,J as je,K as ze,L as qe,M as Ge,N as Ke,O as He,P as We,Q as Qe,R as Ye,T as Xe,U as Je,V as Ze,W as et,X as tt,Y as nt,Z as rt,_ as it,$ as st,a0 as at,a1 as ot,a2 as lt,a3 as ut,a4 as ct,a5 as dt,a6 as ht,a7 as pt,a8 as ft,a9 as mt,aa as vt,ab as gt,ac as yt,ad as bt,ae as wt,af as _t,ag as It,ah as St,ai as kt,aj as Tt,ak as Ct,al as Et,am as xt,an as At,ao as Nt,ap as Dt,aq as Pt,ar as Rt,as as Vt,at as Ot,au as Mt,av as Lt,aw as Ft,ax as Bt,ay as Ut,az as $t,aA as jt,aB as zt,aC as qt,aD as Gt,aE as Kt,aF as Ht,aG as Wt,aH as Qt}from"./vuetify-11KXpVxS.js";
/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */
let Yt;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Xt=e=>Yt=e,Jt=Symbol();function Zt(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var en,tn;(tn=en||(en={})).direct="direct",tn.patchObject="patch object",tn.patchFunction="patch function";const nn=()=>{};function rn(e,t,n,r=nn){e.push(t);const i=()=>{const n=e.indexOf(t);n>-1&&(e.splice(n,1),r())};return!n&&u()&&c(i),i}function sn(e,...t){e.slice().forEach(e=>{e(...t)})}const an=e=>e(),on=Symbol(),ln=Symbol();function un(e,t){e instanceof Map&&t instanceof Map?t.forEach((t,n)=>e.set(n,t)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const r=t[n],i=e[n];Zt(i)&&Zt(r)&&e.hasOwnProperty(n)&&!a(r)&&!o(r)?e[n]=un(i,r):e[n]=r}return e}const cn=Symbol();function dn(e){return!Zt(e)||!e.hasOwnProperty(cn)}const{assign:hn}=Object;function pn(e){return!(!a(e)||!e.effect)}function fn(n,r,i={},u,c,p){let f;const m=hn({actions:{}},i),v={deep:!0};let g,y,b,w=[],_=[];const I=u.state.value[n];let S;function k(e){let t;g=y=!1,"function"==typeof e?(e(u.state.value[n]),t={type:en.patchFunction,storeId:n,events:b}):(un(u.state.value[n],e),t={type:en.patchObject,payload:e,storeId:n,events:b});const r=S=Symbol();h().then(()=>{S===r&&(g=!0)}),y=!0,sn(w,t,u.state.value[n])}p||I||(u.state.value[n]={}),t({});const T=p?function(){const{state:e}=i,t=e?e():{};this.$patch(e=>{hn(e,t)})}:nn;const C=(e,t="")=>{if(on in e)return e[ln]=t,e;const r=function(){Xt(u);const t=Array.from(arguments),i=[],s=[];let a;sn(_,{args:t,name:r[ln],store:x,after:function(e){i.push(e)},onError:function(e){s.push(e)}});try{a=e.apply(this&&this.$id===n?this:x,t)}catch(o){throw sn(s,o),o}return a instanceof Promise?a.then(e=>(sn(i,e),e)).catch(e=>(sn(s,e),Promise.reject(e))):(sn(i,a),a)};return r[on]=!0,r[ln]=t,r},E={_p:u,$id:n,$onAction:rn.bind(null,_),$patch:k,$reset:T,$subscribe(e,t={}){const r=rn(w,e,t.detached,()=>i()),i=f.run(()=>d(()=>u.state.value[n],r=>{("sync"===t.flush?y:g)&&e({storeId:n,type:en.direct,events:b},r)},hn({},v,t)));return r},$dispose:function(){f.stop(),w=[],_=[],u._s.delete(n)}},x=s(E);u._s.set(n,x);const A=(u._a&&u._a.runWithContext||an)(()=>u._e.run(()=>(f=e()).run(()=>r({action:C}))));for(const e in A){const t=A[e];if(a(t)&&!pn(t)||o(t))p||(I&&dn(t)&&(a(t)?t.value=I[e]:un(t,I[e])),u.state.value[n][e]=t);else if("function"==typeof t){const n=C(t,e);A[e]=n,m.actions[e]=t}}return hn(x,A),hn(l(x),A),Object.defineProperty(x,"$state",{get:()=>u.state.value[n],set:e=>{k(t=>{hn(t,e)})}}),u._p.forEach(e=>{hn(x,f.run(()=>e({store:x,app:u._a,pinia:u,options:m})))}),I&&p&&i.hydrate&&i.hydrate(x.$state,I),g=!0,y=!0,x}
/*! #__NO_SIDE_EFFECTS__ */function mn(e,t,s){let a,o;const l="function"==typeof t;function u(e,s){const u=i();(e=e||(u?r(Jt,null):null))&&Xt(e),(e=Yt)._s.has(a)||(l?fn(a,t,o,e):function(e,t,r){const{state:i,actions:s,getters:a}=t,o=r.state.value[e];let l;l=fn(e,function(){o||(r.state.value[e]=i?i():{});const t=p(r.state.value[e]);return hn(t,s,Object.keys(a||{}).reduce((t,i)=>(t[i]=n(f(()=>{Xt(r);const t=r._s.get(e);return a[i].call(t,t)})),t),{}))},t,r,0,!0)}(a,o,e));return e._s.get(a)}return"string"==typeof e?(a=e,o=l?s:t):(o=e,a=e.id),u.$id=a,u}var vn={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},yn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,a=s?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,u=t>>2,c=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,s||(d=64)),r.push(n[u],n[c],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(gn(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const o=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==a||null==o)throw new bn;const l=t<<2|s>>4;if(r.push(l),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==o){const e=a<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class bn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wn=function(e){return function(e){const t=gn(e);return yn.encodeByteArray(t,!0)}(e).replace(/\./g,"")},_n=function(e){try{return yn.decodeString(e,!0)}catch(t){}return null};function In(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&Sn(n)&&(e[n]=In(e[n],t[n]));return e}function Sn(e){return"__proto__"!==e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const kn=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Tn=()=>{try{return kn()||(()=>{if("undefined"==typeof process)return;const e=vn.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&_n(e[1]);return t&&JSON.parse(t)})()}catch(e){return}},Cn=e=>{var t,n;return null===(n=null===(t=Tn())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},En=()=>{var e;return null===(e=Tn())||void 0===e?void 0:e.config},xn=e=>{var t;return null===(t=Tn())||void 0===t?void 0:t[`_${e}`]};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class An{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Nn(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Dn(){var e;const t=null===(e=Tn())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(n){return!1}}function Pn(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function Rn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Vn(){const e=Nn();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function On(){try{return"object"==typeof indexedDB}catch(e){return!1}}class Mn extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ln.prototype.create)}}class Ln{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(Fn,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(i,n):"Error",a=`${this.serviceName}: ${s} (${r}).`;return new Mn(r,a,n)}}const Fn=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Un(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if($n(n)&&$n(s)){if(!Un(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function $n(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function zn(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function qn(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function Gn(e,t){const n=new Kn(e,t);return n.subscribe.bind(n)}class Kn{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Hn),void 0===r.error&&(r.error=Hn),void 0===r.complete&&(r.complete=Hn);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!=typeof console&&console.error}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Hn(){}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(e){return e&&e._delegate?e._delegate:e}class Qn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yn="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new An;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:Yn})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(e=Yn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=Yn){return this.instances.has(e)}getOptions(e=Yn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===Yn?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(i){}var r;return n||null}normalizeInstanceIdentifier(e=Yn){return this.component?this.component.multipleInstances?e:Yn:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Jn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Xn(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zn=[];var er,tr;(tr=er||(er={}))[tr.DEBUG=0]="DEBUG",tr[tr.VERBOSE=1]="VERBOSE",tr[tr.INFO=2]="INFO",tr[tr.WARN=3]="WARN",tr[tr.ERROR=4]="ERROR",tr[tr.SILENT=5]="SILENT";const nr={debug:er.DEBUG,verbose:er.VERBOSE,info:er.INFO,warn:er.WARN,error:er.ERROR,silent:er.SILENT},rr=er.INFO,ir={[er.DEBUG]:"log",[er.VERBOSE]:"log",[er.INFO]:"info",[er.WARN]:"warn",[er.ERROR]:"error"},sr=(e,t,...n)=>{if(t<e.logLevel)return;(new Date).toISOString();if(!ir[t])throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ar{constructor(e){this.name=e,this._logLevel=rr,this._logHandler=sr,this._userLogHandler=null,Zn.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in er))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?nr[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,er.DEBUG,...e),this._logHandler(this,er.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,er.VERBOSE,...e),this._logHandler(this,er.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,er.INFO,...e),this._logHandler(this,er.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,er.WARN,...e),this._logHandler(this,er.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,er.ERROR,...e),this._logHandler(this,er.ERROR,...e)}}let or,lr;const ur=new WeakMap,cr=new WeakMap,dr=new WeakMap,hr=new WeakMap,pr=new WeakMap;let fr={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return cr.get(e);if("objectStoreNames"===t)return e.objectStoreNames||dr.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return gr(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function mr(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(lr||(lr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(yr(this),t),gr(ur.get(this))}:function(...t){return gr(e.apply(yr(this),t))}:function(t,...n){const r=e.call(yr(this),t,...n);return dr.set(r,t.sort?t.sort():[t]),gr(r)}}function vr(e){return"function"==typeof e?mr(e):(e instanceof IDBTransaction&&function(e){if(cr.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});cr.set(e,t)}(e),t=e,(or||(or=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,fr):e);var t}function gr(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(gr(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&ur.set(t,e)}).catch(()=>{}),pr.set(t,e),t}(e);if(hr.has(e))return hr.get(e);const t=vr(e);return t!==e&&(hr.set(e,t),pr.set(t,e)),t}const yr=e=>pr.get(e);const br=["get","getKey","getAll","getAllKeys","count"],wr=["put","add","delete","clear"],_r=new Map;function Ir(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(_r.get(t))return _r.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=wr.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!br.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let a=s.store;return r&&(a=a.index(t.shift())),(await Promise.all([a[n](...t),i&&s.done]))[0]};return _r.set(t,s),s}fr=(e=>({...e,get:(t,n,r)=>Ir(t,n)||e.get(t,n,r),has:(t,n)=>!!Ir(t,n)||e.has(t,n)}))(fr);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Sr{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const kr="@firebase/app",Tr="0.9.13",Cr=new ar("@firebase/app"),Er="@firebase/app-compat",xr="@firebase/analytics-compat",Ar="@firebase/analytics",Nr="@firebase/app-check-compat",Dr="@firebase/app-check",Pr="@firebase/auth",Rr="@firebase/auth-compat",Vr="@firebase/database",Or="@firebase/database-compat",Mr="@firebase/functions",Lr="@firebase/functions-compat",Fr="@firebase/installations",Br="@firebase/installations-compat",Ur="@firebase/messaging",$r="@firebase/messaging-compat",jr="@firebase/performance",zr="@firebase/performance-compat",qr="@firebase/remote-config",Gr="@firebase/remote-config-compat",Kr="@firebase/storage",Hr="@firebase/storage-compat",Wr="@firebase/firestore",Qr="@firebase/firestore-compat",Yr="firebase",Xr="[DEFAULT]",Jr={[kr]:"fire-core",[Er]:"fire-core-compat",[Ar]:"fire-analytics",[xr]:"fire-analytics-compat",[Dr]:"fire-app-check",[Nr]:"fire-app-check-compat",[Pr]:"fire-auth",[Rr]:"fire-auth-compat",[Vr]:"fire-rtdb",[Or]:"fire-rtdb-compat",[Mr]:"fire-fn",[Lr]:"fire-fn-compat",[Fr]:"fire-iid",[Br]:"fire-iid-compat",[Ur]:"fire-fcm",[$r]:"fire-fcm-compat",[jr]:"fire-perf",[zr]:"fire-perf-compat",[qr]:"fire-rc",[Gr]:"fire-rc-compat",[Kr]:"fire-gcs",[Hr]:"fire-gcs-compat",[Wr]:"fire-fst",[Qr]:"fire-fst-compat","fire-js":"fire-js",[Yr]:"fire-js-all"},Zr=new Map,ei=new Map;function ti(e,t){try{e.container.addComponent(t)}catch(n){Cr.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ni(e,t){e.container.addOrOverwriteComponent(t)}function ri(e){const t=e.name;if(ei.has(t))return Cr.debug(`There were multiple attempts to register component ${t}.`),!1;ei.set(t,e);for(const n of Zr.values())ti(n,e);return!0}function ii(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const si=new Ln("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let ai=class{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Qn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw si.create("app-deleted",{appName:this._name})}};
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi="9.23.0";function li(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const r=Object.assign({name:Xr,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw si.create("bad-app-name",{appName:String(i)});if(n||(n=En()),!n)throw si.create("no-options");const s=Zr.get(i);if(s){if(Un(n,s.options)&&Un(r,s.config))return s;throw si.create("duplicate-app",{appName:i})}const a=new Jn(i);for(const l of ei.values())a.addComponent(l);const o=new ai(n,r,a);return Zr.set(i,o),o}function ui(e=Xr){const t=Zr.get(e);if(!t&&e===Xr&&En())return li();if(!t)throw si.create("no-app",{appName:e});return t}async function ci(e){const t=e.name;Zr.has(t)&&(Zr.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function di(e,t,n){var r;let i=null!==(r=Jr[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void Cr.warn(e.join(" "))}ri(new Qn(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}function hi(e,t){if(null!==e&&"function"!=typeof e)throw si.create("invalid-log-argument");!function(e,t){for(const n of Zn){let r=null;t&&t.level&&(r=nr[t.level]),n.userLogHandler=null===e?null:(t,n,...i)=>{const s=i.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}}).filter(e=>e).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:er[n].toLowerCase(),message:s,args:i,type:t.name})}}}(e,t)}function pi(e){var t;t=e,Zn.forEach(e=>{e.setLogLevel(t)})}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi="firebase-heartbeat-store";let mi=null;function vi(){return mi||(mi=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const a=indexedDB.open(e,t),o=gr(a);return r&&a.addEventListener("upgradeneeded",e=>{r(gr(a.result),e.oldVersion,e.newVersion,gr(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(fi)}}).catch(e=>{throw si.create("idb-open",{originalErrorMessage:e.message})})),mi}async function gi(e,t){try{const n=(await vi()).transaction(fi,"readwrite"),r=n.objectStore(fi);await r.put(t,yi(e)),await n.done}catch(n){if(n instanceof Mn)Cr.warn(n.message);else{const e=si.create("idb-set",{originalErrorMessage:null==n?void 0:n.message});Cr.warn(e.message)}}}function yi(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new _i(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=wi();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some(e=>e.date===t))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=wi(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Ii(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ii(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=wn(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function wi(){return(new Date).toISOString().substring(0,10)}class _i{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!On()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{const t=await vi();return await t.transaction(fi).objectStore(fi).get(yi(e))}catch(t){if(t instanceof Mn)Cr.warn(t.message);else{const e=si.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});Cr.warn(e.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return gi(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return gi(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ii(e){return wn(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Si;Si="",ri(new Qn("platform-logger",e=>new Sr(e),"PRIVATE")),ri(new Qn("heartbeat",e=>new bi(e),"PRIVATE")),di(kr,Tr,Si),di(kr,Tr,"esm2017"),di("fire-js","");const ki=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Mn,SDK_VERSION:oi,_DEFAULT_ENTRY_NAME:Xr,_addComponent:ti,_addOrOverwriteComponent:ni,_apps:Zr,_clearComponents:function(){ei.clear()},_components:ei,_getProvider:ii,_registerComponent:ri,_removeServiceInstance:function(e,t,n=Xr){ii(e,t).clearInstance(n)},deleteApp:ci,getApp:ui,getApps:function(){return Array.from(Zr.values())},initializeApp:li,onLog:hi,registerVersion:di,setLogLevel:pi},Symbol.toStringTag,{value:"Module"}));
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,t){this._delegate=e,this.firebase=t,ti(e,new Qn("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),ci(this._delegate)))}_getService(e,t=Xr){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=Xr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){ti(this._delegate,e)}_addOrOverwriteComponent(e){ni(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci=new Ln("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});const Ei=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function e(){const t=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){const t={},n={__esModule:!0,initializeApp:function(r,i={}){const s=li(r,i);if(Bn(t,s.name))return t[s.name];const a=new e(s,n);return t[s.name]=a,a},app:r,registerVersion:di,setLogLevel:pi,onLog:hi,apps:null,SDK_VERSION:oi,INTERNAL:{registerComponent:function(t){const i=t.name,s=i.replace("-compat","");if(ri(t)&&"PUBLIC"===t.type){const a=(e=r())=>{if("function"!=typeof e[s])throw Ci.create("invalid-app-argument",{appName:i});return e[s]()};void 0!==t.serviceProps&&In(a,t.serviceProps),n[s]=a,e.prototype[s]=function(...e){return this._getService.bind(this,i).apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[s]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:ki}};function r(e){if(!Bn(t,e=e||Xr))throw Ci.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map(e=>t[e])}}),r.App=e,n}(Ti);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){In(t,e)},createSubscribe:Gn,ErrorFactory:Ln,deepExtend:In}),t}(),xi=new ar("@firebase/app-compat");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){xi.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&xi.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Ai=Ei;!
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){di("@firebase/app-compat","0.2.13",e)}();function Ni(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Ai.registerVersion("firebase","9.23.0","app-compat"),"function"==typeof SuppressedError&&SuppressedError;const Di="facebook.com",Pi="github.com",Ri="google.com",Vi="password",Oi="twitter.com",Mi="EMAIL_SIGNIN",Li="PASSWORD_RESET",Fi="RECOVER_EMAIL",Bi="REVERT_SECOND_FACTOR_ADDITION",Ui="VERIFY_AND_CHANGE_EMAIL",$i="VERIFY_EMAIL";function ji(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const zi=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},qi=ji,Gi=new Ln("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ki=new ar("@firebase/auth");function Hi(e,...t){Ki.logLevel<=er.ERROR&&Ki.error(`Auth (${oi}): ${e}`,...t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(e,...t){throw Ji(e,...t)}function Qi(e,...t){return Ji(e,...t)}function Yi(e,t,n){const r=Object.assign(Object.assign({},qi()),{[t]:n});return new Ln("auth","Firebase",r).create(t,{appName:e.name})}function Xi(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Wi(e,"argument-error"),Yi(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ji(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Gi.create(e,...t)}function Zi(e,t,...n){if(!e)throw Ji(t,...n)}function es(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Hi(t),new Error(t)}function ts(e,t){e||es(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function rs(){return"http:"===is()||"https:"===is()}function is(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ss{constructor(e,t){this.shortDelay=e,this.longDelay=t,ts(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nn())||Rn()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(rs()||Pn()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function as(e,t){ts(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void es("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void es("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void es("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},us=new ss(3e4,6e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function ds(e,t,n,r,i={}){return hs(e,i,async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const a=jn(Object.assign({key:e.config.apiKey},s)).slice(1),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode),os.fetch()(fs(e,e.config.apiHost,n,a),Object.assign({method:t,headers:o,referrerPolicy:"no-referrer"},i))})}async function hs(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},ls),t);try{const t=new ms(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw vs(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw vs(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw vs(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw vs(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw Yi(e,o,a);Wi(e,o)}}catch(i){if(i instanceof Mn)throw i;Wi(e,"network-request-failed",{message:String(i)})}}async function ps(e,t,n,r,i={}){const s=await ds(e,t,n,r,i);return"mfaPendingCredential"in s&&Wi(e,"multi-factor-auth-required",{_serverResponse:s}),s}function fs(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?as(e.config,i):`${e.config.apiScheme}://${i}`}class ms{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Qi(this.auth,"network-request-failed")),us.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function vs(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Qi(e,t,r);return i.customData._tokenResponse=n,i}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function gs(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function ys(e){return 1e3*Number(e)}function bs(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Hi("JWT malformed, contained fewer than 3 sections"),null;try{const e=_n(n);return e?JSON.parse(e):(Hi("Failed to decode base64 JWT payload"),null)}catch(i){return Hi("Caught error parsing JWT payload as JSON",null==i?void 0:i.toString()),null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function ws(e,t,n=!1){if(n)return t;try{return await t}catch(r){throw r instanceof Mn&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}class _s{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=gs(this.lastLoginAt),this.creationTime=gs(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ss(e){var t;const n=e.auth,r=await e.getIdToken(),i=await ws(e,async function(e,t){return ds(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));Zi(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map(e=>{var{providerId:t}=e,n=Ni(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[];const o=(l=e.providerData,u=a,[...l.filter(e=>!u.some(t=>t.providerId===e.providerId)),...u]);var l,u;const c=e.isAnonymous,d=!(e.email&&s.passwordHash||(null==o?void 0:o.length)),h=!!c&&d,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Is(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,p)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ks{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Zi(e.idToken,"internal-error"),Zi(void 0!==e.idToken,"internal-error"),Zi(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=bs(e);return Zi(t,"internal-error"),Zi(void 0!==t.exp,"internal-error"),Zi(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Zi(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */await async function(e,t){const n=await hs(e,{},async()=>{const n=jn({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=fs(e,r,"/v1/token",`key=${i}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",os.fetch()(s,{method:"POST",headers:a,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new ks;return n&&(Zi("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Zi("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Zi("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ks,this.toJSON())}_performRefresh(){return es("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(e,t){Zi("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Cs{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Ni(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _s(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Is(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ws(this,this.stsTokenManager.getToken(this.auth,e));return Zi(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Wn(e),r=await n.getIdToken(t),i=bs(r);Zi(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,a=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:gs(ys(i.auth_time)),issuedAtTime:gs(ys(i.iat)),expirationTime:gs(ys(i.exp)),signInProvider:a||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Wn(e);await Ss(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Zi(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Cs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Zi(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Ss(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await ws(this,async function(e,t){return ds(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,a,o,l,u;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,f=null!==(a=t.tenantId)&&void 0!==a?a:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,v=null!==(l=t.createdAt)&&void 0!==l?l:void 0,g=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:_,stsTokenManager:I}=t;Zi(y&&I,e,"internal-error");const S=ks.fromJSON(this.name,I);Zi("string"==typeof y,e,"internal-error"),Ts(c,e.name),Ts(d,e.name),Zi("boolean"==typeof b,e,"internal-error"),Zi("boolean"==typeof w,e,"internal-error"),Ts(h,e.name),Ts(p,e.name),Ts(f,e.name),Ts(m,e.name),Ts(v,e.name),Ts(g,e.name);const k=new Cs({uid:y,auth:e,email:d,emailVerified:b,displayName:c,isAnonymous:w,photoURL:p,phoneNumber:h,tenantId:f,stsTokenManager:S,createdAt:v,lastLoginAt:g});return _&&Array.isArray(_)&&(k.providerData=_.map(e=>Object.assign({},e))),m&&(k._redirectEventId=m),k}static async _fromIdTokenResponse(e,t,n=!1){const r=new ks;r.updateFromServerResponse(t);const i=new Cs({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Ss(i),i}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Es=new Map;function xs(e){ts(e instanceof Function,"Expected a class definition");let t=Es.get(e);return t?(ts(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Es.set(e,t),t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}As.type="NONE";const Ns=As;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(e,t,n){return`firebase:${e}:${t}:${n}`}class Ps{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Ds(this.userKey,r.apiKey,i),this.fullPersistenceKey=Ds("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Cs._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ps(xs(Ns),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||xs(Ns);const s=Ds(n,e.config.apiKey,e.name);let a=null;for(const u of t)try{const t=await u._get(s);if(t){const n=Cs._fromJSON(e,t);u!==i&&(a=n),i=u;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length?(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(l){}})),new Ps(i,e,n)):new Ps(i,e,n)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ls(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Vs(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Bs(t))return"Blackberry";if(Us(t))return"Webos";if(Os(t))return"Safari";if((t.includes("chrome/")||Ms(t))&&!t.includes("edge/"))return"Chrome";if(Fs(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Vs(e=Nn()){return/firefox\//i.test(e)}function Os(e=Nn()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Ms(e=Nn()){return/crios\//i.test(e)}function Ls(e=Nn()){return/iemobile/i.test(e)}function Fs(e=Nn()){return/android/i.test(e)}function Bs(e=Nn()){return/blackberry/i.test(e)}function Us(e=Nn()){return/webos/i.test(e)}function $s(e=Nn()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function js(e=Nn()){return $s(e)||Fs(e)||Us(e)||Bs(e)||/windows phone/i.test(e)||Ls(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function zs(e,t=[]){let n;switch(e){case"Browser":n=Rs(Nn());break;case"Worker":n=`${Rs(Nn())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${oi}/${r}`}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qs(e,t){return ds(e,"GET","/v2/recaptchaConfig",cs(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(e){return void 0!==e&&void 0!==e.getResponse}function Ks(e){return void 0!==e&&void 0!==e.enterprise}class Hs{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ws(e){return new Promise((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Qi("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)})}function Qs(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Ys{constructor(e){this.type="recaptcha-enterprise",this.auth=ea(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;Ks(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{qs(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Hs(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Ks(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));Ws("https://www.google.com/recaptcha/enterprise.js?render="+i).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Xs(e,t,n,r=!1){const i=new Ys(e);let s;try{s=await i.verify(n)}catch(o){s=await i.verify(n,!0)}const a=Object.assign({},t);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==n?void 0:n.message})}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ta(this),this.idTokenSubscription=new ta(this),this.beforeStateQueue=new Js(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Gi,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=xs(t)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Ps.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==s||!(null==a?void 0:a.user)||(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Zi(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ss(e)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Wn(e):null;return t&&Zi(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Zi(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(xs(e))})}async initializeRecaptchaConfig(){const e=await qs(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new Hs(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new Ys(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Ln("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&xs(e)||this._popupRedirectResolver;Zi(t,this,"argument-error"),this.redirectPersistenceManager=await Ps.create(this,[xs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Zi(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Zi(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=zs(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Ki.logLevel<=er.WARN&&Ki.warn(`Auth (${oi}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function ea(e){return Wn(e)}class ta{constructor(e){this.auth=e,this.observer=null,this.addObserver=Gn(e=>this.observer=e)}get next(){return Zi(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(e,t,n){const r=ea(e);Zi(r._canInitEmulator,r,"emulator-config-failed"),Zi(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=ra(t),{host:a,port:o}=function(e){const t=ra(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:ia(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:ia(t)}}}(t),l=null===o?"":`:${o}`;r.config.emulator={url:`${s}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&console.info;"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function ra(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ia(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class sa{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return es("not implemented")}_getIdTokenResponse(e){return es("not implemented")}_linkToIdToken(e,t){return es("not implemented")}_getReauthenticationResolver(e){return es("not implemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aa(e,t){return ds(e,"POST","/v1/accounts:resetPassword",cs(e,t))}async function oa(e,t){return ds(e,"POST","/v1/accounts:update",t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function la(e,t){return ps(e,"POST","/v1/accounts:signInWithPassword",cs(e,t))}async function ua(e,t){return ds(e,"POST","/v1/accounts:sendOobCode",cs(e,t))}async function ca(e,t){return ua(e,t)}async function da(e,t){return ua(e,t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ha extends sa{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ha(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new ha(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await Xs(e,n,"signInWithPassword");return la(e,t)}return la(e,n).catch(async t=>{if("auth/missing-recaptcha-token"===t.code){const t=await Xs(e,n,"signInWithPassword");return la(e,t)}return Promise.reject(t)});case"emailLink":
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return async function(e,t){return ps(e,"POST","/v1/accounts:signInWithEmailLink",cs(e,t))}(e,{email:this._email,oobCode:this._password});default:Wi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return oa(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return ps(e,"POST","/v1/accounts:signInWithEmailLink",cs(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Wi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pa(e,t){return ps(e,"POST","/v1/accounts:signInWithIdp",cs(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa extends sa{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new fa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Wi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Ni(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new fa(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return pa(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,pa(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,pa(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=jn(t)}return e}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma={USER_NOT_FOUND:"user-not-found"};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class va extends sa{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new va({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new va({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return ps(e,"POST","/v1/accounts:signInWithPhoneNumber",cs(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await ps(e,"POST","/v1/accounts:signInWithPhoneNumber",cs(e,t));if(n.temporaryProof)throw vs(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return ps(e,"POST","/v1/accounts:signInWithPhoneNumber",cs(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),ma)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new va({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e){var t,n,r,i,s,a;const o=zn(qn(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,u=null!==(n=o.oobCode)&&void 0!==n?n:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);Zi(l&&u&&c,"argument-error"),this.apiKey=l,this.operation=c,this.code=u,this.continueUrl=null!==(i=o.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=o.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=o.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=zn(qn(e)).link,n=t?zn(qn(t)).deep_link_id:null,r=zn(qn(e)).deep_link_id;return(r?zn(qn(r)).link:null)||r||n||t||e}(e);try{return new ga(t)}catch(n){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(){this.providerId=ya.PROVIDER_ID}static credential(e,t){return ha._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ga.parseLink(t);return Zi(n,"argument-error"),ha._fromEmailAndCode(e,n.code,n.tenantId)}}ya.PROVIDER_ID="password",ya.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ya.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ba{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends ba{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class _a extends wa{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return Zi("providerId"in t&&"signInMethod"in t,"argument-error"),fa._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Zi(e.idToken||e.accessToken,"argument-error"),fa._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return _a.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return _a.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:a}=e;if(!(n||r||t||i))return null;if(!a)return null;try{return new _a(a)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:i})}catch(o){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia extends wa{constructor(){super("facebook.com")}static credential(e){return fa._fromParams({providerId:Ia.PROVIDER_ID,signInMethod:Ia.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ia.credentialFromTaggedObject(e)}static credentialFromError(e){return Ia.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Ia.credential(e.oauthAccessToken)}catch(t){return null}}}Ia.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ia.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Sa extends wa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fa._fromParams({providerId:Sa.PROVIDER_ID,signInMethod:Sa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Sa.credentialFromTaggedObject(e)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Sa.credential(t,n)}catch(r){return null}}}Sa.GOOGLE_SIGN_IN_METHOD="google.com",Sa.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ka extends wa{constructor(){super("github.com")}static credential(e){return fa._fromParams({providerId:ka.PROVIDER_ID,signInMethod:ka.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ka.credentialFromTaggedObject(e)}static credentialFromError(e){return ka.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return ka.credential(e.oauthAccessToken)}catch(t){return null}}}ka.GITHUB_SIGN_IN_METHOD="github.com",ka.PROVIDER_ID="github.com";class Ta extends sa{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return pa(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,pa(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,pa(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new Ta(n,i):null}static _create(e,t){return new Ta(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca extends ba{constructor(e){Zi(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return Ca.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Ca.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=Ta.fromJSON(e);return Zi(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return Ta._create(n,t)}catch(r){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea extends wa{constructor(){super("twitter.com")}static credential(e,t){return fa._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ea.credential(t,n)}catch(r){return null}}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function xa(e,t){return ps(e,"POST","/v1/accounts:signUp",cs(e,t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ea.TWITTER_SIGN_IN_METHOD="twitter.com",Ea.PROVIDER_ID="twitter.com";class Aa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Cs._fromIdTokenResponse(e,n,r),s=Na(n);return new Aa({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Na(n);return new Aa({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Na(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Da extends Mn{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Da.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Da(e,t,n,r)}}function Pa(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw Da._fromErrorAndOperation(e,n,t,r);throw n})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Va(e,t){const n=Wn(e);await Ma(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return ds(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=Ra(r||[]);return n.providerData=n.providerData.filter(e=>i.has(e.providerId)),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function Oa(e,t,n=!1){const r=await ws(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Aa._forOperation(e,"link",r)}async function Ma(e,t,n){await Ss(t);const r=!1===e?"provider-already-linked":"no-such-provider";Zi(Ra(t.providerData).has(n)===e,t.auth,r)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function La(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await ws(e,Pa(r,i,t,e),n);Zi(s.idToken,r,"internal-error");const a=bs(s.idToken);Zi(a,r,"internal-error");const{sub:o}=a;return Zi(e.uid===o,r,"user-mismatch"),Aa._forOperation(e,i,s)}catch(s){throw"auth/user-not-found"===(null==s?void 0:s.code)&&Wi(r,"user-mismatch"),s}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fa(e,t,n=!1){const r="signIn",i=await Pa(e,r,t),s=await Aa._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function Ba(e,t){return Fa(ea(e),t)}async function Ua(e,t){const n=Wn(e);return await Ma(!1,n,t.providerId),Oa(n,t)}async function $a(e,t){return La(Wn(e),t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function ja(e,t){const n=ea(e),r=await async function(e,t){return ps(e,"POST","/v1/accounts:signInWithCustomToken",cs(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Aa._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?qa._fromServerResponse(e,t):"totpInfo"in t?Ga._fromServerResponse(e,t):Wi(e,"internal-error")}}class qa extends za{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new qa(t)}}class Ga extends za{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Ga(t)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ka(e,t,n){var r;Zi((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Zi(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Zi(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Zi(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ha(e,t){await async function(e,t){return ds(e,"POST","/v1/accounts:update",cs(e,t))}(Wn(e),{oobCode:t})}async function Wa(e,t){const n=Wn(e),r=await aa(n,{oobCode:t}),i=r.requestType;switch(Zi(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Zi(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Zi(r.mfaInfo,n,"internal-error");default:Zi(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=za._fromServerResponse(ea(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Qa(e,t){const n={identifier:t,continueUri:rs()?ns():"http://localhost"},{signinMethods:r}=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */await async function(e,t){return ds(e,"POST","/v1/accounts:createAuthUri",cs(e,t))}(Wn(e),n);return r||[]}async function Ya(e,t){const n=Wn(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Ka(n.auth,r,t);const{email:i}=await async function(e,t){return ua(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function Xa(e,t,n){const r=Wn(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Ka(r.auth,i,n);const{email:s}=await async function(e,t){return ua(e,t)}(r.auth,i);s!==e.email&&await e.reload()}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
async function Ja(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const r=Wn(e),i={idToken:await r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},s=await ws(r,async function(e,t){return ds(e,"POST","/v1/accounts:update",t)}(r.auth,i));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const a=r.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}async function Za(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await ws(e,oa(r,i));await e._updateTokensIfNecessary(s,!0)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class to extends eo{constructor(e,t,n,r){super(e,t,n),this.username=r}}class no extends eo{constructor(e,t){super(e,"facebook.com",t)}}class ro extends to{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class io extends eo{constructor(e,t){super(e,"google.com",t)}}class so extends to{constructor(e,t,n){super(e,"twitter.com",t,n)}}function ao(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){const r=null===(n=null===(t=bs(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new eo(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new no(s,i);case"github.com":return new ro(s,i);case"google.com":return new io(s,i);case"twitter.com":return new so(s,i,e.screenName||null);case"custom":case"anonymous":return new eo(s,null);default:return new eo(s,r,i)}}(n)}class oo{constructor(e,t,n){this.type=e,this.credential=t,this.auth=n}static _fromIdtoken(e,t){return new oo("enroll",e,t)}static _fromMfaPendingCredential(e){return new oo("signin",e)}toJSON(){const e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[e]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return oo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return oo._fromIdtoken(e.multiFactorSession.idToken)}return null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=ea(e),r=t.customData._serverResponse,i=(r.mfaInfo||[]).map(e=>za._fromServerResponse(n,e));Zi(r.mfaPendingCredential,n,"internal-error");const s=oo._fromMfaPendingCredential(r.mfaPendingCredential);return new lo(s,i,async e=>{const i=await e._process(n,s);delete r.mfaInfo,delete r.mfaPendingCredential;const a=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":const e=await Aa._fromIdTokenResponse(n,t.operationType,a);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return Zi(t.user,n,"internal-error"),Aa._forOperation(t.user,t.operationType,a);default:Wi(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class uo{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>za._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new uo(e)}async getSession(){return oo._fromIdtoken(await this.user.getIdToken(),this.user.auth)}async enroll(e,t){const n=e,r=await this.getSession(),i=await ws(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await ws(this.user,(r=this.user.auth,i={idToken:n,mfaEnrollmentId:t},ds(r,"POST","/v2/accounts/mfaEnrollment:withdraw",cs(r,i))));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(s){throw s}var r,i}}const co=new WeakMap;const ho="__sak";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ho,"1"),this.storage.removeItem(ho),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends po{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Nn();return Os(e)||$s(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=js(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Vn()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}fo.type="LOCAL";const mo=fo;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo extends po{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}vo.type="SESSION";const go=vo;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class yo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new yo(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(s).map(async e=>e(t.origin,i)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function bo(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yo.receivers=[];class wo{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((a,o)=>{const l=bo("",20);r.port1.start();const u=setTimeout(()=>{o(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(t.data.response);break;default:clearTimeout(u),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _o(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Io(){return void 0!==_o().WorkerGlobalScope&&"function"==typeof _o().importScripts}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const So="firebaseLocalStorageDb",ko="firebaseLocalStorage",To="fbase_key";class Co{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Eo(e,t){return e.transaction([ko],t?"readwrite":"readonly").objectStore(ko)}function xo(){const e=indexedDB.open(So,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(ko,{keyPath:To})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(ko)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(So);return new Co(e).toPromise()}(),t(await xo()))})})}async function Ao(e,t,n){const r=Eo(e,!0).put({[To]:t,value:n});return new Co(r).toPromise()}function No(e,t){const n=Eo(e,!0).delete(t);return new Co(n).toPromise()}class Do{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await xo()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Io()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yo._getInstance(Io()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new wo(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xo();return await Ao(e,ho,"1"),await No(e,ho),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ao(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Eo(e,!1).get(t),r=await new Co(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>No(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Eo(e,!1).getAll();return new Co(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Do.type="LOCAL";const Po=Do;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Ro=1e12;class Vo{constructor(e){this.auth=e,this.counter=Ro,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new Oo(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||Ro;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||Ro;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||Ro;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class Oo{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;Zi(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Mo=Qs("rcb"),Lo=new ss(3e4,6e4);class Fo{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=_o().grecaptcha)||void 0===e?void 0:e.render)}load(e,t=""){return Zi(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&Gs(_o().grecaptcha)?Promise.resolve(_o().grecaptcha):new Promise((n,r)=>{const i=_o().setTimeout(()=>{r(Qi(e,"network-request-failed"))},Lo.get());_o()[Mo]=()=>{_o().clearTimeout(i),delete _o()[Mo];const s=_o().grecaptcha;if(!s||!Gs(s))return void r(Qi(e,"internal-error"));const a=s.render;s.render=(e,t)=>{const n=a(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};Ws(`https://www.google.com/recaptcha/api.js??${jn({onload:Mo,render:"explicit",hl:t})}`).catch(()=>{clearTimeout(i),r(Qi(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=_o().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Bo{async load(e){return new Vo(e)}clearedOneInstance(){}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo="recaptcha",$o={theme:"light",type:"image"};let jo=class{constructor(e,t=Object.assign({},$o),n){this.parameters=t,this.type=Uo,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=ea(n),this.isInvisible="invisible"===this.parameters.size,Zi("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof e?document.getElementById(e):e;Zi(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Bo:new Fo,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){Zi(!this.parameters.sitekey,this.auth,"argument-error"),Zi(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Zi("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof e)e(t);else if("string"==typeof e){const n=_o()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){Zi(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Zi(rs()&&!Io(),this.auth,"internal-error"),await function(){let e=null;return new Promise(t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await ds(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);Zi(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Zi(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};class zo{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=va._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function qo(e,t,n){var r;const i=await n.verify();try{let s;if(Zi("string"==typeof i,e,"argument-error"),Zi(n.type===Uo,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Zi("enroll"===t.type,e,"internal-error");const n=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */await function(e,t){return ds(e,"POST","/v2/accounts/mfaEnrollment:start",cs(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Zi("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Zi(n,e,"missing-multi-factor-info");const a=await function(e,t){return ds(e,"POST","/v2/accounts/mfaSignIn:start",cs(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return a.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return ds(e,"POST","/v1/accounts:sendVerificationCode",cs(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Go=class e{constructor(t){this.providerId=e.PROVIDER_ID,this.auth=ea(t)}verifyPhoneNumber(e,t){return qo(this.auth,e,Wn(t))}static credential(e,t){return va._fromVerification(e,t)}static credentialFromResult(t){const n=t;return e.credentialFromTaggedObject(n)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?va._fromTokenResponse(t,n):null}};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ko(e,t){return t?xs(t):(Zi(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Go.PROVIDER_ID="phone",Go.PHONE_SIGN_IN_METHOD="phone";class Ho extends sa{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pa(e,this._buildIdpRequest())}_linkToIdToken(e,t){return pa(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return pa(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Wo(e){return Fa(e.auth,new Ho(e),e.bypassAuthState)}function Qo(e){const{auth:t,user:n}=e;return Zi(n,t,"internal-error"),La(n,new Ho(e),e.bypassAuthState)}async function Yo(e){const{auth:t,user:n}=e;return Zi(n,t,"internal-error"),Oa(n,new Ho(e),e.bypassAuthState)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Wo;case"linkViaPopup":case"linkViaRedirect":return Yo;case"reauthViaPopup":case"reauthViaRedirect":return Qo;default:Wi(this.auth,"internal-error")}}resolve(e){ts(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ts(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo=new ss(2e3,1e4);class Zo extends Xo{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Zo.currentPopupAction&&Zo.currentPopupAction.cancel(),Zo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Zi(e,this.auth,"internal-error"),e}async onExecution(){ts(1===this.filter.length,"Popup operations only handle one event");const e=bo();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Qi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Qi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qi(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Jo.get())};e()}}Zo.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const el=new Map;class tl extends Xo{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=el.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=sl(t),r=il(e);if(!(await r._isAvailable()))return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}el.set(this.auth._key(),e)}return this.bypassAuthState||el.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function nl(e,t){return il(e)._set(sl(t),"true")}function rl(e,t){el.set(e._key(),t)}function il(e){return xs(e._redirectPersistence)}function sl(e){return Ds("pendingRedirect",e.config.apiKey,e.name)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(e,t,n){return async function(e,t,n){const r=ea(e);Xi(e,t,ba),await r._initializationPromise;const i=Ko(r,n);return await nl(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function ol(e,t,n){return async function(e,t,n){const r=Wn(e);Xi(r.auth,t,ba),await r.auth._initializationPromise;const i=Ko(r.auth,n);await nl(i,r.auth);const s=await cl(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function ll(e,t,n){return async function(e,t,n){const r=Wn(e);Xi(r.auth,t,ba),await r.auth._initializationPromise;const i=Ko(r.auth,n);await Ma(!1,r,t.providerId),await nl(i,r.auth);const s=await cl(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function ul(e,t,n=!1){const r=ea(e),i=Ko(r,t),s=new tl(r,i,n),a=await s.execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}async function cl(e){const t=bo(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pl(e);default:return!1}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!pl(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Qi(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(hl(e))}saveEventToCache(e){this.cachedEventUids.add(hl(e)),this.lastProcessedEventTime=Date.now()}}function hl(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function pl({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}async function fl(e,t={}){return ds(e,"GET","/v1/projects",t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vl=/^https?/;function gl(e){const t=ns(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!vl.test(n))return!1;if(ml.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yl=new ss(3e4,6e4);function bl(){const e=_o().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}let wl=null;function _l(e){return wl=wl||function(e){return new Promise((t,n)=>{var r,i,s;function a(){bl(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{bl(),n(Qi(e,"network-request-failed"))},timeout:yl.get()})}if(null===(i=null===(r=_o().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=_o().gapi)||void 0===s?void 0:s.load)){const t=Qs("iframefcb");return _o()[t]=()=>{gapi.load?a():n(Qi(e,"network-request-failed"))},Ws(`https://apis.google.com/js/api.js?onload=${t}`).catch(e=>n(e))}a()}}).catch(e=>{throw wl=null,e})}(e),wl}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=new ss(5e3,15e3),Sl={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kl=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Tl(e){const t=e.config;Zi(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?as(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:oi},i=kl.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${jn(r).slice(1)}`}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Cl={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class El{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function xl(e,t,n,r=500,i=600){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},Cl),{width:r.toString(),height:i.toString(),top:s,left:a}),u=Nn().toLowerCase();n&&(o=Ms(u)?"_blank":n),Vs(u)&&(t=t||"http://localhost",l.scrollbars="yes");const c=Object.entries(l).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=Nn()){var t;return $s(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(u)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t||"",o),new El(null);const d=window.open(t||"",o,c);Zi(d,e,"popup-blocked");try{d.focus()}catch(h){}return new El(d)}const Al="__/auth/handler",Nl="emulator/auth/handler",Dl=encodeURIComponent("fac");async function Pl(e,t,n,r,i,s){Zi(e.config.authDomain,e,"auth-domain-config-required"),Zi(e.config.apiKey,e,"invalid-api-key");const a={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:oi,eventId:i};if(t instanceof ba){t.setDefaultLanguage(e.languageCode),a.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(a.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))a[e]=t}if(t instanceof wa){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(a.scopes=e.join(","))}e.tenantId&&(a.tid=e.tenantId);const o=a;for(const c of Object.keys(o))void 0===o[c]&&delete o[c];const l=await e._getAppCheckToken(),u=l?`#${Dl}=${encodeURIComponent(l)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${Al}`;return as(e,Nl)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e)}?${jn(o).slice(1)}${u}`}const Rl="webStorageSupport";const Vl=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=go,this._completeRedirectFn=ul,this._overrideRedirectResult=rl}async _openPopup(e,t,n,r){var i;ts(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return xl(e,await Pl(e,t,n,ns(),r),bo())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){_o().location.href=e}(await Pl(e,t,n,ns(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(ts(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await async function(e){const t=await _l(e),n=_o().gapi;return Zi(n,e,"internal-error"),t.open({where:document.body,url:Tl(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Sl,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Qi(e,"network-request-failed"),s=_o().setTimeout(()=>{r(i)},Il.get());function a(){_o().clearTimeout(s),n(t)}t.ping(a).then(a,()=>{r(i)})}))}(e),n=new dl(e);return t.register("authEvent",t=>{Zi(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rl,{type:Rl},n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[Rl];void 0!==i&&t(!!i),Wi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await fl(e);for(const r of t)try{if(gl(r))return}catch(n){}Wi(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return js()||Os()||$s()}};class Ol{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return es("unexpected MultiFactorSessionType")}}}class Ml extends Ol{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Ml(e)}_finalizeEnroll(e,t,n){return function(e,t){return ds(e,"POST","/v2/accounts/mfaEnrollment:finalize",cs(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return ds(e,"POST","/v2/accounts/mfaSignIn:finalize",cs(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Ll{constructor(){}static assertion(e){return Ml._fromCredential(e)}}Ll.FACTOR_ID="phone";var Fl="@firebase/auth",Bl="0.23.2";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ul{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Zi(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const $l=xn("authIdTokenMaxAge")||300;let jl=null;function zl(e=ui()){const t=ii(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=ii(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(Un(n.getOptions(),null!=t?t:{}))return e;Wi(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Vl,persistence:[Po,mo,go]}),r=xn("authTokenSyncURL");if(r){const e=(i=r,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>$l)return;const r=null==t?void 0:t.token;jl!==r&&(jl=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Wn(e).beforeAuthStateChanged(t,n)}(n,e,()=>e(n.currentUser)),function(e,t,n,r){Wn(e).onIdTokenChanged(t,n,r)}(n,t=>e(t))}var i;const s=Cn("auth");return s&&na(n,`http://${s}`),n}var ql;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Gl(){return window}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ql="Browser",ri(new Qn("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=n.options;Zi(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const o={apiKey:s,authDomain:a,clientPlatform:ql,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:zs(ql)},l=new Zs(n,r,i,o);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(xs);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(l,t),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ri(new Qn("auth-internal",e=>{const t=ea(e.getProvider("auth").getImmediate());return new Ul(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),di(Fl,Bl,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(ql)),di(Fl,Bl,"esm2017");async function Kl(e,t,n){var r;const{BuildInfo:i}=Gl();ts(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(ts(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}(t.sessionId),a={};return $s()?a.ibi=i.packageName:Fs()?a.apn=i.packageName:Wi(e,"operation-not-supported-in-this-environment"),i.displayName&&(a.appDisplayName=i.displayName),a.sessionId=s,Pl(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,a)}function Hl(e){const{cordova:t}=Gl();return new Promise(n=>{t.plugins.browsertab.isAvailable(r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(e=Nn()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)})})}class Wl extends dl{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}async function Ql(e){const t=await Jl()._get(Zl(e));return t&&await Jl()._remove(Zl(e)),t}function Yl(e,t){var n,r;const i=function(e){const t=eu(e),n=t.link?decodeURIComponent(t.link):void 0,r=eu(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return eu(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=eu(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(t.firebaseError)):null,a=null===(r=null===(n=null==s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],o=a?Qi(a):null;return o?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:o,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function Xl(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(62*Math.random());e.push(t.charAt(n))}return e.join("")}function Jl(){return xs(mo)}function Zl(e){return Ds("authEvent",e.config.apiKey,e.name)}function eu(e){if(!(null==e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return zn(n.join("?"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tu=class{constructor(){this._redirectPersistence=go,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=ul,this._overrideRedirectResult=rl}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new Wl(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){Wi(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,a,o,l,u,c;const d=Gl();Zi("function"==typeof(null===(t=null==d?void 0:d.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Zi(void 0!==(null===(n=null==d?void 0:d.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Zi("function"==typeof(null===(s=null===(i=null===(r=null==d?void 0:d.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Zi("function"==typeof(null===(l=null===(o=null===(a=null==d?void 0:d.cordova)||void 0===a?void 0:a.plugins)||void 0===o?void 0:o.browsertab)||void 0===l?void 0:l.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Zi("function"==typeof(null===(c=null===(u=null==d?void 0:d.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===c?void 0:c.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),el.clear(),await this._originValidation(e);const s=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:Xl(),postBody:null,tenantId:e.tenantId,error:Qi(e,"no-auth-event")}}(e,n,r);await function(e,t){return Jl()._set(Zl(e),t)}(e,s);const a=await Kl(e,s,t);return async function(e,t,n){const{cordova:r}=Gl();let i=()=>{};try{await new Promise((s,a)=>{let o=null;function l(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function u(){o||(o=window.setTimeout(()=>{a(Qi(e,"redirect-cancelled-by-user"))},2e3))}function c(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}t.addPassiveListener(l),document.addEventListener("resume",u,!1),Fs()&&document.addEventListener("visibilitychange",c,!1),i=()=>{t.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",c,!1),o&&window.clearTimeout(o)}})}finally{i()}}(e,i,await Hl(a))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=Gl(),n={};$s()?n.iosBundleId=t.packageName:Fs()?n.androidPackageName=t.packageName:Wi(e,"operation-not-supported-in-this-environment"),await fl(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=Gl(),s=setTimeout(async()=>{await Ql(e),t.onEvent(nu())},500),a=async n=>{clearTimeout(s);const r=await Ql(e);let i=null;r&&(null==n?void 0:n.url)&&(i=Yl(r,n.url)),t.onEvent(i||nu())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,a);const o=r,l=`${i.packageName.toLowerCase()}://`;Gl().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(l)&&a({url:e}),"function"==typeof o)try{o(e)}catch(t){}}}};function nu(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Qi("no-auth-event")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function iu(e=Nn()){return!("file:"!==ru()&&"ionic:"!==ru()&&"capacitor:"!==ru()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function su(e=Nn()){return Vn()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=Nn()){return/Edge\/\d+/.test(e)}(e)}function au(){try{const e=self.localStorage,t=bo();if(e)return e.setItem(t,"1"),e.removeItem(t),!su()||On()}catch(e){return ou()&&On()}return!1}function ou(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function lu(){return("http:"===ru()||"https:"===ru()||Pn()||iu())&&!(Rn()||Dn())&&au()&&!ou()}function uu(){return iu()&&"undefined"!=typeof document}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const cu={LOCAL:"local",NONE:"none",SESSION:"session"},du=Zi,hu="persistence";async function pu(e){await e._initializationPromise;const t=fu(),n=Ds(hu,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function fu(){var e;try{return(null===(e="undefined"!=typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu=Zi;class vu{constructor(){this.browserResolver=xs(Vl),this.cordovaResolver=xs(tu),this.underlyingResolver=null,this._redirectPersistence=go,this._completeRedirectFn=ul,this._overrideRedirectResult=rl}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return uu()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return mu(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!uu()&&new Promise(e=>{const t=setTimeout(()=>{e(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(t),e(!0)})})}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(e){return e.unwrap()}function yu(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null==t?void 0:t.code)){t.resolver=new Iu(e,function(e,t){var n;const r=Wn(e),i=t;return Zi(t.customData.operationType,r,"argument-error"),Zi(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),lo._fromError(r,i)}(e,t))}else if(r){const e=bu(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}function bu(e){const{_tokenResponse:t}=e instanceof Mn?e.customData:e;if(!t)return null;if(!(e instanceof Mn)&&"temporaryProof"in t&&"phoneNumber"in t)return Go.credentialFromResult(e);const n=t.providerId;if(!n||n===Vi)return null;let r;switch(n){case Ri:r=Sa;break;case Di:r=Ia;break;case Pi:r=ka;break;case Oi:r=Ea;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:a,nonce:o}=t;return i||s||e||a?a?n.startsWith("saml.")?Ta._create(n,a):fa._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:e,accessToken:i}):new _a(n).credential({idToken:e,accessToken:i,rawNonce:o}):null}return e instanceof Mn?r.credentialFromError(e):r.credentialFromResult(e)}function wu(e,t){return t.catch(t=>{throw t instanceof Mn&&yu(e,t),t}).then(e=>{const t=e.operationType,n=e.user;return{operationType:t,credential:(r=e,bu(r)),additionalUserInfo:ao(e),user:Su.getOrCreate(n)};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var r})}async function _u(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>wu(e,n.confirm(t))}}class Iu{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return wu(gu(this.auth),this.resolver.resolveSignIn(e))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=Wn(e);return co.has(t)||co.set(t,uo._fromUser(t)),co.get(t)}(e)}static getOrCreate(e){return Su.USER_MAP.has(e)||Su.USER_MAP.set(e,new Su(e)),Su.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return wu(this.auth,Ua(this._delegate,e))}async linkWithPhoneNumber(e,t){return _u(this.auth,async function(e,t,n){const r=Wn(e);await Ma(!1,r,"phone");const i=await qo(r.auth,t,Wn(n));return new zo(i,e=>Ua(r,e))}(this._delegate,e,t))}async linkWithPopup(e){return wu(this.auth,async function(e,t,n){const r=Wn(e);Xi(r.auth,t,ba);const i=Ko(r.auth,n);return new Zo(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(this._delegate,e,vu))}async linkWithRedirect(e){return await pu(ea(this.auth)),ll(this._delegate,e,vu)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return wu(this.auth,$a(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return _u(this.auth,async function(e,t,n){const r=Wn(e),i=await qo(r.auth,t,Wn(n));return new zo(i,e=>$a(r,e))}(this._delegate,e,t))}reauthenticateWithPopup(e){return wu(this.auth,async function(e,t,n){const r=Wn(e);Xi(r.auth,t,ba);const i=Ko(r.auth,n);return new Zo(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}(this._delegate,e,vu))}async reauthenticateWithRedirect(e){return await pu(ea(this.auth)),ol(this._delegate,e,vu)}sendEmailVerification(e){return Ya(this._delegate,e)}async unlink(e){return await Va(this._delegate,e),this}updateEmail(e){return function(e,t){return Za(Wn(e),t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return Za(Wn(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){await Oa(Wn(e),t)}(this._delegate,e)}updateProfile(e){return Ja(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Xa(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Su.USER_MAP=new WeakMap;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const ku=Zi;class Tu{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;ku(n,"invalid-api-key",{appName:e.name}),ku(n,"invalid-api-key",{appName:e.name});const r="undefined"!=typeof window?vu:void 0;this._delegate=t.initialize({options:{persistence:Eu(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(zi),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Su.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){na(this._delegate,e,t)}applyActionCode(e){return Ha(this._delegate,e)}checkActionCode(e){return Wa(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await aa(Wn(e),{oobCode:t,newPassword:n})}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return wu(this._delegate,async function(e,t,n){var r;const i=ea(e),s={returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"};let a;if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await Xs(i,s,"signUpPassword");a=xa(i,e)}else a=xa(i,s).catch(async e=>{if("auth/missing-recaptcha-token"===e.code){const e=await Xs(i,s,"signUpPassword");return xa(i,e)}return Promise.reject(e)});const o=await a.catch(e=>Promise.reject(e)),l=await Aa._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(l.user),l}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return Qa(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=ga.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){ku(lu(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await ea(e)._initializationPromise,ul(e,t,!1)}(this._delegate,vu);return e?wu(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){ea(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=Cu(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=Cu(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
return async function(e,t,n){var r;const i=ea(e),s={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};function a(e,t){Zi(t.handleCodeInApp,i,"argument-error"),t&&Ka(i,e,t)}if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await Xs(i,s,"getOobCode",!0);a(e,n),await da(i,e)}else a(s,n),await da(i,s).catch(async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{const e=await Xs(i,s,"getOobCode",!0);a(e,n),await da(i,e)}})}(this._delegate,e,t)}sendPasswordResetEmail(e,t){return async function(e,t,n){var r;const i=ea(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await Xs(i,s,"getOobCode",!0);n&&Ka(i,e,n),await ca(i,e)}else n&&Ka(i,s,n),await ca(i,s).catch(async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{const e=await Xs(i,s,"getOobCode",!0);n&&Ka(i,e,n),await ca(i,e)}})}(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){du(Object.values(cu).includes(t),e,"invalid-persistence-type"),Rn()?du(t!==cu.SESSION,e,"unsupported-persistence-type"):Dn()?du(t===cu.NONE,e,"unsupported-persistence-type"):ou()?du(t===cu.NONE||t===cu.LOCAL&&On(),e,"unsupported-persistence-type"):du(t===cu.NONE||au(),e,"unsupported-persistence-type")}(this._delegate,e),e){case cu.SESSION:t=go;break;case cu.LOCAL:t=await xs(Po)._isAvailable()?Po:mo;break;case cu.NONE:t=Ns;break;default:return Wi("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return wu(this._delegate,async function(e){var t;const n=ea(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Aa({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await xa(n,{returnSecureToken:!0}),i=await Aa._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return wu(this._delegate,Ba(this._delegate,e))}signInWithCustomToken(e){return wu(this._delegate,ja(this._delegate,e))}signInWithEmailAndPassword(e,t){return wu(this._delegate,function(e,t,n){return Ba(Wn(e),ya.credential(t,n))}(this._delegate,e,t))}signInWithEmailLink(e,t){return wu(this._delegate,async function(e,t,n){const r=Wn(e),i=ya.credentialWithLink(t,n||ns());return Zi(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ba(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return _u(this._delegate,async function(e,t,n){const r=ea(e),i=await qo(r,t,Wn(n));return new zo(i,e=>Ba(r,e))}(this._delegate,e,t))}async signInWithPopup(e){return ku(lu(),this._delegate,"operation-not-supported-in-this-environment"),wu(this._delegate,async function(e,t,n){const r=ea(e);Xi(e,t,ba);const i=Ko(r,n);return new Zo(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,vu))}async signInWithRedirect(e){return ku(lu(),this._delegate,"operation-not-supported-in-this-environment"),await pu(this._delegate),al(this._delegate,e,vu)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await Wa(Wn(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function Cu(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&Su.getOrCreate(e)),error:t,complete:n}}function Eu(e,t){const n=function(e,t){const n=fu();if(!n)return[];const r=Ds(hu,e,t);switch(n.getItem(r)){case cu.NONE:return[Ns];case cu.LOCAL:return[Po,go];case cu.SESSION:return[go];default:return[]}}(e,t);if("undefined"==typeof self||n.includes(Po)||n.push(Po),"undefined"!=typeof window)for(const r of[mo,go])n.includes(r)||n.push(r);return n.includes(Ns)||n.push(Ns),n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tu.Persistence=cu;class xu{constructor(){this.providerId="phone",this._delegate=new Go(gu(Ai.auth()))}static credential(e,t){return Go.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}xu.PHONE_SIGN_IN_METHOD=Go.PHONE_SIGN_IN_METHOD,xu.PROVIDER_ID=Go.PROVIDER_ID;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Au=Zi;class Nu{constructor(e,t,n=Ai.app()){var r;Au(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new jo(e,t,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Du;(Du=Ai).INTERNAL.registerComponent(new Qn("auth-compat",e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new Tu(t,n)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Mi,PASSWORD_RESET:Li,RECOVER_EMAIL:Fi,REVERT_SECOND_FACTOR_ADDITION:Bi,VERIFY_AND_CHANGE_EMAIL:Ui,VERIFY_EMAIL:$i}},EmailAuthProvider:ya,FacebookAuthProvider:Ia,GithubAuthProvider:ka,GoogleAuthProvider:Sa,OAuthProvider:_a,SAMLAuthProvider:Ca,PhoneAuthProvider:xu,PhoneMultiFactorGenerator:Ll,RecaptchaVerifier:Nu,TwitterAuthProvider:Ea,Auth:Tu,AuthCredential:sa,Error:Mn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),Du.registerVersion("@firebase/auth-compat","0.4.2");const Pu={};var Ru,Vu="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Ou=Ou||{},Mu=Vu||self;function Lu(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function Fu(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function Bu(e,t,n){return e.call.apply(e.bind,arguments)}function Uu(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function $u(e,t,n){return($u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Bu:Uu).apply(null,arguments)}function ju(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function zu(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function qu(){this.s=this.s,this.o=this.o}qu.prototype.s=!1,qu.prototype.sa=function(){!this.s&&(this.s=!0,this.N())},qu.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Gu=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Ku(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Hu(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(Lu(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function Wu(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Wu.prototype.h=function(){this.defaultPrevented=!0};var Qu=function(){if(!Mu.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Mu.addEventListener("test",()=>{},t),Mu.removeEventListener("test",()=>{},t)}catch(n){}return e}();function Yu(e){return/^[\s\xa0]*$/.test(e)}function Xu(){var e=Mu.navigator;return e&&(e=e.userAgent)?e:""}function Ju(e){return-1!=Xu().indexOf(e)}function Zu(e){return Zu[" "](e),e}Zu[" "]=function(){};var ec,tc,nc,rc=Ju("Opera"),ic=Ju("Trident")||Ju("MSIE"),sc=Ju("Edge"),ac=sc||ic,oc=Ju("Gecko")&&!(-1!=Xu().toLowerCase().indexOf("webkit")&&!Ju("Edge"))&&!(Ju("Trident")||Ju("MSIE"))&&!Ju("Edge"),lc=-1!=Xu().toLowerCase().indexOf("webkit")&&!Ju("Edge");function uc(){var e=Mu.document;return e?e.documentMode:void 0}e:{var cc="",dc=(tc=Xu(),oc?/rv:([^\);]+)(\)|;)/.exec(tc):sc?/Edge\/([\d\.]+)/.exec(tc):ic?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(tc):lc?/WebKit\/(\S+)/.exec(tc):rc?/(?:Version)[ \/]?(\S+)/.exec(tc):void 0);if(dc&&(cc=dc?dc[1]:""),ic){var hc=uc();if(null!=hc&&hc>parseFloat(cc)){ec=String(hc);break e}}ec=cc}if(Mu.document&&ic){var pc=uc();nc=pc||(parseInt(ec,10)||void 0)}else nc=void 0;var fc=nc;function mc(e,t){if(Wu.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(oc){e:{try{Zu(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:vc[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&mc.$.h.call(this)}}zu(mc,Wu);var vc={2:"touch",3:"pen",4:"mouse"};mc.prototype.h=function(){mc.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var gc="closure_listenable_"+(1e6*Math.random()|0),yc=0;function bc(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++yc,this.fa=this.ia=!1}function wc(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function _c(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function Ic(e){const t={};for(const n in e)t[n]=e[n];return t}const Sc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function kc(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<Sc.length;t++)n=Sc[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Tc(e){this.src=e,this.g={},this.h=0}function Cc(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Gu(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(wc(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Ec(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}Tc.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var a=Ec(e,t,r,i);return-1<a?(t=e[a],n||(t.ia=!1)):((t=new bc(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var xc="closure_lm_"+(1e6*Math.random()|0),Ac={};function Nc(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Nc(e,t[s],n,r,i);return null}return n=Lc(n),e&&e[gc]?e.O(t,n,!!Fu(r)&&!!r.capture,i):function(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=Fu(i)?!!i.capture:!!i,o=Oc(e);if(o||(e[xc]=o=new Tc(e)),n=o.add(t,n,r,a,s),n.proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Vc;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Qu||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Rc(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}(e,t,n,!1,r,i)}function Dc(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Dc(e,t[s],n,r,i);else r=Fu(r)?!!r.capture:!!r,n=Lc(n),e&&e[gc]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Ec(s=e.g[t],n,r,i))&&(wc(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Oc(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Ec(t,n,r,i)),(n=-1<e?t[e]:null)&&Pc(n))}function Pc(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[gc])Cc(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Rc(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Oc(t))?(Cc(n,e),0==n.h&&(n.src=null,t[xc]=null)):wc(e)}}}function Rc(e){return e in Ac?Ac[e]:Ac[e]="on"+e}function Vc(e,t){if(e.fa)e=!0;else{t=new mc(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Pc(e),e=n.call(r,t)}return e}function Oc(e){return(e=e[xc])instanceof Tc?e:null}var Mc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Lc(e){return"function"==typeof e?e:(e[Mc]||(e[Mc]=function(t){return e.handleEvent(t)}),e[Mc])}function Fc(){qu.call(this),this.i=new Tc(this),this.S=this,this.J=null}function Bc(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"==typeof t)t=new Wu(t,e);else if(t instanceof Wu)t.target=t.target||e;else{var i=t;kc(t=new Wu(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=t.g=n[s];i=Uc(a,r,!0,t)&&i}if(i=Uc(a=t.g=e,r,!0,t)&&i,i=Uc(a,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Uc(a=t.g=n[s],r,!1,t)&&i}function Uc(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.fa&&a.capture==n){var o=a.listener,l=a.la||a.src;a.ia&&Cc(e.i,a),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}zu(Fc,qu),Fc.prototype[gc]=!0,Fc.prototype.removeEventListener=function(e,t,n,r){Dc(this,e,t,n,r)},Fc.prototype.N=function(){if(Fc.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)wc(n[r]);delete t.g[e],t.h--}}this.J=null},Fc.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Fc.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var $c=Mu.JSON.stringify;function jc(){var e=Qc;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var zc=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new qc,e=>e.reset());class qc{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Gc(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Kc(e){Mu.setTimeout(()=>{throw e},0)}let Hc,Wc=!1,Qc=new class{constructor(){this.h=this.g=null}add(e,t){const n=zc.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Yc=()=>{const e=Mu.Promise.resolve(void 0);Hc=()=>{e.then(Xc)}};var Xc=()=>{for(var e;e=jc();){try{e.h.call(e.g)}catch(n){Kc(n)}var t=zc;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Wc=!1};function Jc(e,t){Fc.call(this),this.h=e||1,this.g=t||Mu,this.j=$u(this.qb,this),this.l=Date.now()}function Zc(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function ed(e,t,n){if("function"==typeof e)n&&(e=$u(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=$u(e.handleEvent,e)}return 2147483647<Number(t)?-1:Mu.setTimeout(e,t||0)}function td(e){e.g=ed(()=>{e.g=null,e.i&&(e.i=!1,td(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}zu(Jc,Fc),(Ru=Jc.prototype).ga=!1,Ru.T=null,Ru.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Bc(this,"tick"),this.ga&&(Zc(this),this.start()))}},Ru.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Ru.N=function(){Jc.$.N.call(this),Zc(this),delete this.g};class nd extends qu{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:td(this)}N(){super.N(),this.g&&(Mu.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function rd(e){qu.call(this),this.h=e,this.g={}}zu(rd,qu);var id=[];function sd(e,t,n,r){Array.isArray(n)||(n&&(id[0]=n.toString()),n=id);for(var i=0;i<n.length;i++){var s=Nc(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function ad(e){_c(e.g,function(e,t){this.g.hasOwnProperty(t)&&Pc(e)},e),e.g={}}function od(){this.g=!0}function ld(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return $c(n)}catch(o){return t}}(e,n)+(r?" "+r:"")})}rd.prototype.N=function(){rd.$.N.call(this),ad(this)},rd.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},od.prototype.Ea=function(){this.g=!1},od.prototype.info=function(){};var ud={},cd=null;function dd(){return cd=cd||new Fc}function hd(e){Wu.call(this,ud.Ta,e)}function pd(e){const t=dd();Bc(t,new hd(t))}function fd(e,t){Wu.call(this,ud.STAT_EVENT,e),this.stat=t}function md(e){const t=dd();Bc(t,new fd(t,e))}function vd(e,t){Wu.call(this,ud.Ua,e),this.size=t}function gd(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Mu.setTimeout(function(){e()},t)}ud.Ta="serverreachability",zu(hd,Wu),ud.STAT_EVENT="statevent",zu(fd,Wu),ud.Ua="timingevent",zu(vd,Wu);var yd={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},bd={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function wd(){}function _d(e){return e.h||(e.h=e.i())}function Id(){}wd.prototype.h=null;var Sd,kd={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Td(){Wu.call(this,"d")}function Cd(){Wu.call(this,"c")}function Ed(){}function xd(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new rd(this),this.P=Nd,e=ac?125:void 0,this.V=new Jc(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Ad}function Ad(){this.i=null,this.g="",this.h=!1}zu(Td,Wu),zu(Cd,Wu),zu(Ed,wd),Ed.prototype.g=function(){return new XMLHttpRequest},Ed.prototype.i=function(){return{}},Sd=new Ed;var Nd=45e3,Dd={},Pd={};function Rd(e,t,n){e.L=1,e.v=Jd(Hd(t)),e.s=n,e.S=!0,Vd(e,null)}function Vd(e,t){e.G=Date.now(),Fd(e),e.A=Hd(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),dh(n.i,"t",r),e.C=0,n=e.l.J,e.h=new Ad,e.g=dp(e.l,n?t:null,!e.s),0<e.O&&(e.M=new nd($u(e.Pa,e,e.g),e.O)),sd(e.U,e.g,"readystatechange",e.nb),t=e.I?Ic(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),pd(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var u=o[l].split("=");if(1<u.length){var c=u[0];u=u[1];var d=c.split("_");a=2<=d.length&&"type"==d[1]?a+(c+"=")+u+"&":a+(c+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a})}(e.j,e.u,e.A,e.m,e.W,e.s)}function Od(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function Md(e,t,n){let r,i=!0;for(;!e.J&&e.C<n.length;){if(r=Ld(e,n),r==Pd){4==t&&(e.o=4,md(14),i=!1),ld(e.j,e.m,null,"[Incomplete Response]");break}if(r==Dd){e.o=4,md(15),ld(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}ld(e.j,e.m,r,null),zd(e,r)}Od(e)&&r!=Pd&&r!=Dd&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,md(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),rp(t),t.M=!0,md(11))):(ld(e.j,e.m,n,"[Invalid Chunked Response]"),jd(e),$d(e))}function Ld(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Pd:(n=Number(t.substring(n,r)),isNaN(n)?Dd:(r+=1)+n>t.length?Pd:(t=t.slice(r,r+n),e.C=r+n,t))}function Fd(e){e.Y=Date.now()+e.P,Bd(e,e.P)}function Bd(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=gd($u(e.lb,e),t)}function Ud(e){e.B&&(Mu.clearTimeout(e.B),e.B=null)}function $d(e){0==e.l.H||e.J||ap(e.l,e)}function jd(e){Ud(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Zc(e.V),ad(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function zd(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||yh(n.i,e)))if(!e.K&&yh(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;sp(n),Qh(n)}np(n),md(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=gd($u(n.ib,n),6e3));if(1>=gh(n.i)&&n.oa){try{n.oa()}catch(u){}n.oa=void 0}}else lp(n,11)}else if((e.K||n.g==e)&&sp(n),!Yu(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.V=u[0],u=u[1],2==n.H)if("c"==u[0]){n.K=u[1],n.pa=u[2];const t=u[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=u[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const c=u[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(bh(s,s.h),s.h=null))}if(r.F){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,Xd(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var a=e;if((r=n).wa=cp(r,r.J?r.pa:null,r.Y),a.K){wh(r.i,a);var o=a,l=r.L;l&&o.setTimeout(l),o.B&&(Ud(o),Fd(o)),r.g=a}else tp(r);0<n.j.length&&Xh(n)}else"stop"!=u[0]&&"close"!=u[0]||lp(n,7);else 3==n.H&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?lp(n,7):Wh(n):"noop"!=u[0]&&n.h&&n.h.Aa(u),n.A=0)}pd()}catch(u){}}function qd(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Lu(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Lu(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Lu(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(Ru=xd.prototype).setTimeout=function(e){this.P=e},Ru.nb=function(e){e=e.target;const t=this.M;t&&3==jh(e)?t.l():this.Pa(e)},Ru.Pa=function(e){try{if(e==this.g)e:{const c=jh(this.g);var t=this.g.Ia();this.g.da();if(!(3>c)&&(3!=c||ac||this.g&&(this.h.h||this.g.ja()||zh(this.g)))){this.J||4!=c||7==t||pd(),Ud(this);var n=this.g.da();this.ca=n;t:if(Od(this)){var r=zh(this.g);e="";var i=r.length,s=4==jh(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){jd(this),$d(this);var a="";break t}this.h.i=new Mu.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,a){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+a})}(this.j,this.u,this.A,this.m,this.W,c,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var o,l=this.g;if((o=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Yu(o)){var u=o;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,md(12),jd(this),$d(this);break e}ld(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zd(this,n)}this.S?(Md(this,c,a),ac&&this.i&&3==c&&(sd(this.U,this.V,"tick",this.mb),this.V.start())):(ld(this.j,this.m,a,null),zd(this,a)),4==c&&jd(this),this.i&&!this.J&&(4==c?ap(this.l,this):(this.i=!1,Fd(this)))}else(function(e){const t={};e=(e.g&&2<=jh(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(Yu(e[r]))continue;var n=Gc(e[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.o=3,md(12)):(this.o=0,md(13)),jd(this),$d(this)}}}catch(c){}},Ru.mb=function(){if(this.g){var e=jh(this.g),t=this.g.ja();this.C<t.length&&(Ud(this),Md(this,e,t),this.i&&4!=e&&Fd(this))}},Ru.cancel=function(){this.J=!0,jd(this)},Ru.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.L&&(pd(),md(17)),jd(this),this.o=2,$d(this)):Bd(this,this.Y-e)};var Gd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Kd(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Kd){this.h=e.h,Wd(this,e.j),this.s=e.s,this.g=e.g,Qd(this,e.m),this.l=e.l;var t=e.i,n=new oh;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Yd(this,n),this.o=e.o}else e&&(t=String(e).match(Gd))?(this.h=!1,Wd(this,t[1]||"",!0),this.s=Zd(t[2]||""),this.g=Zd(t[3]||"",!0),Qd(this,t[4]),this.l=Zd(t[5]||"",!0),Yd(this,t[6]||"",!0),this.o=Zd(t[7]||"")):(this.h=!1,this.i=new oh(null,this.h))}function Hd(e){return new Kd(e)}function Wd(e,t,n){e.j=n?Zd(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Qd(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Yd(e,t,n){t instanceof oh?(e.i=t,function(e,t){t&&!e.j&&(lh(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(uh(this,t),dh(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=eh(t,sh)),e.i=new oh(t,e.h))}function Xd(e,t,n){e.i.set(t,n)}function Jd(e){return Xd(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Zd(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function eh(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,th),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function th(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Kd.prototype.toString=function(){var e=[],t=this.j;t&&e.push(eh(t,nh,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(eh(t,nh,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(eh(n,"/"==n.charAt(0)?ih:rh,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",eh(n,ah)),e.join("")};var nh=/[#\/\?@]/g,rh=/[#\?:]/g,ih=/[#\?]/g,sh=/[#\?@]/g,ah=/#/g;function oh(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function lh(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function uh(e,t){lh(e),t=hh(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function ch(e,t){return lh(e),t=hh(e,t),e.g.has(t)}function dh(e,t,n){uh(e,t),0<n.length&&(e.i=null,e.g.set(hh(e,t),Ku(n)),e.h+=n.length)}function hh(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Ru=oh.prototype).add=function(e,t){lh(this),this.i=null,e=hh(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Ru.forEach=function(e,t){lh(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},Ru.ta=function(){lh(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},Ru.Z=function(e){lh(this);let t=[];if("string"==typeof e)ch(this,e)&&(t=t.concat(this.g.get(hh(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},Ru.set=function(e,t){return lh(this),this.i=null,ch(this,e=hh(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Ru.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},Ru.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),a=this.Z(r);for(r=0;r<a.length;r++){var i=s;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),e.push(i)}}return this.i=e.join("&")};var ph=class{constructor(e,t){this.g=e,this.map=t}};function fh(e){this.l=e||mh,Mu.PerformanceNavigationTiming?e=0<(e=Mu.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Mu.g&&Mu.g.Ka&&Mu.g.Ka()&&Mu.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var mh=10;function vh(e){return!!e.h||!!e.g&&e.g.size>=e.j}function gh(e){return e.h?1:e.g?e.g.size:0}function yh(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function bh(e,t){e.g?e.g.add(t):e.h=t}function wh(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function _h(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return Ku(e.i)}fh.prototype.cancel=function(){if(this.i=_h(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Ih=class{stringify(e){return Mu.JSON.stringify(e,void 0)}parse(e){return Mu.JSON.parse(e,void 0)}};function Sh(){this.g=new Ih}function kh(e,t,n){const r=n||"";try{qd(e,function(e,n){let i=e;Fu(e)&&(i=$c(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Th(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(s){}}function Ch(e){this.l=e.fc||null,this.j=e.ob||!1}function Eh(e,t){Fc.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=xh,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}zu(Ch,wd),Ch.prototype.g=function(){return new Eh(this.l,this.j)},Ch.prototype.i=function(e){return function(){return e}}({}),zu(Eh,Fc);var xh=0;function Ah(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Nh(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Dh(e)}function Dh(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Ru=Eh.prototype).open=function(e,t){if(this.readyState!=xh)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Dh(this)},Ru.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||Mu).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},Ru.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Nh(this)),this.readyState=xh},Ru.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Dh(this)),this.g&&(this.readyState=3,Dh(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Mu.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ah(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},Ru.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Nh(this):Dh(this),3==this.readyState&&Ah(this)}},Ru.Za=function(e){this.g&&(this.response=this.responseText=e,Nh(this))},Ru.Ya=function(e){this.g&&(this.response=e,Nh(this))},Ru.ka=function(){this.g&&Nh(this)},Ru.setRequestHeader=function(e,t){this.v.append(e,t)},Ru.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Ru.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Eh.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Ph=Mu.JSON.parse;function Rh(e){Fc.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Vh,this.L=this.M=!1}zu(Rh,Fc);var Vh="",Oh=/^https?$/i,Mh=["POST","PUT"];function Lh(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Fh(e),Uh(e)}function Fh(e){e.F||(e.F=!0,Bc(e,"complete"),Bc(e,"error"))}function Bh(e){if(e.h&&void 0!==Ou&&(!e.C[1]||4!=jh(e)||2!=e.da()))if(e.v&&4==jh(e))ed(e.La,0,e);else if(Bc(e,"readystatechange"),4==jh(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===o){var i=String(e.I).match(Gd)[1]||null;!i&&Mu.self&&Mu.self.location&&(i=Mu.self.location.protocol.slice(0,-1)),r=!Oh.test(i?i.toLowerCase():"")}n=r}if(n)Bc(e,"complete"),Bc(e,"success");else{e.m=6;try{var s=2<jh(e)?e.g.statusText:""}catch(a){s=""}e.j=s+" ["+e.da()+"]",Fh(e)}}finally{Uh(e)}}}function Uh(e,t){if(e.g){$h(e);const r=e.g,i=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||Bc(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function $h(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(Mu.clearTimeout(e.A),e.A=null)}function jh(e){return e.g?e.g.readyState:0}function zh(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case Vh:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function qh(e){let t="";return _c(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Gh(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=qh(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Xd(e,t,n))}function Kh(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Hh(e){this.Ga=0,this.j=[],this.l=new od,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Kh("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Kh("baseRetryDelayMs",5e3,e),this.hb=Kh("retryDelaySeedMs",1e4,e),this.eb=Kh("forwardChannelMaxRetries",2,e),this.xa=Kh("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new fh(e&&e.concurrentRequestLimit),this.Ja=new Sh,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Wh(e){if(Yh(e),3==e.H){var t=e.W++,n=Hd(e.I);if(Xd(n,"SID",e.K),Xd(n,"RID",t),Xd(n,"TYPE","terminate"),Zh(e,n),(t=new xd(e,e.l,t)).L=2,t.v=Jd(Hd(n)),n=!1,Mu.navigator&&Mu.navigator.sendBeacon)try{n=Mu.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&Mu.Image&&((new Image).src=t.v,n=!0),n||(t.g=dp(t.l,null),t.g.ha(t.v)),t.G=Date.now(),Fd(t)}up(e)}function Qh(e){e.g&&(rp(e),e.g.cancel(),e.g=null)}function Yh(e){Qh(e),e.u&&(Mu.clearTimeout(e.u),e.u=null),sp(e),e.i.cancel(),e.m&&("number"==typeof e.m&&Mu.clearTimeout(e.m),e.m=null)}function Xh(e){if(!vh(e.i)&&!e.m){e.m=!0;var t=e.Na;Hc||Yc(),Wc||(Hc(),Wc=!0),Qc.add(t,e),e.C=0}}function Jh(e,t){var n;n=t?t.m:e.W++;const r=Hd(e.I);Xd(r,"SID",e.K),Xd(r,"RID",n),Xd(r,"AID",e.V),Zh(e,r),e.o&&e.s&&Gh(r,e.o,e.s),n=new xd(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=ep(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),bh(e.i,n),Rd(n,r,t)}function Zh(e,t){e.na&&_c(e.na,function(e,n){Xd(t,n,e)}),e.h&&qd({},function(e,n){Xd(t,n,e)})}function ep(e,t,n){n=Math.min(e.j.length,n);var r=e.h?$u(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let o=0;o<n;o++){let n=i[o].g;const l=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),a=!1;else try{kh(l,e,"req"+n+"_")}catch(s){r&&r(l)}}if(a){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function tp(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Hc||Yc(),Wc||(Hc(),Wc=!0),Qc.add(t,e),e.A=0}}function np(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=gd($u(e.Ma,e),op(e,e.A)),e.A++,!0)}function rp(e){null!=e.B&&(Mu.clearTimeout(e.B),e.B=null)}function ip(e){e.g=new xd(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Hd(e.wa);Xd(t,"RID","rpc"),Xd(t,"SID",e.K),Xd(t,"AID",e.V),Xd(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Xd(t,"TO",e.qa),Xd(t,"TYPE","xmlhttp"),Zh(e,t),e.o&&e.s&&Gh(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Jd(Hd(t)),n.s=null,n.S=!0,Vd(n,e)}function sp(e){null!=e.v&&(Mu.clearTimeout(e.v),e.v=null)}function ap(e,t){var n=null;if(e.g==t){sp(e),rp(e),e.g=null;var r=2}else{if(!yh(e.i,t))return;n=t.F,wh(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;Bc(r=dd(),new vd(r,n)),Xh(e)}else tp(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(gh(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=gd($u(e.Na,e,t),op(e,e.C)),e.C++,0)))}(e,t)||2==r&&np(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:lp(e,5);break;case 4:lp(e,10);break;case 3:lp(e,6);break;default:lp(e,2)}}function op(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function lp(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=$u(e.pb,e);n||(n=new Kd("//www.google.com/images/cleardot.gif"),Mu.location&&"http"==Mu.location.protocol||Wd(n,"https"),Jd(n)),function(e,t){const n=new od;if(Mu.Image){const r=new Image;r.onload=ju(Th,n,r,"TestLoadImage: loaded",!0,t),r.onerror=ju(Th,n,r,"TestLoadImage: error",!1,t),r.onabort=ju(Th,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=ju(Th,n,r,"TestLoadImage: timeout",!1,t),Mu.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else md(2);e.H=0,e.h&&e.h.za(t),up(e),Yh(e)}function up(e){if(e.H=0,e.ma=[],e.h){const t=_h(e.i);0==t.length&&0==e.j.length||(Hu(e.ma,t),Hu(e.ma,e.j),e.i.i.length=0,Ku(e.j),e.j.length=0),e.h.ya()}}function cp(e,t,n){var r=n instanceof Kd?Hd(n):new Kd(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Qd(r,r.m);else{var i=Mu.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Kd(null);r&&Wd(s,r),t&&(s.g=t),i&&Qd(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&Xd(r,n,t),Xd(r,"VER",e.ra),Zh(e,r),r}function dp(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ha&&!e.va?new Rh(new Ch({ob:!0})):new Rh(e.va)).Oa(e.J),t}function hp(){}function pp(){if(ic&&!(10<=Number(fc)))throw Error("Environmental error: no available transport.")}function fp(e,t){Fc.call(this),this.g=new Hh(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Yu(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Yu(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new gp(this)}function mp(e){Td.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vp(){Cd.call(this),this.status=1}function gp(e){this.g=e}function yp(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function bp(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^n&(i^s))+r[0]+3614090360&4294967295;a=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(a<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(t=n+((a=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function wp(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(Ru=Rh.prototype).Oa=function(e){this.M=e},Ru.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Sd.g(),this.C=this.u?_d(this.u):_d(Sd),this.g.onreadystatechange=$u(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(s){return void Lh(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=Mu.FormData&&e instanceof Mu.FormData,!(0<=Gu(Mh,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of n)this.g.setRequestHeader(a,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{$h(this),0<this.B&&((this.L=function(e){return ic&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=$u(this.ua,this)):this.A=ed(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Lh(this,s)}},Ru.ua=function(){void 0!==Ou&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Bc(this,"timeout"),this.abort(8))},Ru.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Bc(this,"complete"),Bc(this,"abort"),Uh(this))},Ru.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Uh(this,!0)),Rh.$.N.call(this)},Ru.La=function(){this.s||(this.G||this.v||this.l?Bh(this):this.kb())},Ru.kb=function(){Bh(this)},Ru.isActive=function(){return!!this.g},Ru.da=function(){try{return 2<jh(this)?this.g.status:-1}catch(tc){return-1}},Ru.ja=function(){try{return this.g?this.g.responseText:""}catch(tc){return""}},Ru.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ph(t)}},Ru.Ia=function(){return this.m},Ru.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Ru=Hh.prototype).ra=8,Ru.H=1,Ru.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new xd(this,this.l,e);let s=this.s;if(this.U&&(s?(s=Ic(s),kc(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=ep(this,i,t),Xd(n=Hd(this.I),"RID",e),Xd(n,"CVER",22),this.F&&Xd(n,"X-HTTP-Session-Id",this.F),Zh(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(qh(s)))+"&"+t:this.o&&Gh(n,this.o,s)),bh(this.i,i),this.bb&&Xd(n,"TYPE","init"),this.P?(Xd(n,"$req",t),Xd(n,"SID","null"),i.aa=!0,Rd(i,n,null)):Rd(i,n,t),this.H=2}}else 3==this.H&&(e?Jh(this,e):0==this.j.length||vh(this.i)||Jh(this))},Ru.Ma=function(){if(this.u=null,ip(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=gd($u(this.jb,this),e)}},Ru.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,md(10),Qh(this),ip(this))},Ru.ib=function(){null!=this.v&&(this.v=null,Qh(this),np(this),md(19))},Ru.pb=function(e){e?(this.l.info("Successfully pinged google.com"),md(2)):(this.l.info("Failed to ping google.com"),md(1))},Ru.isActive=function(){return!!this.h&&this.h.isActive(this)},(Ru=hp.prototype).Ba=function(){},Ru.Aa=function(){},Ru.za=function(){},Ru.ya=function(){},Ru.isActive=function(){return!0},Ru.Va=function(){},pp.prototype.g=function(e,t){return new fp(e,t)},zu(fp,Fc),fp.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;md(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=cp(e,null,e.Y),Xh(e)},fp.prototype.close=function(){Wh(this.g)},fp.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=$c(e),e=n);t.j.push(new ph(t.fb++,e)),3==t.H&&Xh(t)},fp.prototype.N=function(){this.g.h=null,delete this.j,Wh(this.g),delete this.g,fp.$.N.call(this)},zu(mp,Td),zu(vp,Cd),zu(gp,hp),gp.prototype.Ba=function(){Bc(this.g,"a")},gp.prototype.Aa=function(e){Bc(this.g,new mp(e))},gp.prototype.za=function(e){Bc(this.g,new vp)},gp.prototype.ya=function(){Bc(this.g,"b")},zu(yp,function(){this.blockSize=-1}),yp.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},yp.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)bp(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){bp(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){bp(this,r),i=0;break}}this.h=i,this.i+=t},yp.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var _p={};function Ip(e){return-128<=e&&128>e?function(e,t){var n=_p;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new wp([0|e],0>e?-1:0)}):new wp([0|e],0>e?-1:0)}function Sp(e){if(isNaN(e)||!isFinite(e))return Tp;if(0>e)return Np(Sp(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=kp;return new wp(t,0)}var kp=4294967296,Tp=Ip(0),Cp=Ip(1),Ep=Ip(16777216);function xp(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Ap(e){return-1==e.h}function Np(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new wp(n,~e.h).add(Cp)}function Dp(e,t){return e.add(Np(t))}function Pp(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Rp(e,t){this.g=e,this.h=t}function Vp(e,t){if(xp(t))throw Error("division by zero");if(xp(e))return new Rp(Tp,Tp);if(Ap(e))return t=Vp(Np(e),t),new Rp(Np(t.g),Np(t.h));if(Ap(t))return t=Vp(e,Np(t)),new Rp(Np(t.g),t.h);if(30<e.g.length){if(Ap(e)||Ap(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Cp,r=t;0>=r.X(e);)n=Op(n),r=Op(r);var i=Mp(n,1),s=Mp(r,1);for(r=Mp(r,2),n=Mp(n,2);!xp(r);){var a=s.add(r);0>=a.X(e)&&(i=i.add(n),s=a),r=Mp(r,1),n=Mp(n,1)}return t=Dp(e,i.R(t)),new Rp(i,t)}for(i=Tp;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),a=(s=Sp(n)).R(t);Ap(a)||0<a.X(e);)a=(s=Sp(n-=r)).R(t);xp(s)&&(s=Cp),i=i.add(s),e=Dp(e,a)}return new Rp(i,e)}function Op(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new wp(n,e.h)}function Mp(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new wp(i,e.h)}(Ru=wp.prototype).ea=function(){if(Ap(this))return-Np(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:kp+r)*t,t*=kp}return e},Ru.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(xp(this))return"0";if(Ap(this))return"-"+Np(this).toString(e);for(var t=Sp(Math.pow(e,6)),n=this,r="";;){var i=Vp(n,t).g,s=((0<(n=Dp(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(xp(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},Ru.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},Ru.X=function(e){return Ap(e=Dp(this,e))?-1:xp(e)?0:1},Ru.abs=function(){return Ap(this)?Np(this):this},Ru.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),a=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=a>>>16,s&=65535,a&=65535,n[i]=a<<16|s}return new wp(n,-2147483648&n[n.length-1]?-1:0)},Ru.R=function(e){if(xp(this)||xp(e))return Tp;if(Ap(this))return Ap(e)?Np(this).R(Np(e)):Np(Np(this).R(e));if(Ap(e))return Np(this.R(Np(e)));if(0>this.X(Ep)&&0>e.X(Ep))return Sp(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,a=65535&this.D(r),o=e.D(i)>>>16,l=65535&e.D(i);n[2*r+2*i]+=a*l,Pp(n,2*r+2*i),n[2*r+2*i+1]+=s*l,Pp(n,2*r+2*i+1),n[2*r+2*i+1]+=a*o,Pp(n,2*r+2*i+1),n[2*r+2*i+2]+=s*o,Pp(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new wp(n,0)},Ru.gb=function(e){return Vp(this,e).h},Ru.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new wp(n,this.h&e.h)},Ru.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new wp(n,this.h|e.h)},Ru.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new wp(n,this.h^e.h)},pp.prototype.createWebChannel=pp.prototype.g,fp.prototype.send=fp.prototype.u,fp.prototype.open=fp.prototype.m,fp.prototype.close=fp.prototype.close,yd.NO_ERROR=0,yd.TIMEOUT=8,yd.HTTP_ERROR=6,bd.COMPLETE="complete",Id.EventType=kd,kd.OPEN="a",kd.CLOSE="b",kd.ERROR="c",kd.MESSAGE="d",Fc.prototype.listen=Fc.prototype.O,Rh.prototype.listenOnce=Rh.prototype.P,Rh.prototype.getLastError=Rh.prototype.Sa,Rh.prototype.getLastErrorCode=Rh.prototype.Ia,Rh.prototype.getStatus=Rh.prototype.da,Rh.prototype.getResponseJson=Rh.prototype.Wa,Rh.prototype.getResponseText=Rh.prototype.ja,Rh.prototype.send=Rh.prototype.ha,Rh.prototype.setWithCredentials=Rh.prototype.Oa,yp.prototype.digest=yp.prototype.l,yp.prototype.reset=yp.prototype.reset,yp.prototype.update=yp.prototype.j,wp.prototype.add=wp.prototype.add,wp.prototype.multiply=wp.prototype.R,wp.prototype.modulo=wp.prototype.gb,wp.prototype.compare=wp.prototype.X,wp.prototype.toNumber=wp.prototype.ea,wp.prototype.toString=wp.prototype.toString,wp.prototype.getBits=wp.prototype.D,wp.fromNumber=Sp,wp.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Np(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Sp(Math.pow(n,8)),i=Tp,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+a),n);8>a?(a=Sp(Math.pow(n,a)),i=i.R(a).add(Sp(o))):i=(i=i.R(r)).add(Sp(o))}return i};var Lp=yd,Fp=bd,Bp=ud,Up=10,$p=11,jp=Ch,zp=Id,qp=Rh,Gp=yp,Kp=wp,Hp={};const Wp="@firebase/firestore";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qp.UNAUTHENTICATED=new Qp(null),Qp.GOOGLE_CREDENTIALS=new Qp("google-credentials-uid"),Qp.FIRST_PARTY=new Qp("first-party-uid"),Qp.MOCK_USER=new Qp("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Yp="9.23.0";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp=new ar("@firebase/firestore");function Jp(){return Xp.logLevel}function Zp(e,...t){if(Xp.logLevel<=er.DEBUG){const n=t.map(nf);Xp.debug(`Firestore (${Yp}): ${e}`,...n)}}function ef(e,...t){if(Xp.logLevel<=er.ERROR){const n=t.map(nf);Xp.error(`Firestore (${Yp}): ${e}`,...n)}}function tf(e,...t){if(Xp.logLevel<=er.WARN){const n=t.map(nf);Xp.warn(`Firestore (${Yp}): ${e}`,...n)}}function nf(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(n){return e}
/**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(e="Unexpected state"){const t=`FIRESTORE (${Yp}) INTERNAL ASSERTION FAILED: `+e;throw ef(t),new Error(t)}function sf(e,t){e||rf()}function af(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class lf extends Mn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class df{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Qp.UNAUTHENTICATED))}shutdown(){}}class hf{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class pf{constructor(e){this.t=e,this.currentUser=Qp.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new uf;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new uf,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},a=e=>{Zp("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(Zp("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new uf)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Zp("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(sf("string"==typeof t.accessToken),new cf(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return sf(null===e||"string"==typeof e),new Qp(e)}}class ff{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=Qp.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class mf{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new ff(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(Qp.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class vf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gf{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){const n=e=>{null!=e.error&&Zp("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.T;return this.T=e.token,Zp("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Zp("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.I.getImmediate({optional:!0});e?r(e):Zp("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(sf("string"==typeof e.token),this.T=e.token,new vf(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=yf(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function wf(e,t){return e<t?-1:e>t?1:0}function _f(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function If(e){return e+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new lf(of.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new lf(of.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new lf(of.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new lf(of.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Sf.fromMillis(Date.now())}static fromDate(e){return Sf.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Sf(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?wf(this.nanoseconds,e.nanoseconds):wf(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e){this.timestamp=e}static fromTimestamp(e){return new kf(e)}static min(){return new kf(new Sf(0,0))}static max(){return new kf(new Sf(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,t,n){void 0===t?t=0:t>e.length&&rf(),void 0===n?n=e.length-t:n>e.length-t&&rf(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Tf.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Tf?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Cf extends Tf{construct(e,t,n){return new Cf(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new lf(of.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new Cf(t)}static emptyPath(){return new Cf([])}}const Ef=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xf extends Tf{construct(e,t,n){return new xf(e,t,n)}static isValidIdentifier(e){return Ef.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xf.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new xf(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new lf(of.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new lf(of.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new lf(of.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new lf(of.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xf(t)}static emptyPath(){return new xf([])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e){this.path=e}static fromPath(e){return new Af(Cf.fromString(e))}static fromName(e){return new Af(Cf.fromString(e).popFirst(5))}static empty(){return new Af(Cf.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Cf.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Cf.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Af(new Cf(e.slice()))}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function Df(e){return e.fields.find(e=>2===e.kind)}function Pf(e){return e.fields.filter(e=>2!==e.kind)}Nf.UNKNOWN_ID=-1;class Rf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Vf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Vf(0,Lf.min())}}function Of(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=kf.fromTimestamp(1e9===r?new Sf(n+1,0):new Sf(n,r));return new Lf(i,Af.empty(),t)}function Mf(e){return new Lf(e.readTime,e.key,-1)}class Lf{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Lf(kf.min(),Af.empty(),-1)}static max(){return new Lf(kf.max(),Af.empty(),-1)}}function Ff(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Af.comparator(e.documentKey,t.documentKey),0!==n?n:wf(e.largestBatchId,t.largestBatchId)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}const Bf="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Uf{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $f(e){if(e.code!==of.FAILED_PRECONDITION||e.message!==Bf)throw e;Zp("LocalStore","Unexpectedly lost primary lease")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rf(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new jf((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof jf?t:jf.resolve(t)}catch(t){return jf.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):jf.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):jf.reject(t)}static resolve(e){return new jf((t,n)=>{t(e)})}static reject(e){return new jf((t,n)=>{n(e)})}static waitFor(e){return new jf((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=jf.resolve(!1);for(const n of e)t=t.next(e=>e?jf.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new jf((n,r)=>{const i=e.length,s=new Array(i);let a=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++a,a===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new jf((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new uf,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new Kf(e,t.error)):this.v.resolve()},this.transaction.onerror=t=>{const n=Xf(t.target.error);this.v.reject(new Kf(e,n))}}static open(e,t,n,r){try{return new zf(t,e.transaction(r,n))}catch(i){throw new Kf(t,i)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(Zp("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Wf(t)}}class qf{constructor(e,t,n){this.name=e,this.version=t,this.V=n,12.2===qf.S(Nn())&&ef("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Zp("SimpleDb","Removing database:",e),Qf(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!On())return!1;if(qf.C())return!0;const e=Nn(),t=qf.S(e),n=0<t&&t<10,r=qf.N(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=Hp)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static N(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async $(e){return this.db||(Zp("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Kf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new lf(of.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new lf(of.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Kf(e,r))},r.onupgradeneeded=e=>{Zp("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.V.O(t,r.transaction,e.oldVersion,this.version).next(()=>{Zp("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.F&&(this.db.onversionchange=e=>this.F(e)),this.db}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.$(e);const t=zf.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.P(),e)).catch(e=>(t.abort(e),jf.reject(e))).toPromise();return s.catch(()=>{}),await t.R,s}catch(a){const e=a,t="FirebaseError"!==e.name&&s<3;if(Zp("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Gf{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return Qf(this.L.delete())}}class Kf extends lf{constructor(e,t){super(of.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Hf(e){return"IndexedDbTransactionError"===e.name}class Wf{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Zp("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Zp("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Qf(n)}add(e){return Zp("SimpleDb","ADD",this.store.name,e,e),Qf(this.store.add(e))}get(e){return Qf(this.store.get(e)).next(t=>(void 0===t&&(t=null),Zp("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Zp("SimpleDb","DELETE",this.store.name,e),Qf(this.store.delete(e))}count(){return Zp("SimpleDb","COUNT",this.store.name),Qf(this.store.count())}j(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const e=this.cursor(n),t=[];return this.W(e,(e,n)=>{t.push(n)}).next(()=>t)}{const e=this.store.getAll(n.range);return new jf((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new jf((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}J(e,t){Zp("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.W(r,(e,t,n)=>n.delete())}X(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.W(r,t)}Z(e){const t=this.cursor({});return new jf((n,r)=>{t.onerror=e=>{const t=Xf(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}W(e,t){const n=[];return new jf((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new Gf(i),a=t(i.primaryKey,i.value,s);if(a instanceof jf){const e=a.catch(e=>(s.done(),jf.reject(e)));n.push(e)}s.isDone?r():null===s.K?i.continue():i.continue(s.K)}}).next(()=>jf.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Qf(e){return new jf((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Xf(e.target.error);n(t)}})}let Yf=!1;function Xf(e){const t=qf.S(Nn());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new lf("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Yf||(Yf=!0,setTimeout(()=>{throw e},0)),e}}return e}class Jf{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){Zp("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Zp("IndexBackiller",`Documents written: ${await this.tt.nt()}`)}catch(e){Hf(e)?Zp("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e):await $f(e)}await this.et(6e4)})}}class Zf{constructor(e,t){this.localStore=e,this.persistence=t}async nt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.st(t,e))}st(e,t){const n=new Set;let r=t,i=!0;return jf.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return Zp("IndexBackiller",`Processing collection: ${t}`),this.it(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}it(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.rt(r,n)).next(n=>(Zp("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}rt(e,t){let n=e;return t.changes.forEach((e,t)=>{const r=Mf(t);Ff(r,n)>0&&(n=r)}),new Lf(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}function tm(e){return null==e}function nm(e){return 0===e&&1/e==-1/0}function rm(e){return"number"==typeof e&&Number.isInteger(e)&&!nm(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function im(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=am(t)),t=sm(e.get(n),t);return am(t)}function sm(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="";break;case"":n+="";break;default:n+=t}}return n}function am(e){return e+""}function om(e){const t=e.length;if(sf(t>=2),2===t)return sf(""===e.charAt(0)&&""===e.charAt(1)),Cf.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&rf(),e.charAt(t+1)){case"":const n=e.substring(s,t);let a;0===i.length?a=n:(i+=n,a=i,i=""),r.push(a);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:rf()}s=t+2}return new Cf(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */em.ct=-1;const lm=["userId","batchId"];
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function um(e,t){return[e,im(t)]}function cm(e,t,n){return[e,im(t),n]}const dm={},hm=["prefixPath","collectionGroup","readTime","documentId"],pm=["prefixPath","collectionGroup","documentId"],fm=["collectionGroup","readTime","prefixPath","documentId"],mm=["canonicalId","targetId"],vm=["targetId","path"],gm=["path","targetId"],ym=["collectionId","parent"],bm=["indexId","uid"],wm=["uid","sequenceNumber"],_m=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Im=["indexId","uid","orderedDocumentKey"],Sm=["userId","collectionPath","documentId"],km=["userId","collectionPath","largestBatchId"],Tm=["userId","collectionGroup","largestBatchId"],Cm=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Em=[...Cm,"documentOverlays"],xm=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Am=xm,Nm=[...Am,"indexConfiguration","indexState","indexEntries"];
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm extends Uf{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}}function Pm(e,t){const n=af(e);return qf.M(n.ht,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rm(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Vm(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Om(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e,t){this.comparator=e,this.root=t||Fm.EMPTY}insert(e,t){return new Mm(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fm.BLACK,null,null))}remove(e){return new Mm(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fm.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Lm(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Lm(this.root,e,this.comparator,!1)}getReverseIterator(){return new Lm(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Lm(this.root,e,this.comparator,!0)}}class Lm{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fm{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Fm.RED,this.left=null!=r?r:Fm.EMPTY,this.right=null!=i?i:Fm.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Fm(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Fm.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Fm.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fm.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fm.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rf();if(this.right.isRed())throw rf();const e=this.left.check();if(e!==this.right.check())throw rf();return e+(this.isRed()?0:1)}}Fm.EMPTY=null,Fm.RED=!0,Fm.BLACK=!1,Fm.EMPTY=new class{constructor(){this.size=0}get key(){throw rf()}get value(){throw rf()}get color(){throw rf()}get left(){throw rf()}get right(){throw rf()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Fm(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Bm{constructor(e){this.comparator=e,this.data=new Mm(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Um(this.data.getIterator())}getIteratorFrom(e){return new Um(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Bm))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Bm(this.comparator);return t.data=e,t}}class Um{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $m(e){return e.hasNext()?e.getNext():void 0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this.fields=e,e.sort(xf.comparator)}static empty(){return new jm([])}unionWith(e){let t=new Bm(xf.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new jm(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _f(this.fields,e.fields,(e,t)=>e.isEqual(t))}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class qm{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new zm("Invalid base64 string: "+t):t}}(e);return new qm(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new qm(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return wf(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qm.EMPTY_BYTE_STRING=new qm("");const Gm=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Km(e){if(sf(!!e),"string"==typeof e){let t=0;const n=Gm.exec(e);if(sf(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Hm(e.seconds),nanos:Hm(e.nanos)}}function Hm(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Wm(e){return"string"==typeof e?qm.fromBase64String(e):qm.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qm(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Ym(e){const t=e.mapValue.fields.__previous_value__;return Qm(t)?Ym(t):t}function Xm(e){const t=Km(e.mapValue.fields.__local_write_time__.timestampValue);return new Sf(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{constructor(e,t,n,r,i,s,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}class Zm{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Zm("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Zm&&e.projectId===this.projectId&&e.database===this.database}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ev={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},tv={nullValue:"NULL_VALUE"};function nv(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Qm(e)?4:vv(e)?9007199254740991:10:rf()}function rv(e,t){if(e===t)return!0;const n=nv(e);if(n!==nv(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Xm(e).isEqual(Xm(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Km(e.timestampValue),r=Km(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return r=t,Wm(e.bytesValue).isEqual(Wm(r.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Hm(e.geoPointValue.latitude)===Hm(t.geoPointValue.latitude)&&Hm(e.geoPointValue.longitude)===Hm(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Hm(e.integerValue)===Hm(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Hm(e.doubleValue),r=Hm(t.doubleValue);return n===r?nm(n)===nm(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return _f(e.arrayValue.values||[],t.arrayValue.values||[],rv);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Rm(n)!==Rm(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!rv(n[i],r[i])))return!1;return!0}(e,t);default:return rf()}var r}function iv(e,t){return void 0!==(e.values||[]).find(e=>rv(e,t))}function sv(e,t){if(e===t)return 0;const n=nv(e),r=nv(t);if(n!==r)return wf(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return wf(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Hm(e.integerValue||e.doubleValue),r=Hm(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return av(e.timestampValue,t.timestampValue);case 4:return av(Xm(e),Xm(t));case 5:return wf(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Wm(e),r=Wm(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=wf(n[i],r[i]);if(0!==e)return e}return wf(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=wf(Hm(e.latitude),Hm(t.latitude));return 0!==n?n:wf(Hm(e.longitude),Hm(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=sv(n[i],r[i]);if(e)return e}return wf(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===ev.mapValue&&t===ev.mapValue)return 0;if(e===ev.mapValue)return 1;if(t===ev.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){const e=wf(r[a],s[a]);if(0!==e)return e;const t=sv(n[r[a]],i[s[a]]);if(0!==t)return t}return wf(r.length,s.length)}(e.mapValue,t.mapValue);default:throw rf()}}function av(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return wf(e,t);const n=Km(e),r=Km(t),i=wf(n.seconds,r.seconds);return 0!==i?i:wf(n.nanos,r.nanos)}function ov(e){return lv(e)}function lv(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Km(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Wm(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Af.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=lv(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${lv(e.fields[i])}`;return n+"}"}(e.mapValue):rf();var t,n}function uv(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function cv(e){return!!e&&"integerValue"in e}function dv(e){return!!e&&"arrayValue"in e}function hv(e){return!!e&&"nullValue"in e}function pv(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function fv(e){return!!e&&"mapValue"in e}function mv(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Vm(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=mv(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=mv(e.arrayValue.values[n]);return t}return Object.assign({},e)}function vv(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function gv(e){return"nullValue"in e?tv:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?uv(Zm.empty(),Af.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:rf()}function yv(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?uv(Zm.empty(),Af.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?ev:rf()}function bv(e,t){const n=sv(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function wv(e,t){const n=sv(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(e){this.value=e}static empty(){return new _v({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!fv(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mv(t)}setAll(e){let t=xf.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=mv(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());fv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rv(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];fv(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Vm(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new _v(mv(this.value))}}function Iv(e){const t=[];return Vm(e.fields,(e,n)=>{const r=new xf([e]);if(fv(n)){const e=Iv(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new jm(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class Sv{constructor(e,t,n,r,i,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new Sv(e,0,kf.min(),kf.min(),kf.min(),_v.empty(),0)}static newFoundDocument(e,t,n,r){return new Sv(e,1,t,kf.min(),n,r,0)}static newNoDocument(e,t){return new Sv(e,2,t,kf.min(),kf.min(),_v.empty(),0)}static newUnknownDocument(e,t){return new Sv(e,3,t,kf.min(),kf.min(),_v.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(kf.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_v.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_v.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=kf.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Sv&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Sv(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e,t){this.position=e,this.inclusive=t}}function Tv(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(r=s.field.isKeyField()?Af.comparator(Af.fromName(a.referenceValue),n.key):sv(a,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Cv(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!rv(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,t="asc"){this.field=e,this.dir=t}}function xv(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av{}class Nv extends Av{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Uv(e,t,n):"array-contains"===t?new qv(e,n):"in"===t?new Gv(e,n):"not-in"===t?new Kv(e,n):"array-contains-any"===t?new Hv(e,n):new Nv(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new $v(e,n):new jv(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(sv(t,this.value)):null!==t&&nv(this.value)===nv(t)&&this.matchesComparison(sv(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return rf()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class Dv extends Av{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new Dv(e,t)}matches(e){return Pv(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.lt||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(e=>e.isInequality());return null!==e?e.field:null}ft(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}function Pv(e){return"and"===e.op}function Rv(e){return"or"===e.op}function Vv(e){return Ov(e)&&Pv(e)}function Ov(e){for(const t of e.filters)if(t instanceof Dv)return!1;return!0}function Mv(e){if(e instanceof Nv)return e.field.canonicalString()+e.op.toString()+ov(e.value);if(Vv(e))return e.filters.map(e=>Mv(e)).join(",");{const t=e.filters.map(e=>Mv(e)).join(",");return`${e.op}(${t})`}}function Lv(e,t){return e instanceof Nv?(n=e,(r=t)instanceof Nv&&n.op===r.op&&n.field.isEqual(r.field)&&rv(n.value,r.value)):e instanceof Dv?function(e,t){return t instanceof Dv&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Lv(n,t.filters[r]),!0)}(e,t):void rf();var n,r}function Fv(e,t){const n=e.filters.concat(t);return Dv.create(n,e.op)}function Bv(e){return e instanceof Nv?`${(t=e).field.canonicalString()} ${t.op} ${ov(t.value)}`:e instanceof Dv?function(e){return e.op.toString()+" {"+e.getFilters().map(Bv).join(" ,")+"}"}(e):"Filter";var t}class Uv extends Nv{constructor(e,t,n){super(e,t,n),this.key=Af.fromName(n.referenceValue)}matches(e){const t=Af.comparator(e.key,this.key);return this.matchesComparison(t)}}class $v extends Nv{constructor(e,t){super(e,"in",t),this.keys=zv("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class jv extends Nv{constructor(e,t){super(e,"not-in",t),this.keys=zv("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function zv(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Af.fromName(e.referenceValue))}class qv extends Nv{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return dv(t)&&iv(t.arrayValue,this.value)}}class Gv extends Nv{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&iv(this.value.arrayValue,t)}}class Kv extends Nv{constructor(e,t){super(e,"not-in",t)}matches(e){if(iv(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!iv(this.value.arrayValue,t)}}class Hv extends Nv{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!dv(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>iv(this.value.arrayValue,e))}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,t=null,n=[],r=[],i=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=a,this.dt=null}}function Qv(e,t=null,n=[],r=[],i=null,s=null,a=null){return new Wv(e,t,n,r,i,s,a)}function Yv(e){const t=af(e);if(null===t.dt){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Mv(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),tm(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>ov(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>ov(e)).join(",")),t.dt=e}return t.dt}function Xv(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!xv(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Lv(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Cv(e.startAt,t.startAt)&&Cv(e.endAt,t.endAt)}function Jv(e){return Af.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Zv(e,t){return e.filters.filter(e=>e instanceof Nv&&e.field.isEqual(t))}function eg(e,t,n){let r=tv,i=!0;for(const s of Zv(e,t)){let e=tv,t=!0;switch(s.op){case"<":case"<=":e=gv(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=tv}bv({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];bv({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function tg(e,t,n){let r=ev,i=!0;for(const s of Zv(e,t)){let e=ev,t=!0;switch(s.op){case">=":case">":e=yv(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=ev}wv({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];wv({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,t=null,n=[],r=[],i=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.wt=null,this._t=null,this.startAt,this.endAt}}function rg(e,t,n,r,i,s,a,o){return new ng(e,t,n,r,i,s,a,o)}function ig(e){return new ng(e)}function sg(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ag(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function og(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function lg(e){return null!==e.collectionGroup}function ug(e){const t=af(e);if(null===t.wt){t.wt=[];const e=og(t),n=ag(t);if(null!==e&&null===n)e.isKeyField()||t.wt.push(new Ev(e)),t.wt.push(new Ev(xf.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.wt.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.wt.push(new Ev(xf.keyField(),e))}}}return t.wt}function cg(e){const t=af(e);if(!t._t)if("F"===t.limitType)t._t=Qv(t.path,t.collectionGroup,ug(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of ug(t)){const t="desc"===i.dir?"asc":"desc";e.push(new Ev(i.field,t))}const n=t.endAt?new kv(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new kv(t.startAt.position,t.startAt.inclusive):null;t._t=Qv(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t._t}function dg(e,t){t.getFirstInequalityField(),og(e);const n=e.filters.concat([t]);return new ng(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function hg(e,t,n){return new ng(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function pg(e,t){return Xv(cg(e),cg(t))&&e.limitType===t.limitType}function fg(e){return`${Yv(cg(e))}|lt:${e.limitType}`}function mg(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Bv(e)).join(", ")}]`),tm(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>ov(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>ov(e)).join(",")),`Target(${t})`}(cg(e))}; limitType=${e.limitType})`}function vg(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Af.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of ug(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){const r=Tv(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,ug(n),r)||n.endAt&&!function(e,t,n){const r=Tv(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,ug(n),r)));var n,r}function gg(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function yg(e){return(t,n)=>{let r=!1;for(const i of ug(e)){const e=bg(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function bg(e,t,n){const r=e.field.isKeyField()?Af.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?sv(r,i):rf()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return rf()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Vm(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Om(this.inner)}size(){return this.innerSize}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _g=new Mm(Af.comparator);function Ig(){return _g}const Sg=new Mm(Af.comparator);function kg(...e){let t=Sg;for(const n of e)t=t.insert(n.key,n);return t}function Tg(e){let t=Sg;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Cg(){return xg()}function Eg(){return xg()}function xg(){return new wg(e=>e.toString(),(e,t)=>e.isEqual(t))}const Ag=new Mm(Af.comparator),Ng=new Bm(Af.comparator);function Dg(...e){let t=Ng;for(const n of e)t=t.add(n);return t}const Pg=new Bm(wf);function Rg(){return Pg}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nm(t)?"-0":t}}function Og(e){return{integerValue:""+e}}function Mg(e,t){return rm(t)?Og(t):Vg(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(){this._=void 0}}function Fg(e,t,n){return e instanceof $g?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Qm(t)&&(t=Ym(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof jg?zg(e,t):e instanceof qg?Gg(e,t):function(e,t){const n=Ug(e,t),r=Hg(n)+Hg(e.gt);return cv(n)&&cv(e.gt)?Og(r):Vg(e.serializer,r)}(e,t)}function Bg(e,t,n){return e instanceof jg?zg(e,t):e instanceof qg?Gg(e,t):n}function Ug(e,t){return e instanceof Kg?cv(r=t)||(n=r)&&"doubleValue"in n?t:{integerValue:0}:null;var n,r}class $g extends Lg{}class jg extends Lg{constructor(e){super(),this.elements=e}}function zg(e,t){const n=Wg(t);for(const r of e.elements)n.some(e=>rv(e,r))||n.push(r);return{arrayValue:{values:n}}}class qg extends Lg{constructor(e){super(),this.elements=e}}function Gg(e,t){let n=Wg(t);for(const r of e.elements)n=n.filter(e=>!rv(e,r));return{arrayValue:{values:n}}}class Kg extends Lg{constructor(e,t){super(),this.serializer=e,this.gt=t}}function Hg(e){return Hm(e.integerValue||e.doubleValue)}function Wg(e){return dv(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,t){this.field=e,this.transform=t}}class Yg{constructor(e,t){this.version=e,this.transformResults=t}}class Xg{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xg}static exists(e){return new Xg(void 0,e)}static updateTime(e){return new Xg(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jg(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Zg{}function ey(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new cy(e.key,Xg.none()):new sy(e.key,e.data,Xg.none());{const n=e.data,r=_v.empty();let i=new Bm(xf.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new ay(e.key,r,new jm(i.toArray()),Xg.none())}}function ty(e,t,n){var r;e instanceof sy?function(e,t,n){const r=e.value.clone(),i=ly(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof ay?function(e,t,n){if(!Jg(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=ly(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(oy(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):(r=n,t.convertToNoDocument(r.version).setHasCommittedMutations())}function ny(e,t,n,r){return e instanceof sy?function(e,t,n,r){if(!Jg(e.precondition,t))return n;const i=e.value.clone(),s=uy(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof ay?function(e,t,n,r){if(!Jg(e.precondition,t))return n;const i=uy(e.fieldTransforms,r,t),s=t.data;return s.setAll(oy(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):(i=t,s=n,Jg(e.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):s);var i,s}function ry(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Ug(r.transform,e||null);null!=i&&(null===n&&(n=_v.empty()),n.set(r.field,i))}return n||null}function iy(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&_f(n,r,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof jg&&r instanceof jg||n instanceof qg&&r instanceof qg?_f(n.elements,r.elements,rv):n instanceof Kg&&r instanceof Kg?rv(n.gt,r.gt):n instanceof $g&&r instanceof $g);var n,r}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,r}class sy extends Zg{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ay extends Zg{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function oy(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function ly(e,t,n){const r=new Map;sf(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);r.set(s.field,Bg(a,o,n[i]))}return r}function uy(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Fg(e,s,t))}return r}class cy extends Zg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dy extends Zg{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&ty(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=ny(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=ny(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Eg();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let a=this.applyToLocalView(s,i.mutatedFields);a=t.has(r.key)?null:a;const o=ey(s,a);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(kf.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Dg())}isEqual(e){return this.batchId===e.batchId&&_f(this.mutations,e.mutations,(e,t)=>iy(e,t))&&_f(this.baseMutations,e.baseMutations,(e,t)=>iy(e,t))}}class py{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){sf(e.mutations.length===n.length);let r=Ag;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new py(e,t,n,r)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(e,t){this.count=e,this.unchangedNames=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vy,gy;function yy(e){switch(e){default:return rf();case of.CANCELLED:case of.UNKNOWN:case of.DEADLINE_EXCEEDED:case of.RESOURCE_EXHAUSTED:case of.INTERNAL:case of.UNAVAILABLE:case of.UNAUTHENTICATED:return!1;case of.INVALID_ARGUMENT:case of.NOT_FOUND:case of.ALREADY_EXISTS:case of.PERMISSION_DENIED:case of.FAILED_PRECONDITION:case of.ABORTED:case of.OUT_OF_RANGE:case of.UNIMPLEMENTED:case of.DATA_LOSS:return!0}}function by(e){if(void 0===e)return ef("GRPC error has no .code"),of.UNKNOWN;switch(e){case vy.OK:return of.OK;case vy.CANCELLED:return of.CANCELLED;case vy.UNKNOWN:return of.UNKNOWN;case vy.DEADLINE_EXCEEDED:return of.DEADLINE_EXCEEDED;case vy.RESOURCE_EXHAUSTED:return of.RESOURCE_EXHAUSTED;case vy.INTERNAL:return of.INTERNAL;case vy.UNAVAILABLE:return of.UNAVAILABLE;case vy.UNAUTHENTICATED:return of.UNAUTHENTICATED;case vy.INVALID_ARGUMENT:return of.INVALID_ARGUMENT;case vy.NOT_FOUND:return of.NOT_FOUND;case vy.ALREADY_EXISTS:return of.ALREADY_EXISTS;case vy.PERMISSION_DENIED:return of.PERMISSION_DENIED;case vy.FAILED_PRECONDITION:return of.FAILED_PRECONDITION;case vy.ABORTED:return of.ABORTED;case vy.OUT_OF_RANGE:return of.OUT_OF_RANGE;case vy.UNIMPLEMENTED:return of.UNIMPLEMENTED;case vy.DATA_LOSS:return of.DATA_LOSS;default:return rf()}}(gy=vy||(vy={}))[gy.OK=0]="OK",gy[gy.CANCELLED=1]="CANCELLED",gy[gy.UNKNOWN=2]="UNKNOWN",gy[gy.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gy[gy.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gy[gy.NOT_FOUND=5]="NOT_FOUND",gy[gy.ALREADY_EXISTS=6]="ALREADY_EXISTS",gy[gy.PERMISSION_DENIED=7]="PERMISSION_DENIED",gy[gy.UNAUTHENTICATED=16]="UNAUTHENTICATED",gy[gy.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gy[gy.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gy[gy.ABORTED=10]="ABORTED",gy[gy.OUT_OF_RANGE=11]="OUT_OF_RANGE",gy[gy.UNIMPLEMENTED=12]="UNIMPLEMENTED",gy[gy.INTERNAL=13]="INTERNAL",gy[gy.UNAVAILABLE=14]="UNAVAILABLE",gy[gy.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class wy{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return _y}static getOrCreateInstance(){return null===_y&&(_y=new wy),_y}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let _y=null;
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(){return new TextEncoder}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy=new Kp([4294967295,4294967295],0);function ky(e){const t=Iy().encode(e),n=new Gp;return n.update(t),new Uint8Array(n.digest())}function Ty(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Kp([n,r],0),new Kp([i,s],0)]}class Cy{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ey(`Invalid padding: ${t}`);if(n<0)throw new Ey(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Ey(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Ey(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Kp.fromNumber(this.It)}Et(e,t,n){let r=e.add(t.multiply(Kp.fromNumber(n)));return 1===r.compare(Sy)&&(r=new Kp([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Tt).toNumber()}At(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}vt(e){if(0===this.It)return!1;const t=ky(e),[n,r]=Ty(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,r,i);if(!this.At(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Cy(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.It)return;const t=ky(e),[n,r]=Ty(t);for(let i=0;i<this.hashCount;i++){const e=this.Et(n,r,i);this.Rt(e)}}Rt(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ey extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Ay.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new xy(kf.min(),r,new Mm(wf),Ig(),Dg())}}class Ay{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Ay(n,t,Dg(),Dg(),Dg())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,t,n,r){this.Pt=e,this.removedTargetIds=t,this.key=n,this.bt=r}}class Dy{constructor(e,t){this.targetId=e,this.Vt=t}}class Py{constructor(e,t,n=qm.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Ry{constructor(){this.St=0,this.Dt=My(),this.Ct=qm.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return 0!==this.St}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=Dg(),t=Dg(),n=Dg();return this.Dt.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:rf()}}),new Ay(this.Ct,this.xt,e,t,n)}Ft(){this.Nt=!1,this.Dt=My()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class Vy{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Ig(),this.zt=Oy(),this.Wt=new Mm(wf)}Ht(e){for(const t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(const t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{const n=this.Zt(t);switch(e.state){case 0:this.te(t)&&n.$t(e.resumeToken);break;case 1:n.Ut(),n.kt||n.Ft(),n.$t(e.resumeToken);break;case 2:n.Ut(),n.kt||this.removeTarget(t);break;case 3:this.te(t)&&(n.Kt(),n.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),n.$t(e.resumeToken));break;default:rf()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((e,n)=>{this.te(n)&&t(n)})}ne(e){var t;const n=e.targetId,r=e.Vt.count,i=this.se(n);if(i){const s=i.target;if(Jv(s))if(0===r){const e=new Af(s.path);this.Yt(n,e,Sv.newNoDocument(e,kf.min()))}else sf(1===r);else{const i=this.ie(n);if(i!==r){const r=this.re(e,i);if(0!==r){this.ee(n);const e=2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(n,e)}null===(t=wy.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,i,s,a,o,l;const u={localCacheCount:t,existenceFilterCount:n.count},c=n.unchangedNames;return c&&(u.bloomFilter={applied:0===e,hashCount:null!==(r=null==c?void 0:c.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(a=null===(s=null===(i=null==c?void 0:c.bits)||void 0===i?void 0:i.bitmap)||void 0===s?void 0:s.length)&&void 0!==a?a:0,padding:null!==(l=null===(o=null==c?void 0:c.bits)||void 0===o?void 0:o.padding)&&void 0!==l?l:0}),u}(r,i,e.Vt))}}}}re(e,t){const{unchangedNames:n,count:r}=e.Vt;if(!n||!n.bits)return 1;const{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=n;let o,l;try{o=Wm(i).toUint8Array()}catch(u){if(u instanceof zm)return tf("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw u}try{l=new Cy(o,s,a)}catch(u){return tf(u instanceof Ey?"BloomFilter error: ":"Applying bloom filter failed: ",u),1}return 0===l.It?1:r!==t-this.oe(e.targetId,l)?2:0}oe(e,t){const n=this.Gt.getRemoteKeysForTarget(e);let r=0;return n.forEach(n=>{const i=this.Gt.ue(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;t.vt(s)||(this.Yt(e,n,null),r++)}),r}ce(e){const t=new Map;this.Qt.forEach((n,r)=>{const i=this.se(r);if(i){if(n.current&&Jv(i.target)){const t=new Af(i.target.path);null!==this.jt.get(t)||this.ae(r,t)||this.Yt(r,t,Sv.newNoDocument(t,e))}n.Mt&&(t.set(r,n.Ot()),n.Ft())}});let n=Dg();this.zt.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.se(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.jt.forEach((t,n)=>n.setReadTime(e));const r=new xy(e,t,this.Wt,this.jt,n);return this.jt=Ig(),this.zt=Oy(),this.Wt=new Mm(wf),r}Jt(e,t){if(!this.te(e))return;const n=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,n),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,n){if(!this.te(e))return;const r=this.Zt(e);this.ae(e,t)?r.Bt(t,1):r.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),n&&(this.jt=this.jt.insert(t,n))}removeTarget(e){this.Qt.delete(e)}ie(e){const t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new Ry,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new Bm(wf),this.zt=this.zt.insert(e,t)),t}te(e){const t=null!==this.se(e);return t||Zp("WatchChangeAggregator","Detected inactive target",e),t}se(e){const t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Ry),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}}function Oy(){return new Mm(Af.comparator)}function My(){return new Mm(Af.comparator)}const Ly=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Fy=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),By=(()=>({and:"AND",or:"OR"}))();class Uy{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $y(e,t){return e.useProto3Json||tm(t)?t:{value:t}}function jy(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function zy(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function qy(e,t){return jy(e,t.toTimestamp())}function Gy(e){return sf(!!e),kf.fromTimestamp(function(e){const t=Km(e);return new Sf(t.seconds,t.nanos)}(e))}function Ky(e,t){return(n=e,new Cf(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function Hy(e){const t=Cf.fromString(e);return sf(mb(t)),t}function Wy(e,t){return Ky(e.databaseId,t.path)}function Qy(e,t){const n=Hy(t);if(n.get(1)!==e.databaseId.projectId)throw new lf(of.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new lf(of.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Af(Zy(n))}function Yy(e,t){return Ky(e.databaseId,t)}function Xy(e){const t=Hy(e);return 4===t.length?Cf.emptyPath():Zy(t)}function Jy(e){return new Cf(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Zy(e){return sf(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function eb(e,t,n){return{name:Wy(e,t),fields:n.value.mapValue.fields}}function tb(e,t,n){const r=Qy(e,t.name),i=Gy(t.updateTime),s=t.createTime?Gy(t.createTime):kf.min(),a=new _v({mapValue:{fields:t.fields}}),o=Sv.newFoundDocument(r,i,s,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function nb(e,t){let n;if(t instanceof sy)n={update:eb(e,t.key,t.value)};else if(t instanceof cy)n={delete:Wy(e,t.key)};else if(t instanceof ay)n={update:eb(e,t.key,t.data),updateMask:fb(t.fieldMask)};else{if(!(t instanceof dy))return rf();n={verify:Wy(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof $g)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof jg)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof qg)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Kg)return{fieldPath:t.field.canonicalString(),increment:n.gt};throw rf()}(0,e))),t.precondition.isNone||(n.currentDocument=(r=e,void 0!==(i=t.precondition).updateTime?{updateTime:qy(r,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:rf())),n;var r,i}function rb(e,t){const n=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?Xg.updateTime(Gy(i.updateTime)):void 0!==i.exists?Xg.exists(i.exists):Xg.none():Xg.none(),r=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let n=null;if("setToServerValue"in t)sf("REQUEST_TIME"===t.setToServerValue),n=new $g;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new jg(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new qg(e)}else"increment"in t?n=new Kg(e,t.increment):rf();const r=xf.fromServerFormat(t.fieldPath);return new Qg(r,n)}(e,t)):[];var i;if(t.update){t.update.name;const i=Qy(e,t.update.name),s=new _v({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new jm(t.map(e=>xf.fromServerFormat(e)))}(t.updateMask);return new ay(i,s,e,n,r)}return new sy(i,s,n,r)}if(t.delete){const r=Qy(e,t.delete);return new cy(r,n)}if(t.verify){const r=Qy(e,t.verify);return new dy(r,n)}return rf()}function ib(e,t){return{documents:[Yy(e,t.path)]}}function sb(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Yy(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Yy(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0!==e.length)return pb(Dv.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map(e=>{return{field:db((t=e).field),direction:lb(t.dir)};var t})}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const a=$y(e,t.limit);var o,l;return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt={before:!(l=t.endAt).inclusive,values:l.position}),n}function ab(e){let t=Xy(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){sf(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=ob(e);return t instanceof Dv&&Vv(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=n.orderBy.map(e=>{return new Ev(hb((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,tm(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new kv(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new kv(n,t)}(n.endAt)),rg(t,i,a,s,o,"F",l,u)}function ob(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=hb(e.unaryFilter.field);return Nv.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=hb(e.unaryFilter.field);return Nv.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=hb(e.unaryFilter.field);return Nv.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=hb(e.unaryFilter.field);return Nv.create(i,"!=",{nullValue:"NULL_VALUE"});default:return rf()}}(e):void 0!==e.fieldFilter?(t=e,Nv.create(hb(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rf()}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return Dv.create(e.compositeFilter.filters.map(e=>ob(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return rf()}}(e.compositeFilter.op))}(e):rf();var t}function lb(e){return Ly[e]}function ub(e){return Fy[e]}function cb(e){return By[e]}function db(e){return{fieldPath:e.canonicalString()}}function hb(e){return xf.fromServerFormat(e.fieldPath)}function pb(e){return e instanceof Nv?function(e){if("=="===e.op){if(pv(e.value))return{unaryFilter:{field:db(e.field),op:"IS_NAN"}};if(hv(e.value))return{unaryFilter:{field:db(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(pv(e.value))return{unaryFilter:{field:db(e.field),op:"IS_NOT_NAN"}};if(hv(e.value))return{unaryFilter:{field:db(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:db(e.field),op:ub(e.op),value:e.value}}}(e):e instanceof Dv?function(e){const t=e.getFilters().map(e=>pb(e));return 1===t.length?t[0]:{compositeFilter:{op:cb(e.op),filters:t}}}(e):rf()}function fb(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function mb(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(e,t,n,r,i=kf.min(),s=kf.min(),a=qm.EMPTY_BYTE_STRING,o=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new vb(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new vb(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new vb(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new vb(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{constructor(e){this.fe=e}}function yb(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:bb(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document={name:Wy(i=e.fe,(s=t).key),fields:s.data.value.mapValue.fields,updateTime:jy(i,s.version.toTimestamp()),createTime:jy(i,s.createTime.toTimestamp())};else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:wb(t.version)};else{if(!t.isUnknownDocument())return rf();r.unknownDocument={path:n.path.toArray(),version:wb(t.version)}}var i,s;return r}function bb(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function wb(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function _b(e){const t=new Sf(e.seconds,e.nanoseconds);return kf.fromTimestamp(t)}function Ib(e,t){const n=(t.baseMutations||[]).map(t=>rb(e.fe,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map(t=>rb(e.fe,t)),i=Sf.fromMillis(t.localWriteTimeMs);return new hy(t.batchId,i,n,r)}function Sb(e){const t=_b(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?_b(e.lastLimboFreeSnapshotVersion):kf.min();let r;var i;return void 0!==e.query.documents?(sf(1===(i=e.query).documents.length),r=cg(ig(Xy(i.documents[0])))):r=cg(ab(e.query)),new vb(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,qm.fromBase64String(e.resumeToken))}function kb(e,t){const n=wb(t.snapshotVersion),r=wb(t.lastLimboFreeSnapshotVersion);let i;i=Jv(t.target)?ib(e.fe,t.target):sb(e.fe,t.target);const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Yv(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Tb(e){const t=ab({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?hg(t,t.limit,"L"):t}function Cb(e,t){return new fy(t.largestBatchId,rb(e.fe,t.overlayMutation))}function Eb(e,t){const n=t.path.lastSegment();return[e,im(t.path.popLast()),n]}function xb(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:wb(r.readTime),documentKey:im(r.documentKey.path),largestBatchId:r.largestBatchId}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{getBundleMetadata(e,t){return Nb(e).get(t).next(e=>{if(e)return{id:(t=e).bundleId,createTime:_b(t.createTime),version:t.version};var t})}saveBundleMetadata(e,t){return Nb(e).put({bundleId:(n=t).id,createTime:wb(Gy(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return Db(e).get(t).next(e=>{if(e)return{name:(t=e).name,query:Tb(t.bundledQuery),readTime:_b(t.readTime)};var t})}saveNamedQuery(e,t){return Db(e).put({name:(n=t).name,readTime:wb(Gy(n.readTime)),bundledQuery:n.bundledQuery});var n}}function Nb(e){return Pm(e,"bundles")}function Db(e){return Pm(e,"namedQueries")}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){const n=t.uid||"";return new Pb(e,n)}getOverlay(e,t){return Rb(e).get(Eb(this.userId,t)).next(e=>e?Cb(this.serializer,e):null)}getOverlays(e,t){const n=Cg();return jf.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((n,i)=>{const s=new fy(t,i);r.push(this.we(e,s))}),jf.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(e=>r.add(im(e.getCollectionPath())));const i=[];return r.forEach(t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(Rb(e).J("collectionPathOverlayIndex",r))}),jf.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Cg(),i=im(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Rb(e).j("collectionPathOverlayIndex",s).next(e=>{for(const t of e){const e=Cb(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const i=Cg();let s;const a=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Rb(e).X({index:"collectionGroupOverlayIndex",range:a},(e,t,n)=>{const a=Cb(this.serializer,t);i.size()<r||a.largestBatchId===s?(i.set(a.getKey(),a),s=a.largestBatchId):n.done()}).next(()=>i)}we(e,t){return Rb(e).put(function(e,t,n){const[r,i,s]=Eb(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:nb(e.fe,n.mutation)}}(this.serializer,this.userId,t))}}function Rb(e){return Pm(e,"documentOverlays")}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(Hm(e.integerValue));else if("doubleValue"in e){const n=Hm(e.doubleValue);isNaN(n)?this.ye(t,13):(this.ye(t,15),nm(n)?t.pe(0):t.pe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ye(t,20),"string"==typeof n?t.Ie(n):(t.Ie(`${n.seconds||""}`),t.pe(n.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(Wm(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ye(t,45),t.pe(n.latitude||0),t.pe(n.longitude||0)}else"mapValue"in e?vv(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):rf()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){const n=e.fields||{};this.ye(t,55);for(const r of Object.keys(n))this.Te(r,t),this.me(n[r],t)}Pe(e,t){const n=e.values||[];this.ye(t,50);for(const r of n)this.me(r,t)}ve(e,t){this.ye(t,37),Af.fromName(e).path.forEach(e=>{this.ye(t,60),this.be(e,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}}function Ob(e){if(0===e)return 8;let t=0;return!(e>>4)&&(t+=4,e<<=4),!(e>>6)&&(t+=2,e<<=2),!(e>>7)&&(t+=1),t}function Mb(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Ob(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Vb.Ve=new Vb;class Lb{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.De(n.value),n=t.next();this.Ce()}xe(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ne(n.value),n=t.next();this.ke()}Me(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.De(e);else if(e<2048)this.De(960|e>>>6),this.De(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.De(480|e>>>12),this.De(128|63&e>>>6),this.De(128|63&e);else{const e=t.codePointAt(0);this.De(240|e>>>18),this.De(128|63&e>>>12),this.De(128|63&e>>>6),this.De(128|63&e)}}this.Ce()}$e(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ne(e);else if(e<2048)this.Ne(960|e>>>6),this.Ne(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ne(480|e>>>12),this.Ne(128|63&e>>>6),this.Ne(128|63&e);else{const e=t.codePointAt(0);this.Ne(240|e>>>18),this.Ne(128|63&e>>>12),this.Ne(128|63&e>>>6),this.Ne(128|63&e)}}this.ke()}Oe(e){const t=this.Fe(e),n=Mb(t);this.Be(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Le(e){const t=this.Fe(e),n=Mb(t);this.Be(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}De(e){const t=255&e;0===t?(this.Ue(0),this.Ue(255)):255===t?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){const t=255&e;0===t?(this.Ge(0),this.Ge(255)):255===t?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Fb{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class Bb{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class Ub{constructor(){this.je=new Lb,this.ze=new Fb(this.je),this.We=new Bb(this.je)}seed(e){this.je.seed(e)}He(e){return 0===e?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Je(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new $b(this.indexId,this.documentKey,this.arrayValue,n)}}function jb(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=zb(e.arrayValue,t.arrayValue),0!==n?n:(n=zb(e.directionalValue,t.directionalValue),0!==n?n:Af.comparator(e.documentKey,t.documentKey)))}function zb(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const t of e.filters){const e=t;e.isInequality()?this.Ze=e:this.Xe.push(e)}}tn(e){sf(e.collectionGroup===this.collectionId);const t=Df(e);if(void 0!==t&&!this.en(t))return!1;const n=Pf(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.en(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(void 0!==this.Ze){if(!r.has(this.Ze.field.canonicalString())){const e=n[i];if(!this.nn(this.Ze,e)||!this.sn(this.Ye[s++],e))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.Ye.length||!this.sn(this.Ye[s++],e))return!1}return!0}en(e){for(const t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(e){var t,n;if(sf(e instanceof Nv||e instanceof Dv),e instanceof Nv){if(e instanceof Gv){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(t=>Nv.create(e.field,"==",t)))||[];return Dv.create(r,"or")}return e}const r=e.filters.map(e=>Gb(e));return Dv.create(r,e.op)}function Kb(e){if(0===e.getFilters().length)return[];const t=Yb(Gb(e));return sf(Qb(t)),Hb(t)||Wb(t)?[t]:t.getFilters()}function Hb(e){return e instanceof Nv}function Wb(e){return e instanceof Dv&&Vv(e)}function Qb(e){return Hb(e)||Wb(e)||function(e){if(e instanceof Dv&&Rv(e)){for(const t of e.getFilters())if(!Hb(t)&&!Wb(t))return!1;return!0}return!1}(e)}function Yb(e){if(sf(e instanceof Nv||e instanceof Dv),e instanceof Nv)return e;if(1===e.filters.length)return Yb(e.filters[0]);const t=e.filters.map(e=>Yb(e));let n=Dv.create(t,e.op);return n=Zb(n),Qb(n)?n:(sf(n instanceof Dv),sf(Pv(n)),sf(n.filters.length>1),n.filters.reduce((e,t)=>Xb(e,t)))}function Xb(e,t){let n;return sf(e instanceof Nv||e instanceof Dv),sf(t instanceof Nv||t instanceof Dv),n=e instanceof Nv?t instanceof Nv?(r=e,i=t,Dv.create([r,i],"and")):Jb(e,t):t instanceof Nv?Jb(t,e):function(e,t){if(sf(e.filters.length>0&&t.filters.length>0),Pv(e)&&Pv(t))return Fv(e,t.getFilters());const n=Rv(e)?e:t,r=Rv(e)?t:e,i=n.filters.map(e=>Xb(e,r));return Dv.create(i,"or")}(e,t),Zb(n);var r,i}function Jb(e,t){if(Pv(t))return Fv(t,e.getFilters());{const n=t.filters.map(t=>Xb(e,t));return Dv.create(n,"or")}}function Zb(e){if(sf(e instanceof Nv||e instanceof Dv),e instanceof Nv)return e;const t=e.getFilters();if(1===t.length)return Zb(t[0]);if(Ov(e))return e;const n=t.map(e=>Zb(e)),r=[];return n.forEach(t=>{t instanceof Nv?r.push(t):t instanceof Dv&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:Dv.create(r,e.op)
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class ew{constructor(){this.rn=new tw}addToCollectionParentIndex(e,t){return this.rn.add(t),jf.resolve()}getCollectionParents(e,t){return jf.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return jf.resolve()}deleteFieldIndex(e,t){return jf.resolve()}getDocumentsMatchingTarget(e,t){return jf.resolve(null)}getIndexType(e,t){return jf.resolve(0)}getFieldIndexes(e,t){return jf.resolve([])}getNextCollectionGroupToUpdate(e){return jf.resolve(null)}getMinOffset(e,t){return jf.resolve(Lf.min())}getMinOffsetFromCollectionGroup(e,t){return jf.resolve(Lf.min())}updateCollectionGroup(e,t,n){return jf.resolve()}updateIndexEntries(e,t){return jf.resolve()}}class tw{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Bm(Cf.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Bm(Cf.comparator)).toArray()}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw=new Uint8Array(0);class rw{constructor(e,t){this.user=e,this.databaseId=t,this.on=new tw,this.un=new wg(e=>Yv(e),(e,t)=>Xv(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});const i={collectionId:n,parent:im(r)};return iw(e).put(i)}return jf.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[If(t),""],!1,!0);return iw(e).j(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(om(r.parent))}return n})}addFieldIndex(e,t){const n=aw(e),r={indexId:(i=t).indexId,collectionGroup:i.collectionGroup,fields:i.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};var i;delete r.indexId;const s=n.add(r);if(t.indexState){const n=ow(e);return s.next(e=>{n.put(xb(e,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=aw(e),r=ow(e),i=sw(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const n=sw(e);let r=!0;const i=new Map;return jf.forEach(this.cn(t),t=>this.an(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(r){let e=Dg();const r=[];return jf.forEach(i,(i,s)=>{var a;Zp("IndexedDbIndexManager",`Using index ${a=i,`id=${a.indexId}|cg=${a.collectionGroup}|f=${a.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`} to execute ${Yv(t)}`);const o=function(e,t){const n=Df(t);if(void 0===n)return null;for(const r of Zv(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),l=function(e,t){const n=new Map;for(const r of Pf(t))for(const t of Zv(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of Pf(t)){const t=0===i.kind?eg(e,i.fieldPath,e.startAt):tg(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new kv(n,r)}(s,i),c=function(e,t){const n=[];let r=!0;for(const i of Pf(t)){const t=0===i.kind?tg(e,i.fieldPath,e.endAt):eg(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new kv(n,r)}(s,i),d=this.hn(i,s,u),h=this.hn(i,s,c),p=this.ln(i,s,l),f=this.fn(i.indexId,o,d,u.inclusive,h,c.inclusive,p);return jf.forEach(f,i=>n.H(i,t.limit).next(t=>{t.forEach(t=>{const n=Af.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}return jf.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:Kb(Dv.create(e.filters,"and")).map(t=>Qv(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,n,r,i,s,a){const o=(null!=t?t.length:1)*Math.max(n.length,i.length),l=o/(null!=t?t.length:1),u=[];for(let c=0;c<o;++c){const o=t?this.dn(t[c/l]):nw,d=this.wn(e,o,n[c%l],r),h=this._n(e,o,i[c%l],s),p=a.map(t=>this.wn(e,o,t,!0));u.push(...this.createRange(d,h,p))}return u}wn(e,t,n,r){const i=new $b(e,Af.empty(),t,n);return r?i:i.Je()}_n(e,t,n,r){const i=new $b(e,Af.empty(),t,n);return r?i.Je():i}an(e,t){const n=new qb(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(const r of e)n.tn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2;const r=this.cn(t);return jf.forEach(r,t=>this.an(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new Bm(xf.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>null!==t.limit&&r.length>1&&2===n?1:n)}mn(e,t){const n=new Ub;for(const r of Pf(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.He(r.kind);Vb.Ve._e(e,i)}return n.Qe()}dn(e){const t=new Ub;return Vb.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){const n=new Ub;return Vb.Ve._e(uv(this.databaseId,t),n.He(function(e){const t=Pf(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Qe()}ln(e,t,n){if(null===n)return[];let r=[];r.push(new Ub);let i=0;for(const s of Pf(e)){const e=n[i++];for(const n of r)if(this.yn(t,s.fieldPath)&&dv(e))r=this.pn(r,s,e);else{const t=n.He(s.kind);Vb.Ve._e(e,t)}}return this.In(r)}hn(e,t,n){return this.ln(e,t,n.position)}In(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Qe();return t}pn(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new Ub;n.seed(e.Qe()),Vb.Ve._e(s,n.He(t.kind)),i.push(n)}return i}yn(e,t){return!!e.filters.find(e=>e instanceof Nv&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=aw(e),r=ow(e);return(t?n.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.j()).next(e=>{const t=[];return jf.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){const n=t?new Vf(t.sequenceNumber,new Lf(_b(t.readTime),new Af(om(t.documentKey)),t.largestBatchId)):Vf.empty(),r=e.fields.map(([e,t])=>new Rf(xf.fromServerFormat(e),t));return new Nf(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:wf(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=aw(e),i=ow(e);return this.Tn(e).next(e=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(t=>jf.forEach(t,t=>i.put(xb(t.indexId,this.user,e,n)))))}updateIndexEntries(e,t){const n=new Map;return jf.forEach(t,(t,r)=>{const i=n.get(t.collectionGroup);return(i?jf.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),jf.forEach(i,n=>this.En(e,t,n).next(t=>{const i=this.An(r,n);return t.isEqual(i)?jf.resolve():this.vn(e,r,n,t,i)}))))})}Rn(e,t,n,r){return sw(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.gn(n,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,n,r){return sw(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.gn(n,t.key),t.key.path.toArray()])}En(e,t,n){const r=sw(e);let i=new Bm(jb);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.gn(n,t)])},(e,r)=>{i=i.add(new $b(n.indexId,t,r.arrayValue,r.directionalValue))}).next(()=>i)}An(e,t){let n=new Bm(jb);const r=this.mn(t,e);if(null==r)return n;const i=Df(t);if(null!=i){const s=e.data.field(i.fieldPath);if(dv(s))for(const i of s.arrayValue.values||[])n=n.add(new $b(t.indexId,e.key,this.dn(i),r))}else n=n.add(new $b(t.indexId,e.key,nw,r));return n}vn(e,t,n,r,i){Zp("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),a=t.getIterator();let o=$m(s),l=$m(a);for(;o||l;){let e=!1,t=!1;if(o&&l){const r=n(o,l);r<0?t=!0:r>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(r(l),l=$m(a)):t?(i(o),o=$m(s)):(o=$m(s),l=$m(a))}}(r,i,jb,r=>{s.push(this.Rn(e,t,n,r))},r=>{s.push(this.Pn(e,t,n,r))}),jf.waitFor(s)}Tn(e){let t=1;return ow(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>jb(e,t)).filter((e,t,n)=>!t||0!==jb(e,n[t-1]));const r=[];r.push(e);for(const s of n){const n=jb(s,e),i=jb(s,t);if(0===n)r[0]=e.Je();else if(n>0&&i<0)r.push(s),r.push(s.Je());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.bn(r[s],r[s+1]))return[];const e=[r[s].indexId,this.uid,r[s].arrayValue,r[s].directionalValue,nw,[]],t=[r[s+1].indexId,this.uid,r[s+1].arrayValue,r[s+1].directionalValue,nw,[]];i.push(IDBKeyRange.bound(e,t))}return i}bn(e,t){return jb(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(lw)}getMinOffset(e,t){return jf.mapArray(this.cn(t),t=>this.an(e,t).next(e=>e||rf())).next(lw)}}function iw(e){return Pm(e,"collectionParents")}function sw(e){return Pm(e,"indexEntries")}function aw(e){return Pm(e,"indexConfiguration")}function ow(e){return Pm(e,"indexState")}function lw(e){sf(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Ff(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Lf(t.readTime,t.documentKey,n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class cw{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new cw(e,cw.DEFAULT_COLLECTION_PERCENTILE,cw.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dw(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],a=IDBKeyRange.only(n.batchId);let o=0;const l=r.X({range:a},(e,t,n)=>(o++,n.delete()));s.push(l.next(()=>{sf(1===o)}));const u=[];for(const c of n.mutations){const e=cm(t,c.key.path,n.batchId);s.push(i.delete(e)),u.push(c.key)}return jf.waitFor(s).next(()=>u)}function hw(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw rf();t=e.noDocument}return JSON.stringify(t).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cw.DEFAULT_COLLECTION_PERCENTILE=10,cw.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,cw.DEFAULT=new cw(41943040,cw.DEFAULT_COLLECTION_PERCENTILE,cw.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),cw.DISABLED=new cw(-1,0,0);class pw{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Vn={}}static de(e,t,n,r){sf(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new pw(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mw(e).X({index:"userMutationsIndex",range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const i=vw(e),s=mw(e);return s.add({}).next(a=>{sf("number"==typeof a);const o=new hy(a,t,n,r),l=function(e,t,n){const r=n.baseMutations.map(t=>nb(e.fe,t)),i=n.mutations.map(t=>nb(e.fe,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,o),u=[];let c=new Bm((e,t)=>wf(e.canonicalString(),t.canonicalString()));for(const e of r){const t=cm(this.userId,e.key.path,a);c=c.add(e.key.path.popLast()),u.push(s.put(l)),u.push(i.put(t,dm))}return c.forEach(t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Vn[a]=o.keys()}),jf.waitFor(u).next(()=>o)})}lookupMutationBatch(e,t){return mw(e).get(t).next(e=>e?(sf(e.userId===this.userId),Ib(this.serializer,e)):null)}Sn(e,t){return this.Vn[t]?jf.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Vn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return mw(e).X({index:"userMutationsIndex",range:r},(e,t,r)=>{t.userId===this.userId&&(sf(t.batchId>=n),i=Ib(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return mw(e).X({index:"userMutationsIndex",range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return mw(e).j("userMutationsIndex",t).next(e=>e.map(e=>Ib(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=um(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return vw(e).X({range:r},(n,r,s)=>{const[a,o,l]=n,u=om(o);if(a===this.userId&&t.path.isEqual(u))return mw(e).get(l).next(e=>{if(!e)throw rf();sf(e.userId===this.userId),i.push(Ib(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Bm(wf);const r=[];return t.forEach(t=>{const i=um(this.userId,t.path),s=IDBKeyRange.lowerBound(i),a=vw(e).X({range:s},(e,r,i)=>{const[s,a,o]=e,l=om(a);s===this.userId&&t.path.isEqual(l)?n=n.add(o):i.done()});r.push(a)}),jf.waitFor(r).next(()=>this.Dn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=um(this.userId,n),s=IDBKeyRange.lowerBound(i);let a=new Bm(wf);return vw(e).X({range:s},(e,t,i)=>{const[s,o,l]=e,u=om(o);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(a=a.add(l)):i.done()}).next(()=>this.Dn(e,a))}Dn(e,t){const n=[],r=[];return t.forEach(t=>{r.push(mw(e).get(t).next(e=>{if(null===e)throw rf();sf(e.userId===this.userId),n.push(Ib(this.serializer,e))}))}),jf.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return dw(e.ht,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),jf.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return jf.resolve();const n=IDBKeyRange.lowerBound([this.userId]),r=[];return vw(e).X({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=om(e[1]);r.push(t)}else n.done()}).next(()=>{sf(0===r.length)})})}containsKey(e,t){return fw(e,this.userId,t)}xn(e){return gw(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function fw(e,t,n){const r=um(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let a=!1;return vw(e).X({range:s,Y:!0},(e,n,r)=>{const[s,o,l]=e;s===t&&o===i&&(a=!0),r.done()}).next(()=>a)}function mw(e){return Pm(e,"mutations")}function vw(e){return Pm(e,"documentMutations")}function gw(e){return Pm(e,"mutationQueues")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new yw(0)}static Mn(){return new yw(-1)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{const n=new yw(t.highestTargetId);return t.highestTargetId=n.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(e=>kf.fromTimestamp(new Sf(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.$n(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.On(e,r)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(n=>(n.targetCount+=1,this.Bn(t,n),this.On(e,n))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ww(e).delete(t.targetId)).next(()=>this.$n(e)).next(t=>(sf(t.targetCount>0),t.targetCount-=1,this.On(e,t)))}removeTargets(e,t,n){let r=0;const i=[];return ww(e).X((s,a)=>{const o=Sb(a);o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r++,i.push(this.removeTargetData(e,o)))}).next(()=>jf.waitFor(i)).next(()=>r)}forEachTarget(e,t){return ww(e).X((e,n)=>{const r=Sb(n);t(r)})}$n(e){return _w(e).get("targetGlobalKey").next(e=>(sf(null!==e),e))}On(e,t){return _w(e).put("targetGlobalKey",t)}Fn(e,t){return ww(e).put(kb(this.serializer,t))}Bn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.$n(e).next(e=>e.targetCount)}getTargetData(e,t){const n=Yv(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return ww(e).X({range:r,index:"queryTargetsIndex"},(e,n,r)=>{const s=Sb(n);Xv(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){const r=[],i=Iw(e);return t.forEach(t=>{const s=im(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),jf.waitFor(r)}removeMatchingKeys(e,t,n){const r=Iw(e);return jf.forEach(t,t=>{const i=im(t.path);return jf.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=Iw(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Iw(e);let i=Dg();return r.X({range:n,Y:!0},(e,t,n)=>{const r=om(e[1]),s=new Af(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){const n=im(t.path),r=IDBKeyRange.bound([n],[If(n)],!1,!0);let i=0;return Iw(e).X({index:"documentTargetsIndex",Y:!0,range:r},([e,t],n,r)=>{0!==e&&(i++,r.done())}).next(()=>i>0)}le(e,t){return ww(e).get(t).next(e=>e?Sb(e):null)}}function ww(e){return Pm(e,"targets")}function _w(e){return Pm(e,"targetGlobal")}function Iw(e){return Pm(e,"targetDocuments")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw([e,t],[n,r]){const i=wf(e,n);return 0===i?wf(t,r):i}class kw{constructor(e){this.Ln=e,this.buffer=new Bm(Sw),this.qn=0}Un(){return++this.qn}Kn(e){const t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Sw(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Tw{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}Qn(e){Zp("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Hf(e)?Zp("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await $f(e)}await this.Qn(3e5)})}}class Cw{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return jf.resolve(em.ct);const n=new kw(t);return this.jn.forEachTarget(e,e=>n.Kn(e.sequenceNumber)).next(()=>this.jn.Wn(e,e=>n.Kn(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Zp("LruGarbageCollector","Garbage collection skipped; disabled"),jf.resolve(uw)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Zp("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uw):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let n,r,i,s,a,o,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Zp("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),Jp()<=er.DEBUG&&Zp("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(a-s)+`ms\n\tRemoved ${i} targets in `+(o-a)+`ms\n\tRemoved ${e} documents in `+(l-o)+`ms\nTotal Duration: ${l-u}ms`),jf.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ew{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new Cw(e,t)}(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Jn(e){let t=0;return this.Wn(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(e,n)=>t(n))}addReference(e,t,n){return xw(e,n)}removeReference(e,t,n){return xw(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return xw(e,t)}Xn(e,t){return function(e,t){let n=!1;return gw(e).Z(r=>fw(e,r,t).next(e=>(e&&(n=!0),jf.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Yn(e,(s,a)=>{if(a<=t){const t=this.Xn(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,kf.min()),Iw(e).delete([0,im(s.path)])))});r.push(t)}}).next(()=>jf.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return xw(e,t)}Yn(e,t){const n=Iw(e);let r,i=em.ct;return n.X({index:"documentTargetsIndex"},([e,n],{path:s,sequenceNumber:a})=>{0===e?(i!==em.ct&&t(new Af(om(r)),i),i=a,r=s):i=em.ct}).next(()=>{i!==em.ct&&t(new Af(om(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function xw(e,t){return Iw(e).put((n=t,r=e.currentSequenceNumber,{targetId:0,path:im(n.path),sequenceNumber:r}));var n,r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(){this.changes=new wg(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Sv.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?jf.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Vw(e).put(n)}removeEntry(e,t,n){return Vw(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],bb(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Zn(e,n)))}getEntry(e,t){let n=Sv.newInvalidDocument(t);return Vw(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ow(t))},(e,r)=>{n=this.ts(t,r)}).next(()=>n)}es(e,t){let n={size:0,document:Sv.newInvalidDocument(t)};return Vw(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Ow(t))},(e,r)=>{n={document:this.ts(t,r),size:hw(r)}}).next(()=>n)}getEntries(e,t){let n=Ig();return this.ns(e,t,(e,t)=>{const r=this.ts(e,t);n=n.insert(e,r)}).next(()=>n)}ss(e,t){let n=Ig(),r=new Mm(Af.comparator);return this.ns(e,t,(e,t)=>{const i=this.ts(e,t);n=n.insert(e,i),r=r.insert(e,hw(t))}).next(()=>({documents:n,rs:r}))}ns(e,t,n){if(t.isEmpty())return jf.resolve();let r=new Bm(Lw);t.forEach(e=>r=r.add(e));const i=IDBKeyRange.bound(Ow(r.first()),Ow(r.last())),s=r.getIterator();let a=s.getNext();return Vw(e).X({index:"documentKeyIndex",range:i},(e,t,r)=>{const i=Af.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;a&&Lw(a,i)<0;)n(a,null),a=s.getNext();a&&a.isEqual(i)&&(n(a,t),a=s.hasNext()?s.getNext():null),a?r.G(Ow(a)):r.done()}).next(()=>{for(;a;)n(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r){const i=t.path,s=[i.popLast().toArray(),i.lastSegment(),bb(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Vw(e).j(IDBKeyRange.bound(s,a,!0)).next(e=>{let n=Ig();for(const i of e){const e=this.ts(Af.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(vg(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=Ig();const s=Mw(t,n),a=Mw(t,Lf.max());return Vw(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(e,t,n)=>{const s=this.ts(Af.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new Pw(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return Rw(e).get("remoteDocumentGlobalKey").next(e=>(sf(!!e),e))}Zn(e,t){return Rw(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){const e=function(e,t){let n;if(t.document)n=tb(e.fe,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=Af.fromSegments(t.noDocument.path),r=_b(t.noDocument.readTime);n=Sv.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return rf();{const e=Af.fromSegments(t.unknownDocument.path),r=_b(t.unknownDocument.version);n=Sv.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new Sf(e[0],e[1]);return kf.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(kf.min()))return e}return Sv.newInvalidDocument(e)}}function Dw(e){return new Nw(e)}class Pw extends Aw{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new wg(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new Bm((e,t)=>wf(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{const a=this.us.get(i);if(t.push(this.os.removeEntry(e,i,a.readTime)),s.isValidDocument()){const o=yb(this.os.serializer,s);r=r.add(i.path.popLast());const l=hw(o);n+=l-a.size,t.push(this.os.addEntry(e,i,o))}else if(n-=a.size,this.trackRemovals){const n=yb(this.os.serializer,s.convertToNoDocument(kf.min()));t.push(this.os.addEntry(e,i,n))}}),r.forEach(n=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.os.updateMetadata(e,n)),jf.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(e=>(this.us.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(({documents:e,rs:t})=>(t.forEach((t,n)=>{this.us.set(t,{size:n,readTime:e.get(t).readTime})}),e))}}function Rw(e){return Pm(e,"remoteDocumentGlobal")}function Vw(e){return Pm(e,"remoteDocumentsV14")}function Ow(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Mw(e,t){const n=t.documentKey.path.toArray();return[e,bb(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Lw(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=wf(n[s],r[s]),i)return i;return i=wf(n.length,r.length),i||(i=wf(n[n.length-2],r[r.length-2]),i||wf(n[n.length-1],r[r.length-1])
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */)}class Fw{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&ny(n.mutation,e,jm.empty(),Sf.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Dg()).next(()=>t))}getLocalViewOfDocuments(e,t,n=Dg()){const r=Cg();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=kg();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Cg();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Dg()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=Ig();const s=xg(),a=xg();return t.forEach((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof ay)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),ny(a.mutation,t,a.mutation.getFieldMask(),Sf.now())):s.set(t.key,jm.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return a.set(e,new Fw(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),a))}recalculateAndSaveOverlays(e,t){const n=xg();let r=new Mm((e,t)=>e-t),i=Dg();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let a=n.get(e)||jm.empty();a=i.applyToLocalView(s,a),n.set(e,a);const o=(r.get(i.batchId)||Dg()).add(e);r=r.insert(i.batchId,o)})}).next(()=>{const s=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,u=Eg();l.forEach(e=>{if(!i.has(e)){const r=ey(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,u))}return jf.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return r=t,Af.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):lg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):jf.resolve(Cg());let a=-1,o=i;return s.next(t=>jf.forEach(t,(t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?jf.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,Dg())).next(e=>({batchId:a,changes:Tg(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Af(t)).next(e=>{let t=kg();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=kg();return this.indexManager.getCollectionParents(e,r).next(s=>jf.forEach(s,s=>{const a=(o=t,l=s.child(r),new ng(l,null,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt));var o,l;return this.getDocumentsMatchingCollectionQuery(e,a,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r))).next(e=>{r.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Sv.newInvalidDocument(r)))});let n=kg();return e.forEach((e,i)=>{const s=r.get(e);void 0!==s&&ny(s.mutation,i,jm.empty(),Sf.now()),vg(t,i)&&(n=n.insert(e,i))}),n})}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return jf.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var n;return this.cs.set(t.id,{id:(n=t).id,version:n.version,createTime:Gy(n.createTime)}),jf.resolve()}getNamedQuery(e,t){return jf.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,{name:(n=t).name,query:Tb(n.bundledQuery),readTime:Gy(n.readTime)}),jf.resolve();var n}}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(){this.overlays=new Mm(Af.comparator),this.ls=new Map}getOverlay(e,t){return jf.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Cg();return jf.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.we(e,t,r)}),jf.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.ls.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.ls.delete(n)),jf.resolve()}getOverlaysForCollection(e,t,n){const r=Cg(),i=t.length+1,s=new Af(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return jf.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Mm((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Cg(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=Cg(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=r)););return jf.resolve(a)}we(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.ls.get(r.largestBatchId).delete(n.key);this.ls.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new fy(t,n));let i=this.ls.get(t);void 0===i&&(i=Dg(),this.ls.set(t,i)),this.ls.set(t,i.add(n.key))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(){this.fs=new Bm(zw.ds),this.ws=new Bm(zw._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){const n=new zw(e,t);this.fs=this.fs.add(n),this.ws=this.ws.add(n)}gs(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.ys(new zw(e,t))}ps(e,t){e.forEach(e=>this.removeReference(e,t))}Is(e){const t=new Af(new Cf([])),n=new zw(t,e),r=new zw(t,e+1),i=[];return this.ws.forEachInRange([n,r],e=>{this.ys(e),i.push(e.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const t=new Af(new Cf([])),n=new zw(t,e),r=new zw(t,e+1);let i=Dg();return this.ws.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new zw(e,0),n=this.fs.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class zw{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return Af.comparator(e.key,t.key)||wf(e.As,t.As)}static _s(e,t){return wf(e.As,t.As)||Af.comparator(e.key,t.key)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qw{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new Bm(zw.ds)}checkEmpty(e){return jf.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new hy(i,t,n,r);this.mutationQueue.push(s);for(const a of r)this.Rs=this.Rs.add(new zw(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return jf.resolve(s)}lookupMutationBatch(e,t){return jf.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.bs(n),i=r<0?0:r;return jf.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return jf.resolve(0===this.mutationQueue.length?-1:this.vs-1)}getAllMutationBatches(e){return jf.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new zw(t,0),r=new zw(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([n,r],e=>{const t=this.Ps(e.As);i.push(t)}),jf.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Bm(wf);return t.forEach(e=>{const t=new zw(e,0),r=new zw(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,r],e=>{n=n.add(e.As)})}),jf.resolve(this.Vs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Af.isDocumentKey(i)||(i=i.child(""));const s=new zw(new Af(i),0);let a=new Bm(wf);return this.Rs.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.As)),!0)},s),jf.resolve(this.Vs(a))}Vs(e){const t=[];return e.forEach(e=>{const n=this.Ps(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){sf(0===this.Ss(t.batchId,"removed")),this.mutationQueue.shift();let n=this.Rs;return jf.forEach(t.mutations,r=>{const i=new zw(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=n})}Cn(e){}containsKey(e,t){const n=new zw(t,0),r=this.Rs.firstAfterOrEqual(n);return jf.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,jf.resolve()}Ss(e,t){return this.bs(e)}bs(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Ps(e){const t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e){this.Ds=e,this.docs=new Mm(Af.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Ds(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return jf.resolve(n?n.document.mutableCopy():Sv.newInvalidDocument(t))}getEntries(e,t){let n=Ig();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Sv.newInvalidDocument(e))}),jf.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Ig();const s=t.path,a=new Af(s.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Ff(Mf(a),n)<=0||(r.has(a.key)||vg(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return jf.resolve(i)}getAllFromCollectionGroup(e,t,n,r){rf()}Cs(e,t){return jf.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Kw(this)}getSize(e){return jf.resolve(this.size)}}class Kw extends Aw{constructor(e){super(),this.os=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.os.addEntry(e,r)):this.os.removeEntry(n)}),jf.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e){this.persistence=e,this.xs=new wg(e=>Yv(e),Xv),this.lastRemoteSnapshotVersion=kf.min(),this.highestTargetId=0,this.Ns=0,this.ks=new jw,this.targetCount=0,this.Ms=yw.kn()}forEachTarget(e,t){return this.xs.forEach((e,n)=>t(n)),jf.resolve()}getLastRemoteSnapshotVersion(e){return jf.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return jf.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),jf.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ns&&(this.Ns=t),jf.resolve()}Fn(e){this.xs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ms=new yw(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,jf.resolve()}updateTargetData(e,t){return this.Fn(t),jf.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,jf.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.xs.forEach((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.xs.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),jf.waitFor(i).next(()=>r)}getTargetCount(e){return jf.resolve(this.targetCount)}getTargetData(e,t){const n=this.xs.get(t)||null;return jf.resolve(n)}addMatchingKeys(e,t,n){return this.ks.gs(t,n),jf.resolve()}removeMatchingKeys(e,t,n){this.ks.ps(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),jf.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),jf.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ks.Es(t);return jf.resolve(n)}containsKey(e,t){return jf.resolve(this.ks.containsKey(t))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,t){this.$s={},this.overlays={},this.Os=new em(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Hw(this),this.indexManager=new ew,this.remoteDocumentCache=new Gw(e=>this.referenceDelegate.Ls(e)),this.serializer=new gb(t),this.qs=new Uw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new $w,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.$s[e.toKey()];return n||(n=new qw(t,this.referenceDelegate),this.$s[e.toKey()]=n),n}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,n){Zp("MemoryPersistence","Starting transaction:",e);const r=new Qw(this.Os.next());return this.referenceDelegate.Us(),n(r).next(e=>this.referenceDelegate.Ks(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Gs(e,t){return jf.or(Object.values(this.$s).map(n=>()=>n.containsKey(e,t)))}}class Qw extends Uf{constructor(e){super(),this.currentSequenceNumber=e}}class Yw{constructor(e){this.persistence=e,this.Qs=new jw,this.js=null}static zs(e){return new Yw(e)}get Ws(){if(this.js)return this.js;throw rf()}addReference(e,t,n){return this.Qs.addReference(n,t),this.Ws.delete(n.toString()),jf.resolve()}removeReference(e,t,n){return this.Qs.removeReference(n,t),this.Ws.add(n.toString()),jf.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),jf.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(e=>this.Ws.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Ws.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return jf.forEach(this.Ws,n=>{const r=Af.fromPath(n);return this.Hs(e,r).next(e=>{e||t.removeEntry(r,kf.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(e=>{e?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return jf.or([()=>jf.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e){this.serializer=e}O(e,t,n,r){const i=new zf("createOrUpgrade",t);n<1&&r>=1&&(e.createObjectStore("owner"),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",lm,{unique:!0}),e.createObjectStore("documentMutations")}(e),Jw(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=jf.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),Jw(e)),s=s.next(()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:kf.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>function(e,t){return t.store("mutations").j().next(n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",lm,{unique:!0});const r=t.store("mutations"),i=n.map(e=>r.put(e));return jf.waitFor(i)})}(e,i))),s=s.next(()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.Ys(i))),n<6&&r>=6&&(s=s.next(()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(i)))),n<7&&r>=7&&(s=s.next(()=>this.Zs(i))),n<8&&r>=8&&(s=s.next(()=>this.ti(e,i))),n<9&&r>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(s=s.next(()=>this.ei(i))),n<11&&r>=11&&(s=s.next(()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(s=s.next(()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:Sm});t.createIndex("collectionPathOverlayIndex",km,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Tm,{unique:!1})}(e)})),n<13&&r>=13&&(s=s.next(()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:hm});t.createIndex("documentKeyIndex",pm),t.createIndex("collectionGroupIndex",fm)}(e)).next(()=>this.ni(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(s=s.next(()=>this.si(e,i))),n<15&&r>=15&&(s=s.next(()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:bm}).createIndex("sequenceNumberIndex",wm,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:_m}).createIndex("documentKeyIndex",Im,{unique:!1})}(e))),s}Xs(e){let t=0;return e.store("remoteDocuments").X((e,n)=>{t+=hw(n)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Ys(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.j().next(t=>jf.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.j("userMutationsIndex",r).next(n=>jf.forEach(n,n=>{sf(n.userId===t.userId);const r=Ib(this.serializer,n);return dw(e,t.userId,r).next(()=>{})}))}))}Zs(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(e=>{const r=[];return n.X((n,i)=>{const s=new Cf(n),a=[0,im(s)];r.push(t.get(a).next(n=>{return n?jf.resolve():(r=s,t.put({targetId:0,path:im(r),sequenceNumber:e.highestListenSequenceNumber}));var r}))}).next(()=>jf.waitFor(r))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:ym});const n=t.store("collectionParents"),r=new tw,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:im(r)})}};return t.store("remoteDocuments").X({Y:!0},(e,t)=>{const n=new Cf(e);return i(n.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([e,t,n],r)=>{const s=om(t);return i(s.popLast())}))}ei(e){const t=e.store("targets");return t.X((e,n)=>{const r=Sb(n),i=kb(this.serializer,r);return t.put(i)})}ni(e,t){const n=t.store("remoteDocuments"),r=[];return n.X((e,n)=>{const i=t.store("remoteDocumentsV14"),s=(a=n,a.document?new Af(Cf.fromString(a.document.name).popFirst(5)):a.noDocument?Af.fromSegments(a.noDocument.path):a.unknownDocument?Af.fromSegments(a.unknownDocument.path):rf()).path.toArray();var a;
/**
      * @license
      * Copyright 2017 Google LLC
      *
      * Licensed under the Apache License, Version 2.0 (the "License");
      * you may not use this file except in compliance with the License.
      * You may obtain a copy of the License at
      *
      *   http://www.apache.org/licenses/LICENSE-2.0
      *
      * Unless required by applicable law or agreed to in writing, software
      * distributed under the License is distributed on an "AS IS" BASIS,
      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
      * See the License for the specific language governing permissions and
      * limitations under the License.
      */const o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))}).next(()=>jf.waitFor(r))}si(e,t){const n=t.store("mutations"),r=Dw(this.serializer),i=new Ww(Yw.zs,this.serializer.fe);return n.j().next(e=>{const n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Dg();Ib(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),jf.forEach(n,(e,n)=>{const s=new Qp(n),a=Pb.de(this.serializer,s),o=i.getIndexManager(s),l=pw.de(s,this.serializer,o,i.referenceDelegate);return new Bw(r,l,a,o).recalculateAndSaveOverlaysForDocumentKeys(new Dm(t,em.ct),e).next()})})}}function Jw(e){e.createObjectStore("targetDocuments",{keyPath:vm}).createIndex("documentTargetsIndex",gm,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",mm,{unique:!0}),e.createObjectStore("targetGlobal")}const Zw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class e_{constructor(e,t,n,r,i,s,a,o,l,u,c=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ii=i,this.window=s,this.document=a,this.ri=l,this.oi=u,this.ui=c,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=e=>Promise.resolve(),!e_.D())throw new lf(of.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ew(this,r),this.di=t+"main",this.serializer=new gb(o),this.wi=new qf(this.di,this.ui,new Xw(this.serializer)),this.Bs=new bw(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Dw(this.serializer),this.qs=new Ab,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===u&&ef("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new lf(of.FAILED_PRECONDITION,Zw);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new em(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>n_(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(e=>{e||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(Hf(e))return Zp("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Zp("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return t_(e).get("owner").next(e=>jf.resolve(this.Ri(e)))}Pi(e){return n_(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Vi(this.li,18e5)){this.li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=Pm(e,"clientMetadata");return t.j().next(e=>{const n=this.Si(e,18e5),r=e.filter(e=>-1===n.indexOf(e));return jf.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this._i)for(const t of e)this._i.removeItem(this.Di(t.clientId))}}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?jf.resolve(!0):t_(e).get("owner").next(t=>{if(null!==t&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new lf(of.FAILED_PRECONDITION,Zw);return!1}}return!(!this.networkEnabled||!this.inForeground)||n_(e).j().next(e=>void 0===this.Si(e,5e3).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&Zp("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),await this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new Dm(e,em.ct);return this.Ai(t).next(()=>this.Pi(t))}),this.wi.close(),this.Mi()}Si(e,t){return e.filter(e=>this.Vi(e.updateTimeMs,t)&&!this.Ci(e.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>n_(e).j().next(e=>this.Si(e,18e5).map(e=>e.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return pw.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new rw(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return Pb.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,n){Zp("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=15===(s=this.ui)?Nm:14===s?Am:13===s?xm:12===s?Em:11===s?Cm:void rf();var s;let a;return this.wi.runTransaction(e,r,i,r=>(a=new Dm(r,this.Os?this.Os.next():em.ct),"readwrite-primary"===t?this.Ti(a).next(e=>!!e||this.Ei(a)).next(t=>{if(!t)throw ef(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new lf(of.FAILED_PRECONDITION,Bf);return n(a)}).next(e=>this.vi(a).next(()=>e)):this.Oi(a).next(()=>n(a)))).then(e=>(a.raiseOnCommittedEvent(),e))}Oi(e){return t_(e).get("owner").next(e=>{if(null!==e&&this.Vi(e.leaseTimestampMs,5e3)&&!this.Ci(e.ownerId)&&!this.Ri(e)&&!(this.oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new lf(of.FAILED_PRECONDITION,Zw)})}vi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return t_(e).put("owner",t)}static D(){return qf.D()}Ai(e){const t=t_(e);return t.get("owner").next(e=>this.Ri(e)?(Zp("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):jf.resolve())}Vi(e,t){const n=Date.now();return!(e<n-t||e>n&&(ef(`Detected an update time that is in the future: ${e} > ${n}`),1))}gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground="visible"===this.document.visibilityState)}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const e=/(?:Version|Mobile)\/1[456]/;!Dn()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{const n=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Di(e)));return Zp("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return ef("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){ef("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch(e){}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function t_(e){return Pm(e,"owner")}function n_(e){return Pm(e,"clientMetadata")}function r_(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class i_{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Fi=n,this.Bi=r}static Li(e,t){let n=Dg(),r=Dg();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new i_(e,t.fromCache,n,r)}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ki(e,t).next(i=>i||this.Gi(e,t,r,n)).next(n=>n||this.Qi(e,t))}Ki(e,t){if(sg(t))return jf.resolve(null);let n=cg(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=hg(t,null,"F"),n=cg(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Dg(...r);return this.Ui.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.ji(t,r);return this.zi(t,s,i,n.readTime)?this.Ki(e,hg(t,null,"F")):this.Wi(e,s,t,n)}))})))}Gi(e,t,n,r){return sg(t)||r.isEqual(kf.min())?this.Qi(e,t):this.Ui.getDocuments(e,n).next(i=>{const s=this.ji(t,i);return this.zi(t,s,n,r)?this.Qi(e,t):(Jp()<=er.DEBUG&&Zp("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),mg(t)),this.Wi(e,s,t,Of(r,-1)))})}ji(e,t){let n=new Bm(yg(e));return t.forEach((t,r)=>{vg(e,r)&&(n=n.add(r))}),n}zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Qi(e,t){return Jp()<=er.DEBUG&&Zp("QueryEngine","Using full collection scan to execute query:",mg(t)),this.Ui.getDocumentsMatchingQuery(e,t,Lf.min())}Wi(e,t,n,r){return this.Ui.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,t,n,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new Mm(wf),this.Yi=new wg(e=>Yv(e),Xv),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(n)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Bw(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}}function o_(e,t,n,r){return new a_(e,t,n,r)}async function l_(e,t){const n=af(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.tr(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let a=Dg();for(const e of r){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next(e=>({er:e,removedBatchIds:i,addedBatchIds:s}))})})}function u_(e){const t=af(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Bs.getLastRemoteSnapshotVersion(e))}function c_(e,t,n){let r=Dg(),i=Dg();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Ig();return n.forEach((n,s)=>{const a=e.get(n);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(kf.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Zp("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)}),{nr:r,sr:i}})}function d_(e,t){const n=af(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function h_(e,t){const n=af(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Bs.getTargetData(e,t).next(i=>i?(r=i,jf.resolve(r)):n.Bs.allocateTargetId(e).next(i=>(r=new vb(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Bs.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e})}async function p_(e,t,n){const r=af(e),i=r.Ji.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(a){if(!Hf(a))throw a;Zp("LocalStore",`Failed to update sequence numbers for target ${t}: ${a}`)}r.Ji=r.Ji.remove(t),r.Yi.delete(i.target)}function f_(e,t,n){const r=af(e);let i=kf.min(),s=Dg();return r.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const r=af(e),i=r.Yi.get(n);return void 0!==i?jf.resolve(r.Ji.get(i)):r.Bs.getTargetData(t,n)}(r,e,cg(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Hi.getDocumentsMatchingQuery(e,t,n?i:kf.min(),n?s:Dg())).next(e=>(g_(r,gg(t),e),{documents:e,ir:s})))}function m_(e,t){const n=af(e),r=af(n.Bs),i=n.Ji.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",e=>r.le(e,t).next(e=>e?e.target:null))}function v_(e,t){const n=af(e),r=n.Xi.get(t)||kf.min();return n.persistence.runTransaction("Get new document changes","readonly",e=>n.Zi.getAllFromCollectionGroup(e,t,Of(r,-1),Number.MAX_SAFE_INTEGER)).then(e=>(g_(n,t,e),e))}function g_(e,t,n){let r=e.Xi.get(t)||kf.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Xi.set(t,r)}async function y_(e,t,n=Dg()){const r=await h_(e,cg(Tb(t.bundledQuery))),i=af(e);return i.persistence.runTransaction("Save named query","readwrite",e=>{const s=Gy(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.qs.saveNamedQuery(e,t);const a=r.withResumeToken(qm.EMPTY_BYTE_STRING,s);return i.Ji=i.Ji.insert(a.targetId,a),i.Bs.updateTargetData(e,a).next(()=>i.Bs.removeMatchingKeysForTargetId(e,r.targetId)).next(()=>i.Bs.addMatchingKeys(e,n,r.targetId)).next(()=>i.qs.saveNamedQuery(e,t))})}function b_(e,t){return`firestore_clients_${e}_${t}`}function w_(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function __(e,t){return`firestore_targets_${e}_${t}`}class I_{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static ar(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new lf(r.error.code,r.error.message))),s?new I_(e,t,r.state,i):(ef("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class S_{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static ar(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new lf(n.error.code,n.error.message))),i?new S_(e,n.state,r):(ef("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class k_{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Rg();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=rm(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new k_(e,i):(ef("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class T_{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new T_(t.clientId,t.onlineState):(ef("SharedClientState",`Failed to parse online state: ${e}`),null)}}class C_{constructor(){this.activeTargetIds=Rg()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class E_{constructor(e,t,n,r,i){this.window=e,this.ii=t,this.persistenceKey=n,this.wr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new Mm(wf),this.started=!1,this.yr=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.pr=b_(this.persistenceKey,this.wr),this.Ir=`firestore_sequence_number_${this.persistenceKey}`,this.gr=this.gr.insert(this.wr,new C_),this.Tr=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.vr=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Rr=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.$i();for(const n of e){if(n===this.wr)continue;const e=this.getItem(b_(this.persistenceKey,n));if(e){const t=k_.ar(n,e);t&&(this.gr=this.gr.insert(t.clientId,t))}}this.Pr();const t=this.storage.getItem(this.vr);if(t){const e=this.br(t);e&&this.Vr(e)}for(const n of this.yr)this.mr(n);this.yr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,n){this.Dr(e,t,n),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(__(this.persistenceKey,e));if(n){const r=S_.ar(e,n);r&&(t=r.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(__(this.persistenceKey,e))}updateQueryState(e,t,n){this.kr(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.Cr(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Zp("SharedClientState","READ",e,t),t}setItem(e,t){Zp("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Zp("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){const t=e;if(t.storageArea===this.storage){if(Zp("SharedClientState","EVENT",t.key,t.newValue),t.key===this.pr)return void ef("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.Tr.test(t.key)){if(null==t.newValue){const e=this.Or(t.key);return this.Fr(e,null)}{const e=this.Br(t.key,t.newValue);if(e)return this.Fr(e.clientId,e)}}else if(this.Er.test(t.key)){if(null!==t.newValue){const e=this.Lr(t.key,t.newValue);if(e)return this.qr(e)}}else if(this.Ar.test(t.key)){if(null!==t.newValue){const e=this.Ur(t.key,t.newValue);if(e)return this.Kr(e)}}else if(t.key===this.vr){if(null!==t.newValue){const e=this.br(t.newValue);if(e)return this.Vr(e)}}else if(t.key===this.Ir){const e=function(e){let t=em.ct;if(null!=e)try{const n=JSON.parse(e);sf("number"==typeof n),t=n}catch(n){ef("SharedClientState","Failed to read sequence number from WebStorage",n)}return t}(t.newValue);e!==em.ct&&this.sequenceNumberHandler(e)}else if(t.key===this.Rr){const e=this.Gr(t.newValue);await Promise.all(e.map(e=>this.syncEngine.Qr(e)))}}else this.yr.push(t)})}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,n){const r=new I_(this.currentUser,e,t,n),i=w_(this.persistenceKey,this.currentUser,e);this.setItem(i,r.hr())}Cr(e){const t=w_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){const t={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(t))}kr(e,t,n){const r=__(this.persistenceKey,e),i=new S_(e,t,n);this.setItem(r,i.hr())}$r(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){const t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){const n=this.Or(e);return k_.ar(n,t)}Lr(e,t){const n=this.Er.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return I_.ar(new Qp(i),r,t)}Ur(e,t){const n=this.Ar.exec(e),r=Number(n[1]);return S_.ar(r,t)}br(e){return T_.ar(e)}Gr(e){return JSON.parse(e)}async qr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.jr(e.batchId,e.state,e.error);Zp("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){const n=t?this.gr.insert(e,t):this.gr.remove(e),r=this.Sr(this.gr),i=this.Sr(n),s=[],a=[];return i.forEach(e=>{r.has(e)||s.push(e)}),r.forEach(e=>{i.has(e)||a.push(e)}),this.syncEngine.Wr(s,a).then(()=>{this.gr=n})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=Rg();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class x_{constructor(){this.Hr=new C_,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,n){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new C_,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{Yr(e){}shutdown(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){Zp("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){Zp("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D_=null;function P_(){return null===D_?D_=268435456+Math.round(2147483648*Math.random()):D_++,"0x"+D_.toString(16)
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const R_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="WebChannelConnection";class M_ extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,n,r,i){const s=P_(),a=this.To(e,t);Zp("RestConnection",`Sending RPC '${e}' ${s}:`,a,n);const o={};return this.Eo(o,r,i),this.Ao(e,a,o,n).then(t=>(Zp("RestConnection",`Received RPC '${e}' ${s}: `,t),t),t=>{throw tf("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",n),t})}vo(e,t,n,r,i,s){return this.Io(e,t,n,r,i)}Eo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Yp,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}To(e,t){const n=R_[e];return`${this.mo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,n,r){const i=P_();return new Promise((s,a)=>{const o=new qp;o.setWithCredentials(!0),o.listenOnce(Fp.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case Lp.NO_ERROR:const t=o.getResponseJson();Zp(O_,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Lp.TIMEOUT:Zp(O_,`RPC '${e}' ${i} timed out`),a(new lf(of.DEADLINE_EXCEEDED,"Request time out"));break;case Lp.HTTP_ERROR:const n=o.getStatus();if(Zp(O_,`RPC '${e}' ${i} failed with status:`,n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(of).indexOf(t)>=0?t:of.UNKNOWN}(t.status);a(new lf(e,t.message))}else a(new lf(of.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new lf(of.UNAVAILABLE,"Connection failed."));break;default:rf()}}finally{Zp(O_,`RPC '${e}' ${i} completed.`)}});const l=JSON.stringify(r);Zp(O_,`RPC '${e}' ${i} sending request:`,r),o.send(t,"POST",l,n,15)})}Ro(e,t,n){const r=P_(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=new pp,a=dd(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.xmlHttpFactory=new jp({})),this.Eo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const u=i.join("");Zp(O_,`Creating RPC '${e}' stream ${r}: ${u}`,o);const c=s.createWebChannel(u,o);let d=!1,h=!1;const p=new V_({ro:t=>{h?Zp(O_,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||(Zp(O_,`Opening RPC '${e}' stream ${r} transport.`),c.open(),d=!0),Zp(O_,`RPC '${e}' stream ${r} sending:`,t),c.send(t))},oo:()=>c.close()}),f=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return f(c,zp.EventType.OPEN,()=>{h||Zp(O_,`RPC '${e}' stream ${r} transport opened.`)}),f(c,zp.EventType.CLOSE,()=>{h||(h=!0,Zp(O_,`RPC '${e}' stream ${r} transport closed`),p.wo())}),f(c,zp.EventType.ERROR,t=>{h||(h=!0,tf(O_,`RPC '${e}' stream ${r} transport errored:`,t),p.wo(new lf(of.UNAVAILABLE,"The operation could not be completed")))}),f(c,zp.EventType.MESSAGE,t=>{var n;if(!h){const i=t.data[0];sf(!!i);const s=i,a=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(a){Zp(O_,`RPC '${e}' stream ${r} received error:`,a);const t=a.status;let n=function(e){const t=vy[e];if(void 0!==t)return by(t)}(t),i=a.message;void 0===n&&(n=of.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),h=!0,p.wo(new lf(n,i)),c.close()}else Zp(O_,`RPC '${e}' stream ${r} received:`,i),p._o(i)}}),f(a,Bp.STAT_EVENT,t=>{t.stat===Up?Zp(O_,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===$p&&Zp(O_,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{p.fo()},0),p}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(){return"undefined"!=typeof window?window:null}function F_(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_(e){return new Uy(e,!0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,t,n=1e3,r=1.5,i=6e4){this.ii=e,this.timerId=t,this.Po=n,this.bo=r,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const t=Math.floor(this.So+this.ko()),n=Math.max(0,Date.now()-this.Co),r=Math.max(0,t-n);r>0&&Zp("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,r,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){null!==this.Do&&(this.Do.skipDelay(),this.Do=null)}cancel(){null!==this.Do&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,t,n,r,i,s,a,o){this.ii=e,this.$o=n,this.Oo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new U_(e,t)}Uo(){return 1===this.state||5===this.state||this.Ko()}Ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&null===this.Bo&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,4!==e?this.qo.reset():t&&t.code===of.RESOURCE_EXHAUSTED?(ef(t.toString()),ef("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===of.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.Fo===t&&this.Zo(e,n)},t=>{e(()=>{const e=new lf(of.UNKNOWN,"Fetching auth token failed: "+t.message);return this.tu(e)})})}Zo(e,t){const n=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{n(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(e=>{n(()=>this.tu(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return Zp("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(Zp("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class j_ extends $_{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:rf(),s=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(sf(void 0===t||"string"==typeof t),qm.fromBase64String(t||"")):(sf(void 0===t||t instanceof Uint8Array),qm.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,l=o&&function(e){const t=void 0===e.code?of.UNKNOWN:by(e.code);return new lf(t,e.message||"")}(o);n=new Py(i,s,a,l||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Qy(e,r.document.name),s=Gy(r.document.updateTime),a=r.document.createTime?Gy(r.document.createTime):kf.min(),o=new _v({mapValue:{fields:r.document.fields}}),l=Sv.newFoundDocument(i,s,a,o),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Ny(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Qy(e,r.document),s=r.readTime?Gy(r.readTime):kf.min(),a=Sv.newNoDocument(i,s),o=r.removedTargetIds||[];n=new Ny([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Qy(e,r.document),s=r.removedTargetIds||[];n=new Ny([],s,i,null)}else{if(!("filter"in t))return rf();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new my(r,i),a=e.targetId;n=new Dy(a,s)}}var r;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return kf.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?kf.min():t.readTime?Gy(t.readTime):kf.min()}(e);return this.listener.nu(t,n)}su(e){const t={};t.database=Jy(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Jv(r)?{documents:ib(e,r)}:{query:sb(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=zy(e,t.resumeToken);const r=$y(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(kf.min())>0){n.readTime=jy(e,t.snapshotVersion.toTimestamp());const r=$y(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rf()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.Wo(t)}iu(e){const t={};t.database=Jy(this.serializer),t.removeTarget=e,this.Wo(t)}}class z_ extends $_{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(sf(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const t=function(e,t){return e&&e.length>0?(sf(void 0!==t),e.map(e=>function(e,t){let n=e.updateTime?Gy(e.updateTime):Gy(t);return n.isEqual(kf.min())&&(n=Gy(t)),new Yg(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Gy(e.commitTime);return this.listener.cu(n,t)}return sf(!e.writeResults||0===e.writeResults.length),this.ru=!0,this.listener.au()}hu(){const e={};e.database=Jy(this.serializer),this.Wo(e)}uu(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>nb(this.serializer,e))};this.Wo(t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_ extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.lu=!1}fu(){if(this.lu)throw new lf(of.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,n){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.connection.Io(e,t,n,r,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===of.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new lf(of.UNKNOWN,e.toString())})}vo(e,t,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.vo(e,t,n,i,s,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===of.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new lf(of.UNKNOWN,e.toString())})}terminate(){this.lu=!0}}class G_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){0===this.wu&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){"Online"===this.state?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,"Online"===e&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(ef(t),this.mu=!1):Zp("OnlineStateTracker",t)}Tu(){null!==this._u&&(this._u.cancel(),this._u=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(e=>{n.enqueueAndForget(async()=>{tI(this)&&(Zp("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=af(e);t.vu.add(4),await W_(t),t.bu.set("Unknown"),t.vu.delete(4),await H_(t)}(this))})}),this.bu=new G_(n,r)}}async function H_(e){if(tI(e))for(const t of e.Ru)await t(!0)}async function W_(e){for(const t of e.Ru)await t(!1)}function Q_(e,t){const n=af(e);n.Au.has(t.targetId)||(n.Au.set(t.targetId,t),eI(n)?Z_(n):bI(n).Ko()&&X_(n,t))}function Y_(e,t){const n=af(e),r=bI(n);n.Au.delete(t),r.Ko()&&J_(n,t),0===n.Au.size&&(r.Ko()?r.jo():tI(n)&&n.bu.set("Unknown"))}function X_(e,t){if(e.Vu.qt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(kf.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}bI(e).su(t)}function J_(e,t){e.Vu.qt(t),bI(e).iu(t)}function Z_(e){e.Vu=new Vy({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),le:t=>e.Au.get(t)||null,ue:()=>e.datastore.serializer.databaseId}),bI(e).start(),e.bu.gu()}function eI(e){return tI(e)&&!bI(e).Uo()&&e.Au.size>0}function tI(e){return 0===af(e).vu.size}function nI(e){e.Vu=void 0}async function rI(e){e.Au.forEach((t,n)=>{X_(e,t)})}async function iI(e,t){nI(e),eI(e)?(e.bu.Iu(t),Z_(e)):e.bu.set("Unknown")}async function sI(e,t,n){if(e.bu.set("Online"),t instanceof Py&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Au.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Au.delete(r),e.Vu.removeTarget(r))}(e,t)}catch(r){Zp("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await aI(e,r)}else if(t instanceof Ny?e.Vu.Ht(t):t instanceof Dy?e.Vu.ne(t):e.Vu.Xt(t),!n.isEqual(kf.min()))try{const t=await u_(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Vu.ce(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Au.get(r);i&&e.Au.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Au.get(t);if(!r)return;e.Au.set(t,r.withResumeToken(qm.EMPTY_BYTE_STRING,r.snapshotVersion)),J_(e,t);const i=new vb(r.target,t,n,r.sequenceNumber);X_(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(i){Zp("RemoteStore","Failed to raise snapshot:",i),await aI(e,i)}}async function aI(e,t,n){if(!Hf(t))throw t;e.vu.add(1),await W_(e),e.bu.set("Offline"),n||(n=()=>u_(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Zp("RemoteStore","Retrying IndexedDB access"),await n(),e.vu.delete(1),await H_(e)})}function oI(e,t){return t().catch(n=>aI(e,n,t))}async function lI(e){const t=af(e),n=wI(t);let r=t.Eu.length>0?t.Eu[t.Eu.length-1].batchId:-1;for(;uI(t);)try{const e=await d_(t.localStore,r);if(null===e){0===t.Eu.length&&n.jo();break}r=e.batchId,cI(t,e)}catch(i){await aI(t,i)}dI(t)&&hI(t)}function uI(e){return tI(e)&&e.Eu.length<10}function cI(e,t){e.Eu.push(t);const n=wI(e);n.Ko()&&n.ou&&n.uu(t.mutations)}function dI(e){return tI(e)&&!wI(e).Uo()&&e.Eu.length>0}function hI(e){wI(e).start()}async function pI(e){wI(e).hu()}async function fI(e){const t=wI(e);for(const n of e.Eu)t.uu(n.mutations)}async function mI(e,t,n){const r=e.Eu.shift(),i=py.from(r,t,n);await oI(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await lI(e)}async function vI(e,t){t&&wI(e).ou&&await async function(e,t){if(yy(n=t.code)&&n!==of.ABORTED){const n=e.Eu.shift();wI(e).Qo(),await oI(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await lI(e)}var n}(e,t),dI(e)&&hI(e)}async function gI(e,t){const n=af(e);n.asyncQueue.verifyOperationInProgress(),Zp("RemoteStore","RemoteStore received new credentials");const r=tI(n);n.vu.add(3),await W_(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.vu.delete(3),await H_(n)}async function yI(e,t){const n=af(e);t?(n.vu.delete(2),await H_(n)):t||(n.vu.add(2),await W_(n),n.bu.set("Unknown"))}function bI(e){return e.Su||(e.Su=function(e,t,n){const r=af(e);return r.fu(),new j_(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:rI.bind(null,e),ao:iI.bind(null,e),nu:sI.bind(null,e)}),e.Ru.push(async t=>{t?(e.Su.Qo(),eI(e)?Z_(e):e.bu.set("Unknown")):(await e.Su.stop(),nI(e))})),e.Su}function wI(e){return e.Du||(e.Du=function(e,t,n){const r=af(e);return r.fu(),new z_(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{uo:pI.bind(null,e),ao:vI.bind(null,e),au:fI.bind(null,e),cu:mI.bind(null,e)}),e.Ru.push(async t=>{t?(e.Du.Qo(),await lI(e)):(await e.Du.stop(),e.Eu.length>0&&(Zp("RemoteStore",`Stopping write stream with ${e.Eu.length} pending writes`),e.Eu=[]))})),e.Du
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class _I{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new uf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,a=new _I(e,t,s,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new lf(of.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function II(e,t){if(ef("AsyncQueue",`${t}: ${e}`),Hf(e))return new lf(of.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Af.comparator(t.key,n.key):(e,t)=>Af.comparator(e.key,t.key),this.keyedMap=kg(),this.sortedSet=new Mm(this.comparator)}static emptySet(e){return new SI(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof SI))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new SI;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(){this.Cu=new Mm(Af.comparator)}track(e){const t=e.doc.key,n=this.Cu.get(t);n?0!==e.type&&3===n.type?this.Cu=this.Cu.insert(t,e):3===e.type&&1!==n.type?this.Cu=this.Cu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Cu=this.Cu.remove(t):1===e.type&&2===n.type?this.Cu=this.Cu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):rf():this.Cu=this.Cu.insert(t,e)}xu(){const e=[];return this.Cu.inorderTraversal((t,n)=>{e.push(n)}),e}}class TI{constructor(e,t,n,r,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new TI(e,t,SI.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(){this.Nu=void 0,this.listeners=[]}}class EI{constructor(){this.queries=new wg(e=>fg(e),pg),this.onlineState="Unknown",this.ku=new Set}}async function xI(e,t){const n=af(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new CI),i)try{s.Nu=await n.onListen(r)}catch(a){const e=II(a,`Initialization of query '${mg(t.query)}' failed`);return void t.onError(e)}n.queries.set(r,s),s.listeners.push(t),t.Mu(n.onlineState),s.Nu&&t.$u(s.Nu)&&PI(n)}async function AI(e,t){const n=af(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function NI(e,t){const n=af(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.$u(i)&&(r=!0);t.Nu=i}}r&&PI(n)}function DI(e,t,n){const r=af(e),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(t)}function PI(e){e.ku.forEach(e=>{e.next()})}class RI{constructor(e,t,n){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=n||{}}$u(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new TI(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Lu(e){if(e.docChanges.length>0)return!0;const t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Uu(e){e=TI.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e){this.serializer=e}rr(e){return Qy(this.serializer,e)}ur(e){return e.metadata.exists?tb(this.serializer,e.document,!1):Sv.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return Gy(e)}}class MI{constructor(e,t,n){this.ju=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=LI(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;const n=Cf.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){const t=new Map,n=new OI(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.rr(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Dg()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=af(e);let s=Dg(),a=Ig();for(const c of n){const e=t.rr(c.metadata.name);c.document&&(s=s.add(e));const n=t.ur(c);n.setReadTime(t.cr(c.metadata.readTime)),a=a.insert(e,n)}const o=i.Zi.newChangeBuffer({trackRemovals:!0}),l=await h_(i,(u=r,cg(ig(Cf.fromString(`__bundle__/docs/${u}`)))));var u;return i.persistence.runTransaction("Apply bundle documents","readwrite",e=>c_(e,o,a).next(t=>(o.apply(e),t)).next(t=>i.Bs.removeMatchingKeysForTargetId(e,l.targetId).next(()=>i.Bs.addMatchingKeys(e,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(e,t.nr,t.sr)).next(()=>t.nr)))}(this.localStore,new OI(this.serializer),this.documents,this.ju.id),t=this.Wu(this.documents);for(const n of this.queries)await y_(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:e}}}function LI(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e){this.key=e}}class BI{constructor(e){this.key=e}}class UI{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=Dg(),this.mutatedKeys=Dg(),this.tc=yg(e),this.ec=new SI(this.tc)}get nc(){return this.Yu}sc(e,t){const n=t?t.ic:new kI,r=t?t.ec:this.ec;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const u=r.get(e),c=vg(this.query,t)?t:null,d=!!u&&this.mutatedKeys.has(u.key),h=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let p=!1;u&&c?u.data.isEqual(c.data)?d!==h&&(n.track({type:3,doc:c}),p=!0):this.rc(u,c)||(n.track({type:2,doc:c}),p=!0,(o&&this.tc(c,o)>0||l&&this.tc(c,l)<0)&&(a=!0)):!u&&c?(n.track({type:0,doc:c}),p=!0):u&&!c&&(n.track({type:1,doc:u}),p=!0,(o||l)&&(a=!0)),p&&(c?(s=s.add(c),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{ec:s,ic:n,zi:a,mutatedKeys:i}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rf()}};return n(e)-n(t)}(e.type,t.type)||this.tc(e.doc,t.doc)),this.oc(n);const s=t?this.uc():[],a=0===this.Zu.size&&this.current?1:0,o=a!==this.Xu;return this.Xu=a,0!==i.length||o?{snapshot:new TI(this.query,e.ec,r,i,e.mutatedKeys,0===a,o,!1,!!n&&n.resumeToken.approximateByteSize()>0),cc:s}:{cc:s}}Mu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ec:this.ec,ic:new kI,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(e=>this.Yu=this.Yu.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Yu=this.Yu.delete(e)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=Dg(),this.ec.forEach(e=>{this.ac(e.key)&&(this.Zu=this.Zu.add(e.key))});const t=[];return e.forEach(e=>{this.Zu.has(e)||t.push(new BI(e))}),this.Zu.forEach(n=>{e.has(n)||t.push(new FI(n))}),t}hc(e){this.Yu=e.ir,this.Zu=Dg();const t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return TI.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,0===this.Xu,this.hasCachedResults)}}class $I{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class jI{constructor(e){this.key=e,this.fc=!1}}class zI{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.dc={},this.wc=new wg(e=>fg(e),pg),this._c=new Map,this.mc=new Set,this.gc=new Mm(Af.comparator),this.yc=new Map,this.Ic=new jw,this.Tc={},this.Ec=new Map,this.Ac=yw.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return!0===this.vc}}async function qI(e,t){const n=vS(e);let r,i;const s=n.wc.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{const e=await h_(n.localStore,cg(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await GI(n,t,r,"current"===s,e.resumeToken),n.isPrimaryClient&&Q_(n.remoteStore,e)}return i}async function GI(e,t,n,r,i){e.Rc=(t,n,r)=>async function(e,t,n,r){let i=t.view.sc(n);i.zi&&(i=await f_(e.localStore,t.query,!1).then(({documents:e})=>t.view.sc(e,i)));const s=r&&r.targetChanges.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s);return nS(e,t.targetId,a.cc),a.snapshot}(e,t,n,r);const s=await f_(e.localStore,t,!0),a=new UI(t,s.ir),o=a.sc(s.documents),l=Ay.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=a.applyChanges(o,e.isPrimaryClient,l);nS(e,n,u.cc);const c=new $I(t,n,a);return e.wc.set(t,c),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),u.snapshot}async function KI(e,t){const n=af(e),r=n.wc.get(t),i=n._c.get(r.targetId);if(i.length>1)return n._c.set(r.targetId,i.filter(e=>!pg(e,t))),void n.wc.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await p_(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Y_(n.remoteStore,r.targetId),eS(n,r.targetId)}).catch($f)):(eS(n,r.targetId),await p_(n.localStore,r.targetId,!0))}async function HI(e,t){const n=af(e);try{const e=await function(e,t){const n=af(e),r=t.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Zi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const a=[];t.targetChanges.forEach((s,o)=>{const l=i.get(o);if(!l)return;a.push(n.Bs.removeMatchingKeys(e,s.removedDocuments,o).next(()=>n.Bs.addMatchingKeys(e,s.addedDocuments,o)));let u=l.withSequenceNumber(e.currentSequenceNumber);var c,d,h;null!==t.targetMismatches.get(o)?u=u.withResumeToken(qm.EMPTY_BYTE_STRING,kf.min()).withLastLimboFreeSnapshotVersion(kf.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(o,u),d=u,h=s,(0===(c=l).resumeToken.approximateByteSize()||d.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&a.push(n.Bs.updateTargetData(e,u))});let o=Ig(),l=Dg();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),a.push(c_(e,s,t.documentUpdates).next(e=>{o=e.nr,l=e.sr})),!r.isEqual(kf.min())){const t=n.Bs.getLastRemoteSnapshotVersion(e).next(t=>n.Bs.setTargetsMetadata(e,e.currentSequenceNumber,r));a.push(t)}return jf.waitFor(a).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ji=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.yc.get(t);r&&(sf(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.fc=!0:e.modifiedDocuments.size>0?sf(r.fc):e.removedDocuments.size>0&&(sf(r.fc),r.fc=!1))}),await sS(n,e,t)}catch(r){await $f(r)}}function WI(e,t,n){const r=af(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wc.forEach((n,r)=>{const i=r.view.Mu(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=af(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.listeners)i.Mu(t)&&(r=!0)}),r&&PI(n)}(r.eventManager,t),e.length&&r.dc.nu(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function QI(e,t,n){const r=af(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.yc.get(t),s=i&&i.key;if(s){let e=new Mm(Af.comparator);e=e.insert(s,Sv.newNoDocument(s,kf.min()));const n=Dg().add(s),i=new xy(kf.min(),new Map,new Mm(wf),e,n);await HI(r,i),r.gc=r.gc.remove(s),r.yc.delete(t),iS(r)}else await p_(r.localStore,t,!1).then(()=>eS(r,t,n)).catch($f)}async function YI(e,t){const n=af(e),r=t.batch.batchId;try{const e=await function(e,t){const n=af(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let a=jf.resolve();return s.forEach(e=>{a=a.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);sf(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Dg();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);ZI(n,r,null),JI(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await sS(n,e)}catch(i){await $f(i)}}async function XI(e,t,n){const r=af(e);try{const e=await function(e,t){const n=af(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(sf(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);ZI(r,t,n),JI(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await sS(r,e)}catch(i){await $f(i)}}function JI(e,t){(e.Ec.get(t)||[]).forEach(e=>{e.resolve()}),e.Ec.delete(t)}function ZI(e,t,n){const r=af(e);let i=r.Tc[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Tc[r.currentUser.toKey()]=i}}function eS(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e._c.get(t))e.wc.delete(r),n&&e.dc.Pc(r,n);e._c.delete(t),e.isPrimaryClient&&e.Ic.Is(t).forEach(t=>{e.Ic.containsKey(t)||tS(e,t)})}function tS(e,t){e.mc.delete(t.path.canonicalString());const n=e.gc.get(t);null!==n&&(Y_(e.remoteStore,n),e.gc=e.gc.remove(t),e.yc.delete(n),iS(e))}function nS(e,t,n){for(const r of n)r instanceof FI?(e.Ic.addReference(r.key,t),rS(e,r)):r instanceof BI?(Zp("SyncEngine","Document no longer in limbo: "+r.key),e.Ic.removeReference(r.key,t),e.Ic.containsKey(r.key)||tS(e,r.key)):rf()}function rS(e,t){const n=t.key,r=n.path.canonicalString();e.gc.get(n)||e.mc.has(r)||(Zp("SyncEngine","New document in limbo: "+n),e.mc.add(r),iS(e))}function iS(e){for(;e.mc.size>0&&e.gc.size<e.maxConcurrentLimboResolutions;){const t=e.mc.values().next().value;e.mc.delete(t);const n=new Af(Cf.fromString(t)),r=e.Ac.next();e.yc.set(r,new jI(n)),e.gc=e.gc.insert(n,r),Q_(e.remoteStore,new vb(cg(ig(n.path)),r,"TargetPurposeLimboResolution",em.ct))}}async function sS(e,t,n){const r=af(e),i=[],s=[],a=[];r.wc.isEmpty()||(r.wc.forEach((e,o)=>{a.push(r.Rc(o,t,n).then(e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(o.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=i_.Li(o.targetId,e);s.push(t)}}))}),await Promise.all(a),r.dc.nu(i),await async function(e,t){const n=af(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>jf.forEach(t,t=>jf.forEach(t.Fi,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>jf.forEach(t.Bi,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(r){if(!Hf(r))throw r;Zp("LocalStore","Failed to update sequence numbers: "+r)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.Ji.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ji=n.Ji.insert(e,i)}}}(r.localStore,s))}async function aS(e,t){const n=af(e);if(!n.currentUser.isEqual(t)){Zp("SyncEngine","User change. New user:",t.toKey());const e=await l_(n.localStore,t);n.currentUser=t,(r=n).Ec.forEach(e=>{e.forEach(e=>{e.reject(new lf(of.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.Ec.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await sS(n,e.er)}var r}function oS(e,t){const n=af(e),r=n.yc.get(t);if(r&&r.fc)return Dg().add(r.key);{let e=Dg();const r=n._c.get(t);if(!r)return e;for(const t of r){const r=n.wc.get(t);e=e.unionWith(r.view.nc)}return e}}async function lS(e,t){const n=af(e),r=await f_(n.localStore,t.query,!0),i=t.view.hc(r);return n.isPrimaryClient&&nS(n,t.targetId,i.cc),i}async function uS(e,t){const n=af(e);return v_(n.localStore,t).then(e=>sS(n,e))}async function cS(e,t,n,r){const i=af(e),s=await function(e,t){const n=af(e),r=af(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>r.Sn(e,t).next(t=>t?n.localDocuments.getDocuments(e,t):jf.resolve(null)))}(i.localStore,t);var a,o;null!==s?("pending"===n?await lI(i.remoteStore):"acknowledged"===n||"rejected"===n?(ZI(i,t,r||null),JI(i,t),a=i.localStore,o=t,af(af(a).mutationQueue).Cn(o)):rf(),await sS(i,s)):Zp("SyncEngine","Cannot apply mutation batch with id: "+t)}async function dS(e,t,n){const r=af(e),i=[],s=[];for(const a of t){let e;const t=r._c.get(a);if(t&&0!==t.length){e=await h_(r.localStore,cg(t[0]));for(const e of t){const t=r.wc.get(e),n=await lS(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await m_(r.localStore,a);e=await h_(r.localStore,t),await GI(r,hS(t),a,!1,e.resumeToken)}i.push(e)}return r.dc.nu(s),i}function hS(e){return rg(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function pS(e){const t=af(e);return af(af(t.localStore).persistence).$i()}async function fS(e,t,n,r){const i=af(e);if(i.vc)return void Zp("SyncEngine","Ignoring unexpected query state notification.");const s=i._c.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await v_(i.localStore,gg(s[0])),r=xy.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,qm.EMPTY_BYTE_STRING);await sS(i,e,r);break}case"rejected":await p_(i.localStore,t,!0),eS(i,t,r);break;default:rf()}}async function mS(e,t,n){const r=vS(e);if(r.vc){for(const e of t){if(r._c.has(e)){Zp("SyncEngine","Adding an already active target "+e);continue}const t=await m_(r.localStore,e),n=await h_(r.localStore,t);await GI(r,hS(t),n.targetId,!1,n.resumeToken),Q_(r.remoteStore,n)}for(const e of n)r._c.has(e)&&await p_(r.localStore,e,!1).then(()=>{Y_(r.remoteStore,e),eS(r,e)}).catch($f)}}function vS(e){const t=af(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=HI.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=oS.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=QI.bind(null,t),t.dc.nu=NI.bind(null,t.eventManager),t.dc.Pc=DI.bind(null,t.eventManager),t}function gS(e){const t=af(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=YI.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=XI.bind(null,t),t}class yS{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=B_(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return o_(this.persistence,new s_,e.initialUser,this.serializer)}createPersistence(e){return new Ww(Yw.zs,this.serializer)}createSharedClientState(e){return new x_}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class bS extends yS{constructor(e,t,n){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Vc.initialize(this,e),await gS(this.Vc.syncEngine),await lI(this.Vc.remoteStore),await this.persistence.Ii(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return o_(this.persistence,new s_,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Tw(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new Zf(t,this.persistence);return new Jf(e.asyncQueue,n)}createPersistence(e){const t=r_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?cw.withCacheSize(this.cacheSizeBytes):cw.DEFAULT;return new e_(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,L_(),F_(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new x_}}class wS extends bS{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Vc.syncEngine;this.sharedClientState instanceof E_&&(this.sharedClientState.syncEngine={jr:cS.bind(null,t),zr:fS.bind(null,t),Wr:mS.bind(null,t),$i:pS.bind(null,t),Qr:uS.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ii(async e=>{await async function(e,t){const n=af(e);if(vS(n),gS(n),!0===t&&!0!==n.vc){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await dS(n,e.toArray());n.vc=!0,await yI(n.remoteStore,!0);for(const r of t)Q_(n.remoteStore,r)}else if(!1===t&&!1!==n.vc){const e=[];let t=Promise.resolve();n._c.forEach((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then(()=>(eS(n,i),p_(n.localStore,i,!0))),Y_(n.remoteStore,i)}),await t,await dS(n,e),function(e){const t=af(e);t.yc.forEach((e,n)=>{Y_(t.remoteStore,n)}),t.Ic.Ts(),t.yc=new Map,t.gc=new Mm(Af.comparator)}(n),n.vc=!1,await yI(n.remoteStore,!1)}}(this.Vc.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=L_();if(!E_.D(t))throw new lf(of.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=r_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new E_(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class _S{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>WI(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=aS.bind(null,this.syncEngine),await yI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new EI}createDatastore(e){const t=B_(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new M_(r));var r,i,s;return i=e.authCredentials,s=e.appCheckCredentials,new q_(i,s,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>WI(this.syncEngine,e,0),s=N_.D()?new N_:new A_,new K_(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,a){const o=new zI(e,t,n,r,i,s);return a&&(o.vc=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=af(e);Zp("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await W_(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):ef("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new uf,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(e=>{e&&e.Qu()?this.metadata.resolve(e.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.Gu)}`))},e=>this.metadata.reject(e))}close(){return this.Cc.cancel()}async getMetadata(){return this.metadata.promise}async bc(){return await this.getMetadata(),this.Nc()}async Nc(){const e=await this.kc();if(null===e)return null;const t=this.xc.decode(e),n=Number(t);isNaN(n)&&this.Mc(`length string (${t}) is not valid number`);const r=await this.$c(n);return new VI(JSON.parse(r),e.length+n)}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async kc(){for(;this.Oc()<0&&!(await this.Fc()););if(0===this.buffer.length)return null;const e=this.Oc();e<0&&this.Mc("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $c(e){for(;this.buffer.length<e;)await this.Fc()&&this.Mc("Reached the end of bundle when more is expected.");const t=this.xc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}async Fc(){const e=await this.Cc.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new lf(of.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=af(e),r=Jy(n.serializer)+"/documents",i={documents:t.map(e=>Wy(n.serializer,e))},s=await n.vo("BatchGetDocuments",r,i,t.length),a=new Map;s.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){sf(!!t.found),t.found.name,t.found.updateTime;const n=Qy(e,t.found.name),r=Gy(t.found.updateTime),i=t.found.createTime?Gy(t.found.createTime):kf.min(),s=new _v({mapValue:{fields:t.found.fields}});return Sv.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){sf(!!t.missing),sf(!!t.readTime);const n=Qy(e,t.missing),r=Gy(t.readTime);return Sv.newNoDocument(n,r)}(e,t):rf()}(n.serializer,e);a.set(t.key.toString(),t)});const o=[];return t.forEach(e=>{const t=a.get(e.toString());sf(!!t),o.push(t)}),o}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new cy(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=Af.fromPath(t);this.mutations.push(new dy(n,this.precondition(n)))}),await async function(e,t){const n=af(e),r=Jy(n.serializer)+"/documents",i={writes:t.map(e=>nb(n.serializer,e))};await n.Io("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw rf();t=kf.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new lf(of.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(kf.min())?Xg.exists(!1):Xg.updateTime(t):Xg.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(kf.min()))throw new lf(of.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Xg.updateTime(t)}return Xg.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Bc=n.maxAttempts,this.qo=new U_(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){this.qo.No(async()=>{const e=new TS(this.datastore),t=this.qc(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Uc(e)}))}).catch(e=>{this.Uc(e)})})}qc(e){try{const t=this.updateFunction(e);return!tm(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!yy(t)}return!1}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Qp.UNAUTHENTICATED,this.clientId=bf.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async e=>{Zp("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Zp("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new lf(of.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new uf;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=II(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function xS(e,t){e.asyncQueue.verifyOperationInProgress(),Zp("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await l_(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function AS(e,t){e.asyncQueue.verifyOperationInProgress();const n=await DS(e);Zp("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener(e=>gI(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>gI(t.remoteStore,n)),e._onlineComponents=t}function NS(e){return"FirebaseError"===e.name?e.code===of.FAILED_PRECONDITION||e.code===of.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function DS(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Zp("FirestoreClient","Using user provided OfflineComponentProvider");try{await xS(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!NS(n))throw n;tf("Error using user provided cache. Falling back to memory cache: "+n),await xS(e,new yS)}}else Zp("FirestoreClient","Using default OfflineComponentProvider"),await xS(e,new yS);return e._offlineComponents}async function PS(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Zp("FirestoreClient","Using user provided OnlineComponentProvider"),await AS(e,e._uninitializedComponentsProvider._online)):(Zp("FirestoreClient","Using default OnlineComponentProvider"),await AS(e,new _S))),e._onlineComponents}function RS(e){return DS(e).then(e=>e.persistence)}function VS(e){return DS(e).then(e=>e.localStore)}function OS(e){return PS(e).then(e=>e.remoteStore)}function MS(e){return PS(e).then(e=>e.syncEngine)}async function LS(e){const t=await PS(e),n=t.eventManager;return n.onListen=qI.bind(null,t.syncEngine),n.onUnlisten=KI.bind(null,t.syncEngine),n}function FS(e,t,n={}){const r=new uf;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new SS({next:s=>{t.enqueueAndForget(()=>AI(e,a));const o=s.docs.has(n);!o&&s.fromCache?i.reject(new lf(of.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&s.fromCache&&r&&"server"===r.source?i.reject(new lf(of.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),a=new RI(ig(n.path),s,{includeMetadataChanges:!0,Ku:!0});return xI(e,a)}(await LS(e),e.asyncQueue,t,n,r)),r.promise}function BS(e,t,n={}){const r=new uf;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new SS({next:n=>{t.enqueueAndForget(()=>AI(e,a)),n.fromCache&&"server"===r.source?i.reject(new lf(of.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new RI(n,s,{includeMetadataChanges:!0,Ku:!0});return xI(e,a)}(await LS(e),e.asyncQueue,t,n,r)),r.promise}function US(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?Iy().encode(e):e,r=function(e,t){if(e instanceof Uint8Array)return IS(e,t);if(e instanceof ArrayBuffer)return IS(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),new kS(r,t);var r}(n,B_(t));e.asyncQueue.enqueueAndForget(async()=>{!function(e,t,n){const r=af(e);(async function(e,t,n){try{const i=await t.getMetadata();if(await function(e,t){const n=af(e),r=Gy(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.qs.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(r)>=0)}(e.localStore,i))return await t.close(),n._completeWith({taskState:"Success",documentsLoaded:(r=i).totalDocuments,bytesLoaded:r.totalBytes,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}),Promise.resolve(new Set);n._updateProgress(LI(i));const s=new MI(i,e.localStore,t.serializer);let a=await t.bc();for(;a;){const e=await s.zu(a);e&&n._updateProgress(e),a=await t.bc()}const o=await s.complete();return await sS(e,o.Ju,void 0),await function(e,t){const n=af(e);return n.persistence.runTransaction("Save bundle","readwrite",e=>n.qs.saveBundleMetadata(e,t))}(e.localStore,i),n._completeWith(o.progress),Promise.resolve(o.Hu)}catch(r){return tf("SyncEngine",`Loading bundle failed with ${r}`),n._failWith(r),Promise.resolve(new Set)}var r})(r,t,n).then(e=>{r.sharedClientState.notifyBundleLoaded(e)})}(await MS(e),i,r)})}
/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function $S(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}const jS=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zS(e,t,n){if(!n)throw new lf(of.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function qS(e,t,n,r){if(!0===t&&!0===r)throw new lf(of.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function GS(e){if(!Af.isDocumentKey(e))throw new lf(of.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function KS(e){if(Af.isDocumentKey(e))throw new lf(of.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function HS(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":rf()}function WS(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new lf(of.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=HS(e);throw new lf(of.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function QS(e,t){if(t<=0)throw new lf(of.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new lf(of.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new lf(of.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}qS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$S(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new lf(of.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new lf(of.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new lf(of.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,n=e.experimentalLongPollingOptions,t.timeoutSeconds===n.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,n}}class XS{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new YS({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new lf(of.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new lf(of.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new YS(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new df;switch(e.type){case"firstParty":return new mf(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new lf(of.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=jS.get(e);t&&(Zp("ComponentProvider","Removing Datastore"),jS.delete(e),t.terminate())}(this),Promise.resolve()}}function JS(e,t,n,r={}){var i;const s=(e=WS(e,XS))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==a&&tf("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Qp.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[wn(JSON.stringify({alg:"none",type:"JWT"})),wn(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new lf(of.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Qp(s)}e._authCredentials=new hf(new cf(t,n))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new tk(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ZS(this.firestore,e,this._key)}}class ek{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ek(this.firestore,e,this._query)}}class tk extends ek{constructor(e,t,n){super(e,t,ig(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ZS(this.firestore,null,new Af(e))}withConverter(e){return new tk(this.firestore,e,this._path)}}function nk(e,t,...n){if(e=Wn(e),zS("collection","path",t),e instanceof XS){const r=Cf.fromString(t,...n);return KS(r),new tk(e,null,r)}{if(!(e instanceof ZS||e instanceof tk))throw new lf(of.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Cf.fromString(t,...n));return KS(r),new tk(e.firestore,null,r)}}function rk(e,t){if(e=WS(e,XS),zS("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new lf(of.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ek(e,null,(n=t,new ng(Cf.emptyPath(),n)));var n}function ik(e,t,...n){if(e=Wn(e),1===arguments.length&&(t=bf.A()),zS("doc","path",t),e instanceof XS){const r=Cf.fromString(t,...n);return GS(r),new ZS(e,null,new Af(r))}{if(!(e instanceof ZS||e instanceof tk))throw new lf(of.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Cf.fromString(t,...n));return GS(r),new ZS(e.firestore,e instanceof tk?e.converter:null,new Af(r))}}function sk(e,t){return e=Wn(e),t=Wn(t),(e instanceof ZS||e instanceof tk)&&(t instanceof ZS||t instanceof tk)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function ak(e,t){return e=Wn(e),t=Wn(t),e instanceof ek&&t instanceof ek&&e.firestore===t.firestore&&pg(e._query,t._query)&&e.converter===t.converter
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}class ok{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new U_(this,"async_queue_retry"),this.Xc=()=>{const e=F_();e&&Zp("AsyncQueue","Visibility state changed to "+e.visibilityState),this.qo.Mo()};const e=F_();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const t=F_();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const t=new uf;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(0!==this.Qc.length){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Hf(e))throw e;Zp("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const t=this.Gc.then(()=>(this.Hc=!0,e().catch(e=>{this.Wc=e,this.Hc=!1;throw ef("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.Hc=!1,e))));return this.Gc=t,t}enqueueAfterDelay(e,t,n){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);const r=_I.createAndSchedule(this,e,t,n,e=>this.na(e));return this.zc.push(r),r}Zc(){this.Wc&&rf()}verifyOperationInProgress(){}async sa(){let e;do{e=this.Gc,await e}while(e!==this.Gc)}ia(e){for(const t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.zc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const t=this.zc.indexOf(e);this.zc.splice(t,1)}}function lk(e){return function(e){if("object"!=typeof e||null===e)return!1;const t=e;for(const n of["next","error","complete"])if(n in t&&"function"==typeof t[n])return!0;return!1}(e)}class uk{constructor(){this._progressObserver={},this._taskCompletionResolver=new uf,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck extends XS{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new ok,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||pk(this),this._firestoreClient.terminate()}}function dk(e,t){const n="string"==typeof e?e:"(default)",r=ii("object"==typeof e?e:ui(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=Cn(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&JS(r,...e)}return r}function hk(e){return e._firestoreClient||pk(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function pk(e){var t,n,r;const i=e._freezeSettings(),s=(a=e._databaseId,o=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",l=e._persistenceKey,new Jm(a,o,l,(u=i).host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,$S(u.experimentalLongPollingOptions),u.useFetchStreams));var a,o,l,u;e._firestoreClient=new ES(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function fk(e,t,n){const r=new uf;return e.asyncQueue.enqueue(async()=>{try{await xS(e,n),await AS(e,t),r.resolve()}catch(i){const e=i;if(!NS(e))throw e;tf("Error enabling indexeddb cache. Falling back to memory cache: "+e),r.reject(e)}}).then(()=>r.promise)}function mk(e){return function(e){const t=new uf;return e.asyncQueue.enqueueAndForget(async()=>async function(t,n){const r=af(t);tI(r.remoteStore)||Zp("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=af(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))}(r.localStore);if(-1===e)return void n.resolve();const t=r.Ec.get(e)||[];t.push(n),r.Ec.set(e,t)}catch(e){const r=II(e,"Initialization of waitForPendingWrites() operation failed");n.reject(r)}}(await MS(e),t)),t.promise}(hk(e=WS(e,ck)))}function vk(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await RS(e),n=await OS(e);return t.setNetworkEnabled(!0),function(e){const t=af(e);return t.vu.delete(0),H_(t)}(n)})}(hk(e=WS(e,ck)))}function gk(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await RS(e),n=await OS(e);return t.setNetworkEnabled(!1),async function(e){const t=af(e);t.vu.add(0),await W_(t),t.bu.set("Offline")}(n)})}(hk(e=WS(e,ck)))}function yk(e,t){return function(e,t){return e.asyncQueue.enqueue(async()=>function(e,t){const n=af(e);return n.persistence.runTransaction("Get named query","readonly",e=>n.qs.getNamedQuery(e,t))}(await VS(e),t))}(hk(e=WS(e,ck)),t).then(t=>t?new ek(e,null,t.query):null)}function bk(e){if(e._initialized||e._terminated)throw new lf(of.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e){this._byteString=e}static fromBase64String(e){try{return new wk(qm.fromBase64String(e))}catch(t){throw new lf(of.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new wk(qm.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new lf(of.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xf(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{constructor(e){this._methodName=e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sk{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new lf(of.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new lf(of.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return wf(this._lat,e._lat)||wf(this._long,e._long)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk=/^__.*__$/;class Tk{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new ay(e,this.data,this.fieldMask,t,this.fieldTransforms):new sy(e,this.data,t,this.fieldTransforms)}}class Ck{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ay(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ek(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rf()}}class xk{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new xk(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.fa(e),r}da(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.aa({path:n,la:!1});return r.ua(),r}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Wk(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(0===e.length)throw this._a("Document fields must not be empty");if(Ek(this.ca)&&kk.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class Ak{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||B_(e)}ya(e,t,n,r=!1){return new xk({ca:e,methodName:t,ga:n,path:xf.emptyPath(),la:!1,ma:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nk(e){const t=e._freezeSettings(),n=B_(e._databaseId);return new Ak(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Dk(e,t,n,r,i,s={}){const a=e.ya(s.merge||s.mergeFields?2:0,t,n,i);qk("Data must be an object, but it was:",a,r);const o=jk(r,a);let l,u;if(s.merge)l=new jm(a.fieldMask),u=a.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Gk(t,r,n);if(!a.contains(i))throw new lf(of.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Qk(e,i)||e.push(i)}l=new jm(e),u=a.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,u=a.fieldTransforms;return new Tk(new _v(o),l,u)}class Pk extends Ik{_toFieldTransform(e){if(2!==e.ca)throw 1===e.ca?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pk}}function Rk(e,t,n){return new xk({ca:3,ga:t.settings.ga,methodName:e._methodName,la:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Vk extends Ik{_toFieldTransform(e){return new Qg(e.path,new $g)}isEqual(e){return e instanceof Vk}}class Ok extends Ik{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=Rk(this,e,!0),n=this.pa.map(e=>$k(e,t)),r=new jg(n);return new Qg(e.path,r)}isEqual(e){return this===e}}class Mk extends Ik{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){const t=Rk(this,e,!0),n=this.pa.map(e=>$k(e,t)),r=new qg(n);return new Qg(e.path,r)}isEqual(e){return this===e}}class Lk extends Ik{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){const t=new Kg(e.serializer,Mg(e.serializer,this.Ia));return new Qg(e.path,t)}isEqual(e){return this===e}}function Fk(e,t,n,r){const i=e.ya(1,t,n);qk("Data must be an object, but it was:",i,r);const s=[],a=_v.empty();Vm(r,(e,r)=>{const o=Hk(t,e,n);r=Wn(r);const l=i.da(o);if(r instanceof Pk)s.push(o);else{const e=$k(r,l);null!=e&&(s.push(o),a.set(o,e))}});const o=new jm(s);return new Ck(a,o,i.fieldTransforms)}function Bk(e,t,n,r,i,s){const a=e.ya(1,t,n),o=[Gk(t,r,n)],l=[i];if(s.length%2!=0)throw new lf(of.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)o.push(Gk(t,s[h])),l.push(s[h+1]);const u=[],c=_v.empty();for(let h=o.length-1;h>=0;--h)if(!Qk(u,o[h])){const e=o[h];let t=l[h];t=Wn(t);const n=a.da(e);if(t instanceof Pk)u.push(e);else{const r=$k(t,n);null!=r&&(u.push(e),c.set(e,r))}}const d=new jm(u);return new Ck(c,d,a.fieldTransforms)}function Uk(e,t,n,r=!1){return $k(n,e.ya(r?4:3,t))}function $k(e,t){if(zk(e=Wn(e)))return qk("Unsupported field value:",t,e),jk(e,t);if(e instanceof Ik)return function(e,t){if(!Ek(t.ca))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.la&&4!==t.ca)throw t._a("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=$k(i,t.wa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Wn(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Mg(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Sf.fromDate(e);return{timestampValue:jy(t.serializer,n)}}if(e instanceof Sf){const n=new Sf(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:jy(t.serializer,n)}}if(e instanceof Sk)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof wk)return{bytesValue:zy(t.serializer,e._byteString)};if(e instanceof ZS){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t._a(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ky(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${HS(e)}`)}(e,t)}function jk(e,t){const n={};return Om(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Vm(e,(e,r)=>{const i=$k(r,t.ha(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function zk(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Sf||e instanceof Sk||e instanceof wk||e instanceof ZS||e instanceof Ik)}function qk(e,t,n){if(!zk(n)||("object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){const r=HS(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}var r}function Gk(e,t,n){if((t=Wn(t))instanceof _k)return t._internalPath;if("string"==typeof t)return Hk(e,t);throw Wk("Field path arguments must be of type string or ",e,!1,void 0,n)}const Kk=new RegExp("[~\\*/\\[\\]]");function Hk(e,t,n){if(t.search(Kk)>=0)throw Wk(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new _k(...t.split("."))._internalPath}catch(r){throw Wk(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Wk(e,t,n,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let o=`Function ${t}() called with invalid data`;n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new lf(of.INVALID_ARGUMENT,o+e+l)}function Qk(e,t){return e.some(e=>e.isEqual(t))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ZS(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Xk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Jk("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Xk extends Yk{data(){return super.data()}}function Jk(e,t){return"string"==typeof t?Hk(e,t):t instanceof _k?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new lf(of.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class eT{}class tT extends eT{}function nT(e,t,...n){let r=[];t instanceof eT&&r.push(t),r=r.concat(n),function(e){const t=e.filter(e=>e instanceof sT).length,n=e.filter(e=>e instanceof rT).length;if(t>1||t>0&&n>0)throw new lf(of.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class rT extends tT{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new rT(e,t,n)}_apply(e){const t=this._parse(e);return fT(e._query,t),new ek(e.firestore,e.converter,dg(e._query,t))}_parse(e){const t=Nk(e.firestore);return function(e,t,n,r,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new lf(of.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){pT(a,s);const t=[];for(const n of a)t.push(hT(r,e,n));o={arrayValue:{values:t}}}else o=hT(r,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||pT(a,s),o=Uk(n,"where",a,"in"===s||"not-in"===s);return Nv.create(i,s,o)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}function iT(e,t,n){const r=t,i=Jk("where",e);return rT._create(i,r,n)}class sT extends eT{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new sT(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Dv.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)fT(n,i),n=dg(n,i)}(e._query,t),new ek(e.firestore,e.converter,dg(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class aT extends tT{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new aT(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new lf(of.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new lf(of.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Ev(t,n);return function(e,t){if(null===ag(e)){const n=og(e);null!==n&&mT(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new ek(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new ng(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function oT(e,t="asc"){const n=t,r=Jk("orderBy",e);return aT._create(r,n)}class lT extends tT{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new lT(e,t,n)}_apply(e){return new ek(e.firestore,e.converter,hg(e._query,this._limit,this._limitType))}}class uT extends tT{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new uT(e,t,n)}_apply(e){const t=dT(e,this.type,this._docOrFields,this._inclusive);return new ek(e.firestore,e.converter,(n=e._query,r=t,new ng(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,r,n.endAt)));var n,r}}class cT extends tT{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new cT(e,t,n)}_apply(e){const t=dT(e,this.type,this._docOrFields,this._inclusive);return new ek(e.firestore,e.converter,(n=e._query,r=t,new ng(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,r)));var n,r}}function dT(e,t,n,r){if(n[0]=Wn(n[0]),n[0]instanceof Yk)return function(e,t,n,r,i){if(!r)throw new lf(of.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const a of ug(e))if(a.field.isKeyField())s.push(uv(t,r.key));else{const e=r.data.field(a.field);if(Qm(e))throw new lf(of.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=a.field.canonicalString();throw new lf(of.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new kv(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=Nk(e.firestore);return function(e,t,n,r,i,s){const a=e.explicitOrderBy;if(i.length>a.length)throw new lf(of.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const o=[];for(let l=0;l<i.length;l++){const s=i[l];if(a[l].field.isKeyField()){if("string"!=typeof s)throw new lf(of.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof s}`);if(!lg(e)&&-1!==s.indexOf("/"))throw new lf(of.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${s}' contains a slash.`);const n=e.path.child(Cf.fromString(s));if(!Af.isDocumentKey(n))throw new lf(of.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new Af(n);o.push(uv(t,i))}else{const e=Uk(n,r,s);o.push(e)}}return new kv(o,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function hT(e,t,n){if("string"==typeof(n=Wn(n))){if(""===n)throw new lf(of.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lg(t)&&-1!==n.indexOf("/"))throw new lf(of.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Cf.fromString(n));if(!Af.isDocumentKey(r))throw new lf(of.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return uv(e,new Af(r))}if(n instanceof ZS)return uv(e,n._key);throw new lf(of.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${HS(n)}.`)}function pT(e,t){if(!Array.isArray(e)||0===e.length)throw new lf(of.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function fT(e,t){if(t.isInequality()){const n=og(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new lf(of.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);const i=ag(e);null!==i&&mT(e,r,i)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new lf(of.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new lf(of.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function mT(e,t,n){if(!n.isEqual(t))throw new lf(of.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class vT{convertValue(e,t="none"){switch(nv(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Hm(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wm(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw rf()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Vm(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new Sk(Hm(e.latitude),Hm(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ym(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Xm(e));default:return null}}convertTimestamp(e){const t=Km(e);return new Sf(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Cf.fromString(e);sf(mb(n));const r=new Zm(n.get(1),n.get(3)),i=new Af(n.popFirst(5));return r.isEqual(t)||ef(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class yT extends vT{constructor(e){super(),this.firestore=e}convertBytes(e){return new wk(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ZS(this.firestore,null,t)}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wT extends Yk{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _T(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Jk("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class _T extends wT{data(e={}){return super.data(e)}}class IT{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new bT(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new _T(this._firestore,this._userDataWriter,n.key,n,new bT(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new lf(of.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new _T(e._firestore,e._userDataWriter,n.doc.key,n.doc,new bT(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new _T(e._firestore,e._userDataWriter,t.doc.key,t.doc,new bT(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:ST(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function ST(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rf()}}function kT(e,t){return e instanceof wT&&t instanceof wT?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof IT&&t instanceof IT&&e._firestore===t._firestore&&ak(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT extends vT{constructor(e){super(),this.firestore=e}convertBytes(e){return new wk(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ZS(this.firestore,null,t)}}function CT(e){e=WS(e,ZS);const t=WS(e.firestore,ck),n=hk(t),r=new TT(t);return function(e,t){const n=new uf;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const r=await function(e,t){const n=af(e);return n.persistence.runTransaction("read document","readonly",e=>n.localDocuments.getDocument(e,t))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new lf(of.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(r){const e=II(r,`Failed to get document '${t} from cache`);n.reject(e)}}(await VS(e),t,n)),n.promise}(n,e._key).then(n=>new wT(t,r,e._key,n,new bT(null!==n&&n.hasLocalMutations,!0),e.converter))}function ET(e){e=WS(e,ek);const t=WS(e.firestore,ck),n=hk(t),r=new TT(t);return Zk(e._query),BS(n,e._query).then(n=>new IT(t,r,e,n))}function xT(e){e=WS(e,ek);const t=WS(e.firestore,ck),n=hk(t),r=new TT(t);return function(e,t){const n=new uf;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){try{const r=await f_(e,t,!0),i=new UI(t,r.ir),s=i.sc(r.documents),a=i.applyChanges(s,!1);n.resolve(a.snapshot)}catch(r){const e=II(r,`Failed to execute query '${t} against cache`);n.reject(e)}}(await VS(e),t,n)),n.promise}(n,e._query).then(n=>new IT(t,r,e,n))}function AT(e,t,n){e=WS(e,ZS);const r=WS(e.firestore,ck),i=gT(e.converter,t,n);return OT(r,[Dk(Nk(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Xg.none())])}function NT(e,t,n,...r){e=WS(e,ZS);const i=WS(e.firestore,ck),s=Nk(i);let a;return a="string"==typeof(t=Wn(t))||t instanceof _k?Bk(s,"updateDoc",e._key,t,n,r):Fk(s,"updateDoc",e._key,t),OT(i,[a.toMutation(e._key,Xg.exists(!0))])}function DT(e){return OT(WS(e.firestore,ck),[new cy(e._key,Xg.none())])}function PT(e,t){const n=WS(e.firestore,ck),r=ik(e),i=gT(e.converter,t);return OT(n,[Dk(Nk(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Xg.exists(!1))]).then(()=>r)}function RT(e,...t){var n,r,i;e=Wn(e);let s={includeMetadataChanges:!1},a=0;"object"!=typeof t[a]||lk(t[a])||(s=t[a],a++);const o={includeMetadataChanges:s.includeMetadataChanges};if(lk(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let l,u,c;if(e instanceof ZS)u=WS(e.firestore,ck),c=ig(e._key.path),l={next:n=>{t[a]&&t[a](MT(u,e,n))},error:t[a+1],complete:t[a+2]};else{const n=WS(e,ek);u=WS(n.firestore,ck),c=n._query;const r=new TT(u);l={next:e=>{t[a]&&t[a](new IT(u,r,n,e))},error:t[a+1],complete:t[a+2]},Zk(e._query)}return function(e,t,n,r){const i=new SS(r),s=new RI(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>xI(await LS(e),s)),()=>{i.Dc(),e.asyncQueue.enqueueAndForget(async()=>AI(await LS(e),s))}}(hk(u),c,o,l)}function VT(e,t){return function(e,t){const n=new SS(t);return e.asyncQueue.enqueueAndForget(async()=>{return t=await LS(e),r=n,af(t).ku.add(r),void r.next();var t,r}),()=>{n.Dc(),e.asyncQueue.enqueueAndForget(async()=>{return t=await LS(e),r=n,void af(t).ku.delete(r);var t,r})}}(hk(e=WS(e,ck)),lk(t)?t:{next:t})}function OT(e,t){return function(e,t){const n=new uf;return e.asyncQueue.enqueueAndForget(async()=>async function(t,n,r){const i=gS(t);try{const e=await function(e,t){const n=af(e),r=Sf.now(),i=t.reduce((e,t)=>e.add(t.key),Dg());let s,a;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Ig(),l=Dg();return n.Zi.getEntries(e,i).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(i=>{s=i;const a=[];for(const e of t){const t=ry(e,s.get(e.key).overlayedDocument);null!=t&&a.push(new ay(e.key,t,Iv(t.value.mapValue),Xg.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)}).next(t=>{a=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:a.batchId,changes:Tg(s)}))}(i.localStore,n);i.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Tc[e.currentUser.toKey()];r||(r=new Mm(wf)),r=r.insert(t,n),e.Tc[e.currentUser.toKey()]=r}(i,e.batchId,r),await sS(i,e.changes),await lI(i.remoteStore)}catch(e){const n=II(e,"Failed to persist write");r.reject(n)}}(await MS(e),t,n)),n.promise}(hk(e),t)}function MT(e,t,n){const r=n.docs.get(t._key),i=new TT(e);return new wT(e,i,t._key,r,new bT(n.hasPendingWrites,n.fromCache),t.converter)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT={maxAttempts:5};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Nk(e)}set(e,t,n){this._verifyNotCommitted();const r=BT(e,this._firestore),i=gT(r.converter,t,n),s=Dk(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Xg.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=BT(e,this._firestore);let s;return s="string"==typeof(t=Wn(t))||t instanceof _k?Bk(this._dataReader,"WriteBatch.update",i._key,t,n,r):Fk(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,Xg.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=BT(e,this._firestore);return this._mutations=this._mutations.concat(new cy(t._key,Xg.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new lf(of.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function BT(e,t){if((e=Wn(e)).firestore!==t)throw new lf(of.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Nk(e)}get(e){const t=BT(e,this._firestore),n=new yT(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return rf();const r=e[0];if(r.isFoundDocument())return new Yk(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new Yk(this._firestore,n,t._key,null,t.converter);throw rf()})}set(e,t,n){const r=BT(e,this._firestore),i=gT(r.converter,t,n),s=Dk(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=BT(e,this._firestore);let s;return s="string"==typeof(t=Wn(t))||t instanceof _k?Bk(this._dataReader,"Transaction.update",i._key,t,n,r):Fk(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=BT(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=BT(e,this._firestore),n=new TT(this._firestore);return super.get(e).then(e=>new wT(this._firestore,n,t._key,e._document,new bT(!1,!1),t.converter))}}function $T(e,t,n){e=WS(e,ck);const r=Object.assign(Object.assign({},LT),n);return function(e){if(e.maxAttempts<1)throw new lf(of.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new uf;return e.asyncQueue.enqueueAndForget(async()=>{const i=await function(e){return PS(e).then(e=>e.datastore)}(e);new CS(e.asyncQueue,i,n,t,r).run()}),r.promise}(hk(e),n=>t(new UT(e,n)),r)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(){return new Vk("serverTimestamp")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function zT(e){return hk(e=WS(e,ck)),new FT(e,t=>OT(e,t))}!function(e,t=!0){Yp=oi,ri(new Qn("firestore",(e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new ck(new pf(e.getProvider("auth-internal")),new gf(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new lf(of.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zm(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s},"PUBLIC").setMultipleInstances(!0)),di(Wp,"3.13.0",e),di(Wp,"3.13.0","esm2017")}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function qT(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new lf("invalid-argument",`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GT(){if("undefined"==typeof Uint8Array)throw new lf("unimplemented","Uint8Arrays are not available in this environment.")}function KT(){if("undefined"==typeof atob)throw new lf("unimplemented","Blobs are unavailable in Firestore in this environment.")}let HT=class e{constructor(e){this._delegate=e}static fromBase64String(t){return KT(),new e(wk.fromBase64String(t))}static fromUint8Array(t){return GT(),new e(wk.fromUint8Array(t))}toBase64(){return KT(),this._delegate.toBase64()}toUint8Array(){return GT(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,["next","error","complete"])}class QT{enableIndexedDbPersistence(e,t){return function(e,t){bk(e=WS(e,ck));const n=hk(e);if(n._uninitializedComponentsProvider)throw new lf(of.FAILED_PRECONDITION,"SDK cache is already specified.");tf("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new _S;return fk(n,i,new bS(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(e){bk(e=WS(e,ck));const t=hk(e);if(t._uninitializedComponentsProvider)throw new lf(of.FAILED_PRECONDITION,"SDK cache is already specified.");tf("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new _S;return fk(t,r,new wS(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new lf(of.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new uf;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!qf.D())return Promise.resolve();const t=e+"main";await qf.delete(t)}(r_(e._databaseId,e._persistenceKey)),t.resolve()}catch(n){t.reject(n)}}),t.promise}(e._delegate)}}class YT{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Zm||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||tf("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){JS(this._delegate,e,t,n)}enableNetwork(){return vk(this._delegate)}disableNetwork(){return gk(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,qS("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return mk(this._delegate)}onSnapshotsInSync(e){return VT(this._delegate,e)}get app(){if(!this._appCompat)throw new lf("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new cC(this,nk(this._delegate,e))}catch(t){throw nC(t,"collection()","Firestore.collection()")}}doc(e){try{return new tC(this,ik(this._delegate,e))}catch(t){throw nC(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new oC(this,rk(this._delegate,e))}catch(t){throw nC(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return $T(this._delegate,t=>e(new JT(this,t)))}batch(){return hk(this._delegate),new ZT(new FT(this._delegate,e=>OT(this._delegate,e)))}loadBundle(e){return function(e,t){const n=hk(e=WS(e,ck)),r=new uk;return US(n,e._databaseId,t,r),r}(this._delegate,e)}namedQuery(e){return yk(this._delegate,e).then(e=>e?new oC(this,e):null)}}class XT extends vT{constructor(e){super(),this.firestore=e}convertBytes(e){return new HT(new wk(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return tC.forKey(t,this.firestore,null)}}class JT{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new XT(e)}get(e){const t=dC(e);return this._delegate.get(t).then(e=>new sC(this._firestore,new wT(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter)))}set(e,t,n){const r=dC(e);return n?(qT("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=dC(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=dC(e);return this._delegate.delete(t),this}}class ZT{constructor(e){this._delegate=e}set(e,t,n){const r=dC(e);return n?(qT("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=dC(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=dC(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class eC{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new _T(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new aC(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=eC.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new eC(e,new XT(e),t),r.set(t,i)),i}}eC.INSTANCES=new WeakMap;class tC{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new XT(e)}static forPath(e,t,n){if(e.length%2!=0)throw new lf("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new tC(t,new ZS(t._delegate,n,new Af(e)))}static forKey(e,t,n){return new tC(t,new ZS(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new cC(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new cC(this.firestore,nk(this._delegate,e))}catch(t){throw nC(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=Wn(e))instanceof ZS&&sk(this._delegate,e)}set(e,t){t=qT("DocumentReference.set",t);try{return t?AT(this._delegate,e,t):AT(this._delegate,e)}catch(n){throw nC(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?NT(this._delegate,e):NT(this._delegate,e,t,...n)}catch(r){throw nC(r,"updateDoc()","DocumentReference.update()")}}delete(){return DT(this._delegate)}onSnapshot(...e){const t=rC(e),n=iC(e,e=>new sC(this.firestore,new wT(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)));return RT(this._delegate,t,n)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?CT(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=WS(e,ZS);const t=WS(e.firestore,ck);return FS(hk(t),e._key,{source:"server"}).then(n=>MT(t,e,n))}(this._delegate):function(e){e=WS(e,ZS);const t=WS(e.firestore,ck);return FS(hk(t),e._key).then(n=>MT(t,e,n))}(this._delegate),t.then(e=>new sC(this.firestore,new wT(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)))}withConverter(e){return new tC(this.firestore,e?this._delegate.withConverter(eC.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function nC(e,t,n){return e.message=e.message.replace(t,n),e}function rC(e){for(const t of e)if("object"==typeof t&&!WT(t))return t;return{}}function iC(e,t){var n,r;let i;return i=WT(e[0])?e[0]:WT(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class sC{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new tC(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return kT(this._delegate,e._delegate)}}class aC extends sC{data(e){const t=this._delegate.data(e);return void 0!==t||rf(),t}}class oC{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new XT(e)}where(e,t,n){try{return new oC(this.firestore,nT(this._delegate,iT(e,t,n)))}catch(r){throw nC(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new oC(this.firestore,nT(this._delegate,oT(e,t)))}catch(n){throw nC(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new oC(this.firestore,nT(this._delegate,(QS("limit",t=e),lT._create("limit",t,"F"))))}catch(n){throw nC(n,"limit()","Query.limit()")}var t}limitToLast(e){try{return new oC(this.firestore,nT(this._delegate,(QS("limitToLast",t=e),lT._create("limitToLast",t,"L"))))}catch(n){throw nC(n,"limitToLast()","Query.limitToLast()")}var t}startAt(...e){try{return new oC(this.firestore,nT(this._delegate,function(...e){return uT._create("startAt",e,!0)}(...e)))}catch(t){throw nC(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new oC(this.firestore,nT(this._delegate,function(...e){return uT._create("startAfter",e,!1)}(...e)))}catch(t){throw nC(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new oC(this.firestore,nT(this._delegate,function(...e){return cT._create("endBefore",e,!1)}(...e)))}catch(t){throw nC(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new oC(this.firestore,nT(this._delegate,function(...e){return cT._create("endAt",e,!0)}(...e)))}catch(t){throw nC(t,"endAt()","Query.endAt()")}}isEqual(e){return ak(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?xT(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=WS(e,ek);const t=WS(e.firestore,ck),n=hk(t),r=new TT(t);return BS(n,e._query,{source:"server"}).then(n=>new IT(t,r,e,n))}(this._delegate):ET(this._delegate),t.then(e=>new uC(this.firestore,new IT(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)))}onSnapshot(...e){const t=rC(e),n=iC(e,e=>new uC(this.firestore,new IT(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)));return RT(this._delegate,t,n)}withConverter(e){return new oC(this.firestore,e?this._delegate.withConverter(eC.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class lC{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new aC(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class uC{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new oC(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new aC(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(e=>new lC(this._firestore,e))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new aC(this._firestore,n))})}isEqual(e){return kT(this._delegate,e._delegate)}}class cC extends oC{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new tC(this.firestore,e):null}doc(e){try{return new tC(this.firestore,void 0===e?ik(this._delegate):ik(this._delegate,e))}catch(t){throw nC(t,"doc()","CollectionReference.doc()")}}add(e){return PT(this._delegate,e).then(e=>new tC(this.firestore,e))}isEqual(e){return sk(this._delegate,e._delegate)}withConverter(e){return new cC(this.firestore,e?this._delegate.withConverter(eC.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function dC(e){return WS(e,ZS)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(...e){this._delegate=new _k(...e)}static documentId(){return new hC(xf.keyField().canonicalString())}isEqual(e){return(e=Wn(e))instanceof _k&&this._delegate._internalPath.isEqual(e._internalPath)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e){this._delegate=e}static serverTimestamp(){const e=jT();return e._methodName="FieldValue.serverTimestamp",new pC(e)}static delete(){const e=new Pk("deleteField");return e._methodName="FieldValue.delete",new pC(e)}static arrayUnion(...e){const t=function(...e){return new Ok("arrayUnion",e)}(...e);return t._methodName="FieldValue.arrayUnion",new pC(t)}static arrayRemove(...e){const t=function(...e){return new Mk("arrayRemove",e)}(...e);return t._methodName="FieldValue.arrayRemove",new pC(t)}static increment(e){const t=new Lk("increment",e);return t._methodName="FieldValue.increment",new pC(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC={Firestore:YT,GeoPoint:Sk,Timestamp:Sf,Blob:HT,Transaction:JT,WriteBatch:ZT,DocumentReference:tC,DocumentSnapshot:sC,Query:oC,QueryDocumentSnapshot:aC,QuerySnapshot:uC,CollectionReference:cC,FieldPath:hC,FieldValue:pC,setLogLevel:function(e){var t;t=e,Xp.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};!
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){var t;t=(e,t)=>new YT(e,t,new QT),e.INTERNAL.registerComponent(new Qn("firestore-compat",e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)},"PUBLIC").setServiceProps(Object.assign({},fC))),e.registerVersion("@firebase/firestore-compat","0.3.12")}(Ai);const mC=async()=>{const{getFirebaseInstances:e}=await function(e,t){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));n=Promise.allSettled(t.map(e=>{if((e=function(e){return"/MS_DB_UI/"+e}(e))in Pu)return;Pu[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,r&&i.setAttribute("nonce",r),document.head.appendChild(i),t?new Promise((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})}(async()=>{const{getFirebaseInstances:e}=await import("./firebase-init-C9_oyObH.js");return{getFirebaseInstances:e}},__vite__mapDeps([0,1,2]));return e()},vC=async()=>{const{db:e}=await mC();return e},gC=async()=>{const{auth:e}=await mC();return e},yC=async()=>{const e=await gC(),t=new Ai.auth.GoogleAuthProvider;return e.signInWithPopup(t).catch(e=>{throw e})},bC=async()=>(await gC()).signOut(),wC=async e=>(await gC()).onAuthStateChanged(e),_C=mn("auth",{state:()=>({user:null,isAuthReady:!1}),getters:{isLoggedIn:e=>null!==e.user,userId:e=>{var t;return(null==(t=e.user)?void 0:t.uid)||null},userName:e=>{var t;return(null==(t=e.user)?void 0:t.displayName)||null},userEmail:e=>{var t;return(null==(t=e.user)?void 0:t.email)||null}},actions:{setUser(e){this.user=e},setAuthReady(e){this.isAuthReady=e},async loginWithGoogle(){try{const e=await yC();this.setUser(e.user)}catch(e){throw e}},async logout(){try{await bC(),this.setUser(null)}catch(e){throw e}},async initAuthListener(){await wC(e=>{this.setUser(e),this.isAuthReady||this.setAuthReady(!0)})}}}),IC=e=>{return e?(e=>{if(!Array.isArray(e)||0===e.length)return!1;const t=e[0];return"number"==typeof t||"string"==typeof t})(e)?(t=e,Array.isArray(t)?t.map(e=>{const t=Number(e);return isNaN(t)?null:{itemId:t,isVirtual:!1}}).filter(e=>null!==e):[]):e:[];var t},SC=e=>IC(e).filter(e=>!e.isVirtual);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
di("firebase","9.23.0","app");const kC=async e=>{const[t,n,r,i,s,a]=await(async e=>{if(!e)throw new Error("User ID is required to load initial data.");try{const t=await vC();return Promise.all([ET(nk(t,"accounts")),ET(nk(t,"character_masters")),ET(nk(t,"itemMasters")),ET(rk(t,"owned_characters")),ET(nk(t,"gachaMasters")),ET(nT(nk(t,"teams"),iT("userId","==",e),oT("createdAt","desc")))])}catch(t){throw t}})(e),o=t.docs.map(e=>{const t=e.data();return{id:e.id,name:t.Name||`アカウント${t.id}`,numericId:t.id,indexNumber:t.indexNumber}}).sort((e,t)=>(e.numericId||999)-(t.numericId||999)),l=n.docs.map(e=>({...e.data(),id:e.id})).sort((e,t)=>(e.indexNumber||999999)-(t.indexNumber||999999)),u=new Map(l.map(e=>[e.id,e])),c=r.docs.map(e=>({...e.data(),id:Number(e.data().id)})).sort((e,t)=>e.id-t.id),d=new Map(c.map(e=>[e.id,e.name])),h=s.docs.map(e=>e.data()).sort((e,t)=>(e.id||0)-(t.id||0)),p=a.docs.map(e=>({...e.data(),id:e.id})),f=new Map,m=new Map;return i.forEach(e=>{var t,n;const r=e.data(),i=null==(t=e.ref.parent.parent)?void 0:t.id;if(!i)return;const s=`${r.characterMasterId}-${i}`;m.set(s,(m.get(s)||0)+1),f.has(i)||f.set(i,[]);const a=IC(r.items);null==(n=f.get(i))||n.push({...r,items:a,id:e.id})}),{accounts:o,characterMasters:l,characterMastersMap:u,itemMasters:c,itemMastersMap:d,gachaMasters:h,teams:p,ownedCharactersData:f,ownedCountMap:m}},TC=async(e,t)=>PT(nk(await vC(),"accounts",e,"owned_characters"),t),CC=async(e,t,n)=>NT(ik(await vC(),"accounts",e,"owned_characters",t),{items:n}),EC=async(e,t,n)=>{const r=await vC(),i=zT(r),s=ik(r,"accounts",e,"owned_characters",t.id),a=ik(r,"accounts",e,"owned_characters",n.id);return i.update(s,{items:t.items}),i.update(a,{items:n.items}),i.commit()},xC=async e=>PT(nk(await vC(),"character_masters"),e),AC=async(e,t)=>NT(ik(await vC(),"character_masters",e),t),NC=async(e,t)=>{const n=await vC();return e?NT(ik(n,"teams",e),t):PT(nk(n,"teams"),t)},DC=async e=>DT(ik(await vC(),"teams",e)),PC=mn("data",{state:()=>({dataLoaded:!1,accounts:[],characterMasters:[],itemMasters:[],gachaMasters:[],teams:[],ownedCharactersData:new Map,ownedCountMap:new Map,characterMastersMap:new Map,itemMastersMap:new Map}),getters:{getOwnedCharactersByAccount:e=>t=>e.ownedCharactersData.get(t)||[],getOwnedCount:e=>(t,n)=>{const r=`${t}-${n}`;return e.ownedCountMap.get(r)||0},getCharacterMaster:e=>t=>e.characterMastersMap.get(t),getItemName:e=>t=>e.itemMastersMap.get(t)||`アイテム${t}`,getAccount:e=>t=>e.accounts.find(e=>e.id===t)},actions:{async loadInitialData(e){if(!this.dataLoaded)try{0;const t=await kC(e);this.accounts=t.accounts,this.characterMasters=t.characterMasters,this.characterMastersMap=t.characterMastersMap,this.itemMasters=t.itemMasters,this.itemMastersMap=t.itemMastersMap,this.gachaMasters=t.gachaMasters,this.teams=t.teams,this.ownedCharactersData=t.ownedCharactersData,this.ownedCountMap=t.ownedCountMap,this.dataLoaded=!0}catch(t){throw t}},updateOwnedCharactersForAccount(e,t){this.ownedCharactersData.set(e,t),t.forEach(t=>{const n=`${t.characterMasterId}-${e}`,r=this.ownedCountMap.get(n)||0;this.ownedCountMap.set(n,r)})},async addOwnedCharacter(e,t){try{const n=await TC(e,t),r=this.ownedCharactersData.get(e)||[],i={id:n.id,characterMasterId:t.characterMasterId||"",items:t.items||[],addedAt:new Date};r.push(i),this.ownedCharactersData.set(e,r);const s=`${i.characterMasterId}-${e}`;this.ownedCountMap.set(s,(this.ownedCountMap.get(s)||0)+1)}catch(n){throw n}},setTeams(e){this.teams=e},async saveTeam(e,t){try{if(await NC(e,t),e){const n=this.teams.findIndex(t=>t.id===e);-1!==n&&(this.teams[n]={...this.teams[n],...t})}0}catch(n){throw n}},async deleteTeam(e){try{await DC(e),this.teams=this.teams.filter(t=>t.id!==e)}catch(t){throw t}},resetData(){this.dataLoaded=!1,this.accounts=[],this.characterMasters=[],this.itemMasters=[],this.gachaMasters=[],this.teams=[],this.ownedCharactersData=new Map,this.ownedCountMap=new Map,this.characterMastersMap=new Map,this.itemMastersMap=new Map}}}),RC=mn("ui",{state:()=>({activeTab:"characters",selectedAccountId:null,loading:!1,snackbar:{show:!1,message:"",color:"success"},pinnedCharacterIds:[]}),getters:{isSnackbarVisible:e=>e.snackbar.show,isLoading:e=>e.loading,hasSelectedAccount:e=>null!==e.selectedAccountId},actions:{setActiveTab(e){this.activeTab=e},setSelectedAccountId(e){this.selectedAccountId=e},setLoading(e){this.loading=e},showSnackbar(e,t="success"){this.snackbar={show:!0,message:e,color:t}},showSuccess(e){this.showSnackbar(e,"success")},showError(e){this.showSnackbar(e,"error")},showInfo(e){this.showSnackbar(e,"info")},showWarning(e){this.showSnackbar(e,"warning")},hideSnackbar(){this.snackbar.show=!1},resetUI(){this.activeTab="characters",this.selectedAccountId=null,this.loading=!1,this.snackbar={show:!1,message:"",color:"success"},this.pinnedCharacterIds=[]},togglePinnedCharacter(e){const t=this.pinnedCharacterIds.indexOf(e);t>-1?this.pinnedCharacterIds.splice(t,1):this.pinnedCharacterIds.push(e)},isPinned(e){return this.pinnedCharacterIds.includes(e)},clearPinnedCharacters(){this.pinnedCharacterIds=[]}}}),VC=(e,t)=>{const n=e.__vccOpts||e;for(const[r,i]of t)n[r]=i;return n},OC=oe({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),MC=ae(!1)({name:"VDefaultsProvider",props:OC(),setup(e,t){let{slots:n}=t;const{defaults:r,disabled:i,reset:s,root:a,scoped:o}=p(e);return le(r,{reset:s,root:a,scoped:o,disabled:i}),()=>{var e;return null==(e=n.default)?void 0:e.call(n)}}});function LC(e){return ue(()=>{const t=m(e),n=[],r={};if(t.background)if(ce(t.background)){if(r.backgroundColor=t.background,!t.text&&de(t.background)){const e=he(t.background);if(null==e.a||1===e.a){const t=pe(e);r.color=t,r.caretColor=t}}}else n.push(`bg-${t.background}`);return t.text&&(ce(t.text)?(r.color=t.text,r.caretColor=t.text):n.push(`text-${t.text}`)),{colorClasses:n,colorStyles:r}})}function FC(e){const{colorClasses:t,colorStyles:n}=LC(()=>({text:m(e)}));return{textColorClasses:t,textColorStyles:n}}function BC(e){const{colorClasses:t,colorStyles:n}=LC(()=>({background:m(e)}));return{backgroundColorClasses:t,backgroundColorStyles:n}}const UC=["x-small","small","default","large","x-large"],$C=oe({size:{type:[String,Number],default:"default"}},"size");function jC(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return ue(()=>{const n=e.size;let r,i;return me(UC,n)?r=`${t}--size-${n}`:n&&(i={width:ve(n),height:ve(n)}),{sizeClasses:r,sizeStyles:i}})}const zC=oe({tag:{type:[String,Object,Function],default:"div"}},"tag"),qC=oe({color:String,disabled:Boolean,start:Boolean,end:Boolean,icon:Ie,opacity:[String,Number],..._e(),...$C(),...zC({tag:"i"}),...we()},"VIcon"),GC=ae()({name:"VIcon",props:qC(),setup(e,t){let{attrs:n,slots:r}=t;const i=v(),{themeClasses:s}=ge(),{iconData:a}=ye(()=>i.value||e.icon),{sizeClasses:o}=jC(e),{textColorClasses:l,textColorStyles:u}=FC(()=>e.color);return be(()=>{var t,c;const d=null==(t=r.default)?void 0:t.call(r);d&&(i.value=null==(c=Se(d).filter(e=>e.type===g&&e.children&&"string"==typeof e.children)[0])?void 0:c.children);const h=!(!n.onClick&&!n.onClickOnce);return y(a.value.component,{tag:e.tag,icon:a.value.icon,class:w(["v-icon","notranslate",s.value,o.value,l.value,{"v-icon--clickable":h,"v-icon--disabled":e.disabled,"v-icon--start":e.start,"v-icon--end":e.end},e.class]),style:b([{"--v-icon-opacity":e.opacity},o.value?void 0:{fontSize:ve(e.size),height:ve(e.size),width:ve(e.size)},u.value,e.style]),role:h?"button":void 0,"aria-hidden":!h,tabindex:h?e.disabled?-1:0:void 0},{default:()=>[d]})}),{}}}),KC=oe({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function HC(e){return{dimensionStyles:f(()=>{const t={},n=ve(e.height),r=ve(e.maxHeight),i=ve(e.maxWidth),s=ve(e.minHeight),a=ve(e.minWidth),o=ve(e.width);return null!=n&&(t.height=n),null!=r&&(t.maxHeight=r),null!=i&&(t.maxWidth=i),null!=s&&(t.minHeight=s),null!=a&&(t.minWidth=a),null!=o&&(t.width=o),t})}}const WC=oe({aspectRatio:[String,Number],contentClass:null,inline:Boolean,..._e(),...KC()},"VResponsive"),QC=ae()({name:"VResponsive",props:WC(),setup(e,t){let{slots:n}=t;const{aspectStyles:r}=function(e){return{aspectStyles:f(()=>{const t=Number(e.aspectRatio);return t?{paddingBottom:String(1/t*100)+"%"}:void 0})}}(e),{dimensionStyles:i}=HC(e);return be(()=>{var t;return _("div",{class:w(["v-responsive",{"v-responsive--inline":e.inline},e.class]),style:b([i.value,e.style])},[_("div",{class:"v-responsive__sizer",style:b(r.value)},null),null==(t=n.additional)?void 0:t.call(n),n.default&&_("div",{class:w(["v-responsive__content",e.contentClass])},[n.default()])])}),{}}}),YC=oe({rounded:{type:[Boolean,Number,String],default:void 0},tile:Boolean},"rounded");function XC(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{roundedClasses:f(()=>{const n=a(e)?e.value:e.rounded,r=a(e)?e.value:e.tile,i=[];if(!0===n||""===n)i.push(`${t}--rounded`);else if("string"==typeof n||0===n)for(const e of String(n).split(" "))i.push(`rounded-${e}`);else(r||!1===n)&&i.push("rounded-0");return i})}}const JC=oe({transition:{type:null,default:"fade-transition",validator:e=>!0!==e}},"transition"),ZC=(e,t)=>{let{slots:n}=t;const{transition:r,disabled:i,group:s,...a}=e,{component:o=(s?I:S),...l}=ke(r)?r:{};let u;return u=ke(r)?k(l,Te({disabled:i,group:s}),a):k({name:i||!r?"":r},a),T(o,u,n)};function eE(e,t){var n;const r=null==(n=e._observe)?void 0:n[t.instance.$.uid];r&&(r.observer.unobserve(e),delete e._observe[t.instance.$.uid])}const tE={mounted:function(e,t){if(!Ce)return;const n=t.modifiers||{},r=t.value,{handler:i,options:s}="object"==typeof r?r:{handler:r,options:{}},a=new IntersectionObserver(function(){var r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0;const o=null==(r=e._observe)?void 0:r[t.instance.$.uid];if(!o)return;const l=s.some(e=>e.isIntersecting);!i||n.quiet&&!o.init||n.once&&!l&&!o.init||i(l,s,a),l&&n.once?eE(e,t):o.init=!0},s);e._observe=Object(e._observe),e._observe[t.instance.$.uid]={init:!1,observer:a},a.observe(e)},unmounted:eE},nE=oe({absolute:Boolean,alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...WC(),..._e(),...YC(),...JC()},"VImg"),rE=ae()({name:"VImg",directives:{vIntersect:tE},props:nE(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,n){let{emit:r,slots:i}=n;const{backgroundColorClasses:s,backgroundColorStyles:a}=BC(()=>e.color),{roundedClasses:o}=XC(e),l=Ee("VImg"),u=v(""),c=t(),p=v(e.eager?"loading":"idle"),m=v(),g=v(),b=f(()=>e.src&&"object"==typeof e.src?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),I=f(()=>b.value.aspect||m.value/g.value||0);function S(t){if((!e.eager||!t)&&(!Ce||t||e.eager)){if(p.value="loading",b.value.lazySrc){const e=new Image;e.src=b.value.lazySrc,O(e,null)}b.value.src&&h(()=>{var e;r("loadstart",(null==(e=c.value)?void 0:e.currentSrc)||b.value.src),setTimeout(()=>{var e;if(!l.isUnmounted)if(null==(e=c.value)?void 0:e.complete){if(c.value.naturalWidth||P(),"error"===p.value)return;I.value||O(c.value,null),"loading"===p.value&&T()}else I.value||O(c.value),R()})})}}function T(){var e;l.isUnmounted||(R(),O(c.value),p.value="loaded",r("load",(null==(e=c.value)?void 0:e.currentSrc)||b.value.src))}function P(){var e;l.isUnmounted||(p.value="error",r("error",(null==(e=c.value)?void 0:e.currentSrc)||b.value.src))}function R(){const e=c.value;e&&(u.value=e.currentSrc||e.src)}d(()=>e.src,()=>{S("idle"!==p.value)}),d(I,(e,t)=>{!e&&t&&c.value&&O(c.value)}),C(()=>S());let V=-1;function O(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const n=()=>{if(clearTimeout(V),l.isUnmounted)return;const{naturalHeight:r,naturalWidth:i}=e;r||i?(m.value=i,g.value=r):e.complete||"loading"!==p.value||null==t?(e.currentSrc.endsWith(".svg")||e.currentSrc.startsWith("data:image/svg+xml"))&&(m.value=1,g.value=1):V=window.setTimeout(n,t)};n()}E(()=>{clearTimeout(V)});const M=x(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),L=()=>{var t;if(!b.value.src||"idle"===p.value)return null;const n=_("img",{class:w(["v-img__img",M.value]),style:{objectPosition:e.position},crossorigin:e.crossorigin,src:b.value.src,srcset:b.value.srcset,alt:e.alt,referrerpolicy:e.referrerpolicy,draggable:e.draggable,sizes:e.sizes,ref:c,onLoad:T,onError:P},null),r=null==(t=i.sources)?void 0:t.call(i);return y(ZC,{transition:e.transition,appear:!0},{default:()=>[A(r?_("picture",{class:"v-img__picture"},[r,n]):n,[[D,"loaded"===p.value]])]})},F=()=>y(ZC,{transition:e.transition},{default:()=>[b.value.lazySrc&&"loaded"!==p.value&&_("img",{class:w(["v-img__img","v-img__img--preload",M.value]),style:{objectPosition:e.position},crossorigin:e.crossorigin,src:b.value.lazySrc,alt:e.alt,referrerpolicy:e.referrerpolicy,draggable:e.draggable},null)]}),B=()=>i.placeholder?y(ZC,{transition:e.transition,appear:!0},{default:()=>[("loading"===p.value||"error"===p.value&&!i.error)&&_("div",{class:"v-img__placeholder"},[i.placeholder()])]}):null,U=()=>i.error?y(ZC,{transition:e.transition,appear:!0},{default:()=>["error"===p.value&&_("div",{class:"v-img__error"},[i.error()])]}):null,$=()=>e.gradient?_("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,j=v(!1);{const e=d(I,t=>{t&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{j.value=!0})}),e())})}return be(()=>{const t=QC.filterProps(e);return A(y(QC,k({class:["v-img",{"v-img--absolute":e.absolute,"v-img--booting":!j.value},s.value,o.value,e.class],style:[{width:ve("auto"===e.width?m.value:e.width)},a.value,e.style]},t,{aspectRatio:I.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>_(N,null,[y(L,null,null),y(F,null,null),y($,null,null),y(B,null,null),y(U,null,null)]),default:i.default}),[[tE,{handler:S,options:e.options},null,{once:!0}]])}),{currentSrc:u,image:c,state:p,naturalWidth:m,naturalHeight:g}}}),iE=oe({border:[Boolean,Number,String]},"border");function sE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{borderClasses:f(()=>{const n=e.border;return!0===n||""===n?`${t}--border`:"string"==typeof n||0===n?String(n).split(" ").map(e=>`border-${e}`):[]})}}const aE=[null,"default","comfortable","compact"],oE=oe({density:{type:String,default:"default",validator:e=>aE.includes(e)}},"density");function lE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{densityClasses:x(()=>`${t}--density-${e.density}`)}}const uE=["elevated","flat","tonal","outlined","text","plain"];function cE(e,t){return _(N,null,[e&&_("span",{key:"overlay",class:w(`${t}__overlay`)},null),_("span",{key:"underlay",class:w(`${t}__underlay`)},null)])}const dE=oe({color:String,variant:{type:String,default:"elevated",validator:e=>uE.includes(e)}},"variant");function hE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();const n=x(()=>{const{variant:n}=m(e);return`${t}--variant-${n}`}),{colorClasses:r,colorStyles:i}=LC(()=>{const{variant:t,color:n}=m(e);return{[["elevated","flat"].includes(t)?"background":"text"]:n}});return{colorClasses:r,colorStyles:i,variantClasses:n}}const pE=oe({start:Boolean,end:Boolean,icon:Ie,image:String,text:String,...iE(),..._e(),...oE(),...YC(),...$C(),...zC(),...we(),...dE({variant:"flat"})},"VAvatar"),fE=ae()({name:"VAvatar",props:pE(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=xe(e),{borderClasses:i}=sE(e),{colorClasses:s,colorStyles:a,variantClasses:o}=hE(e),{densityClasses:l}=lE(e),{roundedClasses:u}=XC(e),{sizeClasses:c,sizeStyles:d}=jC(e);return be(()=>y(e.tag,{class:w(["v-avatar",{"v-avatar--start":e.start,"v-avatar--end":e.end},r.value,i.value,s.value,l.value,u.value,c.value,o.value,e.class]),style:b([a.value,d.value,e.style])},{default:()=>[n.default?y(MC,{key:"content-defaults",defaults:{VImg:{cover:!0,src:e.image},VIcon:{icon:e.icon}}},{default:()=>[n.default()]}):e.image?y(rE,{key:"image",src:e.image,alt:"",cover:!0},null):e.icon?y(GC,{key:"icon",icon:e.icon},null):e.text,cE(!1,"v-avatar")]})),{}}}),mE=oe({elevation:{type:[Number,String],validator(e){const t=parseInt(e);return!isNaN(t)&&t>=0&&t<=24}}},"elevation");function vE(e){return{elevationClasses:x(()=>{const t=a(e)?e.value:e.elevation;return null==t?[]:[`elevation-${t}`]})}}const gE=oe({baseColor:String,divided:Boolean,direction:{type:String,default:"horizontal"},...iE(),..._e(),...oE(),...mE(),...YC(),...zC(),...we(),...dE()},"VBtnGroup"),yE=ae()({name:"VBtnGroup",props:gE(),setup(e,t){let{slots:n}=t;const{themeClasses:r}=xe(e),{densityClasses:i}=lE(e),{borderClasses:s}=sE(e),{elevationClasses:a}=vE(e),{roundedClasses:o}=XC(e);le({VBtn:{height:x(()=>"horizontal"===e.direction?"auto":null),baseColor:x(()=>e.baseColor),color:x(()=>e.color),density:x(()=>e.density),flat:!0,variant:x(()=>e.variant)}}),be(()=>y(e.tag,{class:w(["v-btn-group",`v-btn-group--${e.direction}`,{"v-btn-group--divided":e.divided},r.value,s.value,i.value,a.value,o.value,e.class]),style:b(e.style)},n))}}),bE=oe({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),wE=oe({value:null,disabled:Boolean,selectedClass:String},"group-item");function _E(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=Ee("useGroupItem");if(!i)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const s=V();O(Symbol.for(`${t.description}:id`),s);const a=r(t,null);if(!a){if(!n)return a;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${t.description}`)}const o=x(()=>e.value),l=f(()=>!(!a.disabled.value&&!e.disabled));a.register({id:s,value:o,disabled:l},i),E(()=>{a.unregister(s)});const u=f(()=>a.isSelected(s)),c=f(()=>a.items.value[0].id===s),h=f(()=>a.items.value[a.items.value.length-1].id===s),p=f(()=>u.value&&[a.selectedClass.value,e.selectedClass]);return d(u,e=>{i.emit("group:selected",{value:e})},{flush:"sync"}),{id:s,isSelected:u,isFirst:c,isLast:h,toggle:()=>a.select(s,!u.value),select:e=>a.select(s,e),selectedClass:p,value:o,disabled:l,group:a}}function IE(e,t){let n=!1;const r=s([]),i=Ae(e,"modelValue",[],e=>null==e?[]:SE(r,De(e)),t=>{const n=function(e,t){const n=[];return t.forEach(t=>{const r=e.findIndex(e=>e.id===t);if(~r){const t=e[r];n.push(null!=t.value?t.value:r)}}),n}(r,t);return e.multiple?n:n[0]}),a=Ee("useGroup");function o(){const t=r.find(e=>!e.disabled);t&&"force"===e.mandatory&&!i.value.length&&(i.value=[t.id])}function l(t){if(e.multiple,i.value.length){const e=i.value[0],n=r.findIndex(t=>t.id===e);let s=(n+t)%r.length,a=r[s];for(;a.disabled&&s!==n;)s=(s+t)%r.length,a=r[s];if(a.disabled)return;i.value=[r[s].id]}else{const e=r.find(e=>!e.disabled);e&&(i.value=[e.id])}}P(()=>{o()}),E(()=>{n=!0}),R(()=>{for(let e=0;e<r.length;e++)r[e].useIndexAsValue&&(r[e].value=e)});const u={register:function(e,n){const i=e,s=Symbol.for(`${t.description}:id`),o=Pe(s,null==a?void 0:a.vnode).indexOf(n);null==M(i.value)&&(i.value=o,i.useIndexAsValue=!0),o>-1?r.splice(o,0,i):r.push(i)},unregister:function(e){if(n)return;o();const t=r.findIndex(t=>t.id===e);r.splice(t,1)},selected:i,select:function(t,n){const s=r.find(e=>e.id===t);if(!n||!(null==s?void 0:s.disabled))if(e.multiple){const r=i.value.slice(),s=r.findIndex(e=>e===t),a=~s;if(n=n??!a,a&&e.mandatory&&r.length<=1)return;if(!a&&null!=e.max&&r.length+1>e.max)return;s<0&&n?r.push(t):s>=0&&!n&&r.splice(s,1),i.value=r}else{const r=i.value.includes(t);if(e.mandatory&&r)return;if(!r&&!n)return;i.value=n??!r?[t]:[]}},disabled:x(()=>e.disabled),prev:()=>l(r.length-1),next:()=>l(1),isSelected:e=>i.value.includes(e),selectedClass:x(()=>e.selectedClass),items:x(()=>r),getItemIndex:e=>function(e,t){const n=SE(e,[t]);return n.length?e.findIndex(e=>e.id===n[0]):-1}(r,e)};return O(t,u),u}function SE(e,t){const n=[];return t.forEach(t=>{const r=e.find(e=>Ne(t,e.value)),i=e[t];null!=(null==r?void 0:r.value)?n.push(r.id):(null==i?void 0:i.useIndexAsValue)&&n.push(i.id)}),n}const kE=Symbol.for("vuetify:v-btn-toggle"),TE=oe({...gE(),...bE()},"VBtnToggle"),CE=ae()({name:"VBtnToggle",props:TE(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{isSelected:r,next:i,prev:s,select:a,selected:o}=IE(e,kE);return be(()=>{const t=yE.filterProps(e);return y(yE,k({class:["v-btn-toggle",e.class]},t,{style:e.style}),{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n,{isSelected:r,next:i,prev:s,select:a,selected:o})]}})}),{next:i,prev:s,select:a}}});function EE(e,n){const r=t(),i=v(!1);if(Ce){const e=new IntersectionObserver(e=>{i.value=!!e.find(e=>e.isIntersecting)},n);c(()=>{e.disconnect()}),d(r,(t,n)=>{n&&(e.unobserve(n),i.value=!1),t&&e.observe(t)},{flush:"post"})}return{intersectionRef:r,isIntersecting:i}}const xE=oe({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},..._e(),...$C(),...zC({tag:"div"}),...we()},"VProgressCircular"),AE=ae()({name:"VProgressCircular",props:xE(),setup(e,n){let{slots:r}=n;const i=2*Math.PI*20,s=t(),{themeClasses:a}=xe(e),{sizeClasses:o,sizeStyles:l}=jC(e),{textColorClasses:u,textColorStyles:c}=FC(()=>e.color),{textColorClasses:d,textColorStyles:h}=FC(()=>e.bgColor),{intersectionRef:p,isIntersecting:f}=EE(),{resizeRef:m,contentRect:v}=Re(),g=x(()=>Ve(parseFloat(e.modelValue),0,100)),I=x(()=>Number(e.width)),S=x(()=>l.value?Number(e.size):v.value?v.value.width:Math.max(I.value,32)),k=x(()=>20/(1-I.value/S.value)*2),T=x(()=>I.value/S.value*k.value),C=x(()=>ve((100-g.value)/100*i));return L(()=>{p.value=s.value,m.value=s.value}),be(()=>y(e.tag,{ref:s,class:w(["v-progress-circular",{"v-progress-circular--indeterminate":!!e.indeterminate,"v-progress-circular--visible":f.value,"v-progress-circular--disable-shrink":"disable-shrink"===e.indeterminate},a.value,o.value,u.value,e.class]),style:b([l.value,c.value,e.style]),role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":e.indeterminate?void 0:g.value},{default:()=>[_("svg",{style:{transform:`rotate(calc(-90deg + ${Number(e.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${k.value} ${k.value}`},[_("circle",{class:w(["v-progress-circular__underlay",d.value]),style:b(h.value),fill:"transparent",cx:"50%",cy:"50%",r:20,"stroke-width":T.value,"stroke-dasharray":i,"stroke-dashoffset":0},null),_("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:20,"stroke-width":T.value,"stroke-dasharray":i,"stroke-dashoffset":C.value},null)]),r.default&&_("div",{class:"v-progress-circular__content"},[r.default({value:g.value})])]})),{}}}),NE={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},DE=oe({location:String},"location");function PE(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;const{isRtl:r}=Oe();return{locationStyles:f(()=>{if(!e.location)return{};const{side:i,align:s}=Me(e.location.split(" ").length>1?e.location:`${e.location} center`,r.value);function a(e){return n?n(e):0}const o={};return"center"!==i&&(t?o[NE[i]]=`calc(100% - ${a(i)}px)`:o[i]=0),"center"!==s?t?o[NE[s]]=`calc(100% - ${a(s)}px)`:o[s]=0:("center"===i?o.top=o.left="50%":o[{top:"left",bottom:"left",left:"top",right:"top"}[i]]="50%",o.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[i]),o})}}const RE=oe({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},bufferColor:String,bufferOpacity:[Number,String],clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},opacity:[Number,String],reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,..._e(),...DE({location:"top"}),...YC(),...zC(),...we()},"VProgressLinear"),VE=ae()({name:"VProgressLinear",props:RE(),emits:{"update:modelValue":e=>!0},setup(e,t){var n;let{slots:r}=t;const i=Ae(e,"modelValue"),{isRtl:s,rtlClasses:a}=Oe(),{themeClasses:o}=xe(e),{locationStyles:l}=PE(e),{textColorClasses:u,textColorStyles:c}=FC(()=>e.color),{backgroundColorClasses:d,backgroundColorStyles:h}=BC(()=>e.bgColor||e.color),{backgroundColorClasses:p,backgroundColorStyles:m}=BC(()=>e.bufferColor||e.bgColor||e.color),{backgroundColorClasses:v,backgroundColorStyles:g}=BC(()=>e.color),{roundedClasses:I}=XC(e),{intersectionRef:k,isIntersecting:T}=EE(),C=f(()=>parseFloat(e.max)),E=f(()=>parseFloat(e.height)),x=f(()=>Ve(parseFloat(e.bufferValue)/C.value*100,0,100)),A=f(()=>Ve(parseFloat(i.value)/C.value*100,0,100)),N=f(()=>s.value!==e.reverse),D=f(()=>e.indeterminate?"fade-transition":"slide-x-transition"),P=Le&&(null==(n=window.matchMedia)?void 0:n.call(window,"(forced-colors: active)").matches);function R(e){if(!k.value)return;const{left:t,right:n,width:r}=k.value.getBoundingClientRect(),s=N.value?r-e.clientX+(n-r):e.clientX-t;i.value=Math.round(s/r*C.value)}return be(()=>y(e.tag,{ref:k,class:w(["v-progress-linear",{"v-progress-linear--absolute":e.absolute,"v-progress-linear--active":e.active&&T.value,"v-progress-linear--reverse":N.value,"v-progress-linear--rounded":e.rounded,"v-progress-linear--rounded-bar":e.roundedBar,"v-progress-linear--striped":e.striped,"v-progress-linear--clickable":e.clickable},I.value,o.value,a.value,e.class]),style:b([{bottom:"bottom"===e.location?0:void 0,top:"top"===e.location?0:void 0,height:e.active?ve(E.value):0,"--v-progress-linear-height":ve(E.value),...e.absolute?l.value:{}},e.style]),role:"progressbar","aria-hidden":e.active?"false":"true","aria-valuemin":"0","aria-valuemax":e.max,"aria-valuenow":e.indeterminate?void 0:Math.min(parseFloat(i.value),C.value),onClick:e.clickable&&R},{default:()=>[e.stream&&_("div",{key:"stream",class:w(["v-progress-linear__stream",u.value]),style:{...c.value,[N.value?"left":"right"]:ve(-E.value),borderTop:`${ve(E.value/2)} dotted`,opacity:parseFloat(e.bufferOpacity),top:`calc(50% - ${ve(E.value/4)})`,width:ve(100-x.value,"%"),"--v-progress-linear-stream-to":ve(E.value*(N.value?1:-1))}},null),_("div",{class:w(["v-progress-linear__background",P?void 0:d.value]),style:b([h.value,{opacity:parseFloat(e.bgOpacity),width:e.stream?0:void 0}])},null),_("div",{class:w(["v-progress-linear__buffer",P?void 0:p.value]),style:b([m.value,{opacity:parseFloat(e.bufferOpacity),width:ve(x.value,"%")}])},null),y(S,{name:D.value},{default:()=>[e.indeterminate?_("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(e=>_("div",{key:e,class:w(["v-progress-linear__indeterminate",e,P?void 0:v.value]),style:b(g.value)},null))]):_("div",{class:w(["v-progress-linear__determinate",P?void 0:v.value]),style:b([g.value,{width:ve(A.value,"%")}])},null)]}),r.default&&_("div",{class:"v-progress-linear__content"},[r.default({value:A.value,buffer:x.value})])]})),{}}}),OE=oe({loading:[Boolean,String]},"loader");function ME(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{loaderClasses:x(()=>({[`${t}--loading`]:e.loading}))}}function LE(e,t){var n;let{slots:r}=t;return _("div",{class:w(`${e.name}__loader`)},[(null==(n=r.default)?void 0:n.call(r,{color:e.color,isActive:e.active}))||y(VE,{absolute:e.absolute,active:e.active,color:e.color,height:"2",indeterminate:!0},null)])}const FE=["static","relative","fixed","absolute","sticky"],BE=oe({position:{type:String,validator:e=>FE.includes(e)}},"position");function UE(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();return{positionClasses:x(()=>e.position?`${t}--${e.position}`:void 0)}}function $E(e,t){var n,r;const i=F("RouterLink"),a=x(()=>!(!e.href&&!e.to)),o=f(()=>(null==a?void 0:a.value)||Fe(t,"click")||Fe(e,"click"));if("string"==typeof i||!("useLink"in i)){const t=x(()=>e.href);return{isLink:a,isClickable:o,href:t,linkProps:s({href:t})}}const l=i.useLink({to:x(()=>e.to||""),replace:x(()=>e.replace)}),u=f(()=>e.to?l:void 0),c=function(){const e=Ee("useRoute");return f(()=>{var t;return null==(t=null==e?void 0:e.proxy)?void 0:t.$route})}(),d=f(()=>{var t,n,r;return!!u.value&&(e.exact?c.value?(null==(r=u.value.isExactActive)?void 0:r.value)&&Ne(u.value.route.value.query,c.value.query):(null==(n=u.value.isExactActive)?void 0:n.value)??!1:(null==(t=u.value.isActive)?void 0:t.value)??!1)}),h=f(()=>{var t;return e.to?null==(t=u.value)?void 0:t.route.value.href:e.href});return{isLink:a,isClickable:o,isActive:d,route:null==(n=u.value)?void 0:n.route,navigate:null==(r=u.value)?void 0:r.navigate,href:h,linkProps:s({href:h,"aria-current":x(()=>d.value?"page":void 0)})}}const jE=oe({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let zE=!1;const qE=Symbol("rippleStop");function GE(e,t){e.style.transform=t,e.style.webkitTransform=t}function KE(e){return"TouchEvent"===e.constructor.name}function HE(e){return"KeyboardEvent"===e.constructor.name}const WE={show(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!(null==(n=null==t?void 0:t._ripple)?void 0:n.enabled))return;const i=document.createElement("span"),s=document.createElement("span");i.appendChild(s),i.className="v-ripple__container",r.class&&(i.className+=` ${r.class}`);const{radius:a,scale:o,x:l,y:u,centerX:c,centerY:d}=function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=0,s=0;if(!HE(e)){const n=t.getBoundingClientRect(),r=KE(e)?e.touches[e.touches.length-1]:e;i=r.clientX-n.left,s=r.clientY-n.top}let a=0,o=.3;(null==(n=t._ripple)?void 0:n.circle)?(o=.15,a=t.clientWidth/2,a=r.center?a:a+Math.sqrt((i-a)**2+(s-a)**2)/4):a=Math.sqrt(t.clientWidth**2+t.clientHeight**2)/2;const l=(t.clientWidth-2*a)/2+"px",u=(t.clientHeight-2*a)/2+"px";return{radius:a,scale:o,x:r.center?l:i-a+"px",y:r.center?u:s-a+"px",centerX:l,centerY:u}}(e,t,r),h=2*a+"px";s.className="v-ripple__animation",s.style.width=h,s.style.height=h,t.appendChild(i);const p=window.getComputedStyle(t);p&&"static"===p.position&&(t.style.position="relative",t.dataset.previousPosition="static"),s.classList.add("v-ripple__animation--enter"),s.classList.add("v-ripple__animation--visible"),GE(s,`translate(${l}, ${u}) scale3d(${o},${o},${o})`),s.dataset.activated=String(performance.now()),requestAnimationFrame(()=>{requestAnimationFrame(()=>{s.classList.remove("v-ripple__animation--enter"),s.classList.add("v-ripple__animation--in"),GE(s,`translate(${c}, ${d}) scale3d(1,1,1)`)})})},hide(e){var t;if(!(null==(t=null==e?void 0:e._ripple)?void 0:t.enabled))return;const n=e.getElementsByClassName("v-ripple__animation");if(0===n.length)return;const r=Array.from(n).findLast(e=>!e.dataset.isHiding);if(!r)return;r.dataset.isHiding="true";const i=performance.now()-Number(r.dataset.activated),s=Math.max(250-i,0);setTimeout(()=>{r.classList.remove("v-ripple__animation--in"),r.classList.add("v-ripple__animation--out"),setTimeout(()=>{var t;1===e.getElementsByClassName("v-ripple__animation").length&&e.dataset.previousPosition&&(e.style.position=e.dataset.previousPosition,delete e.dataset.previousPosition),(null==(t=r.parentNode)?void 0:t.parentNode)===e&&e.removeChild(r.parentNode)},300)},s)}};function QE(e){return void 0===e||!!e}function YE(e){const t={},n=e.currentTarget;if((null==n?void 0:n._ripple)&&!n._ripple.touched&&!e[qE]){if(e[qE]=!0,KE(e))n._ripple.touched=!0,n._ripple.isTouch=!0;else if(n._ripple.isTouch)return;if(t.center=n._ripple.centered||HE(e),n._ripple.class&&(t.class=n._ripple.class),KE(e)){if(n._ripple.showTimerCommit)return;n._ripple.showTimerCommit=()=>{WE.show(e,n,t)},n._ripple.showTimer=window.setTimeout(()=>{var e;(null==(e=null==n?void 0:n._ripple)?void 0:e.showTimerCommit)&&(n._ripple.showTimerCommit(),n._ripple.showTimerCommit=null)},80)}else WE.show(e,n,t)}}function XE(e){e[qE]=!0}function JE(e){const t=e.currentTarget;if(null==t?void 0:t._ripple){if(window.clearTimeout(t._ripple.showTimer),"touchend"===e.type&&t._ripple.showTimerCommit)return t._ripple.showTimerCommit(),t._ripple.showTimerCommit=null,void(t._ripple.showTimer=window.setTimeout(()=>{JE(e)}));window.setTimeout(()=>{t._ripple&&(t._ripple.touched=!1)}),WE.hide(t)}}function ZE(e){const t=e.currentTarget;(null==t?void 0:t._ripple)&&(t._ripple.showTimerCommit&&(t._ripple.showTimerCommit=null),window.clearTimeout(t._ripple.showTimer))}let ex=!1;function tx(e,t){!ex&&t.includes(e.key)&&(ex=!0,YE(e))}function nx(e){ex=!1,JE(e)}function rx(e){ex&&(ex=!1,JE(e))}function ix(e,t,n){const{value:r,modifiers:i}=t,s=QE(r);s||WE.hide(e),e._ripple=e._ripple??{},e._ripple.enabled=s,e._ripple.centered=i.center,e._ripple.circle=i.circle;const a=ke(r)?r:{};a.class&&(e._ripple.class=a.class);const o=a.keys??["Enter","Space"];if(e._ripple.keyDownHandler=e=>tx(e,o),s&&!n){if(i.stop)return e.addEventListener("touchstart",XE,{passive:!0}),void e.addEventListener("mousedown",XE);e.addEventListener("touchstart",YE,{passive:!0}),e.addEventListener("touchend",JE,{passive:!0}),e.addEventListener("touchmove",ZE,{passive:!0}),e.addEventListener("touchcancel",JE),e.addEventListener("mousedown",YE),e.addEventListener("mouseup",JE),e.addEventListener("mouseleave",JE),e.addEventListener("keydown",e=>tx(e,o)),e.addEventListener("keyup",nx),e.addEventListener("blur",rx),e.addEventListener("dragstart",JE,{passive:!0})}else!s&&n&&sx(e)}function sx(e){var t;e.removeEventListener("mousedown",YE),e.removeEventListener("touchstart",YE),e.removeEventListener("touchend",JE),e.removeEventListener("touchmove",ZE),e.removeEventListener("touchcancel",JE),e.removeEventListener("mouseup",JE),e.removeEventListener("mouseleave",JE),(null==(t=e._ripple)?void 0:t.keyDownHandler)&&e.removeEventListener("keydown",e._ripple.keyDownHandler),e.removeEventListener("keyup",nx),e.removeEventListener("dragstart",JE),e.removeEventListener("blur",rx)}const ax={mounted:function(e,t){ix(e,t,!1)},unmounted:function(e){sx(e),delete e._ripple},updated:function(e,t){if(t.value===t.oldValue)return;ix(e,t,QE(t.oldValue))}},ox=oe({active:{type:Boolean,default:void 0},activeColor:String,baseColor:String,symbol:{type:null,default:kE},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:Ie,appendIcon:Ie,block:Boolean,readonly:Boolean,slim:Boolean,stacked:Boolean,ripple:{type:[Boolean,Object],default:!0},text:{type:[String,Number,Boolean],default:void 0},...iE(),..._e(),...oE(),...KC(),...mE(),...wE(),...OE(),...DE(),...BE(),...YC(),...jE(),...$C(),...zC({tag:"button"}),...we(),...dE({variant:"elevated"})},"VBtn"),lx=ae()({name:"VBtn",props:ox(),emits:{"group:selected":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const{themeClasses:i}=xe(e),{borderClasses:s}=sE(e),{densityClasses:a}=lE(e),{dimensionStyles:o}=HC(e),{elevationClasses:l}=vE(e),{loaderClasses:u}=ME(e),{locationStyles:c}=PE(e),{positionClasses:p}=UE(e),{roundedClasses:m}=XC(e),{sizeClasses:v,sizeStyles:g}=jC(e),b=_E(e,e.symbol,!1),w=$E(e,n),I=f(()=>{var t;return void 0!==e.active?e.active:w.isLink.value?null==(t=w.isActive)?void 0:t.value:null==b?void 0:b.isSelected.value}),S=x(()=>I.value?e.activeColor??e.color:e.color),T=f(()=>{var t,n;return{color:(null==b?void 0:b.isSelected.value)&&(!w.isLink.value||(null==(t=w.isActive)?void 0:t.value))||!b||(null==(n=w.isActive)?void 0:n.value)?S.value??e.baseColor:e.baseColor,variant:e.variant}}),{colorClasses:C,colorStyles:E,variantClasses:N}=hE(T),D=f(()=>(null==b?void 0:b.disabled.value)||e.disabled),P=x(()=>"elevated"===e.variant&&!(e.disabled||e.flat||e.border)),R=f(()=>{if(void 0!==e.value&&"symbol"!=typeof e.value)return Object(e.value)===e.value?JSON.stringify(e.value,null,0):e.value});function V(e){var t;D.value||w.isLink.value&&(e.metaKey||e.ctrlKey||e.shiftKey||0!==e.button||"_blank"===n.target)||(null==(t=w.navigate)||t.call(w,e),null==b||b.toggle())}return function(e,t){d(()=>{var t;return null==(t=e.isActive)?void 0:t.value},n=>{e.isLink.value&&null!=n&&t&&h(()=>{t(n)})},{immediate:!0})}(w,null==b?void 0:b.select),be(()=>{const t=w.isLink.value?"a":e.tag,n=!(!e.prependIcon&&!r.prepend),d=!(!e.appendIcon&&!r.append),h=!(!e.icon||!0===e.icon);return A(y(t,k({type:"a"===t?void 0:"button",class:["v-btn",null==b?void 0:b.selectedClass.value,{"v-btn--active":I.value,"v-btn--block":e.block,"v-btn--disabled":D.value,"v-btn--elevated":P.value,"v-btn--flat":e.flat,"v-btn--icon":!!e.icon,"v-btn--loading":e.loading,"v-btn--readonly":e.readonly,"v-btn--slim":e.slim,"v-btn--stacked":e.stacked},i.value,s.value,C.value,a.value,l.value,u.value,p.value,m.value,v.value,N.value,e.class],style:[E.value,o.value,c.value,g.value,e.style],"aria-busy":!!e.loading||void 0,disabled:D.value||void 0,tabindex:e.loading||e.readonly?-1:void 0,onClick:V,value:R.value},w.linkProps),{default:()=>{var t;return[cE(!0,"v-btn"),!e.icon&&n&&_("span",{key:"prepend",class:"v-btn__prepend"},[r.prepend?y(MC,{key:"prepend-defaults",disabled:!e.prependIcon,defaults:{VIcon:{icon:e.prependIcon}}},r.prepend):y(GC,{key:"prepend-icon",icon:e.prependIcon},null)]),_("span",{class:"v-btn__content","data-no-activator":""},[!r.default&&h?y(GC,{key:"content-icon",icon:e.icon},null):y(MC,{key:"content-defaults",disabled:!h,defaults:{VIcon:{icon:e.icon}}},{default:()=>{var t;return[(null==(t=r.default)?void 0:t.call(r))??B(e.text)]}})]),!e.icon&&d&&_("span",{key:"append",class:"v-btn__append"},[r.append?y(MC,{key:"append-defaults",disabled:!e.appendIcon,defaults:{VIcon:{icon:e.appendIcon}}},r.append):y(GC,{key:"append-icon",icon:e.appendIcon},null)]),!!e.loading&&_("span",{key:"loader",class:"v-btn__loader"},[(null==(t=r.loader)?void 0:t.call(r))??y(AE,{color:"boolean"==typeof e.loading?void 0:e.loading,indeterminate:!0,width:"2"},null)])]}}),[[ax,!D.value&&e.ripple,"",{center:!!e.icon}]])}),{group:b}}}),ux=oe({color:String,inset:Boolean,length:[Number,String],opacity:[Number,String],thickness:[Number,String],vertical:Boolean,..._e(),...we()},"VDivider"),cx=ae()({name:"VDivider",props:ux(),setup(e,t){let{attrs:n,slots:r}=t;const{themeClasses:i}=xe(e),{textColorClasses:s,textColorStyles:a}=FC(()=>e.color),o=f(()=>{const t={};return e.length&&(t[e.vertical?"height":"width"]=ve(e.length)),e.thickness&&(t[e.vertical?"borderRightWidth":"borderTopWidth"]=ve(e.thickness)),t});return be(()=>{const t=_("hr",{class:w([{"v-divider":!0,"v-divider--inset":e.inset,"v-divider--vertical":e.vertical},i.value,s.value,e.class]),style:b([o.value,a.value,{"--v-border-opacity":e.opacity},e.style]),"aria-orientation":n.role&&"separator"!==n.role?void 0:e.vertical?"vertical":"horizontal",role:`${n.role||"separator"}`},null);return r.default?_("div",{class:w(["v-divider__wrapper",{"v-divider__wrapper--vertical":e.vertical,"v-divider__wrapper--inset":e.inset}])},[t,_("div",{class:"v-divider__content"},[r.default()]),t]):t}),{}}}),dx=oe({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function hx(e,t,n){return ae()({name:e,props:dx({mode:n,origin:t}),setup(t,n){let{slots:r}=n;const i={onBeforeEnter(e){t.origin&&(e.style.transformOrigin=t.origin)},onLeave(e){if(t.leaveAbsolute){const{offsetTop:t,offsetLeft:n,offsetWidth:r,offsetHeight:i}=e;e._transitionInitialStyles={position:e.style.position,top:e.style.top,left:e.style.left,width:e.style.width,height:e.style.height},e.style.position="absolute",e.style.top=`${t}px`,e.style.left=`${n}px`,e.style.width=`${r}px`,e.style.height=`${i}px`}t.hideOnLeave&&e.style.setProperty("display","none","important")},onAfterLeave(e){if(t.leaveAbsolute&&(null==e?void 0:e._transitionInitialStyles)){const{position:t,top:n,left:r,width:i,height:s}=e._transitionInitialStyles;delete e._transitionInitialStyles,e.style.position=t||"",e.style.top=n||"",e.style.left=r||"",e.style.width=i||"",e.style.height=s||""}}};return()=>{const n=t.group?I:S;return T(n,{name:t.disabled?"":e,css:!t.disabled,...t.group?void 0:{mode:t.mode},...t.disabled?{}:i},r.default)}}})}function px(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"in-out";return ae()({name:e,props:{mode:{type:String,default:n},disabled:Boolean,group:Boolean},setup(n,r){let{slots:i}=r;const s=n.group?I:S;return()=>T(s,{name:n.disabled?"":e,css:!n.disabled,...n.disabled?{}:t},i.default)}})}function fx(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?"width":"height",n=U(`offset-${t}`);return{onBeforeEnter(e){e._parent=e.parentNode,e._initialStyle={transition:e.style.transition,overflow:e.style.overflow,[t]:e.style[t]}},onEnter(r){const i=r._initialStyle;if(!i)return;r.style.setProperty("transition","none","important"),r.style.overflow="hidden";const s=`${r[n]}px`;r.style[t]="0",r.offsetHeight,r.style.transition=i.transition,e&&r._parent&&r._parent.classList.add(e),requestAnimationFrame(()=>{r.style[t]=s})},onAfterEnter:i,onEnterCancelled:i,onLeave(e){e._initialStyle={transition:"",overflow:e.style.overflow,[t]:e.style[t]},e.style.overflow="hidden",e.style[t]=`${e[n]}px`,e.offsetHeight,requestAnimationFrame(()=>e.style[t]="0")},onAfterLeave:r,onLeaveCancelled:r};function r(t){e&&t._parent&&t._parent.classList.remove(e),i(t)}function i(e){if(!e._initialStyle)return;const n=e._initialStyle[t];e.style.overflow=e._initialStyle.overflow,null!=n&&(e.style[t]=n),delete e._initialStyle}}const mx=oe({target:[Object,Array]},"v-dialog-transition"),vx=new WeakMap,gx=ae()({name:"VDialogTransition",props:mx(),setup(e,t){let{slots:n}=t;const r={onBeforeEnter(e){e.style.pointerEvents="none",e.style.visibility="hidden"},async onEnter(t,n){var r;await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>requestAnimationFrame(e)),t.style.visibility="";const i=bx(e.target,t),{x:s,y:a,sx:o,sy:l,speed:u}=i;vx.set(t,i);const c=Be(t,[{transform:`translate(${s}px, ${a}px) scale(${o}, ${l})`,opacity:0},{}],{duration:225*u,easing:je});null==(r=yx(t))||r.forEach(e=>{Be(e,[{opacity:0},{opacity:0,offset:.33},{}],{duration:450*u,easing:$e})}),c.finished.then(()=>n())},onAfterEnter(e){e.style.removeProperty("pointer-events")},onBeforeLeave(e){e.style.pointerEvents="none"},async onLeave(t,n){var r;let i;await new Promise(e=>requestAnimationFrame(e)),i=!vx.has(t)||Array.isArray(e.target)||e.target.offsetParent||e.target.getClientRects().length?bx(e.target,t):vx.get(t);const{x:s,y:a,sx:o,sy:l,speed:u}=i;Be(t,[{},{transform:`translate(${s}px, ${a}px) scale(${o}, ${l})`,opacity:0}],{duration:125*u,easing:Ue}).finished.then(()=>n()),null==(r=yx(t))||r.forEach(e=>{Be(e,[{},{opacity:0,offset:.2},{opacity:0}],{duration:250*u,easing:$e})})},onAfterLeave(e){e.style.removeProperty("pointer-events")}};return()=>e.target?y(S,k({name:"dialog-transition"},r,{css:!1}),n):y(S,{name:"dialog-transition"},n)}});function yx(e){var t;const n=null==(t=e.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list"))?void 0:t.children;return n&&[...n]}function bx(e,t){const n=ze(e),r=qe(t),[i,s]=getComputedStyle(t).transformOrigin.split(" ").map(e=>parseFloat(e)),[a,o]=getComputedStyle(t).getPropertyValue("--v-overlay-anchor-origin").split(" ");let l=n.left+n.width/2;"left"===a||"left"===o?l-=n.width/2:"right"!==a&&"right"!==o||(l+=n.width/2);let u=n.top+n.height/2;"top"===a||"top"===o?u-=n.height/2:"bottom"!==a&&"bottom"!==o||(u+=n.height/2);const c=n.width/r.width,d=n.height/r.height,h=Math.max(1,c,d),p=c/h||0,f=d/h||0,m=r.width*r.height/(window.innerWidth*window.innerHeight),v=m>.12?Math.min(1.5,10*(m-.12)+1):1;return{x:l-(i+r.left),y:u-(s+r.top),sx:p,sy:f,speed:v}}hx("fab-transition","center center","out-in"),hx("dialog-bottom-transition"),hx("dialog-top-transition");const wx=hx("fade-transition");hx("scale-transition"),hx("scroll-x-transition"),hx("scroll-x-reverse-transition"),hx("scroll-y-transition"),hx("scroll-y-reverse-transition"),hx("slide-x-transition"),hx("slide-x-reverse-transition");const _x=hx("slide-y-transition");hx("slide-y-reverse-transition");const Ix=px("expand-transition",fx()),Sx=px("expand-x-transition",fx("",!0)),kx=Symbol.for("vuetify:list");function Tx(){let{filterable:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{filterable:!1};const t=r(kx,{filterable:!1,hasPrepend:v(!1),updateHasPrepend:()=>null}),n={filterable:t.filterable||e,hasPrepend:v(!1),updateHasPrepend:e=>{e&&(n.hasPrepend.value=e)}};return O(kx,n),t}function Cx(){return r(kx,null)}const Ex=e=>{const t={activate:t=>{let{id:n,value:r,activated:i}=t;return n=l(n),e&&!r&&1===i.size&&i.has(n)||(r?i.add(n):i.delete(n)),i},in:(e,n,r)=>{let i=new Set;if(null!=e)for(const s of De(e))i=t.activate({id:s,value:!0,activated:new Set(i),children:n,parents:r});return i},out:e=>Array.from(e)};return t},xx=e=>{const t=Ex(e);return{activate:e=>{let{activated:n,id:r,...i}=e;r=l(r);const s=n.has(r)?new Set([r]):new Set;return t.activate({...i,id:r,activated:s})},in:(e,n,r)=>{let i=new Set;if(null!=e){const s=De(e);s.length&&(i=t.in(s.slice(0,1),n,r))}return i},out:(e,n,r)=>t.out(e,n,r)}},Ax={open:e=>{let{id:t,value:n,opened:r,parents:i}=e;if(n){const e=new Set;e.add(t);let n=i.get(t);for(;null!=n;)e.add(n),n=i.get(n);return e}return r.delete(t),r},select:()=>null},Nx={open:e=>{let{id:t,value:n,opened:r,parents:i}=e;if(n){let e=i.get(t);for(r.add(t);null!=e&&e!==t;)r.add(e),e=i.get(e);return r}return r.delete(t),r},select:()=>null},Dx={open:Nx.open,select:e=>{let{id:t,value:n,opened:r,parents:i}=e;if(!n)return r;const s=[];let a=i.get(t);for(;null!=a;)s.push(a),a=i.get(a);return new Set(s)}},Px=e=>{const t={select:t=>{let{id:n,value:r,selected:i}=t;if(n=l(n),e&&!r){const e=Array.from(i.entries()).reduce((e,t)=>{let[n,r]=t;return"on"===r&&e.push(n),e},[]);if(1===e.length&&e[0]===n)return i}return i.set(n,r?"on":"off"),i},in:(e,n,r,i)=>{const s=new Map;for(const a of e||[])t.select({id:a,value:!0,selected:s,children:n,parents:r,disabled:i});return s},out:e=>{const t=[];for(const[n,r]of e.entries())"on"===r&&t.push(n);return t}};return t},Rx=e=>{const t=Px(e);return{select:e=>{let{selected:n,id:r,...i}=e;r=l(r);const s=n.has(r)?new Map([[r,n.get(r)]]):new Map;return t.select({...i,id:r,selected:s})},in:(e,n,r,i)=>(null==e?void 0:e.length)?t.in(e.slice(0,1),n,r,i):new Map,out:(e,n,r)=>t.out(e,n,r)}},Vx=e=>{const t={select:t=>{let{id:n,value:r,selected:i,children:s,parents:a,disabled:o}=t;n=l(n);const u=new Map(i),c=[n];for(;c.length;){const e=c.shift();o.has(e)||i.set(l(e),r?"on":"off"),s.has(e)&&c.push(...s.get(e))}let d=l(a.get(n));for(;d;){let e=!0,t=!0;for(const n of s.get(d)){const r=l(n);if(!o.has(r)&&("on"!==i.get(r)&&(e=!1),i.has(r)&&"off"!==i.get(r)&&(t=!1),!e&&!t))break}i.set(d,e?"on":t?"off":"indeterminate"),d=l(a.get(d))}if(e&&!r){if(0===Array.from(i.entries()).reduce((e,t)=>{let[n,r]=t;return"on"===r&&e.push(n),e},[]).length)return u}return i},in:(e,n,r,i)=>{let s=new Map;for(const a of e||[])s=t.select({id:a,value:!0,selected:s,children:n,parents:r,disabled:i});return s},out:(e,t)=>{const n=[];for(const[r,i]of e.entries())"on"!==i||t.has(r)||n.push(r);return n}};return t},Ox=Symbol.for("vuetify:nested"),Mx={id:v(),root:{register:()=>null,unregister:()=>null,children:t(new Map),parents:t(new Map),disabled:t(new Set),open:()=>null,openOnSelect:()=>null,activate:()=>null,select:()=>null,activatable:t(!1),selectable:t(!1),opened:t(new Set),activated:t(new Set),selected:t(new Map),selectedValues:t([]),getPath:()=>[]}},Lx=oe({activatable:Boolean,selectable:Boolean,activeStrategy:[String,Function,Object],selectStrategy:[String,Function,Object],openStrategy:[String,Object],opened:null,activated:null,selected:null,mandatory:Boolean},"nested"),Fx=e=>{let t=!1;const n=v(new Map),r=v(new Map),i=v(new Set),s=Ae(e,"opened",e.opened,e=>new Set(Array.isArray(e)?e.map(e=>l(e)):e),e=>[...e.values()]),a=f(()=>{if("object"==typeof e.activeStrategy)return e.activeStrategy;if("function"==typeof e.activeStrategy)return e.activeStrategy(e.mandatory);switch(e.activeStrategy){case"leaf":return(e=>{const t=Ex(e);return{activate:e=>{let{id:n,activated:r,children:i,...s}=e;return n=l(n),i.has(n)?r:t.activate({id:n,activated:r,children:i,...s})},in:t.in,out:t.out}})(e.mandatory);case"single-leaf":return(e=>{const t=xx(e);return{activate:e=>{let{id:n,activated:r,children:i,...s}=e;return n=l(n),i.has(n)?r:t.activate({id:n,activated:r,children:i,...s})},in:t.in,out:t.out}})(e.mandatory);case"independent":return Ex(e.mandatory);default:return xx(e.mandatory)}}),o=f(()=>{if("object"==typeof e.selectStrategy)return e.selectStrategy;if("function"==typeof e.selectStrategy)return e.selectStrategy(e.mandatory);switch(e.selectStrategy){case"single-leaf":return(e=>{const t=Rx(e);return{select:e=>{let{id:n,selected:r,children:i,...s}=e;return n=l(n),i.has(n)?r:t.select({id:n,selected:r,children:i,...s})},in:t.in,out:t.out}})(e.mandatory);case"leaf":return(e=>{const t=Px(e);return{select:e=>{let{id:n,selected:r,children:i,...s}=e;return n=l(n),i.has(n)?r:t.select({id:n,selected:r,children:i,...s})},in:t.in,out:t.out}})(e.mandatory);case"independent":return Px(e.mandatory);case"single-independent":return Rx(e.mandatory);case"trunk":return(e=>{const t=Vx(e);return{select:t.select,in:t.in,out:(e,t,n)=>{const r=[];for(const[i,s]of e.entries())if("on"===s){if(n.has(i)){const t=n.get(i);if("on"===e.get(t))continue}r.push(i)}return r}}})(e.mandatory);default:return Vx(e.mandatory)}}),u=f(()=>{if("object"==typeof e.openStrategy)return e.openStrategy;switch(e.openStrategy){case"list":return Dx;case"single":return Ax;default:return Nx}}),c=Ae(e,"activated",e.activated,e=>a.value.in(e,n.value,r.value),e=>a.value.out(e,n.value,r.value)),d=Ae(e,"selected",e.selected,e=>o.value.in(e,n.value,r.value,i.value),e=>o.value.out(e,n.value,r.value));function h(e){const t=[];let n=l(e);for(;null!=n;)t.unshift(n),n=r.value.get(n);return t}E(()=>{t=!0});const p=Ee("nested"),m=new Set,g={id:v(),root:{opened:s,activatable:x(()=>e.activatable),selectable:x(()=>e.selectable),activated:c,selected:d,selectedValues:f(()=>{const e=[];for(const[t,n]of d.value.entries())"on"===n&&e.push(t);return e}),register:(e,t,s,a)=>{if(m.has(e))return h(e).map(String).join(" -> "),void h(t).concat(e).map(String).join(" -> ");m.add(e),t&&e!==t&&r.value.set(e,t),s&&i.value.add(e),a&&n.value.set(e,[]),null!=t&&n.value.set(t,[...n.value.get(t)||[],e])},unregister:e=>{if(t)return;m.delete(e),n.value.delete(e),i.value.delete(e);const s=r.value.get(e);if(s){const t=n.value.get(s)??[];n.value.set(s,t.filter(t=>t!==e))}r.value.delete(e)},open:(e,t,i)=>{p.emit("click:open",{id:e,value:t,path:h(e),event:i});const a=u.value.open({id:e,value:t,opened:new Set(s.value),children:n.value,parents:r.value,event:i});a&&(s.value=a)},openOnSelect:(e,t,i)=>{const a=u.value.select({id:e,value:t,selected:new Map(d.value),opened:new Set(s.value),children:n.value,parents:r.value,event:i});a&&(s.value=a)},select:(e,t,s)=>{p.emit("click:select",{id:e,value:t,path:h(e),event:s});const a=o.value.select({id:e,value:t,selected:new Map(d.value),children:n.value,parents:r.value,disabled:i.value,event:s});a&&(d.value=a),g.root.openOnSelect(e,t,s)},activate:(t,i,s)=>{if(!e.activatable)return g.root.select(t,!0,s);p.emit("click:activate",{id:t,value:i,path:h(t),event:s});const o=a.value.activate({id:t,value:i,activated:new Set(c.value),children:n.value,parents:r.value,event:s});if(o.size!==c.value.size)c.value=o;else{for(const e of o)if(!c.value.has(e))return void(c.value=o);for(const e of c.value)if(!o.has(e))return void(c.value=o)}},children:n,parents:r,disabled:i,getPath:h}};return O(Ox,g),g.root},Bx=(e,t,n)=>{const i=r(Ox,Mx),s=Symbol("nested item"),a=f(()=>l(m(e))??s),o={...i,id:a,open:(e,t)=>i.root.open(a.value,e,t),openOnSelect:(e,t)=>i.root.openOnSelect(a.value,e,t),isOpen:f(()=>i.root.opened.value.has(a.value)),parent:f(()=>i.root.parents.value.get(a.value)),activate:(e,t)=>i.root.activate(a.value,e,t),isActivated:f(()=>i.root.activated.value.has(a.value)),select:(e,t)=>i.root.select(a.value,e,t),isSelected:f(()=>"on"===i.root.selected.value.get(a.value)),isIndeterminate:f(()=>"indeterminate"===i.root.selected.value.get(a.value)),isLeaf:f(()=>!i.root.children.value.get(a.value)),isGroupActivator:i.isGroupActivator};return C(()=>{i.isGroupActivator||i.root.register(a.value,i.id.value,m(t),n)}),E(()=>{i.isGroupActivator||i.root.unregister(a.value)}),n&&O(Ox,o),o};function Ux(){const e=v(!1);P(()=>{window.requestAnimationFrame(()=>{e.value=!0})});return{ssrBootStyles:x(()=>e.value?void 0:{transition:"none !important"}),isBooted:$(e)}}const $x=Ge({name:"VListGroupActivator",setup(e,t){let{slots:n}=t;return(()=>{const e=r(Ox,Mx);O(Ox,{...e,isGroupActivator:!0})})(),()=>{var e;return null==(e=n.default)?void 0:e.call(n)}}}),jx=oe({activeColor:String,baseColor:String,color:String,collapseIcon:{type:Ie,default:"$collapse"},disabled:Boolean,expandIcon:{type:Ie,default:"$expand"},rawId:[String,Number],prependIcon:Ie,appendIcon:Ie,fluid:Boolean,subgroup:Boolean,title:String,value:null,..._e(),...zC()},"VListGroup"),zx=ae()({name:"VListGroup",props:jx(),setup(e,t){let{slots:n}=t;const{isOpen:r,open:i,id:s}=Bx(()=>e.value,()=>e.disabled,!0),a=f(()=>`v-list-group--id-${String(e.rawId??s.value)}`),o=Cx(),{isBooted:l}=Ux();function u(e){var t;["INPUT","TEXTAREA"].includes(null==(t=e.target)?void 0:t.tagName)||i(!r.value,e)}const c=f(()=>({onClick:u,class:"v-list-group__header",id:a.value})),d=f(()=>r.value?e.collapseIcon:e.expandIcon),h=f(()=>({VListItem:{activeColor:e.activeColor,baseColor:e.baseColor,color:e.color,prependIcon:e.prependIcon||e.subgroup&&d.value,appendIcon:e.appendIcon||!e.subgroup&&d.value,title:e.title,value:e.value}}));return be(()=>y(e.tag,{class:w(["v-list-group",{"v-list-group--prepend":null==o?void 0:o.hasPrepend.value,"v-list-group--fluid":e.fluid,"v-list-group--subgroup":e.subgroup,"v-list-group--open":r.value},e.class]),style:b(e.style)},{default:()=>[n.activator&&y(MC,{defaults:h.value},{default:()=>[y($x,null,{default:()=>[n.activator({props:c.value,isOpen:r.value})]})]}),y(ZC,{transition:{component:Ix},disabled:!l.value},{default:()=>{var e;return[A(_("div",{class:"v-list-group__items",role:"group","aria-labelledby":a.value},[null==(e=n.default)?void 0:e.call(n)]),[[D,r.value]])]}})]})),{isOpen:r}}}),qx=oe({opacity:[Number,String],..._e(),...zC()},"VListItemSubtitle"),Gx=ae()({name:"VListItemSubtitle",props:qx(),setup(e,t){let{slots:n}=t;return be(()=>y(e.tag,{class:w(["v-list-item-subtitle",e.class]),style:b([{"--v-list-item-subtitle-opacity":e.opacity},e.style])},n)),{}}}),Kx=Ke("v-list-item-title"),Hx=oe({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:Ie,baseColor:String,disabled:Boolean,lines:[Boolean,String],link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:Ie,ripple:{type:[Boolean,Object],default:!0},slim:Boolean,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},value:null,onClick:We(),onClickOnce:We(),...iE(),..._e(),...oE(),...KC(),...mE(),...YC(),...jE(),...zC(),...we(),...dE({variant:"text"})},"VListItem"),Wx=ae()({name:"VListItem",directives:{vRipple:ax},props:Hx(),emits:{click:e=>!0},setup(e,t){let{attrs:n,slots:r,emit:i}=t;const s=$E(e,n),a=f(()=>void 0===e.value?s.href.value:e.value),{activate:o,isActivated:l,select:u,isOpen:c,isSelected:h,isIndeterminate:p,isGroupActivator:m,root:v,parent:g,openOnSelect:b,id:w}=Bx(a,()=>e.disabled,!1),I=Cx(),S=f(()=>{var t;return!1!==e.active&&(e.active||(null==(t=s.isActive)?void 0:t.value)||(v.activatable.value?l.value:h.value))}),T=x(()=>!1!==e.link&&s.isLink.value),E=f(()=>!!I&&(v.selectable.value||v.activatable.value||null!=e.value)),D=f(()=>!e.disabled&&!1!==e.link&&(e.link||s.isClickable.value||E.value)),P=x(()=>e.rounded||e.nav),R=x(()=>e.color??e.activeColor),V=x(()=>({color:S.value?R.value??e.baseColor:e.baseColor,variant:e.variant}));function O(){null!=g.value&&v.open(g.value,!0),b(!0)}d(()=>{var e;return null==(e=s.isActive)?void 0:e.value},e=>{e&&O()}),C(()=>{var e;(null==(e=s.isActive)?void 0:e.value)&&O()});const{themeClasses:M}=xe(e),{borderClasses:L}=sE(e),{colorClasses:F,colorStyles:U,variantClasses:$}=hE(V),{densityClasses:j}=lE(e),{dimensionStyles:z}=HC(e),{elevationClasses:q}=vE(e),{roundedClasses:G}=XC(P),K=x(()=>e.lines?`v-list-item--${e.lines}-line`:void 0),H=x(()=>void 0!==e.ripple&&e.ripple&&(null==I?void 0:I.filterable)?{keys:["Enter"]}:e.ripple),W=f(()=>({isActive:S.value,select:u,isOpen:c.value,isSelected:h.value,isIndeterminate:p.value}));function Q(t){var n,r;i("click",t),["INPUT","TEXTAREA"].includes(null==(n=t.target)?void 0:n.tagName)||D.value&&(null==(r=s.navigate)||r.call(s,t),m||(v.activatable.value?o(!l.value,t):(v.selectable.value||null!=e.value)&&u(!h.value,t)))}function Y(e){const t=e.target;["INPUT","TEXTAREA"].includes(t.tagName)||("Enter"===e.key||" "===e.key&&!(null==I?void 0:I.filterable))&&(e.preventDefault(),e.stopPropagation(),e.target.dispatchEvent(new MouseEvent("click",e)))}return be(()=>{const t=T.value?"a":e.tag,n=r.title||null!=e.title,i=r.subtitle||null!=e.subtitle,a=!(!e.appendAvatar&&!e.appendIcon),o=!(!a&&!r.append),u=!(!e.prependAvatar&&!e.prependIcon),c=!(!u&&!r.prepend);return null==I||I.updateHasPrepend(c),e.activeColor&&He("active-color",["color","base-color"]),A(y(t,k({class:["v-list-item",{"v-list-item--active":S.value,"v-list-item--disabled":e.disabled,"v-list-item--link":D.value,"v-list-item--nav":e.nav,"v-list-item--prepend":!c&&(null==I?void 0:I.hasPrepend.value),"v-list-item--slim":e.slim,[`${e.activeClass}`]:e.activeClass&&S.value},M.value,L.value,F.value,j.value,q.value,K.value,G.value,$.value,e.class],style:[U.value,z.value,e.style],tabindex:D.value?I?-2:0:void 0,"aria-selected":E.value?v.activatable.value?l.value:v.selectable.value?h.value:S.value:void 0,onClick:Q,onKeydown:D.value&&!T.value&&Y},s.linkProps),{default:()=>{var t;return[cE(D.value||S.value,"v-list-item"),c&&_("div",{key:"prepend",class:"v-list-item__prepend"},[r.prepend?y(MC,{key:"prepend-defaults",disabled:!u,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon},VListItemAction:{start:!0}}},{default:()=>{var e;return[null==(e=r.prepend)?void 0:e.call(r,W.value)]}}):_(N,null,[e.prependAvatar&&y(fE,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&y(GC,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)]),_("div",{class:"v-list-item__spacer"},null)]),_("div",{class:"v-list-item__content","data-no-activator":""},[n&&y(Kx,{key:"title"},{default:()=>{var t;return[(null==(t=r.title)?void 0:t.call(r,{title:e.title}))??B(e.title)]}}),i&&y(Gx,{key:"subtitle"},{default:()=>{var t;return[(null==(t=r.subtitle)?void 0:t.call(r,{subtitle:e.subtitle}))??B(e.subtitle)]}}),null==(t=r.default)?void 0:t.call(r,W.value)]),o&&_("div",{key:"append",class:"v-list-item__append"},[r.append?y(MC,{key:"append-defaults",disabled:!a,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon},VListItemAction:{end:!0}}},{default:()=>{var e;return[null==(e=r.append)?void 0:e.call(r,W.value)]}}):_(N,null,[e.appendIcon&&y(GC,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&y(fE,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)]),_("div",{class:"v-list-item__spacer"},null)])]}}),[[ax,D.value&&H.value]])}),{activate:o,isActivated:l,isGroupActivator:m,isSelected:h,list:I,select:u,root:v,id:w,link:s}}}),Qx=oe({color:String,inset:Boolean,sticky:Boolean,title:String,..._e(),...zC()},"VListSubheader"),Yx=ae()({name:"VListSubheader",props:Qx(),setup(e,t){let{slots:n}=t;const{textColorClasses:r,textColorStyles:i}=FC(()=>e.color);return be(()=>{const t=!(!n.default&&!e.title);return y(e.tag,{class:w(["v-list-subheader",{"v-list-subheader--inset":e.inset,"v-list-subheader--sticky":e.sticky},r.value,e.class]),style:b([{textColorStyles:i},e.style])},{default:()=>{var r;return[t&&_("div",{class:"v-list-subheader__text"},[(null==(r=n.default)?void 0:r.call(n))??e.title])]}})}),{}}}),Xx=oe({items:Array,returnObject:Boolean},"VListChildren"),Jx=ae()({name:"VListChildren",props:Xx(),setup(e,t){let{slots:n}=t;return Tx(),()=>{var t,r;return(null==(t=n.default)?void 0:t.call(n))??(null==(r=e.items)?void 0:r.map(t=>{var r,i;let{children:s,props:a,type:o,raw:l}=t;if("divider"===o)return(null==(r=n.divider)?void 0:r.call(n,{props:a}))??y(cx,a,null);if("subheader"===o)return(null==(i=n.subheader)?void 0:i.call(n,{props:a}))??y(Yx,a,null);const u={subtitle:n.subtitle?e=>{var t;return null==(t=n.subtitle)?void 0:t.call(n,{...e,item:l})}:void 0,prepend:n.prepend?e=>{var t;return null==(t=n.prepend)?void 0:t.call(n,{...e,item:l})}:void 0,append:n.append?e=>{var t;return null==(t=n.append)?void 0:t.call(n,{...e,item:l})}:void 0,title:n.title?e=>{var t;return null==(t=n.title)?void 0:t.call(n,{...e,item:l})}:void 0},c=zx.filterProps(a);return s?y(zx,k(c,{value:e.returnObject?l:null==a?void 0:a.value,rawId:null==a?void 0:a.value}),{activator:t=>{let{props:r}=t;const i=k(a,r,{value:e.returnObject?l:a.value});return n.header?n.header({props:i}):y(Wx,i,u)},default:()=>y(Jx,{items:s,returnObject:e.returnObject},n)}):n.item?n.item({props:a}):y(Wx,k(a,{value:e.returnObject?l:a.value}),u)}))}}}),Zx=oe({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},itemType:{type:[Boolean,String,Array,Function],default:"type"},returnObject:Boolean,valueComparator:Function},"list-items"),eA=new Set(["item","divider","subheader"]);function tA(e,t){const n=Xe(t,e.itemTitle,t),r=Xe(t,e.itemValue,n),i=Xe(t,e.itemChildren),s=!0===e.itemProps?"object"!=typeof t||null==t||Array.isArray(t)?void 0:"children"in t?Je(t,["children"]):t:Xe(t,e.itemProps);let a=Xe(t,e.itemType,"item");eA.has(a)||(a="item");const o={title:n,value:r,...s};return{type:a,title:String(o.title??""),value:o.value,props:o,children:"item"===a&&Array.isArray(i)?nA(e,i):void 0,raw:t}}function nA(e,t){const n=Ye(e,tA.neededProps),r=[];for(const i of t)r.push(tA(n,i));return r}function rA(e){const t=f(()=>nA(e,e.items)),n=f(()=>t.value.some(e=>null===e.value)),r=v(new Map),i=v([]);return L(()=>{const e=t.value,n=new Map,s=[];for(let t=0;t<e.length;t++){const r=e[t];if(Qe(r.value)||null===r.value){let e=n.get(r.value);e||(e=[],n.set(r.value,e)),e.push(r)}else s.push(r)}r.value=n,i.value=s}),{items:t,transformIn:function(s){const a=r.value,o=t.value,l=i.value,u=n.value,c=e.returnObject,d=!!e.valueComparator,h=e.valueComparator||Ne,p=Ye(e,tA.neededProps),f=[];e:for(const e of s){if(!u&&null===e)continue;if(c&&"string"==typeof e){f.push(tA(p,e));continue}const t=a.get(e);if(!d&&t)f.push(...t);else{for(const t of d?o:l)if(h(e,t.value)){f.push(t);continue e}f.push(tA(p,e))}}return f},transformOut:function(t){return e.returnObject?t.map(e=>{let{raw:t}=e;return t}):t.map(e=>{let{value:t}=e;return t})}}}tA.neededProps=["itemTitle","itemValue","itemChildren","itemProps","itemType"];const iA=new Set(["item","divider","subheader"]);function sA(e,t){const n=Qe(t)?t:Xe(t,e.itemTitle),r=Qe(t)?t:Xe(t,e.itemValue,void 0),i=Xe(t,e.itemChildren),s=!0===e.itemProps?Je(t,["children"]):Xe(t,e.itemProps);let a=Xe(t,e.itemType,"item");iA.has(a)||(a="item");const o={title:n,value:r,...s};return{type:a,title:o.title,value:o.value,props:o,children:"item"===a&&i?aA(e,i):void 0,raw:t}}function aA(e,t){const n=[];for(const r of t)n.push(sA(e,r));return n}const oA=oe({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,filterable:Boolean,expandIcon:Ie,collapseIcon:Ie,lines:{type:[Boolean,String],default:"one"},slim:Boolean,nav:Boolean,"onClick:open":We(),"onClick:select":We(),"onUpdate:opened":We(),...Lx({selectStrategy:"single-leaf",openStrategy:"list"}),...iE(),..._e(),...oE(),...KC(),...mE(),...Zx(),...YC(),...zC(),...we(),...dE({variant:"text"})},"VList"),lA=ae()({name:"VList",props:oA(),emits:{"update:selected":e=>!0,"update:activated":e=>!0,"update:opened":e=>!0,"click:open":e=>!0,"click:activate":e=>!0,"click:select":e=>!0},setup(e,n){let{slots:r}=n;const{items:i}=function(e){return{items:f(()=>aA(e,e.items))}}(e),{themeClasses:s}=xe(e),{backgroundColorClasses:a,backgroundColorStyles:o}=BC(()=>e.bgColor),{borderClasses:l}=sE(e),{densityClasses:u}=lE(e),{dimensionStyles:c}=HC(e),{elevationClasses:d}=vE(e),{roundedClasses:h}=XC(e),{children:p,open:m,parents:g,select:_,getPath:I}=Fx(e),S=x(()=>e.lines?`v-list--${e.lines}-line`:void 0),k=x(()=>e.activeColor),T=x(()=>e.baseColor),C=x(()=>e.color);Tx({filterable:e.filterable}),le({VListGroup:{activeColor:k,baseColor:T,color:C,expandIcon:x(()=>e.expandIcon),collapseIcon:x(()=>e.collapseIcon)},VListItem:{activeClass:x(()=>e.activeClass),activeColor:k,baseColor:T,color:C,density:x(()=>e.density),disabled:x(()=>e.disabled),lines:x(()=>e.lines),nav:x(()=>e.nav),slim:x(()=>e.slim),variant:x(()=>e.variant)}});const E=v(!1),A=t();function N(e){E.value=!0}function D(e){E.value=!1}function P(e){var t;E.value||e.relatedTarget&&(null==(t=A.value)?void 0:t.contains(e.relatedTarget))||O()}function R(e){const t=e.target;if(A.value&&("INPUT"!==t.tagName||!["Home","End"].includes(e.key))&&"TEXTAREA"!==t.tagName){if("ArrowDown"===e.key)O("next");else if("ArrowUp"===e.key)O("prev");else if("Home"===e.key)O("first");else{if("End"!==e.key)return;O("last")}e.preventDefault()}}function V(e){E.value=!0}function O(e){if(A.value)return Ze(A.value,e)}return be(()=>y(e.tag,{ref:A,class:w(["v-list",{"v-list--disabled":e.disabled,"v-list--nav":e.nav,"v-list--slim":e.slim},s.value,a.value,l.value,u.value,d.value,S.value,h.value,e.class]),style:b([o.value,c.value,e.style]),tabindex:e.disabled?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:N,onFocusout:D,onFocus:P,onKeydown:R,onMousedown:V},{default:()=>[y(Jx,{items:i.value,returnObject:e.returnObject},r)]})),{open:m,select:_,focus:O,children:p,parents:g,getPath:I}}});function uA(e,t){return{x:e.x+t.x,y:e.y+t.y}}function cA(e,t){if("top"===e.side||"bottom"===e.side){const{side:n,align:r}=e;return uA({x:"left"===r?0:"center"===r?t.width/2:"right"===r?t.width:r,y:"top"===n?0:"bottom"===n?t.height:n},t)}if("left"===e.side||"right"===e.side){const{side:n,align:r}=e;return uA({x:"left"===n?0:"right"===n?t.width:n,y:"top"===r?0:"center"===r?t.height/2:"bottom"===r?t.height:r},t)}return uA({x:t.width/2,y:t.height/2},t)}const dA={static:function(){},connected:function(e,t,n){(Array.isArray(e.target.value)||tt(e.target.value))&&Object.assign(n.value,{position:"fixed",top:0,[e.isRtl.value?"right":"left"]:0});const{preferredAnchor:r,preferredOrigin:i}=ue(()=>{const n=Me(t.location,e.isRtl.value),r="overlap"===t.origin?n:"auto"===t.origin?nt(n):Me(t.origin,e.isRtl.value);return n.side===r.side&&n.align===rt(r).align?{preferredAnchor:it(n),preferredOrigin:it(r)}:{preferredAnchor:n,preferredOrigin:r}}),[s,a,o,l]=["minWidth","minHeight","maxWidth","maxHeight"].map(e=>f(()=>{const n=parseFloat(t[e]);return isNaN(n)?1/0:n})),u=f(()=>{if(Array.isArray(t.offset))return t.offset;if("string"==typeof t.offset){const e=t.offset.split(" ").map(parseFloat);return e.length<2&&e.push(0),e}return"number"==typeof t.offset?[t.offset,0]:[0,0]});let p=!1,m=-1;const v=new st(4),g=new ResizeObserver(()=>{if(!p)return;if(requestAnimationFrame(e=>{e!==m&&v.clear(),requestAnimationFrame(e=>{m=e})}),v.isFull){const e=v.values();if(Ne(e.at(-1),e.at(-3))&&!Ne(e.at(-1),e.at(-2)))return}const e=b();e&&v.push(e.flipped)});let y=new at({x:0,y:0,width:0,height:0});function b(){if(p=!1,requestAnimationFrame(()=>p=!0),!e.target.value||!e.contentEl.value)return;(Array.isArray(e.target.value)||e.target.value.offsetParent||e.target.value.getClientRects().length)&&(y=ze(e.target.value));const t=function(e,t){const n=qe(e);t?n.x+=parseFloat(e.style.right||0):n.x-=parseFloat(e.style.left||0);return n.y-=parseFloat(e.style.top||0),n}(e.contentEl.value,e.isRtl.value),c=ot(e.contentEl.value);c.length||(c.push(document.documentElement),e.contentEl.value.style.top&&e.contentEl.value.style.left||(t.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),t.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const d=c.reduce((e,t)=>{const n=lt(t);return e?new at({x:Math.max(e.left,n.left),y:Math.max(e.top,n.top),width:Math.min(e.right,n.right)-Math.max(e.left,n.left),height:Math.min(e.bottom,n.bottom)-Math.max(e.top,n.top)}):n},void 0);d.x+=12,d.y+=12,d.width-=24,d.height-=24;let h={anchor:r.value,origin:i.value};function f(e){const n=new at(t),r=cA(e.anchor,y),i=cA(e.origin,n);let{x:s,y:a}=function(e,t){return{x:e.x-t.x,y:e.y-t.y}}(r,i);switch(e.anchor.side){case"top":a-=u.value[0];break;case"bottom":a+=u.value[0];break;case"left":s-=u.value[0];break;case"right":s+=u.value[0]}switch(e.anchor.align){case"top":a-=u.value[1];break;case"bottom":a+=u.value[1];break;case"left":s-=u.value[1];break;case"right":s+=u.value[1]}n.x+=s,n.y+=a,n.width=Math.min(n.width,o.value),n.height=Math.min(n.height,l.value);return{overflows:ct(n,d),x:s,y:a}}let m=0,v=0;const g={x:0,y:0},b={x:!1,y:!1};let w=-1;for(;!(w++>10);){const{x:e,y:n,overflows:r}=f(h);m+=e,v+=n,t.x+=e,t.y+=n;{const e=ut(h.anchor),t=r.x.before||r.x.after,n=r.y.before||r.y.after;let i=!1;if(["x","y"].forEach(s=>{if("x"===s&&t&&!b.x||"y"===s&&n&&!b.y){const t={anchor:{...h.anchor},origin:{...h.origin}},n="x"===s?"y"===e?rt:nt:"y"===e?nt:rt;t.anchor=n(t.anchor),t.origin=n(t.origin);const{overflows:a}=f(t);(a[s].before<=r[s].before&&a[s].after<=r[s].after||a[s].before+a[s].after<(r[s].before+r[s].after)/2)&&(h=t,i=b[s]=!0)}}),i)continue}r.x.before&&(m+=r.x.before,t.x+=r.x.before),r.x.after&&(m-=r.x.after,t.x-=r.x.after),r.y.before&&(v+=r.y.before,t.y+=r.y.before),r.y.after&&(v-=r.y.after,t.y-=r.y.after);{const e=ct(t,d);g.x=d.width-e.x.before-e.x.after,g.y=d.height-e.y.before-e.y.after,m+=e.x.before,t.x+=e.x.before,v+=e.y.before,t.y+=e.y.before}break}const _=ut(h.anchor);return Object.assign(n.value,{"--v-overlay-anchor-origin":`${h.anchor.side} ${h.anchor.align}`,transformOrigin:`${h.origin.side} ${h.origin.align}`,top:ve(pA(v)),left:e.isRtl.value?void 0:ve(pA(m)),right:e.isRtl.value?ve(pA(-m)):void 0,minWidth:ve("y"===_?Math.min(s.value,y.width):s.value),maxWidth:ve(fA(Ve(g.x,s.value===1/0?0:s.value,o.value))),maxHeight:ve(fA(Ve(g.y,a.value===1/0?0:a.value,l.value)))}),{available:g,contentBox:t,flipped:b}}return d(e.target,(e,t)=>{t&&!Array.isArray(t)&&g.unobserve(t),Array.isArray(e)?Ne(e,t)||b():e&&g.observe(e)},{immediate:!0}),d(e.contentEl,(e,t)=>{t&&g.unobserve(t),e&&g.observe(e)},{immediate:!0}),c(()=>{g.disconnect()}),d(()=>[r.value,i.value,t.offset,t.minWidth,t.minHeight,t.maxWidth,t.maxHeight],()=>b()),h(()=>{const e=b();if(!e)return;const{available:t,contentBox:n}=e;n.height>t.y&&requestAnimationFrame(()=>{b(),requestAnimationFrame(()=>{b()})})}),{updateLocation:b}}},hA=oe({locationStrategy:{type:[String,Function],default:"static",validator:e=>"function"==typeof e||e in dA},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function pA(e){return Math.round(e*devicePixelRatio)/devicePixelRatio}function fA(e){return Math.ceil(e*devicePixelRatio)/devicePixelRatio}let mA=!0;const vA=[];let gA=-1;function yA(){cancelAnimationFrame(gA),gA=requestAnimationFrame(()=>{const e=vA.shift();e&&e(),vA.length?yA():mA=!0})}const bA={none:null,close:function(e){IA(_A(e.target.value,e.contentEl.value),function(t){e.isActive.value=!1})},block:function(e,t){var n;const r=null==(n=e.root.value)?void 0:n.offsetParent,i=_A(e.target.value,e.contentEl.value),s=[...new Set([...ot(i,t.contained?r:void 0),...ot(e.contentEl.value,t.contained?r:void 0)])].filter(e=>!e.classList.contains("v-overlay-scroll-blocked")),a=window.innerWidth-document.documentElement.offsetWidth,o=(l=r||document.documentElement,dt(l)&&l);var l;o&&e.root.value.classList.add("v-overlay--scroll-blocked");s.forEach((e,t)=>{e.style.setProperty("--v-body-scroll-x",ve(-e.scrollLeft)),e.style.setProperty("--v-body-scroll-y",ve(-e.scrollTop)),e!==document.documentElement&&e.style.setProperty("--v-scrollbar-offset",ve(a)),e.classList.add("v-overlay-scroll-blocked")}),c(()=>{s.forEach((e,t)=>{const n=parseFloat(e.style.getPropertyValue("--v-body-scroll-x")),r=parseFloat(e.style.getPropertyValue("--v-body-scroll-y")),i=e.style.scrollBehavior;e.style.scrollBehavior="auto",e.style.removeProperty("--v-body-scroll-x"),e.style.removeProperty("--v-body-scroll-y"),e.style.removeProperty("--v-scrollbar-offset"),e.classList.remove("v-overlay-scroll-blocked"),e.scrollLeft=-n,e.scrollTop=-r,e.style.scrollBehavior=i}),o&&e.root.value.classList.remove("v-overlay--scroll-blocked")})},reposition:function(e,t,n){let r=!1,i=-1,s=-1;function a(t){var n;n=()=>{var n,i;const s=performance.now();null==(i=(n=e.updateLocation).value)||i.call(n,t);const a=performance.now()-s;r=a/(1e3/60)>2},!mA||vA.length?(vA.push(n),yA()):(mA=!1,n(),yA())}s=("undefined"==typeof requestIdleCallback?e=>e():requestIdleCallback)(()=>{n.run(()=>{IA(_A(e.target.value,e.contentEl.value),e=>{r?(cancelAnimationFrame(i),i=requestAnimationFrame(()=>{i=requestAnimationFrame(()=>{a(e)})})):a(e)})})}),c(()=>{"undefined"!=typeof cancelIdleCallback&&cancelIdleCallback(s),cancelAnimationFrame(i)})}},wA=oe({scrollStrategy:{type:[String,Function],default:"block",validator:e=>"function"==typeof e||e in bA}},"VOverlay-scroll-strategies");function _A(e,t){return Array.isArray(e)?document.elementsFromPoint(...e).find(e=>!(null==t?void 0:t.contains(e))):e??t}function IA(e,t){const n=[document,...ot(e)];n.forEach(e=>{e.addEventListener("scroll",t,{passive:!0})}),c(()=>{n.forEach(e=>{e.removeEventListener("scroll",t)})})}const SA=Symbol.for("vuetify:v-menu"),kA=oe({closeDelay:[Number,String],openDelay:[Number,String]},"delay");const TA=oe({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...kA()},"VOverlay-activator");function CA(n,i){let{isActive:s,isTop:a,contentEl:o}=i;const l=Ee("useActivator"),u=t();let p=!1,m=!1,v=!0;const g=f(()=>n.openOnFocus||null==n.openOnFocus&&n.openOnHover),y=f(()=>n.openOnClick||null==n.openOnClick&&!n.openOnHover&&!g.value),{runOpenDelay:b,runCloseDelay:w}=function(e,t){let n=()=>{};function r(r){null==n||n();const i=Number(r?e.openDelay:e.closeDelay);return new Promise(e=>{n=ht(i,()=>{null==t||t(r),e(r)})})}return{clearDelay:n,runOpenDelay:function(){return r(!0)},runCloseDelay:function(){return r(!1)}}}(n,e=>{e!==(n.openOnHover&&p||g.value&&m)||n.openOnHover&&s.value&&!a.value||(s.value!==e&&(v=!0),s.value=e)}),_=t(),I=e=>{e.stopPropagation(),u.value=e.currentTarget||e.target,s.value||(_.value=[e.clientX,e.clientY]),s.value=!s.value},S=e=>{var t;(null==(t=e.sourceCapabilities)?void 0:t.firesTouchEvents)||(p=!0,u.value=e.currentTarget||e.target,b())},T=e=>{p=!1,w()},C=e=>{!1!==ft(e.target,":focus-visible")&&(m=!0,e.stopPropagation(),u.value=e.currentTarget||e.target,b())},E=e=>{m=!1,e.stopPropagation(),w()},x=f(()=>{const e={};return y.value&&(e.onClick=I),n.openOnHover&&(e.onMouseenter=S,e.onMouseleave=T),g.value&&(e.onFocus=C,e.onBlur=E),e}),A=f(()=>{const e={};if(n.openOnHover&&(e.onMouseenter=()=>{p=!0,b()},e.onMouseleave=()=>{p=!1,w()}),g.value&&(e.onFocusin=()=>{m=!0,b()},e.onFocusout=()=>{m=!1,w()}),n.closeOnContentClick){const t=r(SA,null);e.onClick=()=>{s.value=!1,null==t||t.closeParents()}}return e}),N=f(()=>{const e={};return n.openOnHover&&(e.onMouseenter=()=>{v&&(p=!0,v=!1,b())},e.onMouseleave=()=>{p=!1,w()}),e});d(a,e=>{var t;!e||(!n.openOnHover||p||g.value&&m)&&(!g.value||m||n.openOnHover&&p)||(null==(t=o.value)?void 0:t.contains(document.activeElement))||(s.value=!1)}),d(s,e=>{e||setTimeout(()=>{_.value=void 0})},{flush:"post"});const D=pt();L(()=>{D.value&&h(()=>{u.value=D.el})});const P=pt(),R=f(()=>"cursor"===n.target&&_.value?_.value:P.value?P.el:EA(n.target,l)||u.value),V=f(()=>Array.isArray(R.value)?void 0:R.value);let O;return d(()=>!!n.activator,t=>{t&&Le?(O=e(),O.run(()=>{!function(e,t,n){let{activatorEl:r,activatorEvents:i}=n;function s(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.activatorProps;t&&mt(t,k(i.value,n))}function a(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.activatorProps;t&&vt(t,k(i.value,n))}function o(){const n=EA(arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.activator,t);return r.value=(null==n?void 0:n.nodeType)===Node.ELEMENT_NODE?n:void 0,r.value}d(()=>e.activator,(e,t)=>{if(t&&e!==t){const e=o(t);e&&a(e)}e&&h(()=>s())},{immediate:!0}),d(()=>e.activatorProps,()=>{s()}),c(()=>{a()})}(n,l,{activatorEl:u,activatorEvents:x})})):O&&O.stop()},{flush:"post",immediate:!0}),c(()=>{null==O||O.stop()}),{activatorEl:u,activatorRef:D,target:R,targetEl:V,targetRef:P,activatorEvents:x,contentEvents:A,scrimEvents:N}}function EA(e,t){var n,r;if(!e)return;let i;if("parent"===e){let e=null==(r=null==(n=null==t?void 0:t.proxy)?void 0:n.$el)?void 0:r.parentNode;for(;null==e?void 0:e.hasAttribute("data-no-activator");)e=e.parentNode;i=e}else i="string"==typeof e?document.querySelector(e):"$el"in e?e.$el:e;return i}const xA=oe({eager:Boolean},"lazy");function AA(e,t){const n=v(!1),r=x(()=>n.value||e.eager||t.value);return d(t,()=>n.value=!0),{isBooted:n,hasContent:r,onAfterLeave:function(){e.eager||(n.value=!1)}}}function NA(){const e=Ee("useScopeId").vnode.scopeId;return{scopeId:e?{[e]:""}:void 0}}const DA=Symbol.for("vuetify:stack"),PA=s([]);function RA(){return!0}function VA(e,t,n){if(!e||!1===OA(e,n))return!1;const r=yt(t);if("undefined"!=typeof ShadowRoot&&r instanceof ShadowRoot&&r.host===e.target)return!1;const i=("object"==typeof n.value&&n.value.include||(()=>[]))();return i.push(t),!i.some(t=>null==t?void 0:t.contains(e.target))}function OA(e,t){return("object"==typeof t.value&&t.value.closeConditional||RA)(e)}function MA(e,t){const n=yt(e);t(document),"undefined"!=typeof ShadowRoot&&n instanceof ShadowRoot&&t(n)}const LA={mounted(e,t){const n=n=>function(e,t,n){const r="function"==typeof n.value?n.value:n.value.handler;e.shadowTarget=e.target,t._clickOutside.lastMousedownWasOutside&&VA(e,t,n)&&setTimeout(()=>{OA(e,n)&&r&&r(e)},0)}(n,e,t),r=n=>{e._clickOutside.lastMousedownWasOutside=VA(n,e,t)};MA(e,e=>{e.addEventListener("click",n,!0),e.addEventListener("mousedown",r,!0)}),e._clickOutside||(e._clickOutside={lastMousedownWasOutside:!1}),e._clickOutside[t.instance.$.uid]={onClick:n,onMousedown:r}},beforeUnmount(e,t){e._clickOutside&&(MA(e,n=>{var r;if(!n||!(null==(r=e._clickOutside)?void 0:r[t.instance.$.uid]))return;const{onClick:i,onMousedown:s}=e._clickOutside[t.instance.$.uid];n.removeEventListener("click",i,!0),n.removeEventListener("mousedown",s,!0)}),delete e._clickOutside[t.instance.$.uid])}};function FA(e){const{modelValue:t,color:n,...r}=e;return y(S,{name:"fade-transition",appear:!0},{default:()=>[e.modelValue&&_("div",k({class:["v-overlay__scrim",e.color.backgroundColorClasses.value],style:e.color.backgroundColorStyles.value},r),null)]})}const BA=oe({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,opacity:[Number,String],noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...TA(),..._e(),...KC(),...xA(),...hA(),...wA(),...we(),...JC()},"VOverlay"),UA=ae()({name:"VOverlay",directives:{vClickOutside:LA},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...BA()},emits:{"click:outside":e=>!0,"update:modelValue":e=>!0,keydown:e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(n,i){let{slots:a,attrs:o,emit:u}=i;const p=Ee("VOverlay"),g=t(),b=t(),w=t(),I=Ae(n,"modelValue"),S=f({get:()=>I.value,set:e=>{e&&n.disabled||(I.value=e)}}),{themeClasses:T}=xe(n),{rtlClasses:C,isRtl:R}=Oe(),{hasContent:V,onAfterLeave:M}=AA(n,S),F=BC(()=>"string"==typeof n.scrim?n.scrim:null),{globalTop:B,localTop:U,stackStyles:z}=function(e,t,n){const i=Ee("useStack"),a=!n,o=r(DA,void 0),u=s({activeChildren:new Set});O(DA,u);const d=v(Number(m(t)));et(e,()=>{var e;const n=null==(e=PA.at(-1))?void 0:e[1];d.value=n?n+10:Number(m(t)),a&&PA.push([i.uid,d.value]),null==o||o.activeChildren.add(i.uid),c(()=>{if(a){const e=l(PA).findIndex(e=>e[0]===i.uid);PA.splice(e,1)}null==o||o.activeChildren.delete(i.uid)})});const h=v(!0);a&&L(()=>{var e;const t=(null==(e=PA.at(-1))?void 0:e[0])===i.uid;setTimeout(()=>h.value=t)});const p=x(()=>!u.activeChildren.size);return{globalTop:$(h),localTop:p,stackStyles:x(()=>({zIndex:d.value}))}}(S,()=>n.zIndex,n._disableGlobalStack),{activatorEl:q,activatorRef:G,target:K,targetEl:H,targetRef:W,activatorEvents:Q,contentEvents:Y,scrimEvents:X}=CA(n,{isActive:S,isTop:U,contentEl:w}),{teleportTarget:J}=function(e){return{teleportTarget:f(()=>{const t=e();if(!0===t||!Le)return;const n=!1===t?document.body:"string"==typeof t?document.querySelector(t):t;if(null==n)return;let r=[...n.children].find(e=>e.matches(".v-overlay-container"));return r||(r=document.createElement("div"),r.className="v-overlay-container",n.appendChild(r)),r})}}(()=>{var e,t,r;const i=n.attach||n.contained;if(i)return i;const s=(null==(e=null==q?void 0:q.value)?void 0:e.getRootNode())||(null==(r=null==(t=p.proxy)?void 0:t.$el)?void 0:r.getRootNode());return s instanceof ShadowRoot&&s}),{dimensionStyles:Z}=HC(n),ee=function(){if(!Le)return v(!1);const{ssr:e}=gt();if(e){const e=v(!1);return P(()=>{e.value=!0}),e}return v(!0)}(),{scopeId:te}=NA();d(()=>n.disabled,e=>{e&&(S.value=!1)});const{contentStyles:ne,updateLocation:re}=function(e,n){const r=t({}),i=t();function s(e){var t;null==(t=i.value)||t.call(i,e)}function a(e){var t;null==(t=i.value)||t.call(i,e)}function o(e){var t;null==(t=i.value)||t.call(i,e)}return Le&&et(()=>!(!n.isActive.value||!e.locationStrategy),t=>{var l,u;d(()=>e.locationStrategy,t),c(()=>{window.removeEventListener("resize",s),null==visualViewport||visualViewport.removeEventListener("resize",a),null==visualViewport||visualViewport.removeEventListener("scroll",o),i.value=void 0}),window.addEventListener("resize",s,{passive:!0}),null==visualViewport||visualViewport.addEventListener("resize",a,{passive:!0}),null==visualViewport||visualViewport.addEventListener("scroll",o,{passive:!0}),"function"==typeof e.locationStrategy?i.value=null==(l=e.locationStrategy(n,e,r))?void 0:l.updateLocation:i.value=null==(u=dA[e.locationStrategy](n,e,r))?void 0:u.updateLocation}),{contentStyles:r,updateLocation:i}}(n,{isRtl:R,contentEl:w,target:K,isActive:S});function ie(e){u("click:outside",e),n.persistent?he():S.value=!1}function se(e){return S.value&&B.value&&(!n.scrim||e.target===b.value||e instanceof MouseEvent&&e.shadowTarget===b.value)}function ae(e){var t,r,i;"Escape"===e.key&&B.value&&((null==(t=w.value)?void 0:t.contains(document.activeElement))||u("keydown",e),n.persistent?he():(S.value=!1,(null==(r=w.value)?void 0:r.contains(document.activeElement))&&(null==(i=q.value)||i.focus())))}function oe(e){("Escape"!==e.key||B.value)&&u("keydown",e)}!function(t,n){if(!Le)return;let r;L(async()=>{null==r||r.stop(),n.isActive.value&&t.scrollStrategy&&(r=e(),await new Promise(e=>setTimeout(e)),r.active&&r.run(()=>{var e;"function"==typeof t.scrollStrategy?t.scrollStrategy(n,t,r):null==(e=bA[t.scrollStrategy])||e.call(bA,n,t,r)}))}),c(()=>{null==r||r.stop()})}(n,{root:g,contentEl:w,targetEl:H,target:K,isActive:S,updateLocation:re}),Le&&d(S,e=>{e?window.addEventListener("keydown",ae):window.removeEventListener("keydown",ae)},{immediate:!0}),E(()=>{Le&&window.removeEventListener("keydown",ae)});const le=null==(ce=null==(ue=Ee("useRouter"))?void 0:ue.proxy)?void 0:ce.$router;var ue,ce;et(()=>n.closeOnBack,()=>{!function(e,t){let n,r,i=!1;function s(e){var t;(null==(t=e.state)?void 0:t.replaced)||(i=!0,setTimeout(()=>i=!1))}Le&&(null==e?void 0:e.beforeEach)&&(h(()=>{window.addEventListener("popstate",s),n=e.beforeEach((e,n,r)=>{zE?i?t(r):r():setTimeout(()=>i?t(r):r()),zE=!0}),r=null==e?void 0:e.afterEach(()=>{zE=!1})}),c(()=>{window.removeEventListener("popstate",s),null==n||n(),null==r||r()}))}(le,e=>{B.value&&S.value?(e(!1),n.persistent?he():S.value=!1):e()})});const de=t();function he(){n.noClickAnimation||w.value&&Be(w.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:$e})}function pe(){u("afterEnter")}function fe(){M(),u("afterLeave")}return d(()=>S.value&&(n.absolute||n.contained)&&null==J.value,e=>{if(e){const e=bt(g.value);e&&e!==document.scrollingElement&&(de.value=e.scrollTop)}}),be(()=>{var e;return _(N,null,[null==(e=a.activator)?void 0:e.call(a,{isActive:S.value,targetRef:W,props:k({ref:G},Q.value,n.activatorProps)}),ee.value&&V.value&&y(j,{disabled:!J.value,to:J.value},{default:()=>[_("div",k({class:["v-overlay",{"v-overlay--absolute":n.absolute||n.contained,"v-overlay--active":S.value,"v-overlay--contained":n.contained},T.value,C.value,n.class],style:[z.value,{"--v-overlay-opacity":n.opacity,top:ve(de.value)},n.style],ref:g,onKeydown:oe},te,o),[y(FA,k({color:F,modelValue:S.value&&!!n.scrim,ref:b},X.value),null),y(ZC,{appear:!0,persisted:!0,transition:n.transition,target:K.value,onAfterEnter:pe,onAfterLeave:fe},{default:()=>{var e;return[A(_("div",k({ref:w,class:["v-overlay__content",n.contentClass],style:[Z.value,ne.value]},Y.value,n.contentProps),[null==(e=a.default)?void 0:e.call(a,{isActive:S})]),[[D,S.value],[LA,{handler:ie,closeConditional:se,include:()=>[q.value]}]])]}})])]})])}),{activatorEl:q,scrimEl:b,target:K,animateClick:he,contentEl:w,globalTop:B,localTop:U,updateLocation:re}}}),$A=Symbol("Forwarded refs");function jA(e,t){let n=e;for(;n;){const e=Reflect.getOwnPropertyDescriptor(n,t);if(e)return e;n=Object.getPrototypeOf(n)}}function zA(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e[$A]=n,new Proxy(e,{get(e,t){if(Reflect.has(e,t))return Reflect.get(e,t);if("symbol"!=typeof t&&!t.startsWith("$")&&!t.startsWith("__"))for(const r of n)if(r.value&&Reflect.has(r.value,t)){const e=Reflect.get(r.value,t);return"function"==typeof e?e.bind(r.value):e}},has(e,t){if(Reflect.has(e,t))return!0;if("symbol"==typeof t||t.startsWith("$")||t.startsWith("__"))return!1;for(const r of n)if(r.value&&Reflect.has(r.value,t))return!0;return!1},set(e,t,r){if(Reflect.has(e,t))return Reflect.set(e,t,r);if("symbol"==typeof t||t.startsWith("$")||t.startsWith("__"))return!1;for(const i of n)if(i.value&&Reflect.has(i.value,t))return Reflect.set(i.value,t,r);return!1},getOwnPropertyDescriptor(e,t){var r;const i=Reflect.getOwnPropertyDescriptor(e,t);if(i)return i;if("symbol"!=typeof t&&!t.startsWith("$")&&!t.startsWith("__")){for(const e of n){if(!e.value)continue;const n=jA(e.value,t)??("_"in e.value?jA(null==(r=e.value._)?void 0:r.setupState,t):void 0);if(n)return n}for(const e of n){const n=e.value&&e.value[$A];if(!n)continue;const r=n.slice();for(;r.length;){const e=r.shift(),n=jA(e.value,t);if(n)return n;const i=e.value&&e.value[$A];i&&r.push(...i)}}}}})}const qA=oe({id:String,submenu:Boolean,disableInitialFocus:Boolean,...Je(BA({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",location:void 0,openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:gx}}),["absolute"])},"VMenu"),GA=ae()({name:"VMenu",props:qA(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:i}=n;const s=Ae(e,"modelValue"),{scopeId:a}=NA(),{isRtl:o}=Oe(),l=V(),u=x(()=>e.id||`v-menu-${l}`),c=t(),p=r(SA,null),m=v(new Set);async function g(e){var t,n,r;const i=e.relatedTarget,a=e.target;if(await h(),s.value&&i!==a&&(null==(t=c.value)?void 0:t.contentEl)&&(null==(n=c.value)?void 0:n.globalTop)&&![document,c.value.contentEl].includes(a)&&!c.value.contentEl.contains(a)){null==(r=wt(c.value.contentEl)[0])||r.focus()}}function b(e){null==p||p.closeParents(e)}function w(t){var n,r,i,a,l;if(!e.disabled)if("Tab"===t.key||"Enter"===t.key&&!e.closeOnContentClick){if("Enter"===t.key&&(t.target instanceof HTMLTextAreaElement||t.target instanceof HTMLInputElement&&t.target.closest("form")))return;"Enter"===t.key&&t.preventDefault();_t(wt(null==(n=c.value)?void 0:n.contentEl,!1),t.shiftKey?"prev":"next",e=>e.tabIndex>=0)||(s.value=!1,null==(i=null==(r=c.value)?void 0:r.activatorEl)||i.focus())}else e.submenu&&t.key===(o.value?"ArrowRight":"ArrowLeft")&&(s.value=!1,null==(l=null==(a=c.value)?void 0:a.activatorEl)||l.focus())}function _(t){var n;if(e.disabled)return;const r=null==(n=c.value)?void 0:n.contentEl;r&&s.value?"ArrowDown"===t.key?(t.preventDefault(),t.stopImmediatePropagation(),Ze(r,"next")):"ArrowUp"===t.key?(t.preventDefault(),t.stopImmediatePropagation(),Ze(r,"prev")):e.submenu&&(t.key===(o.value?"ArrowRight":"ArrowLeft")?s.value=!1:t.key===(o.value?"ArrowLeft":"ArrowRight")&&(t.preventDefault(),Ze(r,"first"))):(e.submenu?t.key===(o.value?"ArrowLeft":"ArrowRight"):["ArrowDown","ArrowUp"].includes(t.key))&&(s.value=!0,t.preventDefault(),setTimeout(()=>setTimeout(()=>_(t))))}O(SA,{register(){m.value.add(l)},unregister(){m.value.delete(l)},closeParents(t){setTimeout(()=>{var n;m.value.size||e.persistent||null!=t&&(!(null==(n=c.value)?void 0:n.contentEl)||It(t,c.value.contentEl))||(s.value=!1,null==p||p.closeParents())},40)}}),E(()=>{null==p||p.unregister(),document.removeEventListener("focusin",g)}),z(()=>s.value=!1),d(s,t=>{t?(null==p||p.register(),Le&&!e.disableInitialFocus&&document.addEventListener("focusin",g,{once:!0})):(null==p||p.unregister(),Le&&document.removeEventListener("focusin",g))},{immediate:!0});const I=f(()=>k({"aria-haspopup":"menu","aria-expanded":String(s.value),"aria-controls":u.value,onKeydown:_},e.activatorProps));return be(()=>{const t=UA.filterProps(e);return y(UA,k({ref:c,id:u.value,class:["v-menu",e.class],style:e.style},t,{modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,absolute:!0,activatorProps:I.value,location:e.location??(e.submenu?"end":"bottom"),"onClick:outside":b,onKeydown:w},a),{activator:i.activator,default:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return y(MC,{root:"VMenu"},{default:()=>{var e;return[null==(e=i.default)?void 0:e.call(i,...t)]}})}})}),zA({id:u,"ΨopenChildren":m},c)}}),KA={key:0},HA={key:1,class:"text-body-2 font-weight-medium"},WA={key:1},QA=VC({__name:"AuthStatus",props:{user:{type:Object,default:null}},emits:["login","logout"],setup(e,{emit:t}){const n=t,r=()=>{n("login")},i=()=>{n("logout")};return(t,n)=>(G(),q("div",null,[e.user?(G(),q("div",KA,[y(GA,{location:"bottom"},{activator:K(({props:t})=>[y(lx,k({icon:""},t,{variant:"text",class:"minimal-user-button"}),{default:K(()=>[y(fE,{color:"primary",size:"32",class:"minimal-avatar"},{default:K(()=>{var t;return[e.user.photoURL?(G(),W(rE,{key:0,src:e.user.photoURL,alt:e.user.displayName},null,8,["src","alt"])):(G(),q("span",HA,B(null==(t=e.user.displayName)?void 0:t.charAt(0)),1))]}),_:1})]),_:2},1040)]),default:K(()=>[y(lA,{class:"minimal-menu"},{default:K(()=>[y(Wx,{title:e.user.displayName,subtitle:e.user.email,class:"minimal-menu-item"},null,8,["title","subtitle"]),y(cx,{class:"minimal-divider"}),y(Wx,{onClick:i,"prepend-icon":"mdi-logout",class:"minimal-menu-item"},{default:K(()=>[y(Kx,{class:"text-body-2"},{default:K(()=>n[0]||(n[0]=[H("ログアウト",-1)])),_:1,__:[0]})]),_:1})]),_:1})]),_:1})])):(G(),q("div",WA,[y(lx,{onClick:r,"prepend-icon":"mdi-google",variant:"outlined",color:"primary",class:"minimal-login-button"},{default:K(()=>n[1]||(n[1]=[H(" Googleでログイン ",-1)])),_:1,__:[1]})]))]))}},[["__scopeId","data-v-91d386da"]]),YA=oe({text:String,onClick:We(),..._e(),...we()},"VLabel"),XA=ae()({name:"VLabel",props:YA(),setup(e,t){let{slots:n}=t;return be(()=>{var t;return _("label",{class:w(["v-label",{"v-label--clickable":!!e.onClick},e.class]),style:b(e.style),onClick:e.onClick},[e.text,null==(t=n.default)?void 0:t.call(n)])}),{}}}),JA=Symbol.for("vuetify:selection-control-group"),ZA=oe({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:Ie,trueIcon:Ie,ripple:{type:[Boolean,Object],default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:Ne},..._e(),...oE(),...we()},"SelectionControlGroup"),eN=oe({...ZA({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");ae()({name:"VSelectionControlGroup",props:eN(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const r=Ae(e,"modelValue"),i=V(),s=x(()=>e.id||`v-selection-control-group-${i}`),a=x(()=>e.name||s.value),o=new Set;return O(JA,{modelValue:r,forceUpdate:()=>{o.forEach(e=>e())},onForceUpdate:e=>{o.add(e),c(()=>{o.delete(e)})}}),le({[e.defaultsTarget]:{color:x(()=>e.color),disabled:x(()=>e.disabled),density:x(()=>e.density),error:x(()=>e.error),inline:x(()=>e.inline),modelValue:r,multiple:x(()=>!!e.multiple||null==e.multiple&&Array.isArray(r.value)),name:a,falseIcon:x(()=>e.falseIcon),trueIcon:x(()=>e.trueIcon),readonly:x(()=>e.readonly),ripple:x(()=>e.ripple),type:x(()=>e.type),valueComparator:x(()=>e.valueComparator)}}),be(()=>{var t;return _("div",{class:w(["v-selection-control-group",{"v-selection-control-group--inline":e.inline},e.class]),style:b(e.style),role:"radio"===e.type?"radiogroup":void 0},[null==(t=n.default)?void 0:t.call(n)])}),{}}});const tN=oe({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,..._e(),...ZA()},"VSelectionControl");const nN=ae()({name:"VSelectionControl",directives:{vRipple:ax},inheritAttrs:!1,props:tN(),emits:{"update:modelValue":e=>!0},setup(e,n){let{attrs:i,slots:s}=n;const{group:a,densityClasses:o,icon:l,model:u,textColorClasses:c,textColorStyles:d,backgroundColorClasses:p,backgroundColorStyles:m,trueValue:g}=function(e){const t=r(JA,void 0),{densityClasses:n}=lE(e),i=Ae(e,"modelValue"),s=f(()=>void 0!==e.trueValue?e.trueValue:void 0===e.value||e.value),a=f(()=>void 0!==e.falseValue&&e.falseValue),o=f(()=>!!e.multiple||null==e.multiple&&Array.isArray(i.value)),l=f({get(){const n=t?t.modelValue.value:i.value;return o.value?De(n).some(t=>e.valueComparator(t,s.value)):e.valueComparator(n,s.value)},set(n){if(e.readonly)return;const r=n?s.value:a.value;let l=r;o.value&&(l=n?[...De(i.value),r]:De(i.value).filter(t=>!e.valueComparator(t,s.value))),t?t.modelValue.value=l:i.value=l}}),{textColorClasses:u,textColorStyles:c}=FC(()=>{if(!e.error&&!e.disabled)return l.value?e.color:e.baseColor}),{backgroundColorClasses:d,backgroundColorStyles:h}=BC(()=>!l.value||e.error||e.disabled?e.baseColor:e.color),p=f(()=>l.value?e.trueIcon:e.falseIcon);return{group:t,densityClasses:n,trueValue:s,falseValue:a,model:l,textColorClasses:u,textColorStyles:c,backgroundColorClasses:d,backgroundColorStyles:h,icon:p}}(e),I=V(),S=v(!1),T=v(!1),C=t(),E=x(()=>e.id||`input-${I}`),D=x(()=>!e.disabled&&!e.readonly);function P(e){D.value&&(S.value=!0,!1!==ft(e.target,":focus-visible")&&(T.value=!0))}function R(){S.value=!1,T.value=!1}function O(e){e.stopPropagation()}function M(t){D.value?(e.readonly&&a&&h(()=>a.forceUpdate()),u.value=t.target.checked):C.value&&(C.value.checked=u.value)}return null==a||a.onForceUpdate(()=>{C.value&&(C.value.checked=u.value)}),be(()=>{var t,n;const r=s.label?s.label({label:e.label,props:{for:E.value}}):e.label,[a,h]=St(i),f=_("input",k({ref:C,checked:u.value,disabled:!!e.disabled,id:E.value,onBlur:R,onFocus:P,onInput:M,"aria-disabled":!!e.disabled,"aria-label":e.label,type:e.type,value:g.value,name:e.name,"aria-checked":"checkbox"===e.type?u.value:void 0},h),null);return _("div",k({class:["v-selection-control",{"v-selection-control--dirty":u.value,"v-selection-control--disabled":e.disabled,"v-selection-control--error":e.error,"v-selection-control--focused":S.value,"v-selection-control--focus-visible":T.value,"v-selection-control--inline":e.inline},o.value,e.class]},a,{style:e.style}),[_("div",{class:w(["v-selection-control__wrapper",c.value]),style:b(d.value)},[null==(t=s.default)?void 0:t.call(s,{backgroundColorClasses:p,backgroundColorStyles:m}),A(_("div",{class:w(["v-selection-control__input"])},[(null==(n=s.input)?void 0:n.call(s,{model:u,textColorClasses:c,textColorStyles:d,backgroundColorClasses:p,backgroundColorStyles:m,inputNode:f,icon:l.value,props:{onFocus:P,onBlur:R,id:E.value}}))??_(N,null,[l.value&&y(GC,{key:"icon",icon:l.value},null),f])]),[[ax,!e.disabled&&!e.readonly&&e.ripple,null,{center:!0,circle:!0}]])]),r&&y(XA,{for:E.value,onClick:O},{default:()=>[r]})])}),{isFocused:S,input:C}}}),rN=oe({indeterminate:Boolean,indeterminateIcon:{type:Ie,default:"$checkboxIndeterminate"},...tN({falseIcon:"$checkboxOff",trueIcon:"$checkboxOn"})},"VCheckboxBtn"),iN=ae()({name:"VCheckboxBtn",props:rN(),emits:{"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,t){let{slots:n}=t;const r=Ae(e,"indeterminate"),i=Ae(e,"modelValue");function s(e){r.value&&(r.value=!1)}const a=x(()=>r.value?e.indeterminateIcon:e.falseIcon),o=x(()=>r.value?e.indeterminateIcon:e.trueIcon);return be(()=>{const t=Je(nN.filterProps(e),["modelValue"]);return y(nN,k(t,{modelValue:i.value,"onUpdate:modelValue":[e=>i.value=e,s],class:["v-checkbox-btn",e.class],style:e.style,type:"checkbox",falseIcon:a.value,trueIcon:o.value,"aria-checked":r.value?"mixed":void 0}),n)}),{}}});function sN(e){const{t:t}=kt();return{InputIcon:function(n){let{name:r,color:i,...s}=n;const a={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[r],o=e[`onClick:${r}`],l=o&&a?t(`$vuetify.input.${a}`,e.label??""):void 0;return y(GC,k({icon:e[`${r}Icon`],"aria-label":l,onClick:o,onKeydown:function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),Tt(o,new PointerEvent("click",e)))},color:i},s),null)}}}const aN=oe({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},..._e(),...JC({transition:{component:_x,leaveAbsolute:!0,group:!0}})},"VMessages"),oN=ae()({name:"VMessages",props:aN(),setup(e,t){let{slots:n}=t;const r=f(()=>De(e.messages)),{textColorClasses:i,textColorStyles:s}=FC(()=>e.color);return be(()=>y(ZC,{transition:e.transition,tag:"div",class:w(["v-messages",i.value,e.class]),style:b([s.value,e.style])},{default:()=>[e.active&&r.value.map((e,t)=>_("div",{class:"v-messages__message",key:`${t}-${r.value}`},[n.message?n.message({message:e}):e]))]})),{}}}),lN=oe({focused:Boolean,"onUpdate:focused":We()},"focus");function uN(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe();const n=Ae(e,"focused");return{focusClasses:x(()=>({[`${t}--focused`]:n.value})),isFocused:n,focus:function(){n.value=!0},blur:function(){n.value=!1}}}const cN=Symbol.for("vuetify:form"),dN=oe({disabled:Boolean,fastFail:Boolean,readonly:Boolean,modelValue:{type:Boolean,default:null},validateOn:{type:String,default:"input"}},"form");function hN(e){const t=r(cN,null);return{...t,isReadonly:f(()=>!!((null==e?void 0:e.readonly)??(null==t?void 0:t.isReadonly.value))),isDisabled:f(()=>!!((null==e?void 0:e.disabled)??(null==t?void 0:t.isDisabled.value)))}}const pN=Symbol.for("vuetify:rules");const fN=oe({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...lN()},"validation");function mN(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fe(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:V();const s=Ae(e,"modelValue"),a=f(()=>void 0===e.validationValue?s.value:e.validationValue),o=hN(e),l=function(e){const t=r(pN,null);if(!e){if(!t)throw new Error("Could not find Vuetify rules injection");return t.aliases}return(null==t?void 0:t.resolve(e))??x(e)}(()=>e.rules),u=t([]),c=v(!0),p=f(()=>!(!De(""===s.value?null:s.value).length&&!De(""===a.value?null:a.value).length)),m=f(()=>{var t;return(null==(t=e.errorMessages)?void 0:t.length)?De(e.errorMessages).concat(u.value).slice(0,Math.max(0,Number(e.maxErrors))):u.value}),g=f(()=>{var t;let n=(e.validateOn??(null==(t=o.validateOn)?void 0:t.value))||"input";"lazy"===n&&(n="input lazy"),"eager"===n&&(n="input eager");const r=new Set((null==n?void 0:n.split(" "))??[]);return{input:r.has("input"),blur:r.has("blur")||r.has("input")||r.has("invalid-input"),invalidInput:r.has("invalid-input"),lazy:r.has("lazy"),eager:r.has("eager")}}),y=f(()=>{var t;return!e.error&&!(null==(t=e.errorMessages)?void 0:t.length)&&(!e.rules.length||(c.value?!u.value.length&&!g.value.lazy||null:!u.value.length))}),b=v(!1),w=f(()=>({[`${n}--error`]:!1===y.value,[`${n}--dirty`]:p.value,[`${n}--disabled`]:o.isDisabled.value,[`${n}--readonly`]:o.isReadonly.value})),_=Ee("validation"),I=f(()=>e.name??M(i));async function S(){s.value=null,await h(),await k()}async function k(){c.value=!0,g.value.lazy?u.value=[]:await T(!g.value.eager)}async function T(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const n=[];b.value=!0;for(const r of l.value){if(n.length>=Number(e.maxErrors??1))break;const t="function"==typeof r?r:()=>r,i=await t(a.value);!0!==i&&(!1!==i&&"string"!=typeof i||n.push(i||""))}return u.value=n,b.value=!1,c.value=t,u.value}return C(()=>{var e;null==(e=o.register)||e.call(o,{id:I.value,vm:_,validate:T,reset:S,resetValidation:k})}),E(()=>{var e;null==(e=o.unregister)||e.call(o,I.value)}),P(async()=>{var e;g.value.lazy||await T(!g.value.eager),null==(e=o.update)||e.call(o,I.value,y.value,m.value)}),et(()=>g.value.input||g.value.invalidInput&&!1===y.value,()=>{d(a,()=>{if(null!=a.value)T();else if(e.focused){const t=d(()=>e.focused,e=>{e||T(),t()})}})}),et(()=>g.value.blur,()=>{d(()=>e.focused,e=>{e||T()})}),d([y,m],()=>{var e;null==(e=o.update)||e.call(o,I.value,y.value,m.value)}),{errorMessages:m,isDirty:p,isDisabled:o.isDisabled,isReadonly:o.isReadonly,isPristine:c,isValid:y,isValidating:b,reset:S,resetValidation:k,validate:T,validationClasses:w}}const vN=oe({id:String,appendIcon:Ie,baseColor:String,centerAffix:{type:Boolean,default:!0},color:String,glow:Boolean,iconColor:[Boolean,String],prependIcon:Ie,hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},"onClick:prepend":We(),"onClick:append":We(),..._e(),...oE(),...Ye(KC(),["maxWidth","minWidth","width"]),...we(),...fN()},"VInput"),gN=ae()({name:"VInput",props:{...vN()},emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:r,emit:i}=t;const{densityClasses:s}=lE(e),{dimensionStyles:a}=HC(e),{themeClasses:o}=xe(e),{rtlClasses:l}=Oe(),{InputIcon:u}=sN(e),c=V(),d=f(()=>e.id||`input-${c}`),{errorMessages:h,isDirty:p,isDisabled:m,isReadonly:v,isPristine:g,isValid:I,isValidating:S,reset:k,resetValidation:T,validate:C,validationClasses:E}=mN(e,"v-input",d),A=f(()=>{var t;return(null==(t=e.errorMessages)?void 0:t.length)||!g.value&&h.value.length?h.value:e.hint&&(e.persistentHint||e.focused)?e.hint:e.messages}),N=x(()=>A.value.length>0),D=x(()=>!e.hideDetails||"auto"===e.hideDetails&&(N.value||!!r.details)),P=f(()=>D.value?`${d.value}-messages`:void 0),R=f(()=>({id:d,messagesId:P,isDirty:p,isDisabled:m,isReadonly:v,isPristine:g,isValid:I,isValidating:S,hasDetails:D,reset:k,resetValidation:T,validate:C})),O=x(()=>e.error||e.disabled?void 0:e.focused?e.color:e.baseColor),M=x(()=>{if(e.iconColor)return!0===e.iconColor?O.value:e.iconColor});return be(()=>{var t,n,i,c;const d=!(!r.prepend&&!e.prependIcon),h=!(!r.append&&!e.appendIcon);return _("div",{class:w(["v-input",`v-input--${e.direction}`,{"v-input--center-affix":e.centerAffix,"v-input--focused":e.focused,"v-input--glow":e.glow,"v-input--hide-spin-buttons":e.hideSpinButtons},s.value,o.value,l.value,E.value,e.class]),style:b([a.value,e.style])},[d&&_("div",{key:"prepend",class:"v-input__prepend"},[null==(t=r.prepend)?void 0:t.call(r,R.value),e.prependIcon&&y(u,{key:"prepend-icon",name:"prepend",color:M.value},null)]),r.default&&_("div",{class:"v-input__control"},[null==(n=r.default)?void 0:n.call(r,R.value)]),h&&_("div",{key:"append",class:"v-input__append"},[e.appendIcon&&y(u,{key:"append-icon",name:"append",color:M.value},null),null==(i=r.append)?void 0:i.call(r,R.value)]),D.value&&_("div",{id:P.value,class:"v-input__details",role:"alert","aria-live":"polite"},[y(oN,{active:N.value,messages:A.value},{message:r.message}),null==(c=r.details)?void 0:c.call(r,R.value)])])}),{reset:k,resetValidation:T,validate:C,isValid:I,errorMessages:h}}}),yN=oe({...vN(),...Je(rN(),["inline"])},"VCheckbox"),bN=ae()({name:"VCheckbox",inheritAttrs:!1,props:yN(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,n){let{attrs:r,slots:i}=n;const s=Ae(e,"modelValue"),{isFocused:a,focus:o,blur:l}=uN(e),u=t(),c=V();return be(()=>{const[t,n]=St(r),d=gN.filterProps(e),h=iN.filterProps(e);return y(gN,k({ref:u,class:["v-checkbox",e.class]},t,d,{modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,id:e.id||`checkbox-${c}`,focused:a.value,style:e.style}),{...i,default:e=>{let{id:t,messagesId:r,isDisabled:a,isReadonly:u,isValid:c}=e;return y(iN,k(h,{id:t.value,"aria-describedby":r.value,disabled:a.value,readonly:u.value},n,{error:!1===c.value,modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,onFocus:o,onBlur:l}),i)}})}),zA({},u)}});function wN(e,t){return(null==t?void 0:t[e?"scrollWidth":"scrollHeight"])||0}function _N(e,t,n){if(!n)return 0;const{scrollLeft:r,offsetWidth:i,scrollWidth:s}=n;return e?t?s-i+r:r:n.scrollTop}function IN(e,t){return(null==t?void 0:t[e?"offsetWidth":"offsetHeight"])||0}function SN(e,t){return(null==t?void 0:t[e?"offsetLeft":"offsetTop"])||0}const kN=Symbol.for("vuetify:v-slide-group"),TN=oe({centerActive:Boolean,contentClass:null,direction:{type:String,default:"horizontal"},symbol:{type:null,default:kN},nextIcon:{type:Ie,default:"$next"},prevIcon:{type:Ie,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>"boolean"==typeof e||["always","desktop","mobile"].includes(e)},..._e(),...Ct({mobile:null}),...zC(),...bE({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),CN=ae()({name:"VSlideGroup",props:TN(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{isRtl:r}=Oe(),{displayClasses:i,mobile:s}=gt(e),a=IE(e,e.symbol),o=v(!1),l=v(0),u=v(0),c=v(0),h=f(()=>"horizontal"===e.direction),{resizeRef:p,contentRect:m}=Re(),{resizeRef:g,contentRect:I}=Re(),S=Et(),k=f(()=>({container:p.el,duration:200,easing:"easeOutQuart"})),T=f(()=>a.selected.value.length?a.items.value.findIndex(e=>e.id===a.selected.value[0]):-1),C=f(()=>a.selected.value.length?a.items.value.findIndex(e=>e.id===a.selected.value[a.selected.value.length-1]):-1);if(Le){let t=-1;d(()=>[a.selected.value,m.value,I.value,h.value],()=>{cancelAnimationFrame(t),t=requestAnimationFrame(()=>{if(m.value&&I.value){const e=h.value?"width":"height";u.value=m.value[e],c.value=I.value[e],o.value=u.value+1<c.value}if(T.value>=0&&g.el){x(g.el.children[C.value],e.centerActive)}})})}const E=v(!1);function x(e,t){let n=0;n=t?function(e){let{selectedElement:t,containerElement:n,isHorizontal:r}=e;const i=IN(r,n);return SN(r,t)-i/2+IN(r,t)/2}({containerElement:p.el,isHorizontal:h.value,selectedElement:e}):function(e){let{selectedElement:t,containerElement:n,isRtl:r,isHorizontal:i}=e;const s=IN(i,n),a=_N(i,r,n),o=IN(i,t),l=SN(i,t),u=.4*o;return a>l?l-u:a+s<l+o?l-s+o+u:a}({containerElement:p.el,isHorizontal:h.value,isRtl:r.value,selectedElement:e}),A(n)}function A(e){if(!Le||!p.el)return;const t=IN(h.value,p.el),n=_N(h.value,r.value,p.el);if(!(wN(h.value,p.el)<=t||Math.abs(e-n)<16)){if(h.value&&r.value&&p.el){const{scrollWidth:t,offsetWidth:n}=p.el;e=t-n-e}h.value?S.horizontal(e,k.value):S(e,k.value)}}function N(e){const{scrollTop:t,scrollLeft:n}=e.target;l.value=h.value?n:t}function D(e){if(E.value=!0,o.value&&g.el)for(const t of e.composedPath())for(const e of g.el.children)if(e===t)return void x(e)}function P(e){E.value=!1}let R=!1;function V(e){var t;R||E.value||e.relatedTarget&&(null==(t=g.el)?void 0:t.contains(e.relatedTarget))||F(),R=!1}function O(){R=!0}function M(e){function t(t){e.preventDefault(),F(t)}g.el&&(h.value?"ArrowRight"===e.key?t(r.value?"prev":"next"):"ArrowLeft"===e.key&&t(r.value?"next":"prev"):"ArrowDown"===e.key?t("next"):"ArrowUp"===e.key&&t("prev"),"Home"===e.key?t("first"):"End"===e.key&&t("last"))}function L(e,t){if(!e)return;let n=e;do{n=null==n?void 0:n["next"===t?"nextElementSibling":"previousElementSibling"]}while(null==n?void 0:n.hasAttribute("disabled"));return n}function F(e){if(!g.el)return;let t;if(e)if("next"===e){if(t=L(g.el.querySelector(":focus"),e),!t)return F("first")}else if("prev"===e){if(t=L(g.el.querySelector(":focus"),e),!t)return F("last")}else"first"===e?(t=g.el.firstElementChild,(null==t?void 0:t.hasAttribute("disabled"))&&(t=L(t,"next"))):"last"===e&&(t=g.el.lastElementChild,(null==t?void 0:t.hasAttribute("disabled"))&&(t=L(t,"prev")));else{t=wt(g.el)[0]}t&&t.focus({preventScroll:!0})}function B(e){const t=h.value&&r.value?-1:1,n=("prev"===e?-t:t)*u.value;let i=l.value+n;if(h.value&&r.value&&p.el){const{scrollWidth:e,offsetWidth:t}=p.el;i+=e-t}A(i)}const U=f(()=>({next:a.next,prev:a.prev,select:a.select,isSelected:a.isSelected})),$=f(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!s.value;case!0:return o.value||Math.abs(l.value)>0;case"mobile":return s.value||o.value||Math.abs(l.value)>0;default:return!s.value&&(o.value||Math.abs(l.value)>0)}}),j=f(()=>Math.abs(l.value)>1),z=f(()=>{if(!p.value)return!1;const e=wN(h.value,p.el),t=function(e,t){return(null==t?void 0:t[e?"clientWidth":"clientHeight"])||0}(h.value,p.el);return e-t-Math.abs(l.value)>1});return be(()=>y(e.tag,{class:w(["v-slide-group",{"v-slide-group--vertical":!h.value,"v-slide-group--has-affixes":$.value,"v-slide-group--is-overflowing":o.value},i.value,e.class]),style:b(e.style),tabindex:E.value||a.selected.value.length?-1:0,onFocus:V},{default:()=>{var t,i,s;return[$.value&&_("div",{key:"prev",class:w(["v-slide-group__prev",{"v-slide-group__prev--disabled":!j.value}]),onMousedown:O,onClick:()=>j.value&&B("prev")},[(null==(t=n.prev)?void 0:t.call(n,U.value))??y(wx,null,{default:()=>[y(GC,{icon:r.value?e.nextIcon:e.prevIcon},null)]})]),_("div",{key:"container",ref:p,class:w(["v-slide-group__container",e.contentClass]),onScroll:N},[_("div",{ref:g,class:"v-slide-group__content",onFocusin:D,onFocusout:P,onKeydown:M},[null==(i=n.default)?void 0:i.call(n,U.value)])]),$.value&&_("div",{key:"next",class:w(["v-slide-group__next",{"v-slide-group__next--disabled":!z.value}]),onMousedown:O,onClick:()=>z.value&&B("next")},[(null==(s=n.next)?void 0:s.call(n,U.value))??y(wx,null,{default:()=>[y(GC,{icon:r.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:a.selected,scrollTo:B,scrollOffset:l,focus:F,hasPrev:j,hasNext:z}}}),EN=Symbol.for("vuetify:v-chip-group"),xN=oe({baseColor:String,column:Boolean,filter:Boolean,valueComparator:{type:Function,default:Ne},...TN(),..._e(),...bE({selectedClass:"v-chip--selected"}),...zC(),...we(),...dE({variant:"tonal"})},"VChipGroup");ae()({name:"VChipGroup",props:xN(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{themeClasses:r}=xe(e),{isSelected:i,select:s,next:a,prev:o,selected:l}=IE(e,EN);return le({VChip:{baseColor:x(()=>e.baseColor),color:x(()=>e.color),disabled:x(()=>e.disabled),filter:x(()=>e.filter),variant:x(()=>e.variant)}}),be(()=>{const t=CN.filterProps(e);return y(CN,k(t,{class:["v-chip-group",{"v-chip-group--column":e.column},r.value,e.class],style:e.style}),{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n,{isSelected:i,select:s,next:a,prev:o,selected:l.value})]}})}),{}}});const AN=oe({activeClass:String,appendAvatar:String,appendIcon:Ie,baseColor:String,closable:Boolean,closeIcon:{type:Ie,default:"$delete"},closeLabel:{type:String,default:"$vuetify.close"},draggable:Boolean,filter:Boolean,filterIcon:{type:Ie,default:"$complete"},label:Boolean,link:{type:Boolean,default:void 0},pill:Boolean,prependAvatar:String,prependIcon:Ie,ripple:{type:[Boolean,Object],default:!0},text:{type:[String,Number,Boolean],default:void 0},modelValue:{type:Boolean,default:!0},onClick:We(),onClickOnce:We(),...iE(),..._e(),...oE(),...mE(),...wE(),...YC(),...jE(),...$C(),...zC({tag:"span"}),...we(),...dE({variant:"tonal"})},"VChip"),NN=ae()({name:"VChip",directives:{vRipple:ax},props:AN(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0,"group:selected":e=>!0,click:e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const{t:s}=kt(),{borderClasses:a}=sE(e),{densityClasses:o}=lE(e),{elevationClasses:l}=vE(e),{roundedClasses:u}=XC(e),{sizeClasses:c}=jC(e),{themeClasses:d}=xe(e),h=Ae(e,"modelValue"),p=_E(e,EN,!1),m=$E(e,n),v=x(()=>!1!==e.link&&m.isLink.value),g=f(()=>!e.disabled&&!1!==e.link&&(!!p||e.link||m.isClickable.value)),b=x(()=>({"aria-label":s(e.closeLabel),disabled:e.disabled,onClick(e){e.preventDefault(),e.stopPropagation(),h.value=!1,r("click:close",e)}})),{colorClasses:w,colorStyles:I,variantClasses:S}=hE(()=>({color:!p||p.isSelected.value?e.color??e.baseColor:e.baseColor,variant:e.variant}));function T(e){var t;r("click",e),g.value&&(null==(t=m.navigate)||t.call(m,e),null==p||p.toggle())}function C(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),T(e))}return()=>{var t;const n=m.isLink.value?"a":e.tag,r=!(!e.appendIcon&&!e.appendAvatar),s=!(!r&&!i.append),f=!(!i.close&&!e.closable),E=!(!i.filter&&!e.filter)&&p,x=!(!e.prependIcon&&!e.prependAvatar),P=!(!x&&!i.prepend);return h.value&&A(y(n,k({class:["v-chip",{"v-chip--disabled":e.disabled,"v-chip--label":e.label,"v-chip--link":g.value,"v-chip--filter":E,"v-chip--pill":e.pill,[`${e.activeClass}`]:e.activeClass&&(null==(t=m.isActive)?void 0:t.value)},d.value,a.value,w.value,o.value,l.value,u.value,c.value,S.value,null==p?void 0:p.selectedClass.value,e.class],style:[I.value,e.style],disabled:e.disabled||void 0,draggable:e.draggable,tabindex:g.value?0:void 0,onClick:T,onKeydown:g.value&&!v.value&&C},m.linkProps),{default:()=>{var t;return[cE(g.value,"v-chip"),E&&y(Sx,{key:"filter"},{default:()=>[A(_("div",{class:"v-chip__filter"},[i.filter?y(MC,{key:"filter-defaults",disabled:!e.filterIcon,defaults:{VIcon:{icon:e.filterIcon}}},i.filter):y(GC,{key:"filter-icon",icon:e.filterIcon},null)]),[[D,p.isSelected.value]])]}),P&&_("div",{key:"prepend",class:"v-chip__prepend"},[i.prepend?y(MC,{key:"prepend-defaults",disabled:!x,defaults:{VAvatar:{image:e.prependAvatar,start:!0},VIcon:{icon:e.prependIcon,start:!0}}},i.prepend):_(N,null,[e.prependIcon&&y(GC,{key:"prepend-icon",icon:e.prependIcon,start:!0},null),e.prependAvatar&&y(fE,{key:"prepend-avatar",image:e.prependAvatar,start:!0},null)])]),_("div",{class:"v-chip__content","data-no-activator":""},[(null==(t=i.default)?void 0:t.call(i,{isSelected:null==p?void 0:p.isSelected.value,selectedClass:null==p?void 0:p.selectedClass.value,select:null==p?void 0:p.select,toggle:null==p?void 0:p.toggle,value:null==p?void 0:p.value.value,disabled:e.disabled}))??B(e.text)]),s&&_("div",{key:"append",class:"v-chip__append"},[i.append?y(MC,{key:"append-defaults",disabled:!r,defaults:{VAvatar:{end:!0,image:e.appendAvatar},VIcon:{end:!0,icon:e.appendIcon}}},i.append):_(N,null,[e.appendIcon&&y(GC,{key:"append-icon",end:!0,icon:e.appendIcon},null),e.appendAvatar&&y(fE,{key:"append-avatar",end:!0,image:e.appendAvatar},null)])]),f&&_("button",k({key:"close",class:"v-chip__close",type:"button","data-testid":"close-chip"},b.value),[i.close?y(MC,{key:"close-defaults",defaults:{VIcon:{icon:e.closeIcon,size:"x-small"}}},i.close):y(GC,{key:"close-icon",icon:e.closeIcon,size:"x-small"},null)])]}}),[[ax,g.value&&e.ripple,null]])}}}),DN=oe({active:Boolean,disabled:Boolean,max:[Number,String],value:{type:[Number,String],default:0},..._e(),...JC({transition:{component:_x}})},"VCounter"),PN=ae()({name:"VCounter",functional:!0,props:DN(),setup(e,t){let{slots:n}=t;const r=x(()=>e.max?`${e.value} / ${e.max}`:String(e.value));return be(()=>y(ZC,{transition:e.transition},{default:()=>[A(_("div",{class:w(["v-counter",{"text-error":e.max&&!e.disabled&&parseFloat(e.value)>parseFloat(e.max)},e.class]),style:b(e.style)},[n.default?n.default({counter:r.value,max:e.max,value:e.value}):r.value]),[[D,e.active]])]})),{}}}),RN=oe({floating:Boolean,..._e()},"VFieldLabel"),VN=ae()({name:"VFieldLabel",props:RN(),setup(e,t){let{slots:n}=t;return be(()=>y(XA,{class:w(["v-field-label",{"v-field-label--floating":e.floating},e.class]),style:b(e.style)},n)),{}}}),ON=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],MN=oe({appendInnerIcon:Ie,bgColor:String,clearable:Boolean,clearIcon:{type:Ie,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,details:Boolean,dirty:Boolean,disabled:{type:Boolean,default:null},glow:Boolean,error:Boolean,flat:Boolean,iconColor:[Boolean,String],label:String,persistentClear:Boolean,prependInnerIcon:Ie,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:e=>ON.includes(e)},"onClick:clear":We(),"onClick:appendInner":We(),"onClick:prependInner":We(),..._e(),...OE(),...YC(),...we()},"VField"),LN=ae()({name:"VField",inheritAttrs:!1,props:{id:String,...lN(),...MN()},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:r,emit:i,slots:s}=n;const{themeClasses:a}=xe(e),{loaderClasses:o}=ME(e),{focusClasses:l,isFocused:u,focus:c,blur:h}=uN(e),{InputIcon:p}=sN(e),{roundedClasses:m}=XC(e),{rtlClasses:v}=Oe(),g=x(()=>e.dirty||e.active),I=x(()=>!(!e.label&&!s.label)),S=x(()=>!e.singleLine&&I.value),T=V(),C=f(()=>e.id||`input-${T}`),E=x(()=>e.details?`${C.value}-messages`:void 0),P=t(),R=t(),O=t(),M=f(()=>["plain","underlined"].includes(e.variant)),L=f(()=>e.error||e.disabled?void 0:g.value&&u.value?e.color:e.baseColor),F=f(()=>{if(e.iconColor&&(!e.glow||u.value))return!0===e.iconColor?L.value:e.iconColor}),{backgroundColorClasses:B,backgroundColorStyles:U}=BC(()=>e.bgColor),{textColorClasses:$,textColorStyles:j}=FC(L);d(g,e=>{if(S.value){const t=P.value.$el,n=R.value.$el;requestAnimationFrame(()=>{const r=qe(t),i=n.getBoundingClientRect(),s=i.x-r.x,a=i.y-r.y-(r.height/2-i.height/2),o=i.width/.75,l=Math.abs(o-r.width)>1?{maxWidth:ve(o)}:void 0,u=getComputedStyle(t),c=getComputedStyle(n),d=1e3*parseFloat(u.transitionDuration)||150,h=parseFloat(c.getPropertyValue("--v-field-label-scale")),p=c.getPropertyValue("color");t.style.visibility="visible",n.style.visibility="hidden",Be(t,{transform:`translate(${s}px, ${a}px) scale(${h})`,color:p,...l},{duration:d,easing:$e,direction:e?"normal":"reverse"}).finished.then(()=>{t.style.removeProperty("visibility"),n.style.removeProperty("visibility")})})}},{flush:"post"});const z=f(()=>({isActive:g,isFocused:u,controlRef:O,blur:h,focus:c}));function q(e){e.target!==document.activeElement&&e.preventDefault()}return be(()=>{var t,n,i;const u="outlined"===e.variant,d=!(!s["prepend-inner"]&&!e.prependInnerIcon),f=!(!e.clearable&&!s.clear||e.disabled),T=!!(s["append-inner"]||e.appendInnerIcon||f),x=()=>s.label?s.label({...z.value,label:e.label,props:{for:C.value}}):e.label;return _("div",k({class:["v-field",{"v-field--active":g.value,"v-field--appended":T,"v-field--center-affix":e.centerAffix??!M.value,"v-field--disabled":e.disabled,"v-field--dirty":e.dirty,"v-field--error":e.error,"v-field--glow":e.glow,"v-field--flat":e.flat,"v-field--has-background":!!e.bgColor,"v-field--persistent-clear":e.persistentClear,"v-field--prepended":d,"v-field--reverse":e.reverse,"v-field--single-line":e.singleLine,"v-field--no-label":!x(),[`v-field--variant-${e.variant}`]:!0},a.value,B.value,l.value,o.value,m.value,v.value,e.class],style:[U.value,e.style],onClick:q},r),[_("div",{class:"v-field__overlay"},null),y(LE,{name:"v-field",active:!!e.loading,color:e.error?"error":"string"==typeof e.loading?e.loading:e.color},{default:s.loader}),d&&_("div",{key:"prepend",class:"v-field__prepend-inner"},[e.prependInnerIcon&&y(p,{key:"prepend-icon",name:"prependInner",color:F.value},null),null==(t=s["prepend-inner"])?void 0:t.call(s,z.value)]),_("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(e.variant)&&S.value&&y(VN,{key:"floating-label",ref:R,class:w([$.value]),floating:!0,for:C.value,"aria-hidden":!g.value,style:b(j.value)},{default:()=>[x()]}),I.value&&y(VN,{key:"label",ref:P,for:C.value},{default:()=>[x()]}),(null==(n=s.default)?void 0:n.call(s,{...z.value,props:{id:C.value,class:"v-field__input","aria-describedby":E.value},focus:c,blur:h}))??_("div",{id:C.value,class:"v-field__input","aria-describedby":E.value},null)]),f&&y(Sx,{key:"clear"},{default:()=>[A(_("div",{class:"v-field__clearable",onMousedown:e=>{e.preventDefault(),e.stopPropagation()}},[y(MC,{defaults:{VIcon:{icon:e.clearIcon}}},{default:()=>[s.clear?s.clear({...z.value,props:{onFocus:c,onBlur:h,onClick:e["onClick:clear"],tabindex:-1}}):y(p,{name:"clear",onFocus:c,onBlur:h,tabindex:-1},null)]})]),[[D,e.dirty]])]}),T&&_("div",{key:"append",class:"v-field__append-inner"},[null==(i=s["append-inner"])?void 0:i.call(s,z.value),e.appendInnerIcon&&y(p,{key:"append-icon",name:"appendInner",color:F.value},null)]),_("div",{class:w(["v-field__outline",$.value]),style:b(j.value)},[u&&_(N,null,[_("div",{class:"v-field__outline__start"},null),S.value&&_("div",{class:"v-field__outline__notch"},[y(VN,{ref:R,floating:!0,for:C.value,"aria-hidden":!g.value},{default:()=>[x()]})]),_("div",{class:"v-field__outline__end"},null)]),M.value&&S.value&&y(VN,{ref:R,floating:!0,for:C.value,"aria-hidden":!g.value},{default:()=>[x()]})])])}),{controlRef:O,fieldIconColor:F}}});const FN=["color","file","time","date","datetime-local","week","month"],BN=oe({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:[Number,Function],prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...vN(),...MN()},"VTextField"),UN=ae()({name:"VTextField",directives:{vIntersect:tE},inheritAttrs:!1,props:BN(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:r,emit:i,slots:s}=n;const a=Ae(e,"modelValue"),{isFocused:o,focus:l,blur:u}=uN(e),{onIntersect:c}=function(e){return{onIntersect:function(t,n){var r,i;e.autofocus&&t&&(null==(i=null==(r=n[0].target)?void 0:r.focus)||i.call(r))}}}(e),d=f(()=>"function"==typeof e.counterValue?e.counterValue(a.value):"number"==typeof e.counterValue?e.counterValue:(a.value??"").toString().length),p=f(()=>r.maxlength?r.maxlength:!e.counter||"number"!=typeof e.counter&&"string"!=typeof e.counter?void 0:e.counter),m=f(()=>["plain","underlined"].includes(e.variant)),v=t(),g=t(),b=t(),I=f(()=>FN.includes(e.type)||e.persistentPlaceholder||o.value||e.active);function S(){o.value||l(),h(()=>{var e;b.value!==document.activeElement&&(null==(e=b.value)||e.focus())})}function T(e){i("mousedown:control",e),e.target!==b.value&&(S(),e.preventDefault())}function C(e){i("click:control",e)}function E(t){var n;const r=t.target;if(a.value=r.value,(null==(n=e.modelModifiers)?void 0:n.trim)&&["text","search","password","tel","url"].includes(e.type)){const e=[r.selectionStart,r.selectionEnd];h(()=>{r.selectionStart=e[0],r.selectionEnd=e[1]})}}return be(()=>{const t=!!(s.counter||!1!==e.counter&&null!=e.counter),n=!(!t&&!s.details),[i,f]=St(r),{modelValue:x,...D}=gN.filterProps(e),P=LN.filterProps(e);return y(gN,k({ref:v,modelValue:a.value,"onUpdate:modelValue":e=>a.value=e,class:["v-text-field",{"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-input--plain-underlined":m.value},e.class],style:e.style},i,D,{centerAffix:!m.value,focused:o.value}),{...s,default:t=>{let{id:n,isDisabled:r,isDirty:i,isReadonly:d,isValid:p,hasDetails:m,reset:v}=t;return y(LN,k({ref:g,onMousedown:T,onClick:C,"onClick:clear":t=>function(t,n){t.stopPropagation(),S(),h(()=>{a.value=null,n(),Tt(e["onClick:clear"],t)})}(t,v),"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"],role:e.role},P,{id:n.value,active:I.value||i.value,dirty:i.value||e.dirty,disabled:r.value,focused:o.value,details:m.value,error:!1===p.value}),{...s,default:t=>{let{props:{class:n,...i}}=t;const o=A(_("input",k({ref:b,value:a.value,onInput:E,autofocus:e.autofocus,readonly:d.value,disabled:r.value,name:e.name,placeholder:e.placeholder,size:1,type:e.type,onFocus:l,onBlur:u},i,f),null),[[tE,{handler:c},null,{once:!0}]]);return _(N,null,[e.prefix&&_("span",{class:"v-text-field__prefix"},[_("span",{class:"v-text-field__prefix__text"},[e.prefix])]),s.default?_("div",{class:w(n),"data-no-activator":""},[s.default(),o]):Q(o,{class:n}),e.suffix&&_("span",{class:"v-text-field__suffix"},[_("span",{class:"v-text-field__suffix__text"},[e.suffix])])])}})},details:n?n=>{var r;return _(N,null,[null==(r=s.details)?void 0:r.call(s,n),t&&_(N,null,[_("span",null,null),y(PN,{active:e.persistentCounter||o.value,value:d.value,max:p.value,disabled:e.disabled},s.counter)])])}:void 0})}),zA({},v,g,b)}}),$N=oe({renderless:Boolean,..._e()},"VVirtualScrollItem"),jN=ae()({name:"VVirtualScrollItem",inheritAttrs:!1,props:$N(),emits:{"update:height":e=>!0},setup(e,t){let{attrs:n,emit:r,slots:i}=t;const{resizeRef:s,contentRect:a}=Re(void 0,"border");d(()=>{var e;return null==(e=a.value)?void 0:e.height},e=>{null!=e&&r("update:height",e)}),be(()=>{var t,r;return e.renderless?_(N,null,[null==(t=i.default)?void 0:t.call(i,{itemRef:s})]):_("div",k({ref:s,class:["v-virtual-scroll__item",e.class],style:e.style},n),[null==(r=i.default)?void 0:r.call(i)])})}}),zN=oe({itemHeight:{type:[Number,String],default:null},itemKey:{type:[String,Array,Function],default:null},height:[Number,String]},"virtual");function qN(e,n){const r=gt(),i=v(0);L(()=>{i.value=parseFloat(e.itemHeight||0)});const s=v(0),a=v(Math.ceil((parseInt(e.height)||r.height.value)/(i.value||16))||1),o=v(0),l=v(0),u=t(),p=t();let m=0;const{resizeRef:g,contentRect:y}=Re();L(()=>{g.value=u.value});const b=f(()=>{var t;return u.value===document.documentElement?r.height.value:(null==(t=y.value)?void 0:t.height)||parseInt(e.height)||0}),w=f(()=>!!(u.value&&p.value&&b.value&&i.value));let _=Array.from({length:n.value.length}),I=Array.from({length:n.value.length});const S=v(0);let k=-1;function T(e){return _[e]||i.value}const C=xt(()=>{const e=performance.now();I[0]=0;const t=n.value.length;for(let n=1;n<=t-1;n++)I[n]=(I[n-1]||0)+T(n-1);S.value=Math.max(S.value,performance.now()-e)},S),E=d(w,e=>{e&&(E(),m=p.value.offsetTop,C.immediate(),M(),~k&&h(()=>{Le&&window.requestAnimationFrame(()=>{B(k),k=-1})}))});function x(e){e=Ve(e,0,n.value.length-1);const t=Math.floor(e),r=e%1,i=t+1,s=I[t]||0;return s+((I[i]||s)-s)*r}function A(e){return function(e,t){let n=e.length-1,r=0,i=0,s=null,a=-1;if(e[n]<t)return n;for(;r<=n;)if(i=r+n>>1,s=e[i],s>t)n=i-1;else{if(!(s<t))return s===t?i:r;a=i,r=i+1}return a}(I,e)}c(()=>{C.clear()});let N=0,D=0,P=0;d(b,(e,t)=>{t&&(M(),e<t&&requestAnimationFrame(()=>{D=0,M()}))});let R=-1;function V(){u.value&&p.value&&(D=0,P=0,window.clearTimeout(R),M())}let O=-1;function M(){cancelAnimationFrame(O),O=requestAnimationFrame(F)}function F(){if(!u.value||!b.value||!i.value)return;const e=N-m,t=Math.sign(D),r=Math.max(0,e-100),c=Ve(A(r),0,n.value.length),d=e+b.value+100,h=Ve(A(d)+1,c+1,n.value.length);if((-1!==t||c<s.value)&&(1!==t||h>a.value)){const e=x(s.value)-x(c),t=x(h)-x(a.value);Math.max(e,t)>100?(s.value=c,a.value=h):(c<=0&&(s.value=c),h>=n.value.length&&(a.value=h))}o.value=x(s.value),l.value=x(n.value.length)-x(a.value)}function B(e){const t=x(e);!u.value||e&&!t?k=e:u.value.scrollTop=t}const U=f(()=>n.value.slice(s.value,a.value).map((t,n)=>{const r=n+s.value;return{raw:t,index:r,key:Xe(t,e.itemKey,r)}}));return d(n,()=>{_=Array.from({length:n.value.length}),I=Array.from({length:n.value.length}),C.immediate(),M()},{deep:1}),{calculateVisibleItems:M,containerRef:u,markerRef:p,computedItems:U,paddingTop:o,paddingBottom:l,scrollToIndex:B,handleScroll:function(){if(!u.value||!p.value)return;const e=u.value.scrollTop,t=performance.now();t-P>500?(D=Math.sign(e-N),m=p.value.offsetTop):D=e-N,N=e,P=t,window.clearTimeout(R),R=window.setTimeout(V,500),M()},handleScrollend:V,handleItemResize:function(e,t){const n=_[e],r=i.value;i.value=r?Math.min(i.value,t):t,n===t&&r===i.value||(_[e]=t,C())}}}const GN=oe({items:{type:Array,default:()=>[]},renderless:Boolean,...zN(),..._e(),...KC()},"VVirtualScroll"),KN=ae()({name:"VVirtualScroll",props:GN(),setup(e,t){let{slots:n}=t;const r=Ee("VVirtualScroll"),{dimensionStyles:i}=HC(e),{calculateVisibleItems:s,containerRef:a,markerRef:o,handleScroll:l,handleScrollend:u,handleItemResize:d,scrollToIndex:h,paddingTop:p,paddingBottom:f,computedItems:m}=qN(e,x(()=>e.items));return et(()=>e.renderless,()=>{function e(){var e,t;const n=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"addEventListener":"removeEventListener";a.value===document.documentElement?(document[n]("scroll",l,{passive:!0}),document[n]("scrollend",u)):(null==(e=a.value)||e[n]("scroll",l,{passive:!0}),null==(t=a.value)||t[n]("scrollend",u))}P(()=>{a.value=bt(r.vnode.el,!0),e(!0)}),c(e)}),be(()=>{const t=m.value.map(t=>y(jN,{key:t.key,renderless:e.renderless,"onUpdate:height":e=>d(t.index,e)},{default:e=>{var r;return null==(r=n.default)?void 0:r.call(n,{item:t.raw,index:t.index,...e})}}));return e.renderless?_(N,null,[_("div",{ref:o,class:"v-virtual-scroll__spacer",style:{paddingTop:ve(p.value)}},null),t,_("div",{class:"v-virtual-scroll__spacer",style:{paddingBottom:ve(f.value)}},null)]):_("div",{ref:a,class:w(["v-virtual-scroll",e.class]),onScrollPassive:l,onScrollend:u,style:b([i.value,e.style])},[_("div",{ref:o,class:"v-virtual-scroll__container",style:{paddingTop:ve(p.value),paddingBottom:ve(f.value)}},[t])])}),{calculateVisibleItems:s,scrollToIndex:h}}});function HN(e,t){const n=v(!1);let r;return{onScrollPassive:function(e){cancelAnimationFrame(r),n.value=!0,r=requestAnimationFrame(()=>{r=requestAnimationFrame(()=>{n.value=!1})})},onKeydown:async function(r){var i,s;if("Tab"===r.key&&(null==(i=t.value)||i.focus()),!["PageDown","PageUp","Home","End"].includes(r.key))return;const a=null==(s=e.value)?void 0:s.$el;if(!a)return;"Home"!==r.key&&"End"!==r.key||a.scrollTo({top:"Home"===r.key?0:a.scrollHeight,behavior:"smooth"}),await async function(){await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>requestAnimationFrame(e)),await new Promise(e=>{if(n.value){const t=d(n,()=>{t(),e()})}else e()})}();const o=a.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if("PageDown"===r.key||"Home"===r.key){const e=a.getBoundingClientRect().top;for(const t of o)if(t.getBoundingClientRect().top>=e){t.focus();break}}else{const e=a.getBoundingClientRect().bottom;for(const t of[...o].reverse())if(t.getBoundingClientRect().bottom<=e){t.focus();break}}}}}const WN=oe({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:Ie,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,noAutoScroll:Boolean,...Zx({itemChildren:!1})},"Select"),QN=oe({...WN(),...Je(BN({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...JC({transition:{component:gx}})},"VSelect"),YN=ae()({name:"VSelect",props:QN(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{slots:r}=n;const{t:i}=kt(),s=t(),a=t(),o=t(),{items:l,transformIn:u,transformOut:c}=rA(e),p=Ae(e,"modelValue",[],e=>u(null===e?[null]:De(e)),t=>{const n=c(t);return e.multiple?n:n[0]??null}),m=f(()=>"function"==typeof e.counterValue?e.counterValue(p.value):"number"==typeof e.counterValue?e.counterValue:p.value.length),g=hN(e),b=f(()=>p.value.map(e=>e.value)),w=v(!1);let I,S="",T=-1;const C=f(()=>e.hideSelected?l.value.filter(t=>!p.value.some(n=>(e.valueComparator||Ne)(n,t))):l.value),E=f(()=>e.hideNoData&&!C.value.length||g.isReadonly.value||g.isDisabled.value),A=Ae(e,"menu"),D=f({get:()=>A.value,set:e=>{var t;A.value&&!e&&(null==(t=a.value)?void 0:t.ΨopenChildren.size)||e&&E.value||(A.value=e)}}),P=x(()=>D.value?e.closeText:e.openText),R=f(()=>{var t;return{...e.menuProps,activatorProps:{...(null==(t=e.menuProps)?void 0:t.activatorProps)||{},"aria-haspopup":"listbox"}}}),V=t(),O=HN(V,s);function M(t){e.openOnClear&&(D.value=!0)}function L(){E.value||(D.value=!D.value)}function F(e){Dt(e)&&B(e)}function B(t){var n,r,i;if(!t.key||g.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"," "].includes(t.key)&&(D.value=!0),["Escape","Tab"].includes(t.key)&&(D.value=!1),"Home"===t.key?null==(n=V.value)||n.focus("first"):"End"===t.key&&(null==(r=V.value)||r.focus("last"));if(!Dt(t))return;const s=performance.now();s-I>1e3&&(S="",T=-1),S+=t.key.toLowerCase(),I=s;const a=C.value;function o(){for(let e=T+1;e<a.length;e++){const t=a[e];if(t.title.toLowerCase().startsWith(S))return[t,e]}}const l=function(){let e=o();return e||(S.at(-1)===S.at(-2)&&(S=S.slice(0,-1),e=o(),e)?e:(T=-1,e=o(),e||(S=t.key.toLowerCase(),o())))}();if(!l)return;const[u,c]=l;T=c,null==(i=V.value)||i.focus(c),e.multiple||(p.value=[u])}function U(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t.props.disabled)if(e.multiple){const r=p.value.findIndex(n=>(e.valueComparator||Ne)(n.value,t.value)),i=null==n?!~r:n;if(~r){const e=i?[...p.value,t]:[...p.value];e.splice(r,1),p.value=e}else i&&(p.value=[...p.value,t])}else{const e=!1!==n;p.value=e?[t]:[],h(()=>{D.value=!1})}}function $(e){var t;(null==(t=V.value)?void 0:t.$el.contains(e.relatedTarget))||(D.value=!1)}function j(){var t;e.eager&&(null==(t=o.value)||t.calculateVisibleItems())}function z(){var e;w.value&&(null==(e=s.value)||e.focus())}function q(e){w.value=!0}function G(e){if(null==e)p.value=[];else if(ft(s.value,":autofill")||ft(s.value,":-webkit-autofill")){const t=l.value.find(t=>t.title===e);t&&U(t)}else s.value&&(s.value.value="")}return d(D,()=>{if(!e.hideSelected&&D.value&&p.value.length){const t=C.value.findIndex(t=>p.value.some(n=>(e.valueComparator||Ne)(n.value,t.value)));Le&&!e.noAutoScroll&&window.requestAnimationFrame(()=>{var e;t>=0&&(null==(e=o.value)||e.scrollToIndex(t))})}}),d(()=>e.items,(t,n)=>{D.value||w.value&&e.hideNoData&&!n.length&&t.length&&(D.value=!0)}),be(()=>{const t=!(!e.chips&&!r.chip),n=!!(!e.hideNoData||C.value.length||r["prepend-item"]||r["append-item"]||r["no-data"]),l=p.value.length>0,u=UN.filterProps(e),c=l||!w.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return y(UN,k({ref:s},u,{modelValue:p.value.map(e=>e.props.value).join(", "),"onUpdate:modelValue":G,focused:w.value,"onUpdate:focused":e=>w.value=e,validationValue:p.externalValue,counterValue:m.value,dirty:l,class:["v-select",{"v-select--active-menu":D.value,"v-select--chips":!!e.chips,["v-select--"+(e.multiple?"multiple":"single")]:!0,"v-select--selected":p.value.length,"v-select--selection-slot":!!r.selection},e.class],style:e.style,inputmode:"none",placeholder:c,"onClick:clear":M,"onMousedown:control":L,onBlur:$,onKeydown:B,"aria-label":i(P.value),title:i(P.value)}),{...r,default:()=>_(N,null,[y(GA,k({ref:a,modelValue:D.value,"onUpdate:modelValue":e=>D.value=e,activator:"parent",contentClass:"v-select__content",disabled:E.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:j,onAfterLeave:z},R.value),{default:()=>[n&&y(lA,k({ref:V,selected:b.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),onKeydown:F,onFocusin:q,tabindex:"-1","aria-live":"polite","aria-label":`${e.label}-list`,color:e.itemColor??e.color},O,e.listProps),{default:()=>{var t,n,s;return[null==(t=r["prepend-item"])?void 0:t.call(r),!C.value.length&&!e.hideNoData&&((null==(n=r["no-data"])?void 0:n.call(r))??y(Wx,{key:"no-data",title:i(e.noDataText)},null)),y(KN,{ref:o,renderless:!0,items:C.value,itemKey:"value"},{default:t=>{var n,i,s;let{item:a,index:o,itemRef:l}=t;const u=At(a.props),c=k(a.props,{ref:l,key:a.value,onClick:()=>U(a,null)});return"divider"===a.type?(null==(n=r.divider)?void 0:n.call(r,{props:a.raw,index:o}))??y(cx,k(a.props,{key:`divider-${o}`}),null):"subheader"===a.type?(null==(i=r.subheader)?void 0:i.call(r,{props:a.raw,index:o}))??y(Yx,k(a.props,{key:`subheader-${o}`}),null):(null==(s=r.item)?void 0:s.call(r,{item:a,index:o,props:c}))??y(Wx,k(c,{role:"option"}),{prepend:t=>{let{isSelected:n}=t;return _(N,null,[e.multiple&&!e.hideSelected?y(iN,{key:a.value,modelValue:n,ripple:!1,tabindex:"-1"},null):void 0,u.prependAvatar&&y(fE,{image:u.prependAvatar},null),u.prependIcon&&y(GC,{icon:u.prependIcon},null)])}})}}),null==(s=r["append-item"])?void 0:s.call(r)]}})]}),p.value.map((n,i)=>{function s(e){e.stopPropagation(),e.preventDefault(),U(n,!1)}const a={"onClick:close":s,onKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),s(e))},onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},o=t?!!r.chip:!!r.selection,l=o?Nt(t?r.chip({item:n,index:i,props:a}):r.selection({item:n,index:i})):void 0;if(!o||l)return _("div",{key:n.value,class:"v-select__selection"},[t?r.chip?y(MC,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:n.title}}},{default:()=>[l]}):y(NN,k({key:"chip",closable:e.closableChips,size:"small",text:n.title,disabled:n.props.disabled},a),null):l??_("span",{class:"v-select__selection-text"},[n.title,e.multiple&&i<p.value.length-1&&_("span",{class:"v-select__selection-comma"},[H(",")])])])})]),"append-inner":function(){for(var t,n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return _(N,null,[null==(t=r["append-inner"])?void 0:t.call(r,...a),e.menuIcon?y(GC,{class:"v-select__menu-icon",color:null==(n=s.value)?void 0:n.fieldIconColor,icon:e.menuIcon},null):void 0])}})}),zA({isFocused:w,menu:D,select:U},s)}}),XN={id:"account-controls",class:"minimal-account-selector"},JN=VC({__name:"AccountSelector",props:{accounts:{type:Array,required:!0},modelValue:{type:String,default:null},visible:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,r=t,i=f({get:()=>n.modelValue,set(e){r("update:modelValue",e)}});return(t,n)=>A((G(),q("div",XN,[y(YN,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=e=>i.value=e),items:e.accounts,"item-title":"name","item-value":"id",label:"管理対象アカウント",variant:"outlined",density:"compact",color:"primary","prepend-inner-icon":"mdi-account-multiple",class:"minimal-select","hide-details":""},null,8,["modelValue","items"])],512)),[[D,e.visible]])}},[["__scopeId","data-v-eb89f250"]]),ZN=Ke("v-alert-title"),eD=oe({iconSize:[Number,String],iconSizes:{type:Array,default:()=>[["x-small",10],["small",16],["default",24],["large",28],["x-large",32]]}},"iconSize");const tD=["success","info","warning","error"],nD=oe({border:{type:[Boolean,String],validator:e=>"boolean"==typeof e||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:Ie,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>tD.includes(e)},..._e(),...oE(),...KC(),...mE(),...eD(),...DE(),...BE(),...YC(),...zC(),...we(),...dE({variant:"flat"})},"VAlert"),rD=ae()({name:"VAlert",props:nD(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{emit:n,slots:r}=t;const i=Ae(e,"modelValue"),s=x(()=>{if(!1!==e.icon)return e.type?e.icon??`$${e.type}`:e.icon}),{iconSize:a}=function(e,t){return{iconSize:f(()=>{const n=new Map(e.iconSizes),r=e.iconSize??t()??"default";return n.has(r)?n.get(r):r})}}(e,()=>e.prominent?44:void 0),{themeClasses:o}=xe(e),{colorClasses:l,colorStyles:u,variantClasses:c}=hE(()=>({color:e.color??e.type,variant:e.variant})),{densityClasses:d}=lE(e),{dimensionStyles:h}=HC(e),{elevationClasses:p}=vE(e),{locationStyles:m}=PE(e),{positionClasses:v}=UE(e),{roundedClasses:g}=XC(e),{textColorClasses:I,textColorStyles:S}=FC(()=>e.borderColor),{t:T}=kt(),C=x(()=>({"aria-label":T(e.closeLabel),onClick(e){i.value=!1,n("click:close",e)}}));return()=>{const t=!(!r.prepend&&!s.value),n=!(!r.title&&!e.title),f=!(!r.close&&!e.closable),T={density:e.density,icon:s.value,size:e.iconSize||e.prominent?a.value:void 0};return i.value&&y(e.tag,{class:w(["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${!0===e.border?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},o.value,l.value,d.value,p.value,v.value,g.value,c.value,e.class]),style:b([u.value,h.value,m.value,e.style]),role:"alert"},{default:()=>{var i,a;return[cE(!1,"v-alert"),e.border&&_("div",{key:"border",class:w(["v-alert__border",I.value]),style:b(S.value)},null),t&&_("div",{key:"prepend",class:"v-alert__prepend"},[r.prepend?y(MC,{key:"prepend-defaults",disabled:!s.value,defaults:{VIcon:{...T}}},r.prepend):y(GC,k({key:"prepend-icon"},T),null)]),_("div",{class:"v-alert__content"},[n&&y(ZN,{key:"title"},{default:()=>{var t;return[(null==(t=r.title)?void 0:t.call(r))??e.title]}}),(null==(i=r.text)?void 0:i.call(r))??e.text,null==(a=r.default)?void 0:a.call(r)]),r.append&&_("div",{key:"append",class:"v-alert__append"},[r.append()]),f&&_("div",{key:"close",class:"v-alert__close"},[r.close?y(MC,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var e;return[null==(e=r.close)?void 0:e.call(r,{props:C.value})]}}):y(lx,k({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},C.value),null)])]}})}}}),iD=(e,t,n)=>{if(null==e||null==t)return-1;if(!t.length)return 0;e=e.toString().toLocaleLowerCase(),t=t.toString().toLocaleLowerCase();const r=[];let i=e.indexOf(t);for(;~i;)r.push([i,i+t.length]),i=e.indexOf(t,i+t.length);return r.length?r:-1};function sD(e,t){if(null!=e&&"boolean"!=typeof e&&-1!==e)return"number"==typeof e?[[e,e+t.length]]:Array.isArray(e[0])?e:[e]}const aD=oe({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function oD(e,t,n,r){const i=v([]),s=v(new Map),a=f(()=>(null==r?void 0:r.transform)?M(t).map(e=>[e,r.transform(e)]):M(t));return L(()=>{const o="function"==typeof n?n():M(n),l="string"!=typeof o&&"number"!=typeof o?"":String(o),u=function(e,t,n){var r;const i=[],s=(null==n?void 0:n.default)??iD,a=!!(null==n?void 0:n.filterKeys)&&De(n.filterKeys),o=Object.keys((null==n?void 0:n.customKeyFilter)??{}).length;if(!(null==e?void 0:e.length))return i;e:for(let l=0;l<e.length;l++){const[u,c=u]=De(e[l]),d={},h={};let p=-1;if((t||o>0)&&!(null==n?void 0:n.noFilter)){if("object"==typeof u){if("divider"===u.type||"subheader"===u.type)continue;const e=a||Object.keys(c);for(const i of e){const e=Xe(c,i),a=null==(r=null==n?void 0:n.customKeyFilter)?void 0:r[i];if(p=a?a(e,t,u):s(e,t,u),-1!==p&&!1!==p)a?d[i]=sD(p,t):h[i]=sD(p,t);else if("every"===(null==n?void 0:n.filterMode))continue e}}else p=s(u,t,u),-1!==p&&!1!==p&&(h.title=sD(p,t));const e=Object.keys(h).length,i=Object.keys(d).length;if(!e&&!i)continue;if("union"===(null==n?void 0:n.filterMode)&&i!==o&&!e)continue;if("intersection"===(null==n?void 0:n.filterMode)&&(i!==o||!e))continue}i.push({index:l,matches:{...h,...d}})}return i}(a.value,l,{customKeyFilter:{...e.customKeyFilter,...M(null==r?void 0:r.customKeyFilter)},default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),c=M(t),d=[],h=new Map;u.forEach(e=>{let{index:t,matches:n}=e;const r=c[t];d.push(r),h.set(r.value,n)}),i.value=d,s.value=h}),{filteredItems:i,filteredMatches:s,getMatches:function(e){return s.value.get(e.value)}}}const lD=oe({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...aD({filterKeys:["title"]}),...WN(),...Je(BN({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...JC({transition:!1})},"VAutocomplete"),uD=ae()({name:"VAutocomplete",props:lD(),emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,n){let{slots:r}=n;const{t:i}=kt(),s=t(),a=v(!1),o=v(!0),l=v(!1),u=t(),c=t(),p=v(-1),{items:m,transformIn:g,transformOut:I}=rA(e),{textColorClasses:S,textColorStyles:T}=FC(()=>{var e;return null==(e=s.value)?void 0:e.color}),C=Ae(e,"search",""),E=Ae(e,"modelValue",[],e=>g(null===e?[null]:De(e)),t=>{const n=I(t);return e.multiple?n:n[0]??null}),x=f(()=>"function"==typeof e.counterValue?e.counterValue(E.value):"number"==typeof e.counterValue?e.counterValue:E.value.length),A=hN(e),{filteredItems:D,getMatches:P}=oD(e,m,()=>o.value?"":C.value),R=f(()=>e.hideSelected?D.value.filter(e=>!E.value.some(t=>t.value===e.value)):D.value),V=f(()=>!(!e.chips&&!r.chip)),O=f(()=>V.value||!!r.selection),M=f(()=>E.value.map(e=>e.props.value)),L=f(()=>{var t;return(!0===e.autoSelectFirst||"exact"===e.autoSelectFirst&&C.value===(null==(t=R.value[0])?void 0:t.title))&&R.value.length>0&&!o.value&&!l.value}),F=f(()=>e.hideNoData&&!R.value.length||A.isReadonly.value||A.isDisabled.value),B=Ae(e,"menu"),U=f({get:()=>B.value,set:e=>{var t;B.value&&!e&&(null==(t=u.value)?void 0:t.ΨopenChildren.size)||e&&F.value||(B.value=e)}}),$=f(()=>U.value?e.closeText:e.openText),j=t(),z=HN(j,s);function q(t){e.openOnClear&&(U.value=!0),C.value=""}function G(){F.value||(U.value=!0)}function K(e){F.value||(a.value&&(e.preventDefault(),e.stopPropagation()),U.value=!U.value)}function W(e){var t;(Dt(e)||"Backspace"===e.key)&&(null==(t=s.value)||t.focus())}function Q(t){var n,r,i,a,o;if(A.isReadonly.value)return;const l=null==(n=s.value)?void 0:n.selectionStart,u=E.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"].includes(t.key)&&(U.value=!0),["Escape"].includes(t.key)&&(U.value=!1),L.value&&["Enter","Tab"].includes(t.key)&&!E.value.some(e=>{let{value:t}=e;return t===R.value[0].value})&&re(R.value[0]),"ArrowDown"===t.key&&L.value&&(null==(r=j.value)||r.focus("next")),["Backspace","Delete"].includes(t.key)){if(!e.multiple&&O.value&&E.value.length>0&&!C.value)return re(E.value[0],!1);if(~p.value){t.preventDefault();const e=p.value;re(E.value[p.value],!1),p.value=e>=u-1?u-2:e}else"Backspace"!==t.key||C.value||(p.value=u-1)}else if(e.multiple)if("ArrowLeft"===t.key){if(p.value<0&&l&&l>0)return;const e=p.value>-1?p.value-1:u-1;if(E.value[e])p.value=e;else{const e=(null==(i=C.value)?void 0:i.length)??null;p.value=-1,null==(a=s.value)||a.setSelectionRange(e,e)}}else if("ArrowRight"===t.key){if(p.value<0)return;const e=p.value+1;E.value[e]?p.value=e:(p.value=-1,null==(o=s.value)||o.setSelectionRange(0,0))}else~p.value&&Dt(t)&&(p.value=-1)}function Y(e){if(ft(s.value,":autofill")||ft(s.value,":-webkit-autofill")){const t=m.value.find(t=>t.title===e.target.value);t&&re(t)}}function X(){var t;e.eager&&(null==(t=c.value)||t.calculateVisibleItems())}function J(){var e;a.value&&(o.value=!0,null==(e=s.value)||e.focus())}function Z(e){a.value=!0,setTimeout(()=>{l.value=!0})}function ee(e){l.value=!1}function te(t){null!=t&&(""!==t||e.multiple||O.value)||(E.value=[])}const ne=v(!1);function re(t){let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t&&!t.props.disabled)if(e.multiple){const r=E.value.findIndex(n=>(e.valueComparator||Ne)(n.value,t.value)),i=null==n?!~r:n;if(~r){const e=i?[...E.value,t]:[...E.value];e.splice(r,1),E.value=e}else i&&(E.value=[...E.value,t]);e.clearOnSelect&&(C.value="")}else{const e=!1!==n;E.value=e?[t]:[],C.value=e&&!O.value?t.title:"",h(()=>{U.value=!1,o.value=!0})}}return d(a,(t,n)=>{var r;t!==n&&(t?(ne.value=!0,C.value=e.multiple||O.value?"":String((null==(r=E.value.at(-1))?void 0:r.props.title)??""),o.value=!0,h(()=>ne.value=!1)):(e.multiple||null!=C.value||(E.value=[]),U.value=!1,(e.multiple||O.value)&&(C.value=""),p.value=-1))}),d(C,e=>{a.value&&!ne.value&&(e&&(U.value=!0),o.value=!e)}),d(U,()=>{if(!e.hideSelected&&U.value&&E.value.length){const e=R.value.findIndex(e=>E.value.some(t=>e.value===t.value));Le&&window.requestAnimationFrame(()=>{var t;e>=0&&(null==(t=c.value)||t.scrollToIndex(e))})}}),d(()=>e.items,(e,t)=>{U.value||a.value&&!t.length&&e.length&&(U.value=!0)}),be(()=>{const t=!!(!e.hideNoData||R.value.length||r["prepend-item"]||r["append-item"]||r["no-data"]),n=E.value.length>0,l=UN.filterProps(e);return y(UN,k({ref:s},l,{modelValue:C.value,"onUpdate:modelValue":[e=>C.value=e,te],focused:a.value,"onUpdate:focused":e=>a.value=e,validationValue:E.externalValue,counterValue:x.value,dirty:n,onChange:Y,class:["v-autocomplete","v-autocomplete--"+(e.multiple?"multiple":"single"),{"v-autocomplete--active-menu":U.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selection-slot":!!O.value,"v-autocomplete--selecting-index":p.value>-1},e.class],style:e.style,readonly:A.isReadonly.value,placeholder:n?void 0:e.placeholder,"onClick:clear":q,"onMousedown:control":G,onKeydown:Q}),{...r,default:()=>_(N,null,[y(GA,k({ref:u,modelValue:U.value,"onUpdate:modelValue":e=>U.value=e,activator:"parent",contentClass:"v-autocomplete__content",disabled:F.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:X,onAfterLeave:J},e.menuProps),{default:()=>[t&&y(lA,k({ref:j,filterable:!0,selected:M.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:e=>e.preventDefault(),onKeydown:W,onFocusin:Z,onFocusout:ee,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},z,e.listProps),{default:()=>{var t,n,s;return[null==(t=r["prepend-item"])?void 0:t.call(r),!R.value.length&&!e.hideNoData&&((null==(n=r["no-data"])?void 0:n.call(r))??y(Wx,{key:"no-data",title:i(e.noDataText)},null)),y(KN,{ref:c,renderless:!0,items:R.value,itemKey:"value"},{default:t=>{var n,i,s;let{item:a,index:l,itemRef:u}=t;const c=k(a.props,{ref:u,key:a.value,active:!(!L.value||0!==l)||void 0,onClick:()=>re(a,null)});return"divider"===a.type?(null==(n=r.divider)?void 0:n.call(r,{props:a.raw,index:l}))??y(cx,k(a.props,{key:`divider-${l}`}),null):"subheader"===a.type?(null==(i=r.subheader)?void 0:i.call(r,{props:a.raw,index:l}))??y(Yx,k(a.props,{key:`subheader-${l}`}),null):(null==(s=r.item)?void 0:s.call(r,{item:a,index:l,props:c}))??y(Wx,k(c,{role:"option"}),{prepend:t=>{let{isSelected:n}=t;return _(N,null,[e.multiple&&!e.hideSelected?y(iN,{key:a.value,modelValue:n,ripple:!1,tabindex:"-1"},null):void 0,a.props.prependAvatar&&y(fE,{image:a.props.prependAvatar},null),a.props.prependIcon&&y(GC,{icon:a.props.prependIcon},null)])},title:()=>{var e,t,n,r;return o.value?a.title:(t="v-autocomplete",n=a.title,null!=(r=null==(e=P(a))?void 0:e.title)&&r.length?r.map((e,i)=>{const s=0===i?0:r[i-1][1],a=[_("span",{class:w(`${t}__unmask`)},[n.slice(s,e[0])]),_("span",{class:w(`${t}__mask`)},[n.slice(e[0],e[1])])];return i===r.length-1&&a.push(_("span",{class:w(`${t}__unmask`)},[n.slice(e[1])])),_(N,null,[a])}):n)}})}}),null==(s=r["append-item"])?void 0:s.call(r)]}})]}),E.value.map((t,n)=>{function i(e){e.stopPropagation(),e.preventDefault(),re(t,!1)}const s={"onClick:close":i,onKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),i(e))},onMousedown(e){e.preventDefault(),e.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},a=V.value?!!r.chip:!!r.selection,o=a?Nt(V.value?r.chip({item:t,index:n,props:s}):r.selection({item:t,index:n})):void 0;if(!a||o)return _("div",{key:t.value,class:w(["v-autocomplete__selection",n===p.value&&["v-autocomplete__selection--selected",S.value]]),style:b(n===p.value?T.value:{})},[V.value?r.chip?y(MC,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:t.title}}},{default:()=>[o]}):y(NN,k({key:"chip",closable:e.closableChips,size:"small",text:t.title,disabled:t.props.disabled},s),null):o??_("span",{class:"v-autocomplete__selection-text"},[t.title,e.multiple&&n<E.value.length-1&&_("span",{class:"v-autocomplete__selection-comma"},[H(",")])])])})]),"append-inner":function(){for(var t,n,a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return _(N,null,[null==(t=r["append-inner"])?void 0:t.call(r,...o),e.menuIcon?y(GC,{class:"v-autocomplete__menu-icon",color:null==(n=s.value)?void 0:n.fieldIconColor,icon:e.menuIcon,onMousedown:K,onClick:Pt,"aria-label":i($.value),title:i($.value),tabindex:"-1"},null):void 0])}})}),zA({isFocused:a,isPristine:o,menu:U,search:C,filteredItems:D,select:re},s)}}),cD=ae()({name:"VCardActions",props:_e(),setup(e,t){let{slots:n}=t;return le({VBtn:{slim:!0,variant:"text"}}),be(()=>{var t;return _("div",{class:w(["v-card-actions",e.class]),style:b(e.style)},[null==(t=n.default)?void 0:t.call(n)])}),{}}}),dD=oe({opacity:[Number,String],..._e(),...zC()},"VCardSubtitle"),hD=ae()({name:"VCardSubtitle",props:dD(),setup(e,t){let{slots:n}=t;return be(()=>y(e.tag,{class:w(["v-card-subtitle",e.class]),style:b([{"--v-card-subtitle-opacity":e.opacity},e.style])},n)),{}}}),pD=Ke("v-card-title"),fD=oe({appendAvatar:String,appendIcon:Ie,prependAvatar:String,prependIcon:Ie,subtitle:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},..._e(),...oE()},"VCardItem"),mD=ae()({name:"VCardItem",props:fD(),setup(e,t){let{slots:n}=t;return be(()=>{var t;const r=!(!e.prependAvatar&&!e.prependIcon),i=!(!r&&!n.prepend),s=!(!e.appendAvatar&&!e.appendIcon),a=!(!s&&!n.append),o=!(null==e.title&&!n.title),l=!(null==e.subtitle&&!n.subtitle);return _("div",{class:w(["v-card-item",e.class]),style:b(e.style)},[i&&_("div",{key:"prepend",class:"v-card-item__prepend"},[n.prepend?y(MC,{key:"prepend-defaults",disabled:!r,defaults:{VAvatar:{density:e.density,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},n.prepend):_(N,null,[e.prependAvatar&&y(fE,{key:"prepend-avatar",density:e.density,image:e.prependAvatar},null),e.prependIcon&&y(GC,{key:"prepend-icon",density:e.density,icon:e.prependIcon},null)])]),_("div",{class:"v-card-item__content"},[o&&y(pD,{key:"title"},{default:()=>{var t;return[(null==(t=n.title)?void 0:t.call(n))??B(e.title)]}}),l&&y(hD,{key:"subtitle"},{default:()=>{var t;return[(null==(t=n.subtitle)?void 0:t.call(n))??B(e.subtitle)]}}),null==(t=n.default)?void 0:t.call(n)]),a&&_("div",{key:"append",class:"v-card-item__append"},[n.append?y(MC,{key:"append-defaults",disabled:!s,defaults:{VAvatar:{density:e.density,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},n.append):_(N,null,[e.appendIcon&&y(GC,{key:"append-icon",density:e.density,icon:e.appendIcon},null),e.appendAvatar&&y(fE,{key:"append-avatar",density:e.density,image:e.appendAvatar},null)])])])}),{}}}),vD=oe({opacity:[Number,String],..._e(),...zC()},"VCardText"),gD=ae()({name:"VCardText",props:vD(),setup(e,t){let{slots:n}=t;return be(()=>y(e.tag,{class:w(["v-card-text",e.class]),style:b([{"--v-card-text-opacity":e.opacity},e.style])},n)),{}}}),yD=oe({appendAvatar:String,appendIcon:Ie,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:Ie,ripple:{type:[Boolean,Object],default:!0},subtitle:{type:[String,Number,Boolean],default:void 0},text:{type:[String,Number,Boolean],default:void 0},title:{type:[String,Number,Boolean],default:void 0},...iE(),..._e(),...oE(),...KC(),...mE(),...OE(),...DE(),...BE(),...YC(),...jE(),...zC(),...we(),...dE({variant:"elevated"})},"VCard"),bD=ae()({name:"VCard",directives:{vRipple:ax},props:yD(),setup(e,t){let{attrs:n,slots:r}=t;const{themeClasses:i}=xe(e),{borderClasses:s}=sE(e),{colorClasses:a,colorStyles:o,variantClasses:l}=hE(e),{densityClasses:u}=lE(e),{dimensionStyles:c}=HC(e),{elevationClasses:d}=vE(e),{loaderClasses:h}=ME(e),{locationStyles:p}=PE(e),{positionClasses:f}=UE(e),{roundedClasses:m}=XC(e),v=$E(e,n);return be(()=>{const t=!1!==e.link&&v.isLink.value,n=!e.disabled&&!1!==e.link&&(e.link||v.isClickable.value),g=t?"a":e.tag,b=!(!r.title&&null==e.title),w=!(!r.subtitle&&null==e.subtitle),I=b||w,S=!!(r.append||e.appendAvatar||e.appendIcon),T=!!(r.prepend||e.prependAvatar||e.prependIcon),C=!(!r.image&&!e.image),E=I||T||S,x=!(!r.text&&null==e.text);return A(y(g,k({class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":n},i.value,s.value,a.value,u.value,d.value,h.value,f.value,m.value,l.value,e.class],style:[o.value,c.value,p.value,e.style],onClick:n&&v.navigate,tabindex:e.disabled?-1:void 0},v.linkProps),{default:()=>{var t;return[C&&_("div",{key:"image",class:"v-card__image"},[r.image?y(MC,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},r.image):y(rE,{key:"image-img",cover:!0,src:e.image},null)]),y(LE,{name:"v-card",active:!!e.loading,color:"boolean"==typeof e.loading?void 0:e.loading},{default:r.loader}),E&&y(mD,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:r.item,prepend:r.prepend,title:r.title,subtitle:r.subtitle,append:r.append}),x&&y(gD,{key:"text"},{default:()=>{var t;return[(null==(t=r.text)?void 0:t.call(r))??e.text]}}),null==(t=r.default)?void 0:t.call(r),r.actions&&y(cD,null,{default:r.actions}),cE(n,"v-card")]}}),[[ax,n&&e.ripple]])}),{}}}),wD=oe({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...BA({origin:"center center",scrollStrategy:"block",transition:{component:gx},zIndex:2400})},"VDialog"),_D=ae()({name:"VDialog",props:wD(),emits:{"update:modelValue":e=>!0,afterEnter:()=>!0,afterLeave:()=>!0},setup(e,n){let{emit:r,slots:i}=n;const s=Ae(e,"modelValue"),{scopeId:a}=NA(),o=t();function l(e){var t,n;const r=e.relatedTarget,i=e.target;if(r!==i&&(null==(t=o.value)?void 0:t.contentEl)&&(null==(n=o.value)?void 0:n.globalTop)&&![document,o.value.contentEl].includes(i)&&!o.value.contentEl.contains(i)){const e=wt(o.value.contentEl);if(!e.length)return;const t=e[0],n=e[e.length-1];r===t?n.focus():t.focus()}}function u(){var t;r("afterEnter"),(e.scrim||e.retainFocus)&&(null==(t=o.value)?void 0:t.contentEl)&&!o.value.contentEl.contains(document.activeElement)&&o.value.contentEl.focus({preventScroll:!0})}function c(){r("afterLeave")}return E(()=>{document.removeEventListener("focusin",l)}),Le&&d(()=>s.value&&e.retainFocus,e=>{e?document.addEventListener("focusin",l):document.removeEventListener("focusin",l)},{immediate:!0}),d(s,async e=>{var t;e||(await h(),null==(t=o.value.activatorEl)||t.focus({preventScroll:!0}))}),be(()=>{const t=UA.filterProps(e),n=k({"aria-haspopup":"dialog"},e.activatorProps),r=k({tabindex:-1},e.contentProps);return y(UA,k({ref:o,class:["v-dialog",{"v-dialog--fullscreen":e.fullscreen,"v-dialog--scrollable":e.scrollable},e.class],style:e.style},t,{modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,"aria-modal":"true",activatorProps:n,contentProps:r,height:e.fullscreen?void 0:e.height,width:e.fullscreen?void 0:e.width,maxHeight:e.fullscreen?void 0:e.maxHeight,maxWidth:e.fullscreen?void 0:e.maxWidth,role:"dialog",onAfterEnter:u,onAfterLeave:c},a),{activator:i.activator,default:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return y(MC,{root:"VDialog"},{default:()=>{var e;return[null==(e=i.default)?void 0:e.call(i,...t)]}})}})}),zA({},o)}}),ID=oe({fluid:{type:Boolean,default:!1},..._e(),...KC(),...zC()},"VContainer"),SD=ae()({name:"VContainer",props:ID(),setup(e,t){let{slots:n}=t;const{rtlClasses:r}=Oe(),{dimensionStyles:i}=HC(e);return be(()=>y(e.tag,{class:w(["v-container",{"v-container--fluid":e.fluid},r.value,e.class]),style:b([i.value,e.style])},n)),{}}}),kD=Rt.reduce((e,t)=>(e[t]={type:[Boolean,String,Number],default:!1},e),{}),TD=Rt.reduce((e,t)=>(e["offset"+Y(t)]={type:[String,Number],default:null},e),{}),CD=Rt.reduce((e,t)=>(e["order"+Y(t)]={type:[String,Number],default:null},e),{}),ED={col:Object.keys(kD),offset:Object.keys(TD),order:Object.keys(CD)};function xD(e,t,n){let r=e;if(null!=n&&!1!==n){if(t){r+=`-${t.replace(e,"")}`}return"col"===e&&(r="v-"+r),"col"!==e||""!==n&&!0!==n?(r+=`-${n}`,r.toLowerCase()):r.toLowerCase()}}const AD=["auto","start","end","center","baseline","stretch"],ND=oe({cols:{type:[Boolean,String,Number],default:!1},...kD,offset:{type:[String,Number],default:null},...TD,order:{type:[String,Number],default:null},...CD,alignSelf:{type:String,default:null,validator:e=>AD.includes(e)},..._e(),...zC()},"VCol"),DD=ae()({name:"VCol",props:ND(),setup(e,t){let{slots:n}=t;const r=f(()=>{const t=[];let n;for(n in ED)ED[n].forEach(r=>{const i=e[r],s=xD(n,r,i);s&&t.push(s)});const r=t.some(e=>e.startsWith("v-col-"));return t.push({"v-col":!r||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),t});return()=>{var t;return T(e.tag,{class:[r.value,e.class],style:e.style},null==(t=n.default)?void 0:t.call(n))}}}),PD=["start","end","center"],RD=["space-between","space-around","space-evenly"];function VD(e,t){return Rt.reduce((n,r)=>(n[e+Y(r)]=t(),n),{})}const OD=[...PD,"baseline","stretch"],MD=e=>OD.includes(e),LD=VD("align",()=>({type:String,default:null,validator:MD})),FD=[...PD,...RD],BD=e=>FD.includes(e),UD=VD("justify",()=>({type:String,default:null,validator:BD})),$D=[...PD,...RD,"stretch"],jD=e=>$D.includes(e),zD=VD("alignContent",()=>({type:String,default:null,validator:jD})),qD={align:Object.keys(LD),justify:Object.keys(UD),alignContent:Object.keys(zD)},GD={align:"align",justify:"justify",alignContent:"align-content"};function KD(e,t,n){let r=GD[e];if(null!=n){if(t){r+=`-${t.replace(e,"")}`}return r+=`-${n}`,r.toLowerCase()}}const HD=oe({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:MD},...LD,justify:{type:String,default:null,validator:BD},...UD,alignContent:{type:String,default:null,validator:jD},...zD,..._e(),...zC()},"VRow"),WD=ae()({name:"VRow",props:HD(),setup(e,t){let{slots:n}=t;const r=f(()=>{const t=[];let n;for(n in qD)qD[n].forEach(r=>{const i=e[r],s=KD(n,r,i);s&&t.push(s)});return t.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),t});return()=>{var t;return T(e.tag,{class:["v-row",r.value,e.class],style:e.style},null==(t=n.default)?void 0:t.call(n))}}}),QD=Ke("v-spacer","div","VSpacer"),YD={key:0,class:"mb-4"},XD={key:1,class:"mt-6"},JD={class:"text-h6 font-weight-medium mb-3"},ZD={class:"d-flex align-center gap-2"},eP=VC({__name:"ItemEditModal",props:{modelValue:{type:Boolean,default:!1},character:{type:Object,default:null},isNewCharacter:{type:Boolean,default:!1}},emits:["update:modelValue","save"],setup(e,{emit:n}){const r=e,i=n,s=PC(),a=f({get:()=>r.modelValue,set:e=>i("update:modelValue",e)}),o=t([]),l=t([]),u=t(""),c=t(!1),h=f(()=>r.character?s.characterMastersMap.get(r.character.characterMasterId):null),p=f(()=>s.itemMasters.map(e=>({id:e.id,name:e.name}))),m=e=>{if(!e)return!0;const t=l.value.filter(e=>!e.isVirtual).length,n=l.value.filter(e=>e.isVirtual).length;return t>3?"実アイテムは最大3個までです":n>3?"仮アイテムは最大3個までです":!(e.length>6)||"アイテムは最大6個までです"},v=e=>{const t=l.value.find(t=>t.itemId===e);return t?t.isVirtual?"orange":"success":"primary"},g=e=>{const t=e.filter(e=>!l.value.some(t=>t.itemId===e));l.value=l.value.filter(t=>e.includes(t.itemId)),t.forEach(e=>{l.value.push({itemId:Number(e),isVirtual:!1,willRemove:!1})})},b=()=>{a.value=!1,u.value=""},w=async()=>{const e=l.value.filter(e=>!e.isVirtual).length,t=l.value.filter(e=>e.isVirtual).length;if(e>3)u.value="実アイテムは最大3個までです";else if(t>3)u.value="仮アイテムは最大3個までです";else if(l.value.length>6)u.value="アイテムは最大6個までです";else{c.value=!0;try{i("save",{character:r.character,items:l.value,isNew:r.isNewCharacter}),b()}catch(n){u.value=`保存に失敗しました: ${n.message}`}finally{c.value=!1}}};return d(()=>r.character,e=>{if(!e)return l.value=[],void(o.value=[]);const t=IC(e.items||[]);l.value=t.map(e=>({itemId:e.itemId,isVirtual:e.isVirtual||!1,willRemove:e.willRemove||!1})),o.value=t.map(e=>e.itemId)},{immediate:!0}),(t,n)=>(G(),W(_D,{modelValue:a.value,"onUpdate:modelValue":n[2]||(n[2]=e=>a.value=e),"max-width":"600px",persistent:""},{default:K(()=>[y(bD,{class:"dialog-card"},{default:K(()=>[y(pD,{class:"bg-primary text-white pa-4"},{default:K(()=>[y(GC,{icon:e.isNewCharacter?"mdi-plus-circle":"mdi-pencil",class:"mr-2"},null,8,["icon"]),H(" "+B(e.isNewCharacter?"所持追加+アイテム設定":"アイテム編集"),1)]),_:1}),y(gD,{class:"pa-6"},{default:K(()=>[h.value?(G(),q("div",YD,[y(NN,{color:"primary",variant:"tonal",class:"mb-2"},{default:K(()=>[H(B(h.value.monsterName),1)]),_:1})])):X("",!0),y(uD,{modelValue:o.value,"onUpdate:modelValue":[n[0]||(n[0]=e=>o.value=e),g],items:p.value,"item-title":"name","item-value":"id",label:"アイテムを選択（実最大3個+仮最大3個=最大6個）",multiple:"",chips:"","closable-chips":"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-sword-cross",rules:[m]},{chip:K(({props:e,item:t})=>[y(NN,k(e,{color:v(t.value),closable:""}),{default:K(()=>[H(B(t.title),1)]),_:2},1040,["color"])]),_:1},8,["modelValue","items","rules"]),l.value.length>0?(G(),q("div",XD,[y(cx,{class:"mb-4"}),_("h6",JD,[y(GC,{icon:"mdi-cog",class:"mr-2",color:"secondary"}),n[3]||(n[3]=H(" アイテム設定 ",-1))]),y(lA,null,{default:K(()=>[(G(!0),q(N,null,J(l.value,e=>(G(),W(Wx,{key:e.itemId,class:"mb-2 border rounded"},{prepend:K(()=>[y(GC,{icon:e.isVirtual?"mdi-clipboard-text-outline":"mdi-check-circle",color:e.isVirtual?"orange":"success"},null,8,["icon","color"])]),append:K(()=>[_("div",ZD,[y(CE,{"model-value":e.isVirtual?"virtual":"real","onUpdate:modelValue":t=>((e,t)=>{const n=l.value.find(t=>t.itemId===e);n&&(n.isVirtual="virtual"===t)})(e.itemId,t),mandatory:"",density:"compact",color:"primary"},{default:K(()=>[y(lx,{value:"real",size:"small"},{default:K(()=>[y(GC,{icon:"mdi-check",class:"mr-1"}),n[4]||(n[4]=H(" 実 ",-1))]),_:1,__:[4]}),y(lx,{value:"virtual",size:"small"},{default:K(()=>[y(GC,{icon:"mdi-clipboard-text-outline",class:"mr-1"}),n[5]||(n[5]=H(" 予定 ",-1))]),_:1,__:[5]})]),_:2},1032,["model-value","onUpdate:modelValue"]),e.isVirtual?X("",!0):(G(),W(bN,{key:0,modelValue:e.willRemove,"onUpdate:modelValue":t=>e.willRemove=t,label:"外す予定",density:"compact","hide-details":"",color:"warning"},null,8,["modelValue","onUpdate:modelValue"]))])]),default:K(()=>[y(Kx,null,{default:K(()=>{return[H(B((t=e.itemId,s.itemMastersMap.get(Number(t))||"不明")),1)];var t}),_:2},1024)]),_:2},1024))),128))]),_:1})])):X("",!0),u.value?(G(),W(rD,{key:2,type:"error",variant:"tonal",class:"mt-4",closable:"","onClick:close":n[1]||(n[1]=e=>u.value="")},{default:K(()=>[H(B(u.value),1)]),_:1})):X("",!0)]),_:1}),y(cD,{class:"pa-4"},{default:K(()=>[y(QD),y(lx,{onClick:b,variant:"outlined",color:"secondary"},{default:K(()=>n[6]||(n[6]=[H(" キャンセル ",-1)])),_:1,__:[6]}),y(lx,{onClick:w,variant:"elevated",color:"primary",loading:c.value},{default:K(()=>n[7]||(n[7]=[H(" 保存 ",-1)])),_:1,__:[7]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},[["__scopeId","data-v-6b47b519"]]),tP=e=>{const t=String(e);if(t.includes(",")||t.includes('"')||t.includes("\n")){return`"${t.replace(/"/g,'""')}"`}return t},nP=new Map([[1,"同族・加撃"],[2,"同族・加撃速"],[3,"同族・加命撃"],[4,"同族・加速"],[5,"同族・加命"],[6,"同族・加速命"],[7,"撃種・加撃"],[8,"撃種・加撃速"],[9,"撃種・加命撃"],[10,"撃種・加速"],[11,"撃種・加命"],[12,"撃種・加速命"],[13,"戦型・加撃"],[14,"戦型・加撃速"],[15,"戦型・加命撃"],[16,"戦型・加速"],[17,"戦型・加命"],[18,"戦型・加速命"],[19,"熱き友撃"],[20,"ケガ減り"],[21,"将命削り"],[22,"兵命削り"],[23,"一撃失心"],[24,"速必殺"],[25,"毒がまん"],[26,"ちび癒し"],[27,"ハート"],[28,"学び"],[29,"荒稼ぎ"],[30,"スピクリ"],[31,"Sランク"],[32,"スコア稼ぎ"]]),rP=e=>{const{characterMasters:t,ownedCharacters:n,accountName:r,itemMastersMap:i}=e,s=new Map;t.forEach(e=>{s.set(e.id,e)});const a=[];a.push("図鑑No,名前,属性,種類,アカウント,わくわく1,わくわく2,わくわく3");const o=[...n].sort((e,t)=>{const n=s.get(e.characterMasterId),r=s.get(t.characterMasterId);if(!n)return 1;if(!r)return-1;return(n.indexNumber??Number.MAX_SAFE_INTEGER)-(r.indexNumber??Number.MAX_SAFE_INTEGER)});return o.forEach(e=>{const t=s.get(e.characterMasterId);if(!t)return;const n=e.items.filter(e=>!e.isVirtual).slice(0,3).map(e=>((e,t)=>{const n="string"==typeof e?parseInt(e,10):e;return nP.get(n)||t&&t.get(n)||`アイテム${e}`})(e.itemId,i));for(;n.length<3;)n.push("");const o=(e=>e.startsWith("アカウント")?e.substring(5):e)(e.accountName||r),l=[void 0!==t.indexNumber?t.indexNumber:"",(u=t.monsterName||t.name,`"${u.replace(/"/g,'""')}"`),t.element||"",t.type||"",tP(o),tP(n[0]),tP(n[1]),tP(n[2])].join(",");var u;a.push(l)}),"\ufeff"+a.join("\n")};const iP=oe({activeColor:String,start:{type:[Number,String],default:1},modelValue:{type:Number,default:e=>e.start},disabled:Boolean,length:{type:[Number,String],default:1,validator:e=>e%1==0},totalVisible:[Number,String],firstIcon:{type:Ie,default:"$first"},prevIcon:{type:Ie,default:"$prev"},nextIcon:{type:Ie,default:"$next"},lastIcon:{type:Ie,default:"$last"},ariaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.root"},pageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.page"},currentPageAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.currentPage"},firstAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.first"},previousAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.previous"},nextAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.next"},lastAriaLabel:{type:String,default:"$vuetify.pagination.ariaLabel.last"},ellipsis:{type:String,default:"..."},showFirstLastPage:Boolean,...iE(),..._e(),...oE(),...mE(),...YC(),...$C(),...zC({tag:"nav"}),...we(),...dE({variant:"text"})},"VPagination"),sP=ae()({name:"VPagination",props:iP(),emits:{"update:modelValue":e=>!0,first:e=>!0,prev:e=>!0,next:e=>!0,last:e=>!0},setup(e,n){let{slots:r,emit:i}=n;const s=Ae(e,"modelValue"),{t:a,n:o}=kt(),{isRtl:l}=Oe(),{themeClasses:u}=xe(e),{width:c}=gt(),d=v(-1);le(void 0,{scoped:!0});const{resizeRef:p}=Re(e=>{if(!e.length)return;const{target:t,contentRect:n}=e[0],r=t.querySelector(".v-pagination__list > *");if(!r)return;const i=n.width,s=r.offsetWidth+2*parseFloat(getComputedStyle(r).marginRight);d.value=S(i,s)}),m=f(()=>parseInt(e.length,10)),g=f(()=>parseInt(e.start,10)),I=f(()=>null!=e.totalVisible?parseInt(e.totalVisible,10):d.value>=0?d.value:S(c.value,58));function S(t,n){const r=e.showFirstLastPage?5:3;return Math.max(0,Math.floor(Number(((t-n*r)/n).toFixed(2))))}const T=f(()=>{if(m.value<=0||isNaN(m.value)||m.value>Number.MAX_SAFE_INTEGER)return[];if(I.value<=0)return[];if(1===I.value)return[s.value];if(m.value<=I.value)return Vt(m.value,g.value);const t=I.value%2==0,n=t?I.value/2:Math.floor(I.value/2),r=t?n:n+1,i=m.value-n;if(r-s.value>=0)return[...Vt(Math.max(1,I.value-1),g.value),e.ellipsis,m.value];if(s.value-i>=(t?1:0)){const t=I.value-1,n=m.value-t+g.value;return[g.value,e.ellipsis,...Vt(t,n)]}{const t=Math.max(1,I.value-2),n=1===t?s.value:s.value-Math.ceil(t/2)+g.value;return[g.value,e.ellipsis,...Vt(t,n),e.ellipsis,m.value]}});function C(e,t,n){e.preventDefault(),s.value=t,n&&i(n,t)}const{refs:E,updateRef:A}=function(){const e=t([]);return Z(()=>e.value=[]),{refs:e,updateRef:function(t,n){e.value[n]=t}}}();le({VPaginationBtn:{color:x(()=>e.color),border:x(()=>e.border),density:x(()=>e.density),size:x(()=>e.size),variant:x(()=>e.variant),rounded:x(()=>e.rounded),elevation:x(()=>e.elevation)}});const N=f(()=>T.value.map((t,n)=>{const r=e=>A(e,n);if("string"==typeof t)return{isActive:!1,key:`ellipsis-${n}`,page:t,props:{ref:r,ellipsis:!0,icon:!0,disabled:!0}};{const n=t===s.value;return{isActive:n,key:t,page:o(t),props:{ref:r,ellipsis:!1,icon:!0,disabled:!!e.disabled||Number(e.length)<2,color:n?e.activeColor:e.color,"aria-current":n,"aria-label":a(n?e.currentPageAriaLabel:e.pageAriaLabel,t),onClick:e=>C(e,t)}}}})),D=f(()=>{const t=!!e.disabled||s.value<=g.value,n=!!e.disabled||s.value>=g.value+m.value-1;return{first:e.showFirstLastPage?{icon:l.value?e.lastIcon:e.firstIcon,onClick:e=>C(e,g.value,"first"),disabled:t,"aria-label":a(e.firstAriaLabel),"aria-disabled":t}:void 0,prev:{icon:l.value?e.nextIcon:e.prevIcon,onClick:e=>C(e,s.value-1,"prev"),disabled:t,"aria-label":a(e.previousAriaLabel),"aria-disabled":t},next:{icon:l.value?e.prevIcon:e.nextIcon,onClick:e=>C(e,s.value+1,"next"),disabled:n,"aria-label":a(e.nextAriaLabel),"aria-disabled":n},last:e.showFirstLastPage?{icon:l.value?e.firstIcon:e.lastIcon,onClick:e=>C(e,g.value+m.value-1,"last"),disabled:n,"aria-label":a(e.lastAriaLabel),"aria-disabled":n}:void 0}});function P(){var e;const t=s.value-g.value;null==(e=E.value[t])||e.$el.focus()}function R(t){t.key===Ot.left&&!e.disabled&&s.value>Number(e.start)?(s.value=s.value-1,h(P)):t.key===Ot.right&&!e.disabled&&s.value<g.value+m.value-1&&(s.value=s.value+1,h(P))}return be(()=>y(e.tag,{ref:p,class:w(["v-pagination",u.value,e.class]),style:b(e.style),role:"navigation","aria-label":a(e.ariaLabel),onKeydown:R,"data-test":"v-pagination-root"},{default:()=>[_("ul",{class:"v-pagination__list"},[e.showFirstLastPage&&_("li",{key:"first",class:"v-pagination__first","data-test":"v-pagination-first"},[r.first?r.first(D.value.first):y(lx,k({_as:"VPaginationBtn"},D.value.first),null)]),_("li",{key:"prev",class:"v-pagination__prev","data-test":"v-pagination-prev"},[r.prev?r.prev(D.value.prev):y(lx,k({_as:"VPaginationBtn"},D.value.prev),null)]),N.value.map((e,t)=>_("li",{key:e.key,class:w(["v-pagination__item",{"v-pagination__item--is-active":e.isActive}]),"data-test":"v-pagination-item"},[r.item?r.item(e):y(lx,k({_as:"VPaginationBtn"},e.props),{default:()=>[e.page]})])),_("li",{key:"next",class:"v-pagination__next","data-test":"v-pagination-next"},[r.next?r.next(D.value.next):y(lx,k({_as:"VPaginationBtn"},D.value.next),null)]),e.showFirstLastPage&&_("li",{key:"last",class:"v-pagination__last","data-test":"v-pagination-last"},[r.last?r.last(D.value.last):y(lx,k({_as:"VPaginationBtn"},D.value.last),null)])])]})),{}}}),aP=oe({page:{type:[Number,String],default:1},itemsPerPage:{type:[Number,String],default:10}},"DataTable-paginate"),oP=Symbol.for("vuetify:data-table-pagination");const lP=oe({prevIcon:{type:Ie,default:"$prev"},nextIcon:{type:Ie,default:"$next"},firstIcon:{type:Ie,default:"$first"},lastIcon:{type:Ie,default:"$last"},itemsPerPageText:{type:String,default:"$vuetify.dataFooter.itemsPerPageText"},pageText:{type:String,default:"$vuetify.dataFooter.pageText"},firstPageLabel:{type:String,default:"$vuetify.dataFooter.firstPage"},prevPageLabel:{type:String,default:"$vuetify.dataFooter.prevPage"},nextPageLabel:{type:String,default:"$vuetify.dataFooter.nextPage"},lastPageLabel:{type:String,default:"$vuetify.dataFooter.lastPage"},itemsPerPageOptions:{type:Array,default:()=>[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:-1,title:"$vuetify.dataFooter.itemsPerPageAll"}]},showCurrentPage:Boolean},"VDataTableFooter"),uP=ae()({name:"VDataTableFooter",props:lP(),setup(e,t){let{slots:n}=t;const{t:i}=kt(),{page:s,pageCount:a,startIndex:o,stopIndex:l,itemsLength:u,itemsPerPage:c,setItemsPerPage:d}=function(){const e=r(oP);if(!e)throw new Error("Missing pagination!");return e}(),h=f(()=>e.itemsPerPageOptions.map(e=>"number"==typeof e?{value:e,title:-1===e?i("$vuetify.dataFooter.itemsPerPageAll"):String(e)}:{...e,title:isNaN(Number(e.title))?i(e.title):e.title}));return be(()=>{var t;const r=sP.filterProps(e);return _("div",{class:"v-data-table-footer"},[null==(t=n.prepend)?void 0:t.call(n),_("div",{class:"v-data-table-footer__items-per-page"},[_("span",{"aria-label":i(e.itemsPerPageText)},[i(e.itemsPerPageText)]),y(YN,{items:h.value,modelValue:c.value,"onUpdate:modelValue":e=>d(Number(e)),density:"compact",variant:"outlined",hideDetails:!0},null)]),_("div",{class:"v-data-table-footer__info"},[_("div",null,[i(e.pageText,u.value?o.value+1:0,l.value,u.value)])]),_("div",{class:"v-data-table-footer__pagination"},[y(sP,k({modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,density:"comfortable",firstAriaLabel:e.firstPageLabel,lastAriaLabel:e.lastPageLabel,length:a.value,nextAriaLabel:e.nextPageLabel,previousAriaLabel:e.prevPageLabel,rounded:!0,showFirstLastPage:!0,totalVisible:e.showCurrentPage?1:0,variant:"plain"},r),null)])])}),{}}}),cP=Mt({align:{type:String,default:"start"},fixed:{type:[Boolean,String],default:!1},fixedOffset:[Number,String],fixedEndOffset:[Number,String],height:[Number,String],lastFixed:Boolean,firstFixedEnd:Boolean,noPadding:Boolean,tag:String,width:[Number,String],maxWidth:[Number,String],nowrap:Boolean},(e,t)=>{let{slots:n}=t;const r=e.tag??"td",i="string"==typeof e.fixed?e.fixed:e.fixed?"start":"none";return y(r,{class:w(["v-data-table__td",{"v-data-table-column--fixed":"start"===i,"v-data-table-column--fixed-end":"end"===i,"v-data-table-column--last-fixed":e.lastFixed,"v-data-table-column--first-fixed-end":e.firstFixedEnd,"v-data-table-column--no-padding":e.noPadding,"v-data-table-column--nowrap":e.nowrap},`v-data-table-column--align-${e.align}`]),style:{height:ve(e.height),width:ve(e.width),maxWidth:ve(e.maxWidth),left:"start"===i?ve(e.fixedOffset||null):void 0,right:"end"===i?ve(e.fixedEndOffset||null):void 0}},{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n)]}})}),dP=oe({headers:Array},"DataTable-header"),hP=Symbol.for("vuetify:data-table-headers"),pP={title:"",sortable:!1},fP={...pP,width:48};function mP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.children)for(const n of e.children)mP(n,t);else t.push(e);return t}function vP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;for(const n of e)n.key&&t.add(n.key),n.children&&vP(n.children,t);return t}function gP(e){if(e.key)return"data-table-group"===e.key?pP:["data-table-expand","data-table-select"].includes(e.key)?fP:void 0}function yP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.children?Math.max(t,...e.children.map(e=>yP(e,t+1))):t}function bP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;if(e.children){e.fixedOffset=t;for(const n of e.children)t=bP(n,t)}else e.fixed&&"end"!==e.fixed&&(e.fixedOffset=t,t+=parseFloat(e.width||"0")||0);return t}function wP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;if(e.children){e.fixedEndOffset=t;for(const n of e.children)t=wP(n,t)}else"end"===e.fixed&&(e.fixedEndOffset=t,t+=parseFloat(e.width||"0")||0);return t}function _P(e,t){const n=[];let r=0;const i=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(e=>({element:e,priority:0}));return{enqueue:(t,n)=>{let r=!1;for(let i=0;i<e.length;i++)if(e[i].priority>n){e.splice(i,0,{element:t,priority:n}),r=!0;break}r||e.push({element:t,priority:n})},size:()=>e.length,count:()=>{let t=0;if(!e.length)return 0;const n=Math.floor(e[0].priority);for(let r=0;r<e.length;r++)Math.floor(e[r].priority)===n&&(t+=1);return t},dequeue:()=>e.shift()}}(e);for(;i.size()>0;){let e=i.count();const s=[];let a=1;for(;e>0;){const{element:n,priority:o}=i.dequeue(),l=t-r-yP(n);if(s.push({...n,rowspan:l??1,colspan:n.children?mP(n).length:1}),n.children)for(const e of n.children){const t=o%1+a/Math.pow(10,r+2);i.enqueue(e,r+l+t)}a+=1,e-=1}r+=1,n.push(s)}return{columns:e.map(e=>mP(e)).flat(),headers:n}}function IP(e){const t=[];for(const n of e){const e={...gP(n),...n},r=e.key??("string"==typeof e.value?e.value:null),i=e.value??r??null,s={...e,key:r,value:i,sortable:e.sortable??(null!=e.key||!!e.sort),children:e.children?IP(e.children):void 0};t.push(s)}return t}function SP(e,n){const r=t([]),i=t([]),s=t({}),a=t({}),o=t({});L(()=>{var t,l,u;const c=(e.headers||Object.keys(e.items[0]??{}).map(e=>({key:e,title:Y(e)}))).slice(),d=vP(c);(null==(t=null==n?void 0:n.groupBy)?void 0:t.value.length)&&!d.has("data-table-group")&&c.unshift({key:"data-table-group",title:"Group"}),(null==(l=null==n?void 0:n.showSelect)?void 0:l.value)&&!d.has("data-table-select")&&c.unshift({key:"data-table-select"}),(null==(u=null==n?void 0:n.showExpand)?void 0:u.value)&&!d.has("data-table-expand")&&c.push({key:"data-table-expand"});const h=IP(c);!function(e){let t=!1;function n(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none";if(e)if("none"!==i&&(e.fixed=i),!0===e.fixed&&(e.fixed="start"),e.fixed===r)if(e.children)if("start"===r)for(let t=e.children.length-1;t>=0;t--)n(e.children[t],r,r);else for(let t=0;t<e.children.length;t++)n(e.children[t],r,r);else t||"start"!==r?t||"end"!==r?isNaN(Number(e.width))?Lt(`Multiple fixed columns should have a static width (key: ${e.key})`):e.minWidth=Math.max(Number(e.width)||0,Number(e.minWidth)||0):e.firstFixedEnd=!0:e.lastFixed=!0,t=!0;else if(e.children)if("start"===r)for(let t=e.children.length-1;t>=0;t--)n(e.children[t],r);else for(let t=0;t<e.children.length;t++)n(e.children[t],r);else t=!1}for(let s=e.length-1;s>=0;s--)n(e[s],"start");for(let s=0;s<e.length;s++)n(e[s],"end");let r=0;for(let s=0;s<e.length;s++)r=bP(e[s],r);let i=0;for(let s=e.length-1;s>=0;s--)i=wP(e[s],i)}(h);const p=Math.max(...h.map(e=>yP(e)))+1,f=_P(h,p);r.value=f.headers,i.value=f.columns;const m=f.headers.flat(1);for(const e of m)e.key&&(e.sortable&&(e.sort&&(s.value[e.key]=e.sort),e.sortRaw&&(a.value[e.key]=e.sortRaw)),e.filter&&(o.value[e.key]=e.filter))});const l={headers:r,columns:i,sortFunctions:s,sortRawFunctions:a,filterFunctions:o};return O(hP,l),l}function kP(){const e=r(hP);if(!e)throw new Error("Missing headers!");return e}const TP={showSelectAll:!1,allSelected:()=>[],select:e=>{var t;let{items:n,value:r}=e;return new Set(r?[null==(t=n[0])?void 0:t.value]:[])},selectAll:e=>{let{selected:t}=e;return t}},CP={showSelectAll:!0,allSelected:e=>{let{currentPage:t}=e;return t},select:e=>{let{items:t,value:n,selected:r}=e;for(const i of t)n?r.add(i.value):r.delete(i.value);return r},selectAll:e=>{let{value:t,currentPage:n,selected:r}=e;return CP.select({items:n,value:t,selected:r})}},EP={showSelectAll:!0,allSelected:e=>{let{allItems:t}=e;return t},select:e=>{let{items:t,value:n,selected:r}=e;for(const i of t)n?r.add(i.value):r.delete(i.value);return r},selectAll:e=>{let{value:t,allItems:n,selected:r}=e;return EP.select({items:n,value:t,selected:r})}},xP=oe({showSelect:Boolean,selectStrategy:{type:[String,Object],default:"page"},modelValue:{type:Array,default:()=>[]},valueComparator:{type:Function,default:Ne}},"DataTable-select"),AP=Symbol.for("vuetify:data-table-selection");function NP(e,t){let{allItems:n,currentPage:r}=t;const i=Ae(e,"modelValue",e.modelValue,t=>new Set(De(t).map(t=>{var r;return(null==(r=n.value.find(n=>e.valueComparator(t,n.value)))?void 0:r.value)??t})),e=>[...e.values()]),s=f(()=>n.value.filter(e=>e.selectable)),a=f(()=>r.value.filter(e=>e.selectable)),o=f(()=>{if("object"==typeof e.selectStrategy)return e.selectStrategy;switch(e.selectStrategy){case"single":return TP;case"all":return EP;default:return CP}}),l=v(null);function u(e){return De(e).every(e=>i.value.has(e.value))}function c(e,t){const n=o.value.select({items:e,value:t,selected:new Set(i.value)});i.value=n}const d=f(()=>i.value.size>0),h=f(()=>{const e=o.value.allSelected({allItems:s.value,currentPage:a.value});return!!e.length&&u(e)}),p={toggleSelect:function(t,n,i){const s=[];if(n=n??r.value.findIndex(e=>e.value===t.value),"single"!==e.selectStrategy&&(null==i?void 0:i.shiftKey)&&null!==l.value){const[e,t]=[l.value,n].sort((e,t)=>e-t);s.push(...r.value.slice(e,t+1).filter(e=>e.selectable))}else s.push(t),l.value=n;c(s,!u([t]))},select:c,selectAll:function(e){const t=o.value.selectAll({value:e,allItems:s.value,currentPage:a.value,selected:new Set(i.value)});i.value=t},isSelected:u,isSomeSelected:function(e){return De(e).some(e=>i.value.has(e.value))},someSelected:d,allSelected:h,showSelectAll:x(()=>o.value.showSelectAll),lastSelectedIndex:l,selectStrategy:o};return O(AP,p),p}function DP(){const e=r(AP);if(!e)throw new Error("Missing selection!");return e}const PP=oe({sortBy:{type:Array,default:()=>[]},customKeySort:Object,multiSort:Boolean,mustSort:Boolean},"DataTable-sort"),RP=Symbol.for("vuetify:data-table-sort");function VP(e){return{sortBy:Ae(e,"sortBy"),mustSort:x(()=>e.mustSort),multiSort:x(()=>e.multiSort)}}function OP(e){const{sortBy:t,mustSort:n,multiSort:r,page:i}=e;const s={sortBy:t,toggleSort:e=>{if(null==e.key)return;let s=t.value.map(e=>({...e}))??[];const a=s.find(t=>t.key===e.key);a?"desc"===a.order?n.value&&1===s.length?a.order="asc":s=s.filter(t=>t.key!==e.key):a.order="desc":r.value?s.push({key:e.key,order:"asc"}):s=[{key:e.key,order:"asc"}],t.value=s,i&&(i.value=1)},isSorted:function(e){return!!t.value.find(t=>t.key===e.key)}};return O(RP,s),s}function MP(){const e=r(RP);if(!e)throw new Error("Missing sort!");return e}function LP(e,t,n,r){const i=kt(),s=f(()=>{var s,a;return n.value.length?function(e,t,n,r){const i=new Intl.Collator(n,{sensitivity:"accent",usage:"sort"}),s=e.map(e=>[e,(null==r?void 0:r.transform)?r.transform(e):e]);return s.sort((e,n)=>{var s,a;for(let o=0;o<t.length;o++){let l=!1;const u=t[o].key,c=t[o].order??"asc";if(!1===c)continue;let d=Ft(e[1],u),h=Ft(n[1],u),p=e[0].raw,f=n[0].raw;if("desc"===c&&([d,h]=[h,d],[p,f]=[f,p]),null==(s=null==r?void 0:r.sortRawFunctions)?void 0:s[u]){const e=r.sortRawFunctions[u](p,f);if(null==e)continue;if(l=!0,e)return e}if(null==(a=null==r?void 0:r.sortFunctions)?void 0:a[u]){const e=r.sortFunctions[u](d,h);if(null==e)continue;if(l=!0,e)return e}if(!l&&(d instanceof Date&&h instanceof Date&&(d=d.getTime(),h=h.getTime()),[d,h]=[d,h].map(e=>null!=e?e.toString().toLocaleLowerCase():e),d!==h))return Bt(d)&&Bt(h)?0:Bt(d)?-1:Bt(h)?1:isNaN(d)||isNaN(h)?i.compare(d,h):Number(d)-Number(h)}return 0}).map(e=>{let[t]=e;return t})}(t.value,n.value,i.current.value,{transform:null==r?void 0:r.transform,sortFunctions:{...e.customKeySort,...null==(s=null==r?void 0:r.sortFunctions)?void 0:s.value},sortRawFunctions:null==(a=null==r?void 0:r.sortRawFunctions)?void 0:a.value}):t.value});return{sortedItems:s}}const FP=oe({color:String,disableSort:Boolean,fixedHeader:Boolean,multiSort:Boolean,sortAscIcon:{type:Ie,default:"$sortAsc"},sortDescIcon:{type:Ie,default:"$sortDesc"},headerProps:{type:Object},sticky:Boolean,...Ct(),...OE()},"VDataTableHeaders"),BP=ae()({name:"VDataTableHeaders",props:FP(),setup(e,t){let{slots:n}=t;const{t:r}=kt(),{toggleSort:i,sortBy:s,isSorted:a}=MP(),{someSelected:o,allSelected:l,selectAll:u,showSelectAll:c}=DP(),{columns:d,headers:h}=kP(),{loaderClasses:p}=ME(e);function m(t,n){if(!e.sticky&&!e.fixedHeader&&!t.fixed)return;const r="string"==typeof t.fixed?t.fixed:t.fixed?"start":"none";return{position:"sticky",left:"start"===r?ve(t.fixedOffset):void 0,right:"end"===r?ve(t.fixedEndOffset):void 0,top:e.sticky||e.fixedHeader?`calc(var(--v-table-header-height) * ${n})`:void 0}}function v(t){const n=s.value.find(e=>e.key===t.key);return n?"asc"===n.order?e.sortAscIcon:e.sortDescIcon:e.sortAscIcon}const{backgroundColorClasses:g,backgroundColorStyles:I}=BC(()=>e.color),{displayClasses:S,mobile:T}=gt(e),C=f(()=>({headers:h.value,columns:d.value,toggleSort:i,isSorted:a,sortBy:s.value,someSelected:o.value,allSelected:l.value,selectAll:u,getSortIcon:v})),E=f(()=>["v-data-table__th",{"v-data-table__th--sticky":e.sticky||e.fixedHeader},S.value,p.value]),x=t=>{let{column:r,x:d,y:h}=t;const p="data-table-select"===r.key||"data-table-expand"===r.key,f=k(e.headerProps??{},r.headerProps??{});return y(cP,k({tag:"th",align:r.align,class:[{"v-data-table__th--sortable":r.sortable&&!e.disableSort,"v-data-table__th--sorted":a(r),"v-data-table__th--fixed":r.fixed},...E.value],style:{width:ve(r.width),minWidth:ve(r.minWidth),maxWidth:ve(r.maxWidth),...m(r,h)},colspan:r.colspan,rowspan:r.rowspan,fixed:r.fixed,nowrap:r.nowrap,lastFixed:r.lastFixed,firstFixedEnd:r.firstFixedEnd,noPadding:p,tabindex:r.sortable?0:void 0,onClick:r.sortable?()=>i(r):void 0,onKeydown:r.sortable?t=>function(t,n){"Enter"!==t.key||e.disableSort||i(n)}(t,r):void 0},f),{default:()=>{var t;const d=`header.${r.key}`,h={column:r,selectAll:u,isSorted:a,toggleSort:i,sortBy:s.value,someSelected:o.value,allSelected:l.value,getSortIcon:v};return n[d]?n[d](h):"data-table-select"===r.key?(null==(t=n["header.data-table-select"])?void 0:t.call(n,h))??(c.value&&y(iN,{modelValue:l.value,indeterminate:o.value&&!l.value,"onUpdate:modelValue":u},null)):_("div",{class:"v-data-table-header__content"},[_("span",null,[r.title]),r.sortable&&!e.disableSort&&y(GC,{key:"icon",class:"v-data-table-header__sort-icon",icon:v(r)},null),e.multiSort&&a(r)&&_("div",{key:"badge",class:w(["v-data-table-header__sort-badge",...g.value]),style:b(I.value)},[s.value.findIndex(e=>e.key===r.key)+1])])}})},A=()=>{const t=f(()=>d.value.filter(t=>(null==t?void 0:t.sortable)&&!e.disableSort)),n=f(()=>{if(null!=d.value.find(e=>"data-table-select"===e.key))return l.value?"$checkboxOn":o.value?"$checkboxIndeterminate":"$checkboxOff"});return y(cP,k({tag:"th",class:[...E.value],colspan:h.value.length+1},e.headerProps),{default:()=>[_("div",{class:"v-data-table-header__content"},[y(YN,{chips:!0,class:"v-data-table__td-sort-select",clearable:!0,density:"default",items:t.value,label:r("$vuetify.dataTable.sortBy"),multiple:e.multiSort,variant:"underlined","onClick:clear":()=>s.value=[],appendIcon:n.value,"onClick:append":()=>u(!l.value)},{chip:e=>{var t;return y(NN,{onClick:(null==(t=e.item.raw)?void 0:t.sortable)?()=>i(e.item.raw):void 0,onMousedown:e=>{e.preventDefault(),e.stopPropagation()}},{default:()=>[e.item.title,y(GC,{class:w(["v-data-table__td-sort-icon",a(e.item.raw)&&"v-data-table__td-sort-icon-active"]),icon:v(e.item.raw),size:"small"},null)]})}})])]})};be(()=>T.value?_("tr",null,[y(A,null,null)]):_(N,null,[n.headers?n.headers(C.value):h.value.map((e,t)=>_("tr",null,[e.map((e,n)=>y(x,{column:e,x:n,y:t},null))])),e.loading&&_("tr",{class:"v-data-table-progress"},[_("th",{colspan:d.value.length},[y(LE,{name:"v-data-table-progress",absolute:!0,active:!0,color:"boolean"==typeof e.loading?void 0:e.loading,indeterminate:!0},{default:n.loader})])])]))}}),UP=oe({groupBy:{type:Array,default:()=>[]}},"DataTable-group"),$P=Symbol.for("vuetify:data-table-group");function jP(e){return{groupBy:Ae(e,"groupBy")}}function zP(e){const{disableSort:n,groupBy:r,sortBy:i}=e,s=t(new Set);function a(e){return s.value.has(e.id)}const o={sortByWithGroups:f(()=>r.value.map(e=>({...e,order:e.order??!1})).concat((null==n?void 0:n.value)?[]:i.value)),toggleGroup:function(e){const t=new Set(s.value);a(e)?t.delete(e.id):t.add(e.id),s.value=t},opened:s,groupBy:r,extractRows:function(e){return function e(t){const n=[];for(const r of t.items)"type"in r&&"group"===r.type?n.push(...e(r)):n.push(r);return[...new Set(n)]}({items:e})},isGroupOpen:a};return O($P,o),o}function qP(){const e=r($P);if(!e)throw new Error("Missing group!");return e}function GP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"root";if(!t.length)return[];const i=function(e,t){if(!e.length)return[];const n=new Map;for(const r of e){const e=Ft(r.raw,t);n.has(e)||n.set(e,[]),n.get(e).push(r)}return n}(e,t[0]),s=[],a=t.slice(1);return i.forEach((e,i)=>{const o=t[0],l=`${r}_${o}_${i}`;s.push({depth:n,id:l,key:o,value:i,items:a.length?GP(e,a,n+1,l):e,type:"group"})}),s}function KP(e,t){const n=[];for(const r of e)"type"in r&&"group"===r.type?(null!=r.value&&n.push(r),(t.has(r.id)||null==r.value)&&n.push(...KP(r.items,t))):n.push(r);return n}function HP(e,t,n){return{flatItems:f(()=>{if(!t.value.length)return e.value;return KP(GP(e.value,t.value.map(e=>e.key)),n.value)})}}const WP=oe({item:{type:Object,required:!0}},"VDataTableGroupHeaderRow"),QP=ae()({name:"VDataTableGroupHeaderRow",props:WP(),setup(e,t){let{slots:n}=t;const{isGroupOpen:r,toggleGroup:i,extractRows:s}=qP(),{isSelected:a,isSomeSelected:o,select:l}=DP(),{columns:u}=kP(),c=f(()=>s([e.item]));return()=>_("tr",{class:"v-data-table-group-header-row",style:{"--v-data-table-group-header-row-depth":e.item.depth}},[u.value.map(t=>{var s,u;if("data-table-group"===t.key){const t=r(e.item)?"$expand":"$next",a=()=>i(e.item);return(null==(s=n["data-table-group"])?void 0:s.call(n,{item:e.item,count:c.value.length,props:{icon:t,onClick:a}}))??y(cP,{class:"v-data-table-group-header-row__column"},{default:()=>[y(lx,{size:"small",variant:"text",icon:t,onClick:a},null),_("span",null,[e.item.value]),_("span",null,[H("("),c.value.length,H(")")])]})}if("data-table-select"===t.key){const e=a(c.value),t=o(c.value)&&!e,r=e=>l(c.value,e);return(null==(u=n["data-table-select"])?void 0:u.call(n,{props:{modelValue:e,indeterminate:t,"onUpdate:modelValue":r}}))??_("td",null,[y(iN,{modelValue:e,indeterminate:t,"onUpdate:modelValue":r},null)])}return _("td",null,null)})])}}),YP=oe({expandOnClick:Boolean,showExpand:Boolean,expanded:{type:Array,default:()=>[]}},"DataTable-expand"),XP=Symbol.for("vuetify:datatable:expanded");function JP(e){const t=x(()=>e.expandOnClick),n=Ae(e,"expanded",e.expanded,e=>new Set(e),e=>[...e.values()]);function r(e,t){const r=new Set(n.value);t?r.add(e.value):r.delete(e.value),n.value=r}function i(e){return n.value.has(e.value)}const s={expand:r,expanded:n,expandOnClick:t,isExpanded:i,toggleExpand:function(e){r(e,!i(e))}};return O(XP,s),s}function ZP(){const e=r(XP);if(!e)throw new Error("foo");return e}const eR=oe({index:Number,item:Object,cellProps:[Object,Function],onClick:We(),onContextmenu:We(),onDblclick:We(),...Ct()},"VDataTableRow"),tR=ae()({name:"VDataTableRow",props:eR(),setup(e,t){let{slots:n}=t;const{displayClasses:r,mobile:i}=gt(e,"v-data-table__tr"),{isSelected:s,toggleSelect:a,someSelected:o,allSelected:l,selectAll:u}=DP(),{isExpanded:c,toggleExpand:d}=ZP(),{toggleSort:h,sortBy:p,isSorted:f}=MP(),{columns:m}=kP();be(()=>_("tr",{class:w(["v-data-table__tr",{"v-data-table__tr--clickable":!!(e.onClick||e.onContextmenu||e.onDblclick)},r.value]),onClick:e.onClick,onContextmenu:e.onContextmenu,onDblclick:e.onDblclick},[e.item&&m.value.map((t,r)=>{const m=e.item,v=`item.${t.key}`,g=`header.${t.key}`,b={index:e.index,item:m.raw,internalItem:m,value:Ft(m.columns,t.key),column:t,isSelected:s,toggleSelect:a,isExpanded:c,toggleExpand:d},w={column:t,selectAll:u,isSorted:f,toggleSort:h,sortBy:p.value,someSelected:o.value,allSelected:l.value,getSortIcon:()=>""},I="function"==typeof e.cellProps?e.cellProps({index:b.index,item:b.item,internalItem:b.internalItem,value:b.value,column:t}):e.cellProps,S="function"==typeof t.cellProps?t.cellProps({index:b.index,item:b.item,internalItem:b.internalItem,value:b.value}):t.cellProps;return y(cP,k({align:t.align,class:{"v-data-table__td--expanded-row":"data-table-expand"===t.key,"v-data-table__td--select-row":"data-table-select"===t.key},fixed:t.fixed,fixedOffset:t.fixedOffset,fixedEndOffset:t.fixedEndOffset,lastFixed:t.lastFixed,firstFixedEnd:t.firstFixedEnd,maxWidth:i.value?void 0:t.maxWidth,noPadding:"data-table-select"===t.key||"data-table-expand"===t.key,nowrap:t.nowrap,width:i.value?void 0:t.width},I,S),{default:()=>{var r,o,l,u;if("data-table-select"===t.key)return(null==(r=n["item.data-table-select"])?void 0:r.call(n,{...b,props:{disabled:!m.selectable,modelValue:s([m]),onClick:ee(()=>a(m),["stop"])}}))??y(iN,{disabled:!m.selectable,modelValue:s([m]),onClick:ee(t=>a(m,e.index,t),["stop"])},null);if("data-table-expand"===t.key)return(null==(o=n["item.data-table-expand"])?void 0:o.call(n,{...b,props:{icon:c(m)?"$collapse":"$expand",size:"small",variant:"text",onClick:ee(()=>d(m),["stop"])}}))??y(lx,{icon:c(m)?"$collapse":"$expand",size:"small",variant:"text",onClick:ee(()=>d(m),["stop"])},null);if(n[v]&&!i.value)return n[v](b);const h=B(b.value);return i.value?_(N,null,[_("div",{class:"v-data-table__td-title"},[(null==(l=n[g])?void 0:l.call(n,w))??t.title]),_("div",{class:"v-data-table__td-value"},[(null==(u=n[v])?void 0:u.call(n,b))??h])]):h}})})]))}}),nR=oe({loading:[Boolean,String],loadingText:{type:String,default:"$vuetify.dataIterator.loadingText"},hideNoData:Boolean,items:{type:Array,default:()=>[]},noDataText:{type:String,default:"$vuetify.noDataText"},rowProps:[Object,Function],cellProps:[Object,Function],...Ct()},"VDataTableRows"),rR=ae()({name:"VDataTableRows",inheritAttrs:!1,props:nR(),setup(e,t){let{attrs:n,slots:r}=t;const{columns:i}=kP(),{expandOnClick:s,toggleExpand:a,isExpanded:o}=ZP(),{isSelected:l,toggleSelect:u}=DP(),{toggleGroup:c,isGroupOpen:d}=qP(),{t:h}=kt(),{mobile:p}=gt(e);return be(()=>{var t,f;return!e.loading||e.items.length&&!r.loading?e.loading||e.items.length||e.hideNoData?_(N,null,[e.items.map((t,h)=>{var f;if("group"===t.type){const e={index:h,item:t,columns:i.value,isExpanded:o,toggleExpand:a,isSelected:l,toggleSelect:u,toggleGroup:c,isGroupOpen:d};return r["group-header"]?r["group-header"](e):y(QP,k({key:`group-header_${t.id}`,item:t},Ut(n,":group-header",()=>e)),r)}const m={index:h,item:t.raw,internalItem:t,columns:i.value,isExpanded:o,toggleExpand:a,isSelected:l,toggleSelect:u},v={...m,props:k({key:`item_${t.key??t.index}`,onClick:s.value?()=>{a(t)}:void 0,index:h,item:t,cellProps:e.cellProps,mobile:p.value},Ut(n,":row",()=>m),"function"==typeof e.rowProps?e.rowProps({item:m.item,index:m.index,internalItem:m.internalItem}):e.rowProps)};return _(N,{key:v.props.key},[r.item?r.item(v):y(tR,v.props,r),o(t)&&(null==(f=r["expanded-row"])?void 0:f.call(r,m))])})]):_("tr",{class:"v-data-table-rows-no-data",key:"no-data"},[_("td",{colspan:i.value.length},[(null==(f=r["no-data"])?void 0:f.call(r))??h(e.noDataText)])]):_("tr",{class:"v-data-table-rows-loading",key:"loading"},[_("td",{colspan:i.value.length},[(null==(t=r.loading)?void 0:t.call(r))??h(e.loadingText)])])}),{}}}),iR=oe({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,striped:{type:String,default:null,validator:e=>["even","odd"].includes(e)},..._e(),...oE(),...zC(),...we()},"VTable"),sR=ae()({name:"VTable",props:iR(),setup(e,t){let{slots:n,emit:r}=t;const{themeClasses:i}=xe(e),{densityClasses:s}=lE(e);return be(()=>{const t={VCheckboxBtn:{density:e.density}};return y(e.tag,{class:w(["v-table",{"v-table--fixed-height":!!e.height,"v-table--fixed-header":e.fixedHeader,"v-table--fixed-footer":e.fixedFooter,"v-table--has-top":!!n.top,"v-table--has-bottom":!!n.bottom,"v-table--hover":e.hover,"v-table--striped-even":"even"===e.striped,"v-table--striped-odd":"odd"===e.striped},i.value,s.value,e.class]),style:b(e.style)},{default:()=>{var r,i;return[null==(r=n.top)?void 0:r.call(n),y(MC,{defaults:t},{default:()=>{var t;return[n.default?_("div",{class:"v-table__wrapper",style:{height:ve(e.height)}},[_("table",null,[n.default()])]):null==(t=n.wrapper)?void 0:t.call(n)]}}),null==(i=n.bottom)?void 0:i.call(n)]}})}),{}}}),aR=oe({items:{type:Array,default:()=>[]},itemValue:{type:[String,Array,Function],default:"id"},itemSelectable:{type:[String,Array,Function],default:null},rowProps:[Object,Function],cellProps:[Object,Function],returnObject:Boolean},"DataTable-items");function oR(e,t,n){return t.map((t,r)=>function(e,t,n,r){const i=e.returnObject?t:Xe(t,e.itemValue),s=Xe(t,e.itemSelectable,!0),a=r.reduce((e,n)=>(null!=n.key&&(e[n.key]=Xe(t,n.value)),e),{});return{type:"item",key:e.returnObject?Xe(t,e.itemValue):i,index:n,value:i,selectable:s,columns:a,raw:t}}(e,t,r,n))}function lR(e,t){return{items:f(()=>oR(e,e.items,t.value))}}function uR(e){let{page:t,itemsPerPage:n,sortBy:r,groupBy:i,search:s}=e;const a=Ee("VDataTable");let o=null;d(()=>({page:t.value,itemsPerPage:n.value,sortBy:r.value,groupBy:i.value,search:s.value}),e=>{Ne(o,e)||(o&&o.search!==e.search&&(t.value=1),a.emit("update:options",e),o=e)},{deep:!0,immediate:!0})}const cR=oe({...nR(),hideDefaultBody:Boolean,hideDefaultFooter:Boolean,hideDefaultHeader:Boolean,width:[String,Number],search:String,...YP(),...UP(),...dP(),...aR(),...xP(),...PP(),...FP(),...iR()},"DataTable"),dR=oe({...aP(),...cR(),...aD(),...lP()},"VDataTable");ae()({name:"VDataTable",props:dR(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0,"update:currentItems":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const{groupBy:i}=jP(e),{sortBy:s,multiSort:a,mustSort:o}=VP(e),{page:l,itemsPerPage:u}=function(e){return{page:Ae(e,"page",void 0,e=>Number(e??1)),itemsPerPage:Ae(e,"itemsPerPage",void 0,e=>Number(e??10))}}(e),{disableSort:c}=p(e),{columns:h,headers:m,sortFunctions:v,sortRawFunctions:g,filterFunctions:b}=SP(e,{groupBy:i,showSelect:x(()=>e.showSelect),showExpand:x(()=>e.showExpand)}),{items:w}=lR(e,h),I=x(()=>e.search),{filteredItems:S}=oD(e,w,I,{transform:e=>e.columns,customKeyFilter:b}),{toggleSort:T}=OP({sortBy:s,multiSort:a,mustSort:o,page:l}),{sortByWithGroups:C,opened:E,extractRows:A,isGroupOpen:D,toggleGroup:P}=zP({groupBy:i,sortBy:s,disableSort:c}),{sortedItems:R}=LP(e,S,C,{transform:e=>({...e.raw,...e.columns}),sortFunctions:v,sortRawFunctions:g}),{flatItems:V}=HP(R,i,E),M=f(()=>V.value.length),{startIndex:L,stopIndex:F,pageCount:B,setItemsPerPage:U}=function(e){const{page:t,itemsPerPage:n,itemsLength:r}=e,i=f(()=>-1===n.value?0:n.value*(t.value-1)),s=f(()=>-1===n.value?r.value:Math.min(r.value,i.value+n.value)),a=f(()=>-1===n.value||0===r.value?1:Math.ceil(r.value/n.value));d([t,a],()=>{t.value>a.value&&(t.value=a.value)});const o={page:t,itemsPerPage:n,startIndex:i,stopIndex:s,pageCount:a,itemsLength:r,nextPage:function(){t.value=Ve(t.value+1,1,a.value)},prevPage:function(){t.value=Ve(t.value-1,1,a.value)},setPage:function(e){t.value=Ve(e,1,a.value)},setItemsPerPage:function(e){n.value=e,t.value=1}};return O(oP,o),o}({page:l,itemsPerPage:u,itemsLength:M}),{paginatedItems:$}=function(e){const t=Ee("usePaginatedItems"),{items:n,startIndex:r,stopIndex:i,itemsPerPage:s}=e,a=f(()=>s.value<=0?n.value:n.value.slice(r.value,i.value));return d(a,e=>{t.emit("update:currentItems",e)},{immediate:!0}),{paginatedItems:a}}({items:V,startIndex:L,stopIndex:F,itemsPerPage:u}),j=f(()=>A($.value)),{isSelected:z,select:q,selectAll:G,toggleSelect:K,someSelected:H,allSelected:W}=NP(e,{allItems:w,currentPage:j}),{isExpanded:Q,toggleExpand:Y}=JP(e);uR({page:l,itemsPerPage:u,sortBy:s,groupBy:i,search:I}),le({VDataTableRows:{hideNoData:x(()=>e.hideNoData),noDataText:x(()=>e.noDataText),loading:x(()=>e.loading),loadingText:x(()=>e.loadingText)}});const X=f(()=>({page:l.value,itemsPerPage:u.value,sortBy:s.value,pageCount:B.value,toggleSort:T,setItemsPerPage:U,someSelected:H.value,allSelected:W.value,isSelected:z,select:q,selectAll:G,toggleSelect:K,isExpanded:Q,toggleExpand:Y,isGroupOpen:D,toggleGroup:P,items:j.value.map(e=>e.raw),internalItems:j.value,groupedItems:$.value,columns:h.value,headers:m.value}));return be(()=>{const t=uP.filterProps(e),i=BP.filterProps(e),s=rR.filterProps(e),a=sR.filterProps(e);return y(sR,k({class:["v-data-table",{"v-data-table--show-select":e.showSelect,"v-data-table--loading":e.loading},e.class],style:e.style},a,{fixedHeader:e.fixedHeader||e.sticky}),{top:()=>{var e;return null==(e=r.top)?void 0:e.call(r,X.value)},default:()=>{var t,a,o,l,u,c;return r.default?r.default(X.value):_(N,null,[null==(t=r.colgroup)?void 0:t.call(r,X.value),!e.hideDefaultHeader&&_("thead",{key:"thead"},[y(BP,i,r)]),null==(a=r.thead)?void 0:a.call(r,X.value),!e.hideDefaultBody&&_("tbody",null,[null==(o=r["body.prepend"])?void 0:o.call(r,X.value),r.body?r.body(X.value):y(rR,k(n,s,{items:$.value}),r),null==(l=r["body.append"])?void 0:l.call(r,X.value)]),null==(u=r.tbody)?void 0:u.call(r,X.value),null==(c=r.tfoot)?void 0:c.call(r,X.value)])},bottom:()=>r.bottom?r.bottom(X.value):!e.hideDefaultFooter&&_(N,null,[y(cx,null,null),y(uP,t,{prepend:r["footer.prepend"]})])})}),{}}});const hR=oe({...Je(cR(),["hideDefaultFooter"]),...UP(),...zN(),...aD()},"VDataTableVirtual"),pR=ae()({name:"VDataTableVirtual",props:hR(),emits:{"update:modelValue":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const{groupBy:i}=jP(e),{sortBy:s,multiSort:a,mustSort:o}=VP(e),{disableSort:l}=p(e),{columns:u,headers:c,filterFunctions:d,sortFunctions:h,sortRawFunctions:m}=SP(e,{groupBy:i,showSelect:x(()=>e.showSelect),showExpand:x(()=>e.showExpand)}),{items:g}=lR(e,u),b=x(()=>e.search),{filteredItems:w}=oD(e,g,b,{transform:e=>e.columns,customKeyFilter:d}),{toggleSort:I}=OP({sortBy:s,multiSort:a,mustSort:o}),{sortByWithGroups:S,opened:T,extractRows:C,isGroupOpen:E,toggleGroup:A}=zP({groupBy:i,sortBy:s,disableSort:l}),{sortedItems:N}=LP(e,w,S,{transform:e=>({...e.raw,...e.columns}),sortFunctions:h,sortRawFunctions:m}),{flatItems:D}=HP(N,i,T),P=f(()=>C(D.value)),{isSelected:R,select:V,selectAll:O,toggleSelect:M,someSelected:L,allSelected:F}=NP(e,{allItems:P,currentPage:P}),{isExpanded:B,toggleExpand:U}=JP(e),{containerRef:$,markerRef:j,paddingTop:z,paddingBottom:q,computedItems:G,handleItemResize:K,handleScroll:H,handleScrollend:W,calculateVisibleItems:Q,scrollToIndex:Y}=qN(e,D),X=f(()=>G.value.map(e=>e.raw));uR({sortBy:s,page:v(1),itemsPerPage:v(-1),groupBy:i,search:b}),le({VDataTableRows:{hideNoData:x(()=>e.hideNoData),noDataText:x(()=>e.noDataText),loading:x(()=>e.loading),loadingText:x(()=>e.loadingText)}});const J=f(()=>({sortBy:s.value,toggleSort:I,someSelected:L.value,allSelected:F.value,isSelected:R,select:V,selectAll:O,toggleSelect:M,isExpanded:B,toggleExpand:U,isGroupOpen:E,toggleGroup:A,items:P.value.map(e=>e.raw),internalItems:P.value,groupedItems:D.value,columns:u.value,headers:c.value}));return be(()=>{const t=BP.filterProps(e),i=rR.filterProps(e),s=sR.filterProps(e);return y(sR,k({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},s,{fixedHeader:e.fixedHeader||e.sticky}),{top:()=>{var e;return null==(e=r.top)?void 0:e.call(r,J.value)},wrapper:()=>{var s,a,o,l,c,d;return _("div",{ref:$,onScrollPassive:H,onScrollend:W,class:"v-table__wrapper",style:{height:ve(e.height)}},[_("table",null,[null==(s=r.colgroup)?void 0:s.call(r,J.value),!e.hideDefaultHeader&&_("thead",{key:"thead"},[y(BP,t,r)]),null==(a=r.thead)?void 0:a.call(r,J.value),!e.hideDefaultBody&&_("tbody",{key:"tbody"},[_("tr",{ref:j,style:{height:ve(z.value),border:0}},[_("td",{colspan:u.value.length,style:{height:0,border:0}},null)]),null==(o=r["body.prepend"])?void 0:o.call(r,J.value),y(rR,k(n,i,{items:X.value}),{...r,item:e=>y(jN,{key:e.internalItem.index,renderless:!0,"onUpdate:height":t=>K(e.internalItem.index,t)},{default:t=>{var n;let{itemRef:i}=t;return(null==(n=r.item)?void 0:n.call(r,{...e,itemRef:i}))??y(tR,k(e.props,{ref:i,key:e.internalItem.index,index:e.internalItem.index}),r)}})}),null==(l=r["body.append"])?void 0:l.call(r,J.value),_("tr",{style:{height:ve(q.value),border:0}},[_("td",{colspan:u.value.length,style:{height:0,border:0}},null)])]),null==(c=r.tbody)?void 0:c.call(r,J.value),null==(d=r.tfoot)?void 0:d.call(r,J.value)])])},bottom:()=>{var e;return null==(e=r.bottom)?void 0:e.call(r,J.value)}})}),{calculateVisibleItems:Q,scrollToIndex:Y}}}),fR=Symbol.for("vuetify:v-expansion-panel"),mR=oe({..._e(),...xA()},"VExpansionPanelText"),vR=ae()({name:"VExpansionPanelText",props:mR(),setup(e,t){let{slots:n}=t;const i=r(fR);if(!i)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:s,onAfterLeave:a}=AA(e,i.isSelected);return be(()=>y(Ix,{onAfterLeave:a},{default:()=>{var t;return[A(_("div",{class:w(["v-expansion-panel-text",e.class]),style:b(e.style)},[n.default&&s.value&&_("div",{class:"v-expansion-panel-text__wrapper"},[null==(t=n.default)?void 0:t.call(n)])]),[[D,i.isSelected.value]])]}})),{}}}),gR=oe({color:String,expandIcon:{type:Ie,default:"$expand"},collapseIcon:{type:Ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,..._e(),...KC()},"VExpansionPanelTitle"),yR=ae()({name:"VExpansionPanelTitle",directives:{vRipple:ax},props:gR(),setup(e,t){let{slots:n}=t;const i=r(fR);if(!i)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:s,backgroundColorStyles:a}=BC(()=>e.color),{dimensionStyles:o}=HC(e),l=f(()=>({collapseIcon:e.collapseIcon,disabled:i.disabled.value,expanded:i.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly})),u=x(()=>i.isSelected.value?e.collapseIcon:e.expandIcon);return be(()=>{var t;return A(_("button",{class:w(["v-expansion-panel-title",{"v-expansion-panel-title--active":i.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},s.value,e.class]),style:b([a.value,o.value,e.style]),type:"button",tabindex:i.disabled.value?-1:void 0,disabled:i.disabled.value,"aria-expanded":i.isSelected.value,onClick:e.readonly?void 0:i.toggle},[_("span",{class:"v-expansion-panel-title__overlay"},null),null==(t=n.default)?void 0:t.call(n,l.value),!e.hideActions&&y(MC,{defaults:{VIcon:{icon:u.value}}},{default:()=>{var e;return[_("span",{class:"v-expansion-panel-title__icon"},[(null==(e=n.actions)?void 0:e.call(n,l.value))??y(GC,null,null)])]}})]),[[ax,e.ripple]])}),{}}}),bR=oe({title:String,text:String,bgColor:String,...mE(),...wE(),...YC(),...zC(),...gR(),...mR()},"VExpansionPanel"),wR=ae()({name:"VExpansionPanel",props:bR(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const r=_E(e,fR),{backgroundColorClasses:i,backgroundColorStyles:s}=BC(()=>e.bgColor),{elevationClasses:a}=vE(e),{roundedClasses:o}=XC(e),l=x(()=>(null==r?void 0:r.disabled.value)||e.disabled),u=f(()=>r.group.items.value.reduce((e,t,n)=>(r.group.selected.value.includes(t.id)&&e.push(n),e),[])),c=f(()=>{const e=r.group.items.value.findIndex(e=>e.id===r.id);return!r.isSelected.value&&u.value.some(t=>t-e===1)}),d=f(()=>{const e=r.group.items.value.findIndex(e=>e.id===r.id);return!r.isSelected.value&&u.value.some(t=>t-e===-1)});return O(fR,r),be(()=>{const t=!(!n.text&&!e.text),u=!(!n.title&&!e.title),h=yR.filterProps(e),p=vR.filterProps(e);return y(e.tag,{class:w(["v-expansion-panel",{"v-expansion-panel--active":r.isSelected.value,"v-expansion-panel--before-active":c.value,"v-expansion-panel--after-active":d.value,"v-expansion-panel--disabled":l.value},o.value,i.value,e.class]),style:b([s.value,e.style])},{default:()=>[_("div",{class:w(["v-expansion-panel__shadow",...a.value])},null),y(MC,{defaults:{VExpansionPanelTitle:{...h},VExpansionPanelText:{...p}}},{default:()=>{var r;return[u&&y(yR,{key:"title"},{default:()=>[n.title?n.title():e.title]}),t&&y(vR,{key:"text"},{default:()=>[n.text?n.text():e.text]}),null==(r=n.default)?void 0:r.call(n)]}})]})}),{groupItem:r}}}),_R=["default","accordion","inset","popout"],IR=oe({flat:Boolean,...bE(),...Ye(bR(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...we(),..._e(),...zC(),variant:{type:String,default:"default",validator:e=>_R.includes(e)}},"VExpansionPanels"),SR=ae()({name:"VExpansionPanels",props:IR(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{next:r,prev:i}=IE(e,fR),{themeClasses:s}=xe(e),a=x(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return le({VExpansionPanel:{bgColor:x(()=>e.bgColor),collapseIcon:x(()=>e.collapseIcon),color:x(()=>e.color),eager:x(()=>e.eager),elevation:x(()=>e.elevation),expandIcon:x(()=>e.expandIcon),focusable:x(()=>e.focusable),hideActions:x(()=>e.hideActions),readonly:x(()=>e.readonly),ripple:x(()=>e.ripple),rounded:x(()=>e.rounded),static:x(()=>e.static)}}),be(()=>y(e.tag,{class:w(["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},s.value,a.value,e.class]),style:b(e.style)},{default:()=>{var e;return[null==(e=n.default)?void 0:e.call(n,{prev:i,next:r})]}})),{next:r,prev:i}}}),kR=oe({id:String,interactive:Boolean,text:String,...Je(BA({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:null}),["absolute","persistent"])},"VTooltip"),TR=ae()({name:"VTooltip",props:kR(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:r}=n;const i=Ae(e,"modelValue"),{scopeId:s}=NA(),a=V(),o=x(()=>e.id||`v-tooltip-${a}`),l=t(),u=f(()=>e.location.split(" ").length>1?e.location:e.location+" center"),c=f(()=>"auto"===e.origin||"overlap"===e.origin||e.origin.split(" ").length>1||e.location.split(" ").length>1?e.origin:e.origin+" center"),d=x(()=>null!=e.transition?e.transition:i.value?"scale-transition":"fade-transition"),h=f(()=>k({"aria-describedby":o.value},e.activatorProps));return be(()=>{const t=UA.filterProps(e);return y(UA,k({ref:l,class:["v-tooltip",{"v-tooltip--interactive":e.interactive},e.class],style:e.style,id:o.value},t,{modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,transition:d.value,absolute:!0,location:u.value,origin:c.value,persistent:!0,role:"tooltip",activatorProps:h.value,_disableGlobalStack:!0},s),{activator:r.activator,default:function(){for(var t,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(null==(t=r.default)?void 0:t.call(r,...i))??e.text}})}),zA({},l)}}),CR={class:"pa-6"},ER={class:"d-flex align-center mb-6"},xR={class:"d-flex align-center mb-3"},AR={class:"d-flex justify-space-between align-center"},NR={class:"d-flex align-center gap-4"},DR={class:"d-flex align-center"},PR={class:"text-body-1 font-weight-medium"},RR={class:"d-flex align-center gap-2"},VR={class:"character-name-cell"},OR={class:"d-flex align-center"},MR={class:"text-caption text-white font-weight-bold"},LR={class:"character-name"},FR={class:"ml-1"},BR={class:"text-caption"},UR=["onClick"],$R=["innerHTML"],jR=["innerHTML"],zR=["onClick"],qR=["innerHTML"],GR=["innerHTML"],KR=VC({__name:"ViewAllCharactersTab",emits:["items-updated"],setup(e,{expose:n,emit:r}){const i=PC(),a=RC(),o=r,l=t(!1),u=t(!1),c=t(!1),h=t(null),p=t(null),m=t(new Map),v=t("current");d(v,e=>{i.characterMasters.forEach(t=>{Q(t.id)&&m.value.set(t.id,e)})});const g=s({charSearch:"",element:[],itemSearch:[],type:[],gachaSearch:[],totalOwnership:[],account:"",ownership:"",columnFilter:[]}),b=f(()=>i.characterMasters),I=f(()=>i.accounts),S=f(()=>i.itemMasters),T=f(()=>i.gachaMasters);f(()=>i.itemMastersMap),f(()=>i.characterMastersMap);const C=f(()=>i.dataLoaded),E=f(()=>Array.from(new Set(i.characterMasters.map(e=>e.type).filter(Boolean))).sort()),x=f(()=>{const e=[{title:"図鑑No.",key:"indexNumber",align:"center",sortable:!0,width:80},{title:"キャラ名",key:"monsterName",align:"start",sortable:!0,width:200}];return u.value&&e.push({title:"属性",key:"element",align:"center",sortable:!0,width:100},{title:"分類",key:"type",align:"center",sortable:!0,width:100},{title:"排出ガチャ",key:"ejectionGacha",align:"center",sortable:!0,width:100}),i.accounts.forEach(t=>{var n;const r=t.indexNumber||(null==(n=t.name.match(/\d+/))?void 0:n[0])||t.id;e.push({title:`${r}-1`,key:`account_${t.id}_1`,align:"center",sortable:!1,width:78},{title:`${r}-2`,key:`account_${t.id}_2`,align:"center",sortable:!1,width:78})}),e}),A=f(()=>{if(!i.dataLoaded)return[];const{charSearch:e,element:t,itemSearch:n,type:r,gachaSearch:s,totalOwnership:a,account:o,ownership:l,columnFilter:u}=g,c=e.toLowerCase(),d=n.map(e=>Number(e));return i.characterMasters.filter(e=>{if(c&&!e.monsterName.toLowerCase().includes(c)&&!(e.indexNumber+"").includes(c))return!1;if(t.length>0&&!t.includes(e.element))return!1;if(r.length>0){let t=!1;for(const n of r)if("恒常_or_限定"===n){if("恒常"===e.type||"限定"===e.type){t=!0;break}}else if(e.type===n){t=!0;break}if(!t)return!1}if(s.length>0&&!s.includes(e.ejectionGacha||""))return!1;if(d.length>0){let t=!1;const n=o||null;for(const r of d)if(n){if((i.ownedCharactersData.get(n)||[]).some(t=>{if(t.characterMasterId!==e.id)return!1;if(!t.items||0===t.items.length)return!1;return IC(t.items).some(e=>e.itemId===r)})){t=!0;break}}else{let n=!1;for(const t of i.ownedCharactersData.values())if(t.some(t=>{if(t.characterMasterId!==e.id)return!1;if(!t.items||0===t.items.length)return!1;return IC(t.items).some(e=>e.itemId===r)})){n=!0;break}if(n){t=!0;break}}if(!t)return!1}if(a&&a.length>0){const t=i.accounts.reduce((t,n)=>t+V(e.id,n.id),0);let n=!1;for(const r of a){if("all_unowned"===r&&0===t){n=!0;break}if("one_total"===r&&1===t){n=!0;break}if("two_total"===r&&2===t){n=!0;break}if("three_total"===r&&3===t){n=!0;break}if("four_total"===r&&4===t){n=!0;break}if("five_or_more"===r&&t>=5){n=!0;break}if("one_in_each"===r&&i.accounts.every(t=>V(e.id,t.id)>=1)){n=!0;break}}if(!n)return!1}if(o&&l){const t=V(e.id,o);if("owned"===l&&0===t)return!1;if("unowned"===l&&t>0)return!1;if("one"===l&&1!==t)return!1;if("two"===l&&2!==t)return!1}if(u&&u.length>0){let t=!1;for(const n of u){let r=!1;for(const t of i.accounts){const s=(i.ownedCharactersData.get(t.id)||[]).filter(t=>t.characterMasterId===e.id);if("has_zero_item_character"===n&&s.some(e=>!e.items||0===e.items.length)){r=!0;break}if("has_one_item_character"===n&&s.some(e=>e.items&&1===e.items.length)){r=!0;break}if("has_two_item_character"===n&&s.some(e=>e.items&&2===e.items.length)){r=!0;break}if("has_three_item_character"===n&&s.some(e=>e.items&&3===e.items.length)){r=!0;break}if("has_virtual_item_character"===n&&s.some(e=>(e.items||[]).some(e=>"object"==typeof e&&!0===e.isVirtual))){r=!0;break}}if(r){t=!0;break}}if(!t)return!1}return!0})}),N=f(()=>A.value.filter(e=>a.isPinned(e.id))),D=f(()=>A.value.filter(e=>!a.isPinned(e.id))),P=f(()=>[...N.value,...D.value]),R=e=>a.isPinned(e.id)?"pinned-row":"",V=(e,t)=>i.ownedCountMap.get(`${e}-${t}`)||0,O=(e,t,n)=>{const r=(i.ownedCharactersData.get(t)||[]).filter(t=>t.characterMasterId===e);if(!r||r.length<=n)return"—";const s=r[n].items||[],a=Y(e),o=s.filter(e=>{const t="object"==typeof e&&e.isVirtual,n="object"==typeof e&&e.willRemove;return"current"===a?!t:!n}).map(e=>{const t="object"==typeof e?e.itemId:e,n="object"==typeof e&&e.isVirtual,r="object"==typeof e&&e.willRemove,s=i.itemMastersMap.get(Number(t));return s?"current"===a&&r?`<span class="will-remove-item item-name">${s}</span>`:n?`<span class="virtual-item item-name">${s}</span>`:`<span class="item-name">${s}</span>`:null}).filter(Boolean).join("<br>");return o?`✔️<br>${o}`:"✔️"},L=(e,t,n)=>{const r=(i.ownedCharactersData.get(t)||[]).filter(t=>t.characterMasterId===e);if(!r||r.length<=n)return"未所持";return(r[n].items||[]).map(e=>{const t="object"==typeof e?e.itemId:e,n=("object"==typeof e&&e.isVirtual,i.itemMastersMap.get(Number(t)));return n||null}).filter(Boolean).join("<br>")||"アイテムなし"},F=(e,t,n)=>V(e,t)>=n?"status-owned":"status-unowned",U=e=>({"火":"red","水":"blue","木":"green","光":"amber","闇":"deep-purple"}[e]||"grey"),$=()=>{Object.assign(g,{charSearch:"",element:[],itemSearch:[],type:[],gachaSearch:[],totalOwnership:[],account:"",ownership:"",columnFilter:[]})},j=e=>m.value.get(e)||"current",z=e=>{const t="current"===j(e)?"planned":"current";m.value.set(e,t)},Q=e=>{for(const t of i.accounts){const n=(i.ownedCharactersData.get(t.id)||[]).filter(t=>t.characterMasterId===e);for(const e of n){if((e.items||[]).some(e=>"object"==typeof e&&!0===e.isVirtual))return!0}}return!1},Y=(e,t,n)=>j(e),Z=(e,t,n)=>{const r=(i.ownedCharactersData.get(t)||[]).filter(t=>t.characterMasterId===e);if(!r||r.length<=n)return h.value={characterMasterId:e,accountId:t,items:[],isNew:!0},p.value=t,void(c.value=!0);h.value=r[n],p.value=t,c.value=!0},re=async({character:e,items:t,isNew:n})=>{o("items-updated",n?{accountId:p.value,characterMasterId:e.characterMasterId,items:t,isNew:!0}:{accountId:p.value,ownedCharacterId:e.id,items:t,isNew:!1})},ie=async()=>{try{l.value=!0;const e=[];i.accounts.forEach(t=>{(i.ownedCharactersData.get(t.id)||[]).forEach(n=>{e.push({...n,accountName:t.name})})});const t=rP({characterMasters:i.characterMasters,ownedCharacters:e,accountName:"",itemMastersMap:i.itemMastersMap}),n=new Date,r=`${n.getFullYear()}${String(n.getMonth()+1).padStart(2,"0")}${String(n.getDate()).padStart(2,"0")}`,s=`${String(n.getHours()).padStart(2,"0")}${String(n.getMinutes()).padStart(2,"0")}`;((e,t)=>{const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=t,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)})(t,`characters_export_${r}_${s}.csv`),a.showSuccess("CSVエクスポートが完了しました")}catch(e){a.showError("CSVエクスポートに失敗しました")}finally{l.value=!1}};return n({rowDisplayModes:m,cellDisplayModes:m,getRowDisplayMode:j,getCellDisplayMode:Y,toggleRowDisplayMode:z,toggleCellDisplayMode:(e,t,n)=>{z(e)},isModalOpen:c,editingCharacter:h,filters:g,exportToCSV:ie}),(e,t)=>{var n;const r=te("v-subheader");return G(),q("div",CR,[_("div",ER,[y(GC,{icon:"mdi-account-multiple",size:"28",color:"primary",class:"mr-3"}),t[12]||(t[12]=_("h2",{class:"text-h5 font-weight-medium text-primary"},"所持状況一覧",-1))]),y(bD,{class:"mb-6 minimal-filter-card"},{default:K(()=>[y(pD,{class:"minimal-card-title pa-4"},{default:K(()=>[y(GC,{icon:"mdi-filter-variant",class:"mr-2",size:"20"}),t[13]||(t[13]=H(" フィルターとオプション ",-1))]),_:1,__:[13]}),y(SR,null,{default:K(()=>[y(wR,null,{default:K(()=>[y(yR,{class:"pa-4 minimal-panel-title"},{default:K(()=>[y(GC,{start:"",icon:"mdi-filter-variant",color:"primary",size:"20"}),t[14]||(t[14]=_("span",{class:"text-body-1 font-weight-medium"},"詳細フィルターを開く",-1))]),_:1,__:[14]}),y(vR,{class:"pa-6"},{default:K(()=>[y(SD,null,{default:K(()=>[y(WD,null,{default:K(()=>[y(DD,{cols:"12",md:"4"},{default:K(()=>[y(UN,{modelValue:g.charSearch,"onUpdate:modelValue":t[0]||(t[0]=e=>g.charSearch=e),modelModifiers:{lazy:!0},label:"キャラクター名 or 図鑑番号",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-account-search",class:"minimal-input"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"4"},{default:K(()=>[y(YN,{modelValue:g.element,"onUpdate:modelValue":t[1]||(t[1]=e=>g.element=e),items:["火","水","木","光","闇"],label:"属性",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-fire",class:"minimal-select",multiple:""},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"4"},{default:K(()=>[y(YN,{modelValue:g.itemSearch,"onUpdate:modelValue":t[2]||(t[2]=e=>g.itemSearch=e),items:S.value,"item-title":"name","item-value":"id",label:"アイテム名",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-sword-cross",class:"minimal-select",multiple:""},null,8,["modelValue","items"])]),_:1}),y(DD,{cols:"12",md:"4"},{default:K(()=>[y(YN,{modelValue:g.type,"onUpdate:modelValue":t[3]||(t[3]=e=>g.type=e),items:["恒常_or_限定",...E.value],label:"分類 (Type)",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-tag",class:"minimal-select",multiple:""},null,8,["modelValue","items"])]),_:1}),y(DD,{cols:"12",md:"4"},{default:K(()=>[y(YN,{modelValue:g.gachaSearch,"onUpdate:modelValue":t[4]||(t[4]=e=>g.gachaSearch=e),items:T.value,"item-title":"name","item-value":"name",label:"排出ガチャ",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-gift",class:"minimal-select",multiple:""},null,8,["modelValue","items"])]),_:1}),y(DD,{cols:"12",md:"4"},{default:K(()=>[y(YN,{modelValue:g.totalOwnership,"onUpdate:modelValue":t[5]||(t[5]=e=>g.totalOwnership=e),items:[{value:"all_unowned",title:"未所持"},{value:"one_total",title:"合計1体"},{value:"two_total",title:"合計2体"},{value:"three_total",title:"合計3体"},{value:"four_total",title:"合計4体"},{value:"five_or_more",title:"合計それ以上（5体以上）"},{value:"one_in_each",title:"各アカウントで1体以上所持"}],multiple:"",label:"全体の所持状況",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-account-group",class:"minimal-select"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(YN,{modelValue:g.columnFilter,"onUpdate:modelValue":t[6]||(t[6]=e=>g.columnFilter=e),items:[{value:"has_zero_item_character",title:"アイテム0つ所持キャラが居る列"},{value:"has_one_item_character",title:"アイテム1つ所持キャラが居る列"},{value:"has_two_item_character",title:"アイテム2つ所持キャラが居る列"},{value:"has_three_item_character",title:"アイテム3つ所持キャラが居る列"},{value:"has_virtual_item_character",title:"仮想アイテム所持キャラが居る列"}],multiple:"",label:"列単位での絞り込み",variant:"outlined",density:"compact",clearable:"",color:"primary","prepend-inner-icon":"mdi-view-column",class:"minimal-select"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12"},{default:K(()=>[y(cx,{class:"my-4 minimal-divider"}),_("div",xR,[y(GC,{icon:"mdi-account",color:"secondary",class:"mr-2",size:"20"}),y(r,{class:"text-body-1 font-weight-medium"},{default:K(()=>t[15]||(t[15]=[H("単一アカウントでの絞り込み",-1)])),_:1,__:[15]})])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(YN,{modelValue:g.account,"onUpdate:modelValue":t[7]||(t[7]=e=>g.account=e),items:I.value,"item-title":"name","item-value":"id",label:"アカウント",variant:"outlined",density:"compact",clearable:"",color:"secondary","prepend-inner-icon":"mdi-account",class:"minimal-select"},null,8,["modelValue","items"])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(YN,{modelValue:g.ownership,"onUpdate:modelValue":t[8]||(t[8]=e=>g.ownership=e),items:[{value:"owned",title:"所持"},{value:"unowned",title:"未所持"},{value:"one",title:"1体所持"},{value:"two",title:"2体所持"}],label:"所持状況 (指定アカウント内)",variant:"outlined",density:"compact",clearable:"",color:"secondary","prepend-inner-icon":"mdi-check-circle",class:"minimal-select"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),y(cD,{class:"pa-4 minimal-actions"},{default:K(()=>[y(lx,{onClick:t[9]||(t[9]=e=>u.value=!u.value),variant:"outlined",color:"info","prepend-icon":"mdi-eye",class:"minimal-button"},{default:K(()=>[H(B(u.value?"詳細を非表示":"詳細を表示"),1)]),_:1}),y(QD),y(lx,{onClick:$,color:"secondary",variant:"outlined","prepend-icon":"mdi-refresh",class:"minimal-button"},{default:K(()=>t[16]||(t[16]=[H(" リセット ",-1)])),_:1,__:[16]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),y(bD,{class:"mb-4 minimal-stats-card"},{default:K(()=>[y(gD,{class:"pa-4"},{default:K(()=>[_("div",AR,[_("div",NR,[_("div",DR,[y(GC,{icon:"mdi-chart-bar",color:"primary",class:"mr-2",size:"20"}),_("span",PR,"表示件数: "+B(A.value.length)+" / "+B(b.value.length),1)]),y(CE,{modelValue:v.value,"onUpdate:modelValue":t[10]||(t[10]=e=>v.value=e),mandatory:"",density:"comfortable",color:"primary"},{default:K(()=>[y(lx,{value:"current",size:"small"},{default:K(()=>[y(GC,{size:"small",class:"mr-1"},{default:K(()=>t[17]||(t[17]=[H("mdi-eye",-1)])),_:1,__:[17]}),t[18]||(t[18]=H(" 全て現在 ",-1))]),_:1,__:[18]}),y(lx,{value:"planned",size:"small"},{default:K(()=>[y(GC,{size:"small",class:"mr-1"},{default:K(()=>t[19]||(t[19]=[H("mdi-eye-outline",-1)])),_:1,__:[19]}),t[20]||(t[20]=H(" 全て予定後 ",-1))]),_:1,__:[20]})]),_:1},8,["modelValue"])]),_("div",RR,[y(lx,{onClick:ie,loading:l.value,color:"success",variant:"outlined","prepend-icon":"mdi-file-export",class:"minimal-button"},{default:K(()=>t[21]||(t[21]=[H(" CSVエクスポート ",-1)])),_:1,__:[21]},8,["loading"]),y(NN,{color:A.value.length===b.value.length?"success":"warning",variant:"outlined",class:"minimal-chip"},{default:K(()=>[H(B(A.value.length===b.value.length?"全件表示":"フィルター適用中"),1)]),_:1},8,["color"])])])]),_:1})]),_:1}),y(bD,{elevation:"3",rounded:"lg"},{default:K(()=>[y(pD,{class:"bg-primary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-table",class:"mr-2"}),t[22]||(t[22]=H(" キャラクター所持状況 ",-1))]),_:1,__:[22]}),y(gD,{class:"pa-0"},{default:K(()=>[y(pR,{items:P.value,headers:x.value,loading:!C.value,height:"70vh",density:"compact","fixed-header":"",class:"table-fixed","fixed-columns":!0,"item-class":R},ne({"item.monsterName":K(({item:e})=>[_("div",VR,[_("div",OR,[y(fE,{size:"32",color:U(e.element),class:"mr-2"},{default:K(()=>[_("span",MR,B(e.element||"?"),1)]),_:2},1032,["color"]),_("span",LR,B(e.monsterName||"—"),1),y(lx,{onClick:ee(t=>M(a).togglePinnedCharacter(e.id),["stop"]),icon:M(a).isPinned(e.id)?"mdi-pin":"mdi-pin-outline",color:M(a).isPinned(e.id)?"amber":"grey",variant:"text",size:"x-small",density:"compact",class:"ml-1 pin-btn"},null,8,["onClick","icon","color"])]),Q(e.id)?(G(),W(lx,{key:0,onClick:ee(t=>z(e.id),["stop"]),color:"current"===j(e.id)?"primary":"orange",variant:"tonal",size:"x-small",class:"row-toggle-btn mt-1"},{default:K(()=>[y(GC,{size:"x-small"},{default:K(()=>[H(B("current"===j(e.id)?"mdi-eye":"mdi-eye-outline"),1)]),_:2},1024),_("span",FR,B("current"===j(e.id)?"現在":"予定後"),1)]),_:2},1032,["onClick","color"])):X("",!0)])]),"item.element":K(({item:e})=>[y(NN,{color:U(e.element),variant:"tonal",size:"small"},{default:K(()=>[H(B(e.element||"—"),1)]),_:2},1032,["color"])]),"item.type":K(({item:e})=>{return[y(NN,{color:(t=e.type,{"恒常":"success","限定":"warning","コラボ":"info","イベント":"secondary"}[t]||"grey"),variant:"tonal",size:"small"},{default:K(()=>[H(B(e.type||"—"),1)]),_:2},1032,["color"])];var t}),"item.ejectionGacha":K(({item:e})=>[_("span",BR,B(e.ejectionGacha||"—"),1)]),_:2},[J(I.value,e=>({name:`item.account_${e.id}_1`,fn:K(({item:t})=>[_("div",{class:w([[F(t.id,e.id,1),"account-cell"],"text-center"]),onClick:n=>Z(t.id,e.id,0),style:{cursor:"pointer"}},[y(TR,{location:"bottom"},{activator:K(({props:n})=>[_("div",k(n,{class:"cell-content",innerHTML:O(t.id,e.id,0)}),null,16,$R)]),default:K(()=>[_("span",{innerHTML:L(t.id,e.id,0)},null,8,jR)]),_:2},1024)],10,UR)])})),J(I.value,e=>({name:`item.account_${e.id}_2`,fn:K(({item:t})=>[_("div",{class:w([[F(t.id,e.id,2),"account-cell"],"text-center"]),onClick:n=>Z(t.id,e.id,1),style:{cursor:"pointer"}},[y(TR,{location:"bottom"},{activator:K(({props:n})=>[_("div",k(n,{class:"cell-content",innerHTML:O(t.id,e.id,1)}),null,16,qR)]),default:K(()=>[_("span",{innerHTML:L(t.id,e.id,1)},null,8,GR)]),_:2},1024)],10,zR)])}))]),1032,["items","headers","loading"])]),_:1})]),_:1}),y(eP,{modelValue:c.value,"onUpdate:modelValue":t[11]||(t[11]=e=>c.value=e),character:h.value,"is-new-character":(null==(n=h.value)?void 0:n.isNew)||!1,onSave:re},null,8,["modelValue","character","is-new-character"])])}}},[["__scopeId","data-v-34fae6e7"]]),HR={class:"text-h6"},WR={class:"d-flex align-center w-100"},QR={class:"flex-grow-1 premium-text-content"},YR={class:"d-flex align-center"},XR=VC({__name:"CharacterSelector",props:{modelValue:{type:[String,null],required:!0},items:{type:Array,required:!0},itemTitle:{type:[String,Function],default:"monsterName"},disabledItems:{type:Array,default:()=>[]},label:{type:String,default:"キャラクター名で検索"},variant:{type:String,default:"outlined"},clearable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},prependInnerIcon:{type:String,default:"mdi-magnify"},listHeight:{type:[String,Number],default:"400px"},listCardVariant:{type:String,default:"elevated"},noDataText:{type:String,default:"該当するキャラクターがいません"},density:{type:String,default:"comfortable"},listDensity:{type:String,default:"compact"},primaryColor:{type:String,default:"primary"},searchBgColor:{type:String,default:"grey-lighten-5"},cardElevation:{type:[Number,String],default:2},cardBorder:{type:[Boolean,String],default:!0}},emits:["update:modelValue"],setup(e,{emit:n}){const r=e,i=n,s=t(""),a=t(!1),o=f(()=>{if(!s.value)return r.items;const e=s.value.toLowerCase();return r.items.filter(t=>l(t).toLowerCase().includes(e))}),l=e=>"function"==typeof r.itemTitle?r.itemTitle(e):e[r.itemTitle]||"",u=e=>r.modelValue===e.id?r.primaryColor:r.disabledItems.includes(e.id)?"grey-lighten-3":"primary-lighten-5",c=e=>"player"===e.type?"mdi-account":"monster"===e.type?"mdi-dragon":"npc"===e.type?"mdi-account-tie":"mdi-account-circle",d=e=>{const t=e.length>0?e[0]:null;r.modelValue!==t&&i("update:modelValue",t)};return(t,n)=>(G(),q(N,null,[y(UN,{modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=e=>s.value=e),label:e.label,variant:e.variant,clearable:e.clearable,"prepend-inner-icon":e.prependInnerIcon,disabled:e.disabled,"hide-details":"",class:"mb-4 character-selector-search premium-search",density:e.density,color:e.primaryColor,"bg-color":e.searchBgColor,focused:a.value,onFocus:n[1]||(n[1]=e=>a.value=!0),onBlur:n[2]||(n[2]=e=>a.value=!1)},{"prepend-inner":K(()=>[y(GC,{color:a.value?e.primaryColor:"grey",icon:e.prependInnerIcon,size:"20",class:"search-icon"},null,8,["color","icon"])]),_:1},8,["modelValue","label","variant","clearable","prepend-inner-icon","disabled","density","color","bg-color","focused"]),y(bD,{variant:e.listCardVariant,height:e.listHeight,disabled:e.disabled,class:"character-selector-card premium-card",elevation:e.cardElevation,border:e.cardBorder,style:{display:"flex","flex-direction":"column"}},{default:K(()=>[e.modelValue?(G(),W(pD,{key:0,class:"d-flex align-center justify-end pa-4 pb-3 premium-card-header"},{default:K(()=>[y(NN,{size:"small",color:"success",variant:"tonal",class:"premium-chip"},{default:K(()=>n[3]||(n[3]=[H(" 選択中 ",-1)])),_:1,__:[3]})]),_:1})):X("",!0),y(lA,{"model-value":[e.modelValue],"onUpdate:selected":d,class:"character-selector-list premium-list",density:e.listDensity,style:{"overflow-y":"auto","max-height":"calc(100% - 60px)"}},{default:K(()=>[0===o.value.length?(G(),W(Wx,{key:0,class:"no-data-item premium-no-data"},{default:K(()=>[y(Kx,{class:"text-center text-grey-darken-1 py-12"},{default:K(()=>[y(GC,{icon:"mdi-information-outline",size:"64",class:"mb-4 no-data-icon",color:"grey-lighten-1"}),_("div",HR,B(e.noDataText),1)]),_:1})]),_:1})):X("",!0),(G(!0),q(N,null,J(o.value,(s,a)=>(G(),W(Wx,{key:s.id,value:s.id,disabled:e.disabledItems.includes(s.id),class:w(["character-item premium-item",{"character-item--selected":e.modelValue===s.id,"character-item--disabled":e.disabledItems.includes(s.id)}]),onClick:e=>(e=>{r.disabledItems.includes(e.id)||i("update:modelValue",e.id)})(s)},{default:K(()=>[re(t.$slots,"item",{item:s},()=>[_("div",WR,[y(fE,{size:"40",class:w(["mr-4 premium-avatar",{"selected-avatar":e.modelValue===s.id}]),color:u(s)},{default:K(()=>[y(GC,{icon:c(s),color:e.modelValue===s.id?"white":"primary",size:"20",class:"avatar-icon"},null,8,["icon","color"])]),_:2},1032,["color","class"]),_("div",QR,[y(Kx,{class:w(["font-weight-bold text-h6",{"text-primary":e.modelValue===s.id}])},{default:K(()=>[H(B(l(s)),1)]),_:2},1032,["class"]),s.subtitle?(G(),W(Gx,{key:0,class:"text-body-2 text-grey-darken-1 mt-1"},{default:K(()=>[H(B(s.subtitle),1)]),_:2},1024)):X("",!0)])])],!0)]),append:K(()=>[_("div",YR,[e.disabledItems.includes(s.id)?(G(),W(NN,{key:0,size:"small",color:"warning",variant:"tonal",class:"mr-3 premium-status-chip"},{default:K(()=>n[4]||(n[4]=[H(" 選択済 ",-1)])),_:1,__:[4]})):X("",!0),e.modelValue===s.id?(G(),W(GC,{key:1,icon:"mdi-check-circle",color:"success",size:"24",class:"selection-indicator premium-check"})):X("",!0)])]),_:2},1032,["value","disabled","class","onClick"]))),128))]),_:3},8,["model-value","density"])]),_:3},8,["variant","height","disabled","elevation","border"])],64))}},[["__scopeId","data-v-a7887c2a"]]),JR=oe({..._e(),...dN()},"VForm"),ZR=ae()({name:"VForm",props:JR(),emits:{"update:modelValue":e=>!0,submit:e=>!0},setup(e,r){let{slots:i,emit:s}=r;const a=function(e){const r=Ae(e,"modelValue"),i=x(()=>e.disabled),s=x(()=>e.readonly),a=v(!1),o=t([]),l=t([]);return d(o,()=>{let e=0,t=0;const n=[];for(const r of o.value)!1===r.isValid?(t++,n.push({id:r.id,errorMessages:r.errorMessages})):!0===r.isValid&&e++;l.value=n,r.value=!(t>0)&&(e===o.value.length||null)},{deep:!0,flush:"post"}),O(cN,{register:e=>{let{id:t,vm:r,validate:i,reset:s,resetValidation:a}=e;o.value.some(e=>e.id===t),o.value.push({id:t,validate:i,reset:s,resetValidation:a,vm:n(r),isValid:null,errorMessages:[]})},unregister:e=>{o.value=o.value.filter(t=>t.id!==e)},update:(e,t,n)=>{const r=o.value.find(t=>t.id===e);r&&(r.isValid=t,r.errorMessages=n)},isDisabled:i,isReadonly:s,isValidating:a,isValid:r,items:o,validateOn:x(()=>e.validateOn)}),{errors:l,isDisabled:i,isReadonly:s,isValidating:a,isValid:r,items:o,validate:async function(){const t=[];let n=!0;l.value=[],a.value=!0;for(const r of o.value){const i=await r.validate();if(i.length>0&&(n=!1,t.push({id:r.id,errorMessages:i})),!n&&e.fastFail)break}return l.value=t,a.value=!1,{valid:n,errors:l.value}},reset:function(){o.value.forEach(e=>e.reset())},resetValidation:function(){o.value.forEach(e=>e.resetValidation())}}}(e),o=t();function l(e){e.preventDefault(),a.reset()}function u(e){const t=e,n=a.validate();t.then=n.then.bind(n),t.catch=n.catch.bind(n),t.finally=n.finally.bind(n),s("submit",t),t.defaultPrevented||n.then(e=>{var t;let{valid:n}=e;n&&(null==(t=o.value)||t.submit())}),t.preventDefault()}return be(()=>{var t;return _("form",{ref:o,class:w(["v-form",e.class]),style:b(e.style),novalidate:!0,onReset:l,onSubmit:u},[null==(t=i.default)?void 0:t.call(i,a)])}),zA(a,o)}}),eV={class:"pa-6"},tV={class:"d-flex align-center mb-6"},nV={class:"mb-4"},rV={class:"d-flex align-center mb-3"},iV={__name:"AddOwnedCharacterTab",emits:["character-added"],setup(e,{emit:n}){const r=PC(),i=RC(),s=n,a=t(null),o=t(!1),l=f(()=>i.selectedAccountId?r.characterMasters.filter(e=>u(e.id)<2):[]);d(()=>i.selectedAccountId,()=>{a.value=null});const u=e=>i.selectedAccountId&&r.ownedCountMap.get(`${e}-${i.selectedAccountId}`)||0,c=e=>{const t=u(e.id);return`[${e.indexNumber||"?"}] ${e.monsterName} | 所持数: ${t} / 2`},h=async()=>{if(!a.value||!i.selectedAccountId)return alert("追加するキャラとアカウントを選択してください。");if(u(a.value)>=2)return alert("このキャラは既に2体所持しています。");o.value=!0;try{const e=r.characterMastersMap.get(a.value);if(!e)throw new Error("キャラのマスター情報が見つかりません。");const t={characterMasterId:a.value,monsterName:e.monsterName,items:[],createdAt:jT()},n=await TC(i.selectedAccountId,t),o={...t,id:n.id,createdAt:{toDate:()=>new Date}};s("character-added",{accountId:i.selectedAccountId,newCharacter:o}),alert(`「${e.monsterName}」を所持リストに追加しました。`),a.value=null}catch(e){alert("エラー: "+e.message)}finally{o.value=!1}};return(e,t)=>(G(),q("div",eV,[_("div",tV,[y(GC,{icon:"mdi-account-plus",size:"32",color:"primary",class:"mr-3"}),t[1]||(t[1]=_("h2",{class:"text-h4 font-weight-bold text-primary"}," 所持キャラクター追加 ",-1))]),y(ZR,{onSubmit:ee(h,["prevent"])},{default:K(()=>[y(bD,{elevation:"3",rounded:"lg"},{default:K(()=>[y(pD,{class:"bg-primary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-account-search",class:"mr-2"}),t[2]||(t[2]=H(" キャラクター選択 ",-1))]),_:1,__:[2]}),y(gD,{class:"pa-6"},{default:K(()=>[y(SD,{class:"pa-0"},{default:K(()=>[y(WD,null,{default:K(()=>[y(DD,{cols:"12"},{default:K(()=>[_("div",nV,[_("div",rV,[y(GC,{icon:"mdi-account-search",color:"primary",class:"mr-2"}),t[3]||(t[3]=_("h6",{class:"text-h6 font-weight-medium"}," 追加するキャラクター ",-1))]),y(XR,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),items:l.value,"item-title":c,label:"追加するキャラクター名で検索","list-height":"400px","no-data-text":"追加できるキャラクターがいません",color:"primary","prepend-inner-icon":"mdi-account-search"},null,8,["modelValue","items"])])]),_:1})]),_:1})]),_:1})]),_:1}),y(cD,{class:"pa-6 bg-grey-lighten-5"},{default:K(()=>[y(QD),y(lx,{loading:o.value,disabled:!a.value||o.value,onClick:h,color:"primary",size:"large",variant:"elevated","prepend-icon":"mdi-account-plus",class:"px-8"},{default:K(()=>[H(B(o.value?"追加中...":"このキャラクターを所持リストに追加"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]))}},sV=(e,t,n,r,i,s=null)=>{if(!e)return"キャラクター情報なし";const a=n.get(e.characterMasterId),o=a?a.monsterName:"不明",l=e.accountId||s;if(!l)return`${o} (アカウント不明)`;const u=(r.get(l)||[]).filter(t=>t.characterMasterId===e.characterMasterId).findIndex(t=>t.id===e.id);let c=`${o} (${u>=0?u+1:"？"}体目)`;{const t=SC(e.items||[]).map(e=>i.get(e.itemId)).filter(Boolean).join("、");t&&(c+=`[${t}]`)}return c},aV={class:"pa-6"},oV={class:"d-flex align-center mb-6"},lV={class:"mb-4"},uV={class:"d-flex align-center mb-3"},cV={class:"mb-4"},dV={class:"d-flex align-center mb-3"},hV={class:"text-center mb-4"},pV={class:"text-center mb-4"},fV={key:0,class:"text-center pa-4"},mV={key:1,class:"text-center pa-4"},vV={key:2},gV={class:"mb-3"},yV={class:"text-center mb-4"},bV={class:"d-flex justify-center"},wV={__name:"ManageItemsTab",emits:["items-updated","items-moved"],setup(e,{emit:n}){const r=PC(),i=RC(),a=n,o=s({selectedOwnedId:null,items:[]}),l=s({from:{selectedId:null},to:{selectedId:null},selectedItemIds:[],itemFilter:null}),u=t(!1),c=t(!1),h=f(()=>{if(!i.selectedAccountId||!r.ownedCharactersData.has(i.selectedAccountId))return[];return(r.ownedCharactersData.get(i.selectedAccountId)||[]).map(e=>{const t=r.characterMastersMap.get(e.characterMasterId);return{...e,id:e.id,indexNumber:(null==t?void 0:t.indexNumber)||999999,monsterName:(null==t?void 0:t.monsterName)||"不明"}}).sort((e,t)=>e.indexNumber-t.indexNumber)}),p=f(()=>{let e=[...h.value];if(l.itemFilter){const t=Number(l.itemFilter);e=e.filter(e=>{if(!e.items||0===e.items.length)return!1;return IC(e.items).some(e=>e.itemId===t&&!e.isVirtual)}),e.sort((e,n)=>{const r=IC(e.items||[]),i=IC(n.items||[]),s=r.find(e=>e.itemId===t),a=i.find(e=>e.itemId===t),o=(null==s?void 0:s.willRemove)||!1,l=(null==a?void 0:a.willRemove)||!1;return o&&!l?-1:!o&&l?1:e.indexNumber-n.indexNumber})}return e}),m=f(()=>h.value),v=f(()=>{if(!l.from.selectedId)return[];const e=m.value.find(e=>e.id===l.from.selectedId);if(!e||!e.items)return[];return SC(e.items).map(e=>({id:e.itemId,name:r.itemMastersMap.get(e.itemId)||`不明(ID:${e.itemId})`}))});d(()=>i.selectedAccountId,()=>{Object.assign(o,{selectedOwnedId:null,items:[]}),Object.assign(l,{from:{selectedId:null},to:{selectedId:null},selectedItemIds:[]})}),d(()=>o.selectedOwnedId,e=>{if(!e)return void(o.items=[]);const t=m.value.find(t=>t.id===e),n=SC((null==t?void 0:t.items)||[]);o.items=n.map(e=>e.itemId)}),d(()=>l.from.selectedId,()=>{l.selectedItemIds=[]});const g=async()=>{if(o.selectedOwnedId){if(o.items.length>3)return alert("アイテムは3つまでです。");u.value=!0;try{const e=o.items.map(e=>({itemId:Number(e),isVirtual:!1}));await CC(i.selectedAccountId,o.selectedOwnedId,e),a("items-updated",{accountId:i.selectedAccountId,ownedCharacterId:o.selectedOwnedId,items:e}),alert("アイテムを更新しました。")}catch(e){alert("エラー: "+e.message)}finally{u.value=!1}}},b=async()=>{c.value=!0;try{const e=l.from.selectedId,t=l.to.selectedId,n=l.selectedItemIds;if(e===t||!e||!t)throw new Error("有効な移動元と移動先を選択してください。");if(0===n.length)throw new Error("移動するアイテムを選択してください。");const r=m.value.find(t=>t.id===e),s=m.value.find(e=>e.id===t);if(!r||!s)throw new Error("キャラクター情報が見つかりません。");const o=SC(r.items||[]),u=SC(s.items||[]);if(u.length+n.length>3)throw new Error("移動先のアイテム所持数が上限を超えます。");const c=o.filter(e=>!n.includes(e.itemId)).map(e=>({itemId:e.itemId,isVirtual:!1})),d=[...u.map(e=>({itemId:e.itemId,isVirtual:!1})),...n.map(e=>({itemId:Number(e),isVirtual:!1}))];await EC(i.selectedAccountId,{id:e,items:c},{id:t,items:d}),a("items-moved",{accountId:i.selectedAccountId,from:{id:e,items:c},to:{id:t,items:d}}),alert("アイテムを移動しました。"),l.from.selectedId=null,l.to.selectedId=null,l.selectedItemIds=[]}catch(e){alert(`エラー: ${e.message}`)}finally{c.value=!1}},w=(e,t)=>sV(e,0,r.characterMastersMap,r.ownedCharactersData,r.itemMastersMap,i.selectedAccountId);return(e,t)=>(G(),q("div",aV,[_("div",oV,[y(GC,{icon:"mdi-sword-cross",size:"32",color:"primary",class:"mr-3"}),t[6]||(t[6]=_("h2",{class:"text-h4 font-weight-bold text-primary"},"アイテム管理",-1))]),y(ZR,null,{default:K(()=>[y(bD,{elevation:"3",rounded:"lg",class:"mb-6"},{default:K(()=>[y(pD,{class:"bg-primary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-update",class:"mr-2"}),t[7]||(t[7]=H(" 所持キャラクターのアイテムを変更 ",-1))]),_:1,__:[7]}),y(gD,{class:"pa-6"},{default:K(()=>[y(SD,null,{default:K(()=>[y(WD,null,{default:K(()=>[y(DD,{cols:"12",md:"6"},{default:K(()=>[_("div",lV,[_("div",uV,[y(GC,{icon:"mdi-account-search",color:"primary",class:"mr-2"}),t[8]||(t[8]=_("h6",{class:"text-h6 font-weight-medium"},"対象キャラクター",-1))]),y(XR,{modelValue:o.selectedOwnedId,"onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedOwnedId=e),items:m.value,label:"変更対象のキャラクターを検索","list-height":"300px",color:"primary","prepend-inner-icon":"mdi-account-search"},{item:K(({item:e})=>[y(Kx,null,{default:K(()=>[H(B(w(e)),1)]),_:2},1024)]),_:1},8,["modelValue","items"])])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[_("div",cV,[_("div",dV,[y(GC,{icon:"mdi-sword-cross",color:"primary",class:"mr-2"}),t[9]||(t[9]=_("h6",{class:"text-h6 font-weight-medium"},"アイテム選択",-1))]),y(YN,{modelValue:o.items,"onUpdate:modelValue":t[1]||(t[1]=e=>o.items=e),items:M(r).itemMasters,"item-title":"name","item-value":"id",label:"アイテム (最大3つまで)",multiple:"",chips:"",clearable:"",variant:"outlined",disabled:!o.selectedOwnedId,color:"primary","prepend-inner-icon":"mdi-sword-cross"},null,8,["modelValue","items","disabled"]),y(lx,{loading:u.value,disabled:!o.selectedOwnedId||u.value||o.items.length>3,onClick:g,color:"primary",block:"",size:"large",variant:"elevated","prepend-icon":"mdi-update",class:"mt-4"},{default:K(()=>[H(B(u.value?"更新中...":"アイテムを更新"),1)]),_:1},8,["loading","disabled"]),o.items.length>3?(G(),W(rD,{key:0,type:"error",variant:"tonal",class:"mt-3","prepend-icon":"mdi-alert-circle"},{default:K(()=>t[10]||(t[10]=[H(" アイテムは3つまでしか選択できません。 ",-1)])),_:1,__:[10]})):X("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),y(bD,{elevation:"3",rounded:"lg"},{default:K(()=>[y(pD,{class:"bg-secondary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-swap-horizontal",class:"mr-2"}),t[11]||(t[11]=H(" キャラクター間でアイテムを移動 ",-1))]),_:1,__:[11]}),y(gD,{class:"pa-6"},{default:K(()=>[y(SD,null,{default:K(()=>[y(WD,{class:"mb-4"},{default:K(()=>[y(DD,{cols:"12"},{default:K(()=>[y(YN,{modelValue:l.itemFilter,"onUpdate:modelValue":t[2]||(t[2]=e=>l.itemFilter=e),items:M(r).itemMasters,"item-title":"name","item-value":"id",label:"アイテムでフィルタ（外す予定のキャラを優先表示）",clearable:"",variant:"outlined",color:"secondary","prepend-inner-icon":"mdi-filter",density:"comfortable"},{"prepend-inner":K(()=>[y(GC,{icon:"mdi-filter",color:"secondary"})]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),y(WD,null,{default:K(()=>[y(DD,{cols:"12",md:"4"},{default:K(()=>[_("div",hV,[y(fE,{size:"48",color:"secondary",class:"mb-2"},{default:K(()=>[y(GC,{icon:"mdi-arrow-left",size:"24",color:"white"})]),_:1}),t[12]||(t[12]=_("h6",{class:"text-h6 font-weight-bold text-secondary"}," 移動元 ",-1))]),y(XR,{modelValue:l.from.selectedId,"onUpdate:modelValue":t[3]||(t[3]=e=>l.from.selectedId=e),items:p.value,label:"移動元キャラクターを検索","list-height":"250px","disabled-items":[l.to.selectedId].filter(Boolean),color:"secondary","prepend-inner-icon":"mdi-account-arrow-left"},{item:K(({item:e})=>[y(Kx,null,{default:K(()=>[H(B(w(e)),1)]),_:2},1024)]),_:1},8,["modelValue","items","disabled-items"])]),_:1}),y(DD,{cols:"12",md:"4"},{default:K(()=>[_("div",pV,[y(fE,{size:"48",color:"info",class:"mb-2"},{default:K(()=>[y(GC,{icon:"mdi-sword-cross",size:"24",color:"white"})]),_:1}),t[13]||(t[13]=_("h6",{class:"text-h6 font-weight-bold text-info"}," 移動するアイテム ",-1))]),y(bD,{elevation:"2",rounded:"lg",style:{height:"318px","overflow-y":"auto"},class:"border-info border"},{default:K(()=>[y(gD,{class:"pa-4"},{default:K(()=>[l.from.selectedId?v.value.length?(G(),q("div",vV,[_("div",gV,[y(NN,{color:"info",variant:"tonal",size:"small",class:"mb-2"},{default:K(()=>[H(B(v.value.length)+"個のアイテム ",1)]),_:1})]),(G(!0),q(N,null,J(v.value,e=>(G(),W(bN,{key:e.id,modelValue:l.selectedItemIds,"onUpdate:modelValue":t[4]||(t[4]=e=>l.selectedItemIds=e),label:e.name,value:e.id,density:"compact","hide-details":"",color:"info",class:"mb-2"},null,8,["modelValue","label","value"]))),128))])):(G(),q("div",mV,[y(GC,{icon:"mdi-inbox-outline",size:"48",color:"grey-lighten-1"}),t[15]||(t[15]=_("div",{class:"mt-2 text-body-2 text-medium-emphasis"}," 移動できるアイテムがありません。 ",-1))])):(G(),q("div",fV,[y(GC,{icon:"mdi-information",size:"48",color:"grey-lighten-1"}),t[14]||(t[14]=_("div",{class:"mt-2 text-body-2 text-medium-emphasis"}," 移動元キャラクターを選択してください。 ",-1))]))]),_:1})]),_:1})]),_:1}),y(DD,{cols:"12",md:"4"},{default:K(()=>[_("div",yV,[y(fE,{size:"48",color:"success",class:"mb-2"},{default:K(()=>[y(GC,{icon:"mdi-arrow-right",size:"24",color:"white"})]),_:1}),t[16]||(t[16]=_("h6",{class:"text-h6 font-weight-bold text-success"},"移動先",-1))]),y(XR,{modelValue:l.to.selectedId,"onUpdate:modelValue":t[5]||(t[5]=e=>l.to.selectedId=e),items:h.value,label:"移動先キャラクターを検索","list-height":"250px","disabled-items":[l.from.selectedId].filter(Boolean),color:"success","prepend-inner-icon":"mdi-account-arrow-right"},{item:K(({item:e})=>[y(Kx,null,{default:K(()=>[H(B(w(e)),1)]),_:2},1024)]),_:1},8,["modelValue","items","disabled-items"])]),_:1})]),_:1}),y(WD,{class:"mt-6"},{default:K(()=>[y(DD,null,{default:K(()=>[_("div",bV,[y(lx,{loading:c.value,disabled:!l.from.selectedId||!l.to.selectedId||0===l.selectedItemIds.length||c.value,onClick:b,color:"success",size:"large",variant:"elevated","prepend-icon":"mdi-swap-horizontal",class:"px-8"},{default:K(()=>[H(B(c.value?"移動中...":"選択したアイテムを移動"),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}},_V={class:"team-list-container",style:{height:"65vh","overflow-y":"auto"}},IV={key:0,class:"text-center pa-8"},SV={key:1,class:"text-center pa-8"},kV=["onClick"],TV={class:"d-flex align-center justify-space-between mb-3"},CV={class:"flex-grow-1"},EV={class:"text-h6 font-weight-bold text-primary mb-1"},xV=["title"],AV=["title"],NV=["title"],DV={__name:"TeamList",props:{dataLoaded:{type:Boolean,required:!0},teams:{type:Array,required:!0},accounts:{type:Array,required:!0},ownedCharactersData:{type:Map,required:!0},characterMastersMap:{type:Map,required:!0},itemMastersMap:{type:Map,required:!0},selectedTeamId:{type:String,default:null}},emits:["select-team","delete-team"],setup(e,{emit:t}){const n=e,r=t,i=["禁忌","天魔(試練)","天魔(庭園)","星墓","轟絶","黎絶"],a=s({type:""}),o=f(()=>a.type?n.teams.filter(e=>e.type===a.type):n.teams),l=(e,t)=>{if(!e.characters||!n.dataLoaded||t>=e.characters.length)return{characterName:"—",accountName:"—",items:[]};const r=e.characters[t],i=n.accounts.find(e=>e.id===r.accountId),s=(n.ownedCharactersData.get(r.accountId)||[]).find(e=>e.id===r.ownedCharacterId);if(!s)return{characterName:"キャラ不明",accountName:(null==i?void 0:i.name)||"不明",items:[]};const a=n.characterMastersMap.get(s.characterMasterId),o=SC(s.items||[]).map(e=>n.itemMastersMap.get(e.itemId)||`不明ID:${e.itemId}`).filter(Boolean);return{characterName:(null==a?void 0:a.monsterName)||"不明",accountName:(null==i?void 0:i.name)||"不明",items:o}};return(t,n)=>(G(),W(bD,{class:"h-100",elevation:"3",rounded:"lg"},{default:K(()=>[y(pD,{class:"bg-primary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-format-list-bulleted",class:"mr-2"}),n[1]||(n[1]=H(" 編成一覧 ",-1))]),_:1,__:[1]}),y(gD,{class:"pa-4"},{default:K(()=>[y(YN,{modelValue:a.type,"onUpdate:modelValue":n[0]||(n[0]=e=>a.type=e),items:["",...i],label:"タイプで絞り込み",variant:"outlined",clearable:"",density:"compact","prepend-inner-icon":"mdi-filter",class:"mb-4",color:"primary"},null,8,["modelValue","items"]),_("div",_V,[e.dataLoaded?0===o.value.length?(G(),q("div",SV,[y(GC,{icon:"mdi-inbox-outline",size:"64",color:"grey-lighten-1"}),n[3]||(n[3]=_("div",{class:"mt-3 text-body-1 text-medium-emphasis"}," 該当する編成がありません ",-1))])):X("",!0):(G(),q("div",IV,[y(AE,{indeterminate:"",color:"primary",size:"48"}),n[2]||(n[2]=_("div",{class:"mt-3 text-body-1 text-medium-emphasis"}," データを読み込んでいます... ",-1))])),(G(!0),q(N,null,J(o.value,t=>{return G(),q("div",{key:t.id,onClick:e=>(e=>{r("select-team",e)})(t),class:w(["team-item mb-3 pa-4 rounded-lg cursor-pointer transition-all",e.selectedTeamId===t.id?"bg-primary-lighten-5 border-primary border-2":"bg-grey-lighten-5 border-grey-lighten-3 border"]),style:{"min-height":"120px"}},[_("div",TV,[_("div",CV,[_("h3",EV,B(t.name),1),y(NN,{color:(n=t.type,{"禁忌":"deep-purple","天魔(試練)":"red-darken-2","天魔(庭園)":"green-darken-2","星墓":"blue-darken-2","轟絶":"orange-darken-2","黎絶":"blue-darken-2"}[n]||"grey"),size:"small",variant:"tonal",class:"font-weight-medium"},{default:K(()=>[H(B(t.type),1)]),_:2},1032,["color"])]),y(lx,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:ee(e=>{return n=t.id,void r("delete-team",n);var n},["stop"]),class:"ml-2"},null,8,["onClick"])]),y(WD,{dense:""},{default:K(()=>[(G(!0),q(N,null,J(Array(4),(e,n)=>(G(),W(DD,{key:n,cols:"3"},{default:K(()=>[_("div",{class:w(["character-slot pa-2 rounded text-center","—"!==l(t,n).characterName?"bg-white":"bg-grey-lighten-4"])},[_("div",{class:"text-caption font-weight-bold text-truncate mb-1",title:l(t,n).characterName},B(l(t,n).characterName),9,xV),_("div",{class:"text-caption text-truncate mb-1",title:l(t,n).accountName},B(l(t,n).accountName),9,AV),y(cx,{class:"my-1"}),(G(),q(N,null,J(4,e=>_("div",{key:e,class:"text-caption text-truncate",title:l(t,n).items[e-1]},B(l(t,n).items[e-1]||"—"),9,NV)),64))],2)]),_:2},1024))),128))]),_:2},1024)],10,kV);var n}),128))])]),_:1})]),_:1}))}},PV={class:"character-formation-section"},RV={class:"d-flex align-center mb-4"},VV={class:"d-flex align-center mb-4"},OV={class:"text-white font-weight-bold"},MV={class:"text-h6 font-weight-bold"},LV={key:1,class:"pa-8 text-center"},FV={__name:"TeamForm",props:{team:{type:Object,required:!0},accounts:{type:Array,required:!0},ownedCharactersData:{type:Map,required:!0},characterMastersMap:{type:Map,required:!0},itemMastersMap:{type:Map,required:!0},isSaving:{type:Boolean,default:!1}},emits:["save-team","reset-form","update:team"],setup(e,{emit:t}){const n=e,r=t,i=(e,t)=>{const i=JSON.parse(JSON.stringify(n.team));i[e]=t,r("update:team",i)},s=(e,t,i)=>{const s={...n.team,slots:n.team.slots.map((n,r)=>r===e?{...n,[t]:i}:n)};"selectedAccountId"===t&&(s.slots[e].selectedOwnedId=null),r("update:team",s)},a=["禁忌","天魔(試練)","天魔(庭園)","星墓","轟絶","黎絶"],o=f(()=>n.team.name&&n.team.type&&n.team.slots.every(e=>e.selectedAccountId&&e.selectedOwnedId)),l=e=>{if(!e.selectedAccountId)return[];return(n.ownedCharactersData.get(e.selectedAccountId)||[]).map(t=>{const r=n.characterMastersMap.get(t.characterMasterId);return{...t,accountId:e.selectedAccountId,indexNumber:(null==r?void 0:r.indexNumber)||999999,monsterName:(null==r?void 0:r.monsterName)||"不明"}}).sort((e,t)=>e.indexNumber-t.indexNumber)};return(t,r)=>(G(),W(bD,{class:"h-100",elevation:"3",rounded:"lg"},{default:K(()=>[y(pD,{class:"bg-primary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-account-edit",class:"mr-2"}),H(" "+B(e.team.id?"編成編集":"新規編成作成"),1)]),_:1}),y(hD,{class:"pa-4 bg-grey-lighten-5"},{default:K(()=>[y(lx,{onClick:r[0]||(r[0]=e=>t.$emit("reset-form")),size:"small",variant:"tonal",color:"primary","prepend-icon":"mdi-plus"},{default:K(()=>r[4]||(r[4]=[H(" 新規作成フォームを開く ",-1)])),_:1,__:[4]})]),_:1}),e.accounts.length>0&&e.ownedCharactersData.size>0&&e.characterMastersMap.size>0?(G(),q(N,{key:0},[y(gD,{class:"pa-6"},{default:K(()=>[y(UN,{"model-value":e.team.name,"onUpdate:modelValue":r[1]||(r[1]=e=>i("name",e)),label:"編成名",variant:"outlined",placeholder:"例: 天魔の孤城 第1の間",class:"mb-6",color:"primary","prepend-inner-icon":"mdi-format-title"},null,8,["model-value"]),y(YN,{"model-value":e.team.type,"onUpdate:modelValue":r[2]||(r[2]=e=>i("type",e)),items:a,label:"タイプ",variant:"outlined",class:"mb-8",color:"primary","prepend-inner-icon":"mdi-tag"},null,8,["model-value"]),_("div",PV,[_("div",RV,[y(GC,{icon:"mdi-account-multiple",color:"primary",class:"mr-2"}),r[5]||(r[5]=_("h4",{class:"text-h5 font-weight-bold text-primary"}," キャラクター編成 (4体) ",-1))]),y(WD,null,{default:K(()=>[(G(!0),q(N,null,J(e.team.slots,(t,r)=>(G(),W(DD,{key:r,cols:"12",md:"6"},{default:K(()=>[y(bD,{elevation:"2",class:w(["pa-4 h-100 character-slot-card",t.selectedAccountId?"border-primary border-2":"border-grey-lighten-3 border"]),rounded:"lg",style:{"min-height":"400px"}},{default:K(()=>{return[_("div",VV,[y(fE,{size:"32",color:"primary",class:"mr-3"},{default:K(()=>[_("span",OV,B(r+1),1)]),_:2},1024),_("h5",MV," スロット "+B(r+1),1)]),y(YN,{"model-value":t.selectedAccountId,"onUpdate:modelValue":e=>s(r,"selectedAccountId",e),items:e.accounts,"item-title":"name","item-value":"id",label:"アカウント",variant:"outlined",density:"compact",class:"mb-3",color:"primary","prepend-inner-icon":"mdi-account"},null,8,["model-value","onUpdate:modelValue","items"]),y(XR,{"model-value":t.selectedOwnedId,"onUpdate:modelValue":e=>((e,t)=>{s(e,"selectedOwnedId",t)})(r,e),items:l(t),label:"キャラクターを選択","list-height":"280px",variant:"filled",disabled:!t.selectedAccountId,"disabled-items":(i=r,n.team.slots.filter((e,t)=>t!==i&&e.selectedOwnedId).map(e=>e.selectedOwnedId)),"no-data-text":"先にアカウントを選択",density:"comfortable","list-density":"comfortable","primary-color":"primary","search-bg-color":"grey-lighten-5","card-elevation":2,"prepend-inner-icon":"mdi-account-search"},{item:K(({item:e})=>[y(Kx,null,{default:K(()=>{return[H(B((t=e,sV(t,0,n.characterMastersMap,n.ownedCharactersData,n.itemMastersMap,t.accountId))),1)];var t}),_:2},1024)]),_:2},1032,["model-value","onUpdate:modelValue","items","disabled","disabled-items"])];var i}),_:2},1032,["class"])]),_:2},1024))),128))]),_:1})])]),_:1}),y(cD,{class:"pa-6 bg-grey-lighten-5"},{default:K(()=>[y(QD),y(lx,{loading:e.isSaving,disabled:!o.value||e.isSaving,onClick:r[3]||(r[3]=e=>t.$emit("save-team")),color:"primary",size:"large",variant:"elevated","prepend-icon":"mdi-content-save",class:"px-8"},{default:K(()=>[H(B(e.isSaving?"保存中...":e.team.id?"編成を更新":"編成を保存"),1)]),_:1},8,["loading","disabled"])]),_:1})],64)):(G(),q("div",LV,[y(AE,{indeterminate:"",color:"primary",size:"48"}),r[6]||(r[6]=_("div",{class:"mt-3 text-body-1 text-medium-emphasis"}," データを読み込んでいます... ",-1))]))]),_:1}))}},BV={class:"pa-6"},UV={class:"d-flex align-center mb-6"},$V=VC({__name:"ManageTeamsTab",emits:["team-added","team-updated","team-deleted"],setup(e,{emit:n}){const r=PC();RC();const i=_C(),a=n,o=t(!1),l=()=>({id:null,name:"",type:"",slots:Array(4).fill().map(()=>({selectedAccountId:"",selectedOwnedId:"",characterSearch:""}))}),u=s(l()),c=e=>{Object.assign(u,e)},d=e=>{Object.assign(u,{id:e.id,name:e.name,type:e.type,slots:JSON.parse(JSON.stringify(e.characters.map(e=>({selectedAccountId:e.accountId,selectedOwnedId:e.ownedCharacterId,characterSearch:""}))))})},h=()=>{Object.assign(u,l())},p=async()=>{if(!(u.name&&u.type&&u.slots.every(e=>e.selectedAccountId&&e.selectedOwnedId)))return void alert("編成名、タイプ、4体のキャラを全て選択してください。");o.value=!0;const e={userId:i.userId,name:u.name,type:u.type,characters:u.slots.map(e=>({accountId:e.selectedAccountId,ownedCharacterId:e.selectedOwnedId}))};try{const t=u.id;Object.assign(e,t?{updatedAt:jT()}:{createdAt:jT()});const n=await NC(t,e);if(t)a("team-updated",{...e,id:t}),alert("編成を更新しました。");else{const t={...e,id:n.id,createdAt:{toDate:()=>new Date}};a("team-added",t),alert("編成を保存しました。"),h()}}catch(t){alert("エラー: "+t.message)}finally{o.value=!1}},f=async e=>{if(confirm("この編成を本当に削除しますか？"))try{await DC(e),a("team-deleted",e),alert("編成を削除しました。"),u.id===e&&h()}catch(t){alert("エラー: "+t.message)}};return(e,t)=>(G(),q("div",BV,[_("div",UV,[y(GC,{icon:"mdi-account-group",size:"32",color:"primary",class:"mr-3"}),t[0]||(t[0]=_("h2",{class:"text-h4 font-weight-bold text-primary"},"編成管理",-1))]),y(WD,null,{default:K(()=>[y(DD,{cols:"12",lg:"5"},{default:K(()=>[y(DV,{"data-loaded":M(r).dataLoaded,teams:M(r).teams,accounts:M(r).accounts,"owned-characters-data":M(r).ownedCharactersData,"character-masters-map":M(r).characterMastersMap,"item-masters-map":M(r).itemMastersMap,"selected-team-id":u.id,onSelectTeam:d,onDeleteTeam:f},null,8,["data-loaded","teams","accounts","owned-characters-data","character-masters-map","item-masters-map","selected-team-id"])]),_:1}),y(DD,{cols:"12",lg:"7"},{default:K(()=>[y(FV,{team:u,accounts:M(r).accounts,"owned-characters-data":M(r).ownedCharactersData,"character-masters-map":M(r).characterMastersMap,"item-masters-map":M(r).itemMastersMap,"is-saving":o.value,onSaveTeam:p,onResetForm:h,"onUpdate:team":c},null,8,["team","accounts","owned-characters-data","character-masters-map","item-masters-map","is-saving"])]),_:1})]),_:1})]))}},[["__scopeId","data-v-b6817dbf"]]),jV={class:"pa-6"},zV={class:"d-flex align-center mb-6"},qV={__name:"AddMasterCharacterTab",emits:["master-added"],setup(e,{emit:n}){const r=PC();RC();const i=n,a=s({no:"",name:"",element:"",type:"恒常",gacha:""}),o=t(!1),l=async()=>{if(!a.name)return alert("キャラクター名は必須です。");o.value=!0;try{const e={indexNumber:a.no?Number(a.no):0,monsterName:a.name,element:a.element||"",type:a.type||"恒常",ejectionGacha:a.gacha||""};await xC(e),alert("マスターを追加しました。ページをリロードして反映してください。"),i("master-added")}catch(e){alert("エラー: "+e.message)}finally{o.value=!1}};return(e,t)=>(G(),q("div",jV,[_("div",zV,[y(GC,{icon:"mdi-account-plus",size:"32",color:"primary",class:"mr-3"}),t[5]||(t[5]=_("h2",{class:"text-h4 font-weight-bold text-primary"}," キャラクターマスター新規追加 ",-1))]),y(ZR,{onSubmit:ee(l,["prevent"])},{default:K(()=>[y(bD,{elevation:"3",rounded:"lg"},{default:K(()=>[y(pD,{class:"bg-primary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-account-plus",class:"mr-2"}),t[6]||(t[6]=H(" 新規キャラクター情報 ",-1))]),_:1,__:[6]}),y(gD,{class:"pa-6"},{default:K(()=>[y(SD,null,{default:K(()=>[y(WD,null,{default:K(()=>[y(DD,{cols:"12",md:"6"},{default:K(()=>[y(UN,{modelValue:a.no,"onUpdate:modelValue":t[0]||(t[0]=e=>a.no=e),modelModifiers:{number:!0},label:"図鑑番号",type:"number",placeholder:"例: 1234",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-numeric",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(UN,{modelValue:a.name,"onUpdate:modelValue":t[1]||(t[1]=e=>a.name=e),modelModifiers:{trim:!0},label:"キャラクター名",required:"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-account",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(YN,{modelValue:a.element,"onUpdate:modelValue":t[2]||(t[2]=e=>a.element=e),items:["火","水","木","光","闇"],label:"属性",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-fire",clearable:"",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(YN,{modelValue:a.type,"onUpdate:modelValue":t[3]||(t[3]=e=>a.type=e),items:["恒常","限定","コラボ","α"],label:"分類",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-tag",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12"},{default:K(()=>[y(YN,{modelValue:a.gacha,"onUpdate:modelValue":t[4]||(t[4]=e=>a.gacha=e),items:M(r).gachaMasters,"item-title":"name","item-value":"name",label:"排出ガチャ (限定の場合)",placeholder:"(限定ではない/その他)",clearable:"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-gift",class:"mb-4"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),y(cD,{class:"pa-6 bg-grey-lighten-5"},{default:K(()=>[y(QD),y(lx,{loading:o.value,disabled:!a.name||o.value,onClick:l,color:"primary",size:"large",variant:"elevated","prepend-icon":"mdi-content-save",class:"px-8"},{default:K(()=>[H(B(o.value?"追加中...":"マスターリストに新規追加"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]))}},GV={class:"pa-6"},KV={class:"d-flex align-center mb-6"},HV={__name:"EditMasterCharacterTab",emits:["master-updated"],setup(e,{emit:n}){const r=PC();RC();const i=n,a=s({search:"",selectedMasterId:null,no:"",name:"",element:"",type:"",gacha:""}),o=t(!1);d(()=>a.selectedMasterId,e=>{if(!e)return void Object.assign(a,{name:"",no:"",element:"",type:"",gacha:""});const t=r.characterMastersMap.get(e);t&&Object.assign(a,{name:t.monsterName,no:t.indexNumber,element:t.element,type:t.type,gacha:t.ejectionGacha})});const l=async()=>{if(!a.selectedMasterId||!a.name)return alert("キャラを選択し名前を入力してください。");o.value=!0;try{const e={monsterName:a.name,indexNumber:a.no?Number(a.no):0,element:a.element,type:a.type,ejectionGacha:a.gacha};await AC(a.selectedMasterId,e),alert("マスター情報を更新しました。ページをリロードしてください。"),i("master-updated")}catch(e){alert("更新に失敗: "+e.message)}finally{o.value=!1}};return(e,t)=>(G(),q("div",GV,[_("div",KV,[y(GC,{icon:"mdi-account-edit",size:"32",color:"primary",class:"mr-3"}),t[6]||(t[6]=_("h2",{class:"text-h4 font-weight-bold text-primary"}," キャラクターマスター編集 ",-1))]),y(ZR,null,{default:K(()=>[y(SD,{class:"pa-0"},{default:K(()=>[y(WD,null,{default:K(()=>[y(DD,{cols:"12"},{default:K(()=>[y(bD,{elevation:"2",rounded:"lg",class:"mb-4"},{default:K(()=>[y(pD,{class:"bg-primary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-account-search",class:"mr-2"}),t[7]||(t[7]=H(" 編集対象キャラクター選択 ",-1))]),_:1,__:[7]}),y(gD,{class:"pa-4"},{default:K(()=>[y(XR,{modelValue:a.selectedMasterId,"onUpdate:modelValue":t[0]||(t[0]=e=>a.selectedMasterId=e),items:M(r).characterMasters,"item-title":e=>`[${e.indexNumber||"?"}] ${e.monsterName}`,label:"編集したいキャラクター名で検索","list-height":"300px",color:"primary","prepend-inner-icon":"mdi-account-search"},null,8,["modelValue","items","item-title"])]),_:1})]),_:1})]),_:1})]),_:1}),a.selectedMasterId?(G(),W(WD,{key:0,class:"mt-4"},{default:K(()=>[y(DD,{cols:"12"},{default:K(()=>[y(bD,{elevation:"3",rounded:"lg"},{default:K(()=>[y(pD,{class:"bg-secondary text-white pa-4"},{default:K(()=>[y(GC,{icon:"mdi-account-edit",class:"mr-2"}),t[8]||(t[8]=H(" 編集フォーム ",-1))]),_:1,__:[8]}),y(gD,{class:"pa-6"},{default:K(()=>[y(SD,null,{default:K(()=>[y(WD,null,{default:K(()=>[y(DD,{cols:"12",md:"6"},{default:K(()=>[y(UN,{modelValue:a.no,"onUpdate:modelValue":t[1]||(t[1]=e=>a.no=e),modelModifiers:{number:!0},label:"図鑑番号",type:"number",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-numeric",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(UN,{modelValue:a.name,"onUpdate:modelValue":t[2]||(t[2]=e=>a.name=e),modelModifiers:{trim:!0},label:"キャラクター名",required:"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-account",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(YN,{modelValue:a.element,"onUpdate:modelValue":t[3]||(t[3]=e=>a.element=e),items:["火","水","木","光","闇"],label:"属性",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-fire",clearable:"",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12",md:"6"},{default:K(()=>[y(YN,{modelValue:a.type,"onUpdate:modelValue":t[4]||(t[4]=e=>a.type=e),items:["恒常","限定","コラボ","イベント"],label:"分類",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-tag",class:"mb-4"},null,8,["modelValue"])]),_:1}),y(DD,{cols:"12"},{default:K(()=>[y(YN,{modelValue:a.gacha,"onUpdate:modelValue":t[5]||(t[5]=e=>a.gacha=e),items:M(r).gachaMasters,"item-title":"name","item-value":"name",label:"排出ガチャ (限定の場合)",placeholder:"(限定ではない/その他)",clearable:"",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-gift",class:"mb-4"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),y(cD,{class:"pa-6 bg-grey-lighten-5"},{default:K(()=>[y(QD),y(lx,{loading:o.value,disabled:!a.selectedMasterId||o.value,onClick:l,color:"primary",size:"large",variant:"elevated","prepend-icon":"mdi-content-save",class:"px-8"},{default:K(()=>[H(B(o.value?"更新中...":"マスター情報を更新"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})):X("",!0)]),_:1})]),_:1})]))}},WV=oe({..._e(),...Je(jt(),["fullHeight"]),...we()},"VApp"),QV=ae()({name:"VApp",props:WV(),setup(e,t){let{slots:n}=t;const r=xe(e),{layoutClasses:i,getLayoutItem:s,items:a,layoutRef:o}=$t({...e,fullHeight:!0}),{rtlClasses:l}=Oe();return be(()=>{var t;return _("div",{ref:o,class:w(["v-application",r.themeClasses.value,i.value,l.value,e.class]),style:b([e.style])},[_("div",{class:"v-application__wrap"},[null==(t=n.default)?void 0:t.call(n)])])}),{getLayoutItem:s,items:a,theme:r}}}),YV=oe({text:String,..._e(),...zC()},"VToolbarTitle"),XV=ae()({name:"VToolbarTitle",props:YV(),setup(e,t){let{slots:n}=t;return be(()=>{const t=!!(n.default||n.text||e.text);return y(e.tag,{class:w(["v-toolbar-title",e.class]),style:b(e.style)},{default:()=>{var r;return[t&&_("div",{class:"v-toolbar-title__placeholder"},[n.text?n.text():e.text,null==(r=n.default)?void 0:r.call(n)])]}})}),{}}}),JV=[null,"prominent","default","comfortable","compact"],ZV=oe({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>JV.includes(e)},extended:{type:Boolean,default:null},extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...iE(),..._e(),...mE(),...YC(),...zC({tag:"header"}),...we()},"VToolbar"),eO=ae()({name:"VToolbar",props:ZV(),setup(e,t){var n;let{slots:r}=t;const{backgroundColorClasses:i,backgroundColorStyles:s}=BC(()=>e.color),{borderClasses:a}=sE(e),{elevationClasses:o}=vE(e),{roundedClasses:l}=XC(e),{themeClasses:u}=xe(e),{rtlClasses:c}=Oe(),d=v(null===e.extended?!!(null==(n=r.extension)?void 0:n.call(r)):e.extended),h=f(()=>parseInt(Number(e.height)+("prominent"===e.density?Number(e.height):0)-("comfortable"===e.density?8:0)-("compact"===e.density?16:0),10)),p=f(()=>d.value?parseInt(Number(e.extensionHeight)+("prominent"===e.density?Number(e.extensionHeight):0)-("comfortable"===e.density?4:0)-("compact"===e.density?8:0),10):0);return le({VBtn:{variant:"text"}}),be(()=>{var t;const n=!(!e.title&&!r.title),f=!(!r.image&&!e.image),m=null==(t=r.extension)?void 0:t.call(r);return d.value=null===e.extended?!!m:e.extended,y(e.tag,{class:w(["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},i.value,a.value,o.value,l.value,u.value,c.value,e.class]),style:b([s.value,e.style])},{default:()=>[f&&_("div",{key:"image",class:"v-toolbar__image"},[r.image?y(MC,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},r.image):y(rE,{key:"image-img",cover:!0,src:e.image},null)]),y(MC,{defaults:{VTabs:{height:ve(h.value)}}},{default:()=>{var t,i,s;return[_("div",{class:"v-toolbar__content",style:{height:ve(h.value)}},[r.prepend&&_("div",{class:"v-toolbar__prepend"},[null==(t=r.prepend)?void 0:t.call(r)]),n&&y(XV,{key:"title",text:e.title},{text:r.title}),null==(i=r.default)?void 0:i.call(r),r.append&&_("div",{class:"v-toolbar__append"},[null==(s=r.append)?void 0:s.call(r)])])]}}),y(MC,{defaults:{VTabs:{height:ve(p.value)}}},{default:()=>[y(Ix,null,{default:()=>[d.value&&_("div",{class:"v-toolbar__extension",style:{height:ve(p.value)}},[m])]})]})]})}),{contentHeight:h,extensionHeight:p}}}),tO=oe({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");const nO=oe({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...ZV(),...qt(),...tO(),height:{type:[Number,String],default:64}},"VAppBar"),rO=ae()({name:"VAppBar",props:nO(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:r}=n;const i=t(),s=Ae(e,"modelValue"),a=f(()=>{var t;const n=new Set((null==(t=e.scrollBehavior)?void 0:t.split(" "))??[]);return{hide:n.has("hide"),fullyHide:n.has("fully-hide"),inverted:n.has("inverted"),collapse:n.has("collapse"),elevate:n.has("elevate"),fadeImage:n.has("fade-image")}}),o=f(()=>{const e=a.value;return e.hide||e.fullyHide||e.inverted||e.collapse||e.elevate||e.fadeImage||!s.value}),{currentScroll:l,scrollThreshold:u,isScrollingUp:c,scrollRatio:h}=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{canScroll:r}=n;let i=0,s=0;const a=t(null),o=v(0),l=v(0),u=v(0),c=v(!1),h=v(!1),p=f(()=>Number(e.scrollThreshold)),m=f(()=>Ve((p.value-o.value)/p.value||0)),g=()=>{const e=a.value;if(!e||r&&!r.value)return;i=o.value,o.value="window"in e?e.pageYOffset:e.scrollTop;const t=e instanceof Window?document.documentElement.scrollHeight:e.scrollHeight;s===t?(h.value=o.value<i,u.value=Math.abs(o.value-p.value)):s=t};return d(h,()=>{l.value=l.value||o.value}),d(c,()=>{l.value=0}),P(()=>{d(()=>e.scrollTarget,e=>{var t;const n=e?document.querySelector(e):window;n&&n!==a.value&&(null==(t=a.value)||t.removeEventListener("scroll",g),a.value=n,a.value.addEventListener("scroll",g,{passive:!0}))},{immediate:!0})}),E(()=>{var e;null==(e=a.value)||e.removeEventListener("scroll",g)}),r&&d(r,g,{immediate:!0}),{scrollThreshold:p,currentScroll:o,currentThreshold:u,isScrollActive:c,scrollRatio:m,isScrollingUp:h,savedScroll:l}}(e,{canScroll:o}),p=x(()=>a.value.hide||a.value.fullyHide),m=f(()=>e.collapse||a.value.collapse&&(a.value.inverted?h.value>0:0===h.value)),g=f(()=>e.flat||a.value.fullyHide&&!s.value||a.value.elevate&&(a.value.inverted?l.value>0:0===l.value)),b=f(()=>a.value.fadeImage?a.value.inverted?1-h.value:h.value:void 0),w=f(()=>{var e,t;if(a.value.hide&&a.value.inverted)return 0;const n=(null==(e=i.value)?void 0:e.contentHeight)??0,r=(null==(t=i.value)?void 0:t.extensionHeight)??0;return p.value?l.value<u.value||a.value.fullyHide?n+r:n:n+r});et(()=>!!e.scrollBehavior,()=>{L(()=>{p.value?a.value.inverted?s.value=l.value>u.value:s.value=c.value||l.value<u.value:s.value=!0})});const{ssrBootStyles:_}=Ux(),{layoutItemStyles:I}=zt({id:e.name,order:f(()=>parseInt(e.order,10)),position:x(()=>e.location),layoutSize:w,elementSize:v(void 0),active:s,absolute:x(()=>e.absolute)});return be(()=>{const t=eO.filterProps(e);return y(eO,k({ref:i,class:["v-app-bar",{"v-app-bar--bottom":"bottom"===e.location},e.class],style:[{...I.value,"--v-toolbar-image-opacity":b.value,height:void 0,..._.value},e.style]},t,{collapse:m.value,flat:g.value}),r)}),{}}}),iO=oe({scrollable:Boolean,..._e(),...KC(),...zC({tag:"main"})},"VMain"),sO=ae()({name:"VMain",props:iO(),setup(e,t){let{slots:n}=t;const{dimensionStyles:r}=HC(e),{mainStyles:i}=Gt(),{ssrBootStyles:s}=Ux();return be(()=>y(e.tag,{class:w(["v-main",{"v-main--scrollable":e.scrollable},e.class]),style:b([i.value,s.value,r.value,e.style])},{default:()=>{var t,r;return[e.scrollable?_("div",{class:"v-main__scroller"},[null==(t=n.default)?void 0:t.call(n)]):null==(r=n.default)?void 0:r.call(n)]}})),{}}});const aO=oe({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...DE({location:"bottom"}),...BE(),...YC(),...dE(),...we(),...Je(BA({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),oO=ae()({name:"VSnackbar",props:aO(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:i}=n;const s=Ae(e,"modelValue"),{positionClasses:a}=UE(e),{scopeId:o}=NA(),{themeClasses:l}=xe(e),{colorClasses:u,colorStyles:p,variantClasses:m}=hE(e),{roundedClasses:g}=XC(e),b=function(e){const t=v(e());let n=-1;function r(){clearInterval(n)}return c(r),{clear:r,time:t,start:function(i){const s=i?getComputedStyle(i):{transitionDuration:.2},a=1e3*parseFloat(s.transitionDuration)||200;if(r(),t.value<=0)return;const o=performance.now();n=window.setInterval(()=>{const n=performance.now()-o+a;t.value=Math.max(e()-n,0),t.value<=0&&r()},a)},reset:function(){r(),h(()=>t.value=e())}}}(()=>Number(e.timeout)),w=t(),I=t(),S=v(!1),T=v(0),C=t(),E=r(Kt,void 0);et(()=>!!E,()=>{const e=Gt();L(()=>{C.value=e.mainStyles.value})}),d(s,A),d(()=>e.timeout,A),P(()=>{s.value&&A()});let x=-1;function A(){b.reset(),window.clearTimeout(x);const t=Number(e.timeout);if(!s.value||-1===t)return;const n=Ht(I.value);b.start(n),x=window.setTimeout(()=>{s.value=!1},t)}function N(){S.value=!0,b.reset(),window.clearTimeout(x)}function D(){S.value=!1,A()}function R(e){T.value=e.touches[0].clientY}function V(e){Math.abs(T.value-e.changedTouches[0].clientY)>50&&(s.value=!1)}function O(){S.value&&D()}const M=f(()=>e.location.split(" ").reduce((e,t)=>(e[`v-snackbar--${t}`]=!0,e),{}));return be(()=>{const t=UA.filterProps(e),n=!!(i.default||i.text||e.text);return y(UA,k({ref:w,class:["v-snackbar",{"v-snackbar--active":s.value,"v-snackbar--multi-line":e.multiLine&&!e.vertical,"v-snackbar--timer":!!e.timer,"v-snackbar--vertical":e.vertical},M.value,a.value,e.class],style:[C.value,e.style]},t,{modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,contentProps:k({class:["v-snackbar__wrapper",l.value,u.value,g.value,m.value],style:[p.value],onPointerenter:N,onPointerleave:D},t.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0,onTouchstartPassive:R,onTouchend:V,onAfterLeave:O},o),{default:()=>{var t,r;return[cE(!1,"v-snackbar"),e.timer&&!S.value&&_("div",{key:"timer",class:"v-snackbar__timer"},[y(VE,{ref:I,color:"string"==typeof e.timer?e.timer:"info",max:e.timeout,modelValue:b.time.value},null)]),n&&_("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[(null==(t=i.text)?void 0:t.call(i))??e.text,null==(r=i.default)?void 0:r.call(i)]),i.actions&&y(MC,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[_("div",{class:"v-snackbar__actions"},[i.actions({isActive:s})])]})]},activator:i.activator})}),zA({},w)}}),lO=Symbol.for("vuetify:v-tabs"),uO=oe({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Je(ox({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),cO=ae()({name:"VTab",props:uO(),setup(e,n){let{slots:r,attrs:i}=n;const{textColorClasses:s,textColorStyles:a}=FC(()=>e.sliderColor),o=t(),l=t(),u=f(()=>"horizontal"===e.direction),c=f(()=>{var e,t;return(null==(t=null==(e=o.value)?void 0:e.group)?void 0:t.isSelected.value)??!1});function d(e){var t,n;let{value:r}=e;if(r){const e=null==(n=null==(t=o.value)?void 0:t.$el.parentElement)?void 0:n.querySelector(".v-tab--selected .v-tab__slider"),r=l.value;if(!e||!r)return;const i=getComputedStyle(e).color,s=e.getBoundingClientRect(),a=r.getBoundingClientRect(),c=u.value?"x":"y",d=u.value?"X":"Y",h=u.value?"right":"bottom",p=u.value?"width":"height",f=s[c]>a[c]?s[h]-a[h]:s[c]-a[c],m=Math.sign(f)>0?u.value?"right":"bottom":Math.sign(f)<0?u.value?"left":"top":"center",v=(Math.abs(f)+(Math.sign(f)<0?s[p]:a[p]))/Math.max(s[p],a[p])||0,g=s[p]/a[p]||0,y=1.5;Be(r,{backgroundColor:[i,"currentcolor"],transform:[`translate${d}(${f}px) scale${d}(${g})`,`translate${d}(${f/y}px) scale${d}(${(v-1)/y+1})`,"none"],transformOrigin:Array(3).fill(m)},{duration:225,easing:$e})}}return be(()=>{const t=lx.filterProps(e);return y(lx,k({symbol:lO,ref:o,class:["v-tab",e.class],style:e.style,tabindex:c.value?0:-1,role:"tab","aria-selected":String(c.value),active:!1},t,i,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":d}),{...r,default:()=>{var t;return _(N,null,[(null==(t=r.default)?void 0:t.call(r))??e.text,!e.hideSlider&&_("div",{ref:l,class:w(["v-tab__slider",s.value]),style:b(a.value)},null)])}})}),zA({},o)}});function dO(e,t){var n;const r=e.changedTouches[0];t.touchendX=r.clientX,t.touchendY=r.clientY,null==(n=t.end)||n.call(t,{originalEvent:e,...t}),(e=>{const{touchstartX:t,touchendX:n,touchstartY:r,touchendY:i}=e;e.offsetX=n-t,e.offsetY=i-r,Math.abs(e.offsetY)<.5*Math.abs(e.offsetX)&&(e.left&&n<t-16&&e.left(e),e.right&&n>t+16&&e.right(e)),Math.abs(e.offsetX)<.5*Math.abs(e.offsetY)&&(e.up&&i<r-16&&e.up(e),e.down&&i>r+16&&e.down(e))})(t)}const hO={mounted:function(e,t){var n;const r=t.value,i=(null==r?void 0:r.parent)?e.parentElement:e,s=(null==r?void 0:r.options)??{passive:!0},a=null==(n=t.instance)?void 0:n.$.uid;if(!i||!a)return;const o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:e=>function(e,t){var n;const r=e.changedTouches[0];t.touchstartX=r.clientX,t.touchstartY=r.clientY,null==(n=t.start)||n.call(t,{originalEvent:e,...t})}(e,t),touchend:e=>dO(e,t),touchmove:e=>function(e,t){var n;const r=e.changedTouches[0];t.touchmoveX=r.clientX,t.touchmoveY=r.clientY,null==(n=t.move)||n.call(t,{originalEvent:e,...t})}(e,t)}}(t.value);i._touchHandlers=i._touchHandlers??Object.create(null),i._touchHandlers[a]=o,Wt(o).forEach(e=>{i.addEventListener(e,o[e],s)})},unmounted:function(e,t){var n,r;const i=(null==(n=t.value)?void 0:n.parent)?e.parentElement:e,s=null==(r=t.instance)?void 0:r.$.uid;if(!(null==i?void 0:i._touchHandlers)||!s)return;const a=i._touchHandlers[s];Wt(a).forEach(e=>{i.removeEventListener(e,a[e])}),delete i._touchHandlers[s]}},pO=Symbol.for("vuetify:v-window"),fO=Symbol.for("vuetify:v-window-group"),mO=oe({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>"boolean"==typeof e||"hover"===e},verticalArrows:[Boolean,String],touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},..._e(),...zC(),...we()},"VWindow"),vO=ae()({name:"VWindow",directives:{vTouch:hO},props:mO(),emits:{"update:modelValue":e=>!0},setup(e,n){let{slots:r}=n;const{themeClasses:i}=xe(e),{isRtl:s}=Oe(),{t:a}=kt(),o=IE(e,fO),l=t(),u=f(()=>s.value?!e.reverse:e.reverse),c=v(!1),h=f(()=>`v-window-${"vertical"===e.direction?"y":"x"}${(u.value?!c.value:c.value)?"-reverse":""}-transition`),p=v(0),m=t(void 0),g=f(()=>o.items.value.findIndex(e=>o.selected.value.includes(e.id)));d(g,(e,t)=>{const n=o.items.value.length,r=n-1;c.value=n<=2?e<t:e===r&&0===t||(0!==e||t!==r)&&e<t}),O(pO,{transition:h,isReversed:c,transitionCount:p,transitionHeight:m,rootRef:l});const I=x(()=>e.continuous||0!==g.value),S=x(()=>e.continuous||g.value!==o.items.value.length-1);function k(){I.value&&o.prev()}function T(){S.value&&o.next()}const C=f(()=>{const t=[],n={icon:s.value?e.nextIcon:e.prevIcon,class:"v-window__"+(u.value?"right":"left"),onClick:o.prev,"aria-label":a("$vuetify.carousel.prev")};t.push(I.value?r.prev?r.prev({props:n}):y(lx,n,null):_("div",null,null));const i={icon:s.value?e.prevIcon:e.nextIcon,class:"v-window__"+(u.value?"left":"right"),onClick:o.next,"aria-label":a("$vuetify.carousel.next")};return t.push(S.value?r.next?r.next({props:i}):y(lx,i,null):_("div",null,null)),t}),E=f(()=>{if(!1===e.touch)return e.touch;return{...{left:()=>{u.value?k():T()},right:()=>{u.value?T():k()},start:e=>{let{originalEvent:t}=e;t.stopPropagation()}},...!0===e.touch?{}:e.touch}});return be(()=>A(y(e.tag,{ref:l,class:w(["v-window",{"v-window--show-arrows-on-hover":"hover"===e.showArrows,"v-window--vertical-arrows":!!e.verticalArrows},i.value,e.class]),style:b(e.style)},{default:()=>{var t,n;return[_("div",{class:"v-window__container",style:{height:m.value}},[null==(t=r.default)?void 0:t.call(r,{group:o}),!1!==e.showArrows&&_("div",{class:w(["v-window__controls",{"v-window__controls--left":"left"===e.verticalArrows||!0===e.verticalArrows},{"v-window__controls--right":"right"===e.verticalArrows}])},[C.value])]),null==(n=r.additional)?void 0:n.call(r,{group:o})]}}),[[hO,E.value]])),{group:o}}}),gO=oe({...Je(mO(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),yO=ae()({name:"VTabsWindow",props:gO(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const i=r(lO,null),s=Ae(e,"modelValue"),a=f({get(){var e;return null==s.value&&i?null==(e=i.items.value.find(e=>i.selected.value.includes(e.id)))?void 0:e.value:s.value},set(e){s.value=e}});return be(()=>{const t=vO.filterProps(e);return y(vO,k({_as:"VTabsWindow"},t,{modelValue:a.value,"onUpdate:modelValue":e=>a.value=e,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),n)}),{}}}),bO=oe({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},..._e(),...wE(),...xA()},"VWindowItem"),wO=ae()({name:"VWindowItem",directives:{vTouch:hO},props:bO(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const i=r(pO),s=_E(e,fO),{isBooted:a}=Ux();if(!i||!s)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const o=v(!1),l=f(()=>a.value&&(i.isReversed.value?!1!==e.reverseTransition:!1!==e.transition));function u(){o.value&&i&&(o.value=!1,i.transitionCount.value>0&&(i.transitionCount.value-=1,0===i.transitionCount.value&&(i.transitionHeight.value=void 0)))}function c(){var e;!o.value&&i&&(o.value=!0,0===i.transitionCount.value&&(i.transitionHeight.value=ve(null==(e=i.rootRef.value)?void 0:e.clientHeight)),i.transitionCount.value+=1)}function d(){u()}function p(e){o.value&&h(()=>{l.value&&o.value&&i&&(i.transitionHeight.value=ve(e.clientHeight))})}const m=f(()=>{const t=i.isReversed.value?e.reverseTransition:e.transition;return!!l.value&&{name:"string"!=typeof t?i.transition.value:t,onBeforeEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:c,onAfterLeave:u,onLeaveCancelled:d,onEnter:p}}),{hasContent:g}=AA(e,s.isSelected);return be(()=>y(ZC,{transition:m.value,disabled:!a.value},{default:()=>{var t;return[A(_("div",{class:w(["v-window-item",s.selectedClass.value,e.class]),style:b(e.style)},[g.value&&(null==(t=n.default)?void 0:t.call(n))]),[[D,s.isSelected.value]])]}})),{groupItem:s}}}),_O=oe({...bO()},"VTabsWindowItem"),IO=ae()({name:"VTabsWindowItem",props:_O(),setup(e,t){let{slots:n}=t;return be(()=>{const t=wO.filterProps(e);return y(wO,k({_as:"VTabsWindowItem"},t,{class:["v-tabs-window-item",e.class],style:e.style}),n)}),{}}});const SO=oe({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...TN({mandatory:"force",selectedClass:"v-tab-item--selected"}),...oE(),...zC()},"VTabs"),kO=ae()({name:"VTabs",props:SO(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:r}=t;const i=Ae(e,"modelValue"),s=f(()=>function(e){return e?e.map(e=>ke(e)?e:{text:e,value:e}):[]}(e.items)),{densityClasses:a}=lE(e),{backgroundColorClasses:o,backgroundColorStyles:l}=BC(()=>e.bgColor),{scopeId:u}=NA();return le({VTab:{color:x(()=>e.color),direction:x(()=>e.direction),stacked:x(()=>e.stacked),fixed:x(()=>e.fixedTabs),sliderColor:x(()=>e.sliderColor),hideSlider:x(()=>e.hideSlider)}}),be(()=>{const t=CN.filterProps(e),c=!!(r.window||e.items.length>0);return _(N,null,[y(CN,k(t,{modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},a.value,o.value,e.class],style:[{"--v-tabs-height":ve(e.height)},l.value,e.style],role:"tablist",symbol:lO},u,n),{default:()=>{var e;return[(null==(e=r.default)?void 0:e.call(r))??s.value.map(e=>{var t;return(null==(t=r.tab)?void 0:t.call(r,{item:e}))??y(cO,k(e,{key:e.text,value:e.value}),{default:r[`tab.${e.value}`]?()=>{var t;return null==(t=r[`tab.${e.value}`])?void 0:t.call(r,{item:e})}:void 0})})]}}),c&&y(yO,k({modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,key:"tabs-window"},u),{default:()=>{var e;return[s.value.map(e=>{var t;return(null==(t=r.item)?void 0:t.call(r,{item:e}))??y(IO,{value:e.value},{default:()=>{var t;return null==(t=r[`item.${e.value}`])?void 0:t.call(r,{item:e})}})}),null==(e=r.window)?void 0:e.call(r)]}})])}),{}}}),TO={class:"d-flex align-center w-100"},CO={class:"d-flex align-center mr-8"},EO={class:"w-100 minimal-tabs-container"},xO={key:0},AO={key:1,class:"text-center pa-16 minimal-loading"},NO={key:1,class:"text-center pa-16 minimal-welcome"},DO=VC(ie({__name:"App",setup(e){const n=_C(),r=PC(),i=RC(),s=t([{id:"view-all",name:"所持状況一覧",icon:"mdi-account-multiple"},{id:"add-owned",name:"所持キャラ追加",icon:"mdi-account-plus"},{id:"manage-items",name:"アイテム管理",icon:"mdi-sword-cross"},{id:"manage-teams",name:"編成管理",icon:"mdi-account-group"},{id:"add-master",name:"マスター追加",icon:"mdi-database-plus"},{id:"edit-master",name:"マスター編集",icon:"mdi-database-edit"}]),a=f(()=>"add-owned"===i.activeTab||"manage-items"===i.activeTab);P(()=>{n.initAuthListener()}),d(()=>n.user,e=>{e&&n.userId?async function(){if(r.dataLoaded)return;if(!n.userId)return;try{i.setLoading(!0),await r.loadInitialData(n.userId),r.accounts.length>0&&i.setSelectedAccountId(r.accounts[0].id)}catch(e){i.showError(`データ読み込みエラー: ${e.message}`)}finally{i.setLoading(!1)}}():(r.resetData(),i.resetUI())});const o=async()=>{try{await n.loginWithGoogle()}catch(e){i.showError("ログインに失敗しました")}},l=async()=>{await n.logout()};const u=async({accountId:e,newCharacter:t})=>{const n=r.ownedCharactersData.get(e)||[];n.push(t),r.updateOwnedCharactersForAccount(e,n),i.showSuccess("キャラクターを追加しました")},c=async({accountId:e,ownedCharacterId:t,characterMasterId:n,items:s,isNew:a})=>{try{if(a)await r.addOwnedCharacter(e,{characterMasterId:n,items:s}),i.showSuccess("キャラクターを追加しました");else{if(!t)throw new Error("ownedCharacterIdが必要です");await CC(e,t,s);const n=r.ownedCharactersData.get(e)||[],a=n.find(e=>e.id===t);a&&(a.items=s),r.updateOwnedCharactersForAccount(e,n),i.showSuccess("アイテムを更新しました")}}catch(o){i.showError(`アイテム更新エラー: ${o.message}`)}},h=({accountId:e,from:t,to:n})=>{const i=r.ownedCharactersData.get(e)||[],s=i.find(e=>e.id===t.id),a=i.find(e=>e.id===n.id);s&&(s.items=t.items),a&&(a.items=n.items),r.updateOwnedCharactersForAccount(e,i)},p=e=>{const t=[e,...r.teams];r.setTeams(t),i.showSuccess("チームを追加しました")},m=e=>{const t=r.teams.map(t=>t.id===e.id?{...t,...e}:t);r.setTeams(t),i.showSuccess("チームを更新しました")},v=e=>{const t=r.teams.filter(t=>t.id!==e);r.setTeams(t),i.showSuccess("チームを削除しました")},g=()=>{location.reload()};return(e,t)=>(G(),W(QV,null,{default:K(()=>[y(rO,{app:"",color:"white",elevation:"0",class:"minimal-header",height:"64"},ne({default:K(()=>[_("div",TO,[_("div",CO,[y(GC,{icon:"mdi-dragon",size:"28",class:"mr-3",color:"primary"}),y(XV,{class:"text-h5 font-weight-medium text-primary"},{default:K(()=>t[4]||(t[4]=[H(" キャラクター管理 ",-1)])),_:1,__:[4]})]),y(QD),y(QA,{onLogin:o,onLogout:l,class:"mr-4"})])]),_:2},[M(n).isLoggedIn?{name:"extension",fn:K(()=>[_("div",EO,[y(kO,{modelValue:M(i).activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>M(i).activeTab=e),"align-with-title":"",color:"primary",class:"minimal-tabs",height:"48"},{default:K(()=>[(G(!0),q(N,null,J(s.value,e=>(G(),W(cO,{key:e.id,value:e.id,class:"minimal-tab"},{default:K(()=>[y(GC,{icon:e.icon,class:"mr-2",size:"20"},null,8,["icon"]),H(" "+B(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),key:"0"}:void 0]),1024),y(sO,null,{default:K(()=>[y(SD,{class:"pa-6 main-container"},{default:K(()=>[M(n).isLoggedIn?(G(),q("div",xO,[y(JN,{accounts:M(r).accounts,modelValue:M(i).selectedAccountId,"onUpdate:modelValue":t[1]||(t[1]=e=>M(i).selectedAccountId=e),visible:a.value,class:"mb-6 minimal-account-selector"},null,8,["accounts","modelValue","visible"]),M(r).dataLoaded?(G(),W(vO,{key:0,modelValue:M(i).activeTab,"onUpdate:modelValue":t[2]||(t[2]=e=>M(i).activeTab=e),class:"minimal-window"},{default:K(()=>[y(wO,{value:"view-all",key:"view-all"},{default:K(()=>[y(KR,{onItemsUpdated:c})]),_:1}),y(wO,{value:"add-owned",key:"add-owned"},{default:K(()=>[y(iV,{onCharacterAdded:u})]),_:1}),y(wO,{value:"manage-items",key:"manage-items"},{default:K(()=>[y(wV,{onItemsUpdated:c,onItemsMoved:h})]),_:1}),y(wO,{value:"manage-teams",key:"manage-teams"},{default:K(()=>[y($V,{onTeamAdded:p,onTeamUpdated:m,onTeamDeleted:v})]),_:1}),y(wO,{value:"add-master",key:"add-master"},{default:K(()=>[y(qV,{onMasterAdded:g})]),_:1}),y(wO,{value:"edit-master",key:"edit-master"},{default:K(()=>[y(HV,{onMasterUpdated:g})]),_:1})]),_:1},8,["modelValue"])):(G(),q("div",AO,[y(AE,{indeterminate:"",color:"primary",size:"64",width:"4",class:"mb-6"}),t[5]||(t[5]=_("p",{class:"text-body-1 text-grey-darken-1"}," データを読み込んでいます... ",-1))]))])):(G(),q("div",NO,[y(GC,{icon:"mdi-dragon",size:"80",color:"primary",class:"mb-6"}),t[7]||(t[7]=_("h1",{class:"text-h4 font-weight-medium text-primary mb-4"}," キャラクター管理システム ",-1)),t[8]||(t[8]=_("p",{class:"text-body-1 text-grey-darken-1 mb-8"}," ログインして、あなたのキャラクターを管理しましょう ",-1)),y(lx,{color:"primary",size:"large",variant:"outlined",class:"px-8",onClick:o},{default:K(()=>[y(GC,{icon:"mdi-login",class:"mr-2"}),t[6]||(t[6]=H(" ログイン ",-1))]),_:1,__:[6]})]))]),_:1})]),_:1}),y(oO,{modelValue:M(i).snackbar.show,"onUpdate:modelValue":t[3]||(t[3]=e=>M(i).snackbar.show=e),color:M(i).snackbar.color,timeout:3e3},{actions:K(()=>[y(lx,{variant:"text",onClick:M(i).hideSnackbar},{default:K(()=>t[9]||(t[9]=[H(" 閉じる ",-1)])),_:1,__:[9]},8,["onClick"])]),default:K(()=>[H(B(M(i).snackbar.message)+" ",1)]),_:1},8,["modelValue","color"])]),_:1}))}}),[["__scopeId","data-v-5d56edaf"]]),PO=Qt({theme:{defaultTheme:"light",themes:{light:{colors:{primary:"#1976d2",secondary:"#424242",accent:"#42a5f5",success:"#4caf50",warning:"#ff9800",error:"#f44336",info:"#2196f3",surface:"#ffffff",background:"#fafafa","on-surface":"#212121","on-background":"#212121"}}}},defaults:{VCard:{variant:"outlined",elevation:0,rounded:"md"},VBtn:{variant:"outlined",rounded:"md",class:"text-none font-weight-medium"},VTextField:{variant:"outlined",density:"compact",rounded:"md"},VSelect:{variant:"outlined",density:"compact",rounded:"md"},VList:{density:"compact"},VListItem:{rounded:"sm"},VChip:{rounded:"md",variant:"outlined"},VAvatar:{rounded:"md"},VIcon:{size:"20"}}});const RO=new class{constructor(){this.markers=new Map,this.measures=new Map}startMarker(e){this.markers.set(e,performance.now()),performance.mark(`${e}-start`)}endMarker(e){const t=this.markers.get(e);if(t){const n=performance.now()-t;return performance.mark(`${e}-end`),performance.measure(e,`${e}-start`,`${e}-end`),this.measures.set(e,n),n}return 0}getMeasure(e){return this.measures.get(e)}getAllMeasures(){return Object.fromEntries(this.measures)}clear(){this.markers.clear(),this.measures.clear()}};RO.startMarker("app-init");const VO=se(DO),OO=function(){const r=e(!0),i=r.run(()=>t({}));let s=[],a=[];const o=n({install(e){Xt(o),o._a=e,e.provide(Jt,o),e.config.globalProperties.$pinia=o,a.forEach(e=>s.push(e)),a=[]},use(e){return this._a?s.push(e):a.push(e),this},_p:s,_a:null,_e:r,_s:new Map,state:i});return o}();VO.use(OO),VO.use(PO),((e={})=>{const{loadTime:t=3e3,memoryUsage:n=50}=e;window.addEventListener("load",()=>{performance.now()});const r=performance;r.memory&&setInterval(()=>{const e=r.memory;e&&(e.usedJSHeapSize,e.jsHeapSizeLimit)},1e4)})({loadTime:2e3,memoryUsage:60}),VO.mount("#app"),RO.endMarker("app-init");export{dk as P,nT as R,zT as W,nk as _,ik as a,iT as b,NT as c,ET as d,zl as g,li as i,rk as m,PT as p,oT as x,DT as y};
